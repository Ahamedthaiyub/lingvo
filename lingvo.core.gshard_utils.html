

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>lingvo.core.gshard_utils module &mdash; Lingvo  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="lingvo.core.hyperparams module" href="lingvo.core.hyperparams.html" />
    <link rel="prev" title="lingvo.core.gshard_layers module" href="lingvo.core.gshard_layers.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Lingvo
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="lingvo.html">lingvo package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="lingvo.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="lingvo.core.html">lingvo.core package</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="lingvo.core.html#subpackages">Subpackages</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="lingvo.core.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lingvo.tasks.html">lingvo.tasks package</a></li>
<li class="toctree-l3"><a class="reference internal" href="lingvo.tools.html">lingvo.tools package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lingvo.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Lingvo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="lingvo.html">lingvo package</a> &raquo;</li>
        
          <li><a href="lingvo.core.html">lingvo.core package</a> &raquo;</li>
        
      <li>lingvo.core.gshard_utils module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/lingvo.core.gshard_utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-lingvo.core.gshard_utils">
<span id="lingvo-core-gshard-utils-module"></span><h1>lingvo.core.gshard_utils module<a class="headerlink" href="#module-lingvo.core.gshard_utils" title="Permalink to this headline">¶</a></h1>
<p>Utilities for applying xla-sharding to a model.</p>
<dl class="py function">
<dt id="lingvo.core.gshard_utils.Split">
<code class="sig-prename descclassname">lingvo.core.gshard_utils.</code><code class="sig-name descname">Split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">split_dimension</span></em>, <em class="sig-param"><span class="n">num_devices</span></em>, <em class="sig-param"><span class="n">use_sharding_op</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">input_shape</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#Split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.Split" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for xla_sharding.split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Tensor to annotate.</p></li>
<li><p><strong>split_dimension</strong> – xla_sharding.split arg.</p></li>
<li><p><strong>num_devices</strong> – xla_sharding.split arg.</p></li>
<li><p><strong>use_sharding_op</strong> – <p>If true, adds a sharding op to set the sharding: tensor =
gen_xla_ops.xla_sharding(tensor)</p>
<dl class="simple">
<dt>hyouklee&#64;: use_sharding_op=False “It adds the sharding attribute to the op</dt><dd><p>itself. The outcome is that, that information could be lost by TF graph
transformations. Also, directly attaching the sharding annotation to the
op caused some compilation failures in the past (due to incompatible
shardings), so the plan is to make use_sharding_op to be the default.”
“The only case I would set it to False today is when annotating weights.
Weight annotation does some special handling, so there may be some
changes needed in that logic if we add separate sharding op.”</p>
</dd>
</dl>
</p></li>
<li><p><strong>input_shape</strong> – The shape of the original tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor conditionally annotated with sharding.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lingvo.core.gshard_utils.MeshSplit">
<code class="sig-prename descclassname">lingvo.core.gshard_utils.</code><code class="sig-name descname">MeshSplit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">device_mesh</span></em>, <em class="sig-param"><span class="n">tensor_split_dims_mapping</span></em>, <em class="sig-param"><span class="n">use_sharding_op</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#MeshSplit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.MeshSplit" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper of xla_sharding.mesh_split().</p>
</dd></dl>

<dl class="py function">
<dt id="lingvo.core.gshard_utils.ZigzagOrderOnDeviceMesh">
<code class="sig-prename descclassname">lingvo.core.gshard_utils.</code><code class="sig-name descname">ZigzagOrderOnDeviceMesh</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">device_mesh</span></em>, <em class="sig-param"><span class="n">zigzag_mesh_dim</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#ZigzagOrderOnDeviceMesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.ZigzagOrderOnDeviceMesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Permutes device_mesh to form zigzag order along zigzag_mesh_dim.</p>
</dd></dl>

<dl class="py function">
<dt id="lingvo.core.gshard_utils.GetNonPod2dMesh">
<code class="sig-prename descclassname">lingvo.core.gshard_utils.</code><code class="sig-name descname">GetNonPod2dMesh</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">device_mesh_shape</span></em>, <em class="sig-param"><span class="n">physical_mesh_shape</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#GetNonPod2dMesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.GetNonPod2dMesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 2D device mesh on slices smaller than a pod.</p>
</dd></dl>

<dl class="py function">
<dt id="lingvo.core.gshard_utils.ReshapeDim">
<code class="sig-prename descclassname">lingvo.core.gshard_utils.</code><code class="sig-name descname">ReshapeDim</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">dim</span></em>, <em class="sig-param"><span class="n">dim_reshape_segments</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#ReshapeDim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.ReshapeDim" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshapes tensor x according to dim_reshape_segments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – A input Tensor of shape […, x.shape[dim], …].</p></li>
<li><p><strong>dim</strong> – The dim that needs to be reshaped.</p></li>
<li><p><strong>dim_reshape_segments</strong> – The leading dim size of the reshaped dims.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Tensor of shape […, dim_reshape_segments,
x.shape[dim] // dim_reshape_segments, …].</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec">
<em class="property">class </em><code class="sig-prename descclassname">lingvo.core.gshard_utils.</code><code class="sig-name descname">TensorShardingSpec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">split_dims_mapping</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)">int</a><span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">device_mesh</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)">numpy.ndarray</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">uneven_padding</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)">int</a><span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#TensorShardingSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.7/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Represents a sharding annotation for GShard/XLA.</p>
<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.FromFullShape">
<em class="property">classmethod </em><code class="sig-name descname">FromFullShape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">full_shape</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)">int</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">split_dims_mapping</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)">int</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">device_mesh</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)">numpy.ndarray</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#TensorShardingSpec.FromFullShape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.FromFullShape" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates tiled sharding spec with uneven padding computed from shape.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.ApplyToTensor">
<code class="sig-name descname">ApplyToTensor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor</span><span class="p">:</span> <span class="n">tensorflow.python.framework.ops.Tensor</span></em>, <em class="sig-param"><span class="n">use_sharding_op</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)">bool</a></span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; tensorflow.python.framework.ops.Tensor<a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#TensorShardingSpec.ApplyToTensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.ApplyToTensor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.ApplyToVariable">
<code class="sig-name descname">ApplyToVariable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">variable</span><span class="p">:</span> <span class="n">tensorflow.python.ops.variables.VariableV1</span></em><span class="sig-paren">)</span> &#x2192; tensorflow.python.ops.variables.VariableV1<a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#TensorShardingSpec.ApplyToVariable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.ApplyToVariable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.ShardShape">
<code class="sig-name descname">ShardShape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">full_shape</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)">int</a><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Sequence<span class="p">[</span><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)">int</a><span class="p">]</span><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#TensorShardingSpec.ShardShape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.ShardShape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the shape after applying this sharding to full_shape.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.ManualToAutoPartitioning">
<code class="sig-name descname">ManualToAutoPartitioning</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor</span><span class="p">:</span> <span class="n">tensorflow.python.framework.ops.Tensor</span></em><span class="sig-paren">)</span> &#x2192; tensorflow.python.framework.ops.Tensor<a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#TensorShardingSpec.ManualToAutoPartitioning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.ManualToAutoPartitioning" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts manually sharded tensor to full-size for auto partitioning.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.AutoToManualPartitioning">
<code class="sig-name descname">AutoToManualPartitioning</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor</span><span class="p">:</span> <span class="n">tensorflow.python.framework.ops.Tensor</span></em><span class="sig-paren">)</span> &#x2192; tensorflow.python.framework.ops.Tensor<a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#TensorShardingSpec.AutoToManualPartitioning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.AutoToManualPartitioning" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts full-size tensor (auto partitioning) to manually sharded.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.ToXlaOpSharding">
<code class="sig-name descname">ToXlaOpSharding</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; tensorflow.compiler.xla.xla_data_pb2.OpSharding<a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#TensorShardingSpec.ToXlaOpSharding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.ToXlaOpSharding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.FromXlaOpSharding">
<em class="property">classmethod </em><code class="sig-name descname">FromXlaOpSharding</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">op_sharding_proto</span><span class="p">:</span> <span class="n">tensorflow.compiler.xla.xla_data_pb2.OpSharding</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lingvo.core.gshard_utils.TensorShardingSpec" title="lingvo.core.gshard_utils.TensorShardingSpec">lingvo.core.gshard_utils.TensorShardingSpec</a><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#TensorShardingSpec.FromXlaOpSharding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.FromXlaOpSharding" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses from an XLA OpSharding proto.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.AddLeadingDims">
<code class="sig-name descname">AddLeadingDims</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_dims</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)">int</a></span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lingvo.core.gshard_utils.TensorShardingSpec" title="lingvo.core.gshard_utils.TensorShardingSpec">lingvo.core.gshard_utils.TensorShardingSpec</a><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#TensorShardingSpec.AddLeadingDims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.AddLeadingDims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.RemoveLeadingDims">
<code class="sig-name descname">RemoveLeadingDims</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_dims</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)">int</a></span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lingvo.core.gshard_utils.TensorShardingSpec" title="lingvo.core.gshard_utils.TensorShardingSpec">lingvo.core.gshard_utils.TensorShardingSpec</a><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#TensorShardingSpec.RemoveLeadingDims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.RemoveLeadingDims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.RemoveDim">
<code class="sig-name descname">RemoveDim</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dim</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lingvo.core.gshard_utils.TensorShardingSpec" title="lingvo.core.gshard_utils.TensorShardingSpec">lingvo.core.gshard_utils.TensorShardingSpec</a><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#TensorShardingSpec.RemoveDim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.RemoveDim" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of self with dimension ‘dim’ removed.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.ReplicatedSpec">
<em class="property">classmethod </em><code class="sig-name descname">ReplicatedSpec</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#TensorShardingSpec.ReplicatedSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.ReplicatedSpec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.split_dims_mapping">
<em class="property">property </em><code class="sig-name descname">split_dims_mapping</code><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.split_dims_mapping" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.device_mesh">
<em class="property">property </em><code class="sig-name descname">device_mesh</code><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.device_mesh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.is_replicated">
<em class="property">property </em><code class="sig-name descname">is_replicated</code><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.is_replicated" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.mesh_dim_to_tensor_dim_mapping">
<em class="property">property </em><code class="sig-name descname">mesh_dim_to_tensor_dim_mapping</code><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.mesh_dim_to_tensor_dim_mapping" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lingvo.core.gshard_utils.TensorShardingSpec.uneven_padding">
<em class="property">property </em><code class="sig-name descname">uneven_padding</code><a class="headerlink" href="#lingvo.core.gshard_utils.TensorShardingSpec.uneven_padding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="lingvo.core.gshard_utils.GetVarSharding">
<code class="sig-prename descclassname">lingvo.core.gshard_utils.</code><code class="sig-name descname">GetVarSharding</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">var</span><span class="p">:</span> <span class="n">tensorflow.python.ops.variables.VariableV1</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lingvo.core.gshard_utils.TensorShardingSpec" title="lingvo.core.gshard_utils.TensorShardingSpec">lingvo.core.gshard_utils.TensorShardingSpec</a><a class="reference internal" href="_modules/lingvo/core/gshard_utils.html#GetVarSharding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.gshard_utils.GetVarSharding" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the sharding directly attached to a variable.</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="lingvo.core.hyperparams.html" class="btn btn-neutral float-right" title="lingvo.core.hyperparams module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="lingvo.core.gshard_layers.html" class="btn btn-neutral float-left" title="lingvo.core.gshard_layers module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>