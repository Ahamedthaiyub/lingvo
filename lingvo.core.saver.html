<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lingvo.core.saver module &mdash; Lingvo  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="lingvo.core.scatter_update module" href="lingvo.core.scatter_update.html" />
    <link rel="prev" title="lingvo.core.routing_config_helper module" href="lingvo.core.routing_config_helper.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Lingvo
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="lingvo.html">lingvo package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="lingvo.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="lingvo.core.html">lingvo.core package</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="lingvo.core.html#subpackages">Subpackages</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="lingvo.core.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lingvo.tasks.html">lingvo.tasks package</a></li>
<li class="toctree-l3"><a class="reference internal" href="lingvo.tools.html">lingvo.tools package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lingvo.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Lingvo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="lingvo.html">lingvo package</a> &raquo;</li>
          <li><a href="lingvo.core.html">lingvo.core package</a> &raquo;</li>
      <li>lingvo.core.saver module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/lingvo.core.saver.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-lingvo.core.saver">
<span id="lingvo-core-saver-module"></span><h1>lingvo.core.saver module<a class="headerlink" href="#module-lingvo.core.saver" title="Permalink to this headline"></a></h1>
<p>A saver that we use to save and restore variables.</p>
<p>The implementation mimics tf.train.Saver. Meanwhile, it allows us
to carry out extra sanity checks on the checkpoint.</p>
<dl class="py class">
<dt class="sig sig-object py" id="lingvo.core.saver.SanityCheck">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">lingvo.core.saver.</span></span><span class="sig-name descname"><span class="pre">SanityCheck</span></span><a class="reference internal" href="_modules/lingvo/core/saver.html#SanityCheck"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.SanityCheck" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.7/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="lingvo.core.saver.SanityCheck.Check">
<span class="sig-name descname"><span class="pre">Check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#SanityCheck.Check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.SanityCheck.Check" title="Permalink to this definition"></a></dt>
<dd><p>Returns true iff the sanity check passes.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lingvo.core.saver.InRange">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">lingvo.core.saver.</span></span><span class="sig-name descname"><span class="pre">InRange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#InRange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.InRange" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#lingvo.core.saver.SanityCheck" title="lingvo.core.saver.SanityCheck"><code class="xref py py-class docutils literal notranslate"><span class="pre">lingvo.core.saver.SanityCheck</span></code></a></p>
<p>Sanity check a value is within [low, high].</p>
<dl class="py method">
<dt class="sig sig-object py" id="lingvo.core.saver.InRange.Check">
<span class="sig-name descname"><span class="pre">Check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#InRange.Check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.InRange.Check" title="Permalink to this definition"></a></dt>
<dd><p>Returns true iff the sanity check passes.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lingvo.core.saver.IsFinite">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">lingvo.core.saver.</span></span><span class="sig-name descname"><span class="pre">IsFinite</span></span><a class="reference internal" href="_modules/lingvo/core/saver.html#IsFinite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.IsFinite" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#lingvo.core.saver.SanityCheck" title="lingvo.core.saver.SanityCheck"><code class="xref py py-class docutils literal notranslate"><span class="pre">lingvo.core.saver.SanityCheck</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="lingvo.core.saver.IsFinite.Check">
<span class="sig-name descname"><span class="pre">Check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#IsFinite.Check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.IsFinite.Check" title="Permalink to this definition"></a></dt>
<dd><p>Returns true iff the sanity check passes.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingvo.core.saver._VarKey">
<span class="sig-prename descclassname"><span class="pre">lingvo.core.saver.</span></span><span class="sig-name descname"><span class="pre">_VarKey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#_VarKey"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver._VarKey" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lingvo.core.saver.Saver">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">lingvo.core.saver.</span></span><span class="sig-name descname"><span class="pre">Saver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sanity_checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_latest_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_every_n_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#Saver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.Saver" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.7/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Simpler version of tf.train.Saver with extra sanity checks.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lingvo.core.saver.Saver._BuildSave">
<span class="sig-name descname"><span class="pre">_BuildSave</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#Saver._BuildSave"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.Saver._BuildSave" title="Permalink to this definition"></a></dt>
<dd><p>Builds save ops.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingvo.core.saver.Saver._BuildRestore">
<span class="sig-name descname"><span class="pre">_BuildRestore</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#Saver._BuildRestore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.Saver._BuildRestore" title="Permalink to this definition"></a></dt>
<dd><p>Builds restore ops.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingvo.core.saver.Saver._GetState">
<span class="sig-name descname"><span class="pre">_GetState</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#Saver._GetState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.Saver._GetState" title="Permalink to this definition"></a></dt>
<dd><p>Returns the latest checkpoint id.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingvo.core.saver.Saver._SetState">
<span class="sig-name descname"><span class="pre">_SetState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#Saver._SetState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.Saver._SetState" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingvo.core.saver.Saver._GetCheckpointId">
<span class="sig-name descname"><span class="pre">_GetCheckpointId</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename_prefix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#Saver._GetCheckpointId"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.Saver._GetCheckpointId" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingvo.core.saver.Saver._GarbageCollect">
<span class="sig-name descname"><span class="pre">_GarbageCollect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#Saver._GarbageCollect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.Saver._GarbageCollect" title="Permalink to this definition"></a></dt>
<dd><p>Garbage collect obsolete checkpoint files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingvo.core.saver.Saver._DoSanityCheck">
<span class="sig-name descname"><span class="pre">_DoSanityCheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#Saver._DoSanityCheck"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.Saver._DoSanityCheck" title="Permalink to this definition"></a></dt>
<dd><p>Sanity-check the content of the checkpoint.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingvo.core.saver.Saver.Save">
<span class="sig-name descname"><span class="pre">Save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sess</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#Saver.Save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.Saver.Save" title="Permalink to this definition"></a></dt>
<dd><p>Generate a new checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sess</strong> – A session with tf.Graph under which this object is constructed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If the checkpoint is successfully generated, returns its global step
and file prefix. Otherwise, raises an Aborted error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingvo.core.saver.Saver._UpdateState">
<span class="sig-name descname"><span class="pre">_UpdateState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#Saver._UpdateState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.Saver._UpdateState" title="Permalink to this definition"></a></dt>
<dd><p>Updates the checkpoint state with the new checkpoint prefix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingvo.core.saver.Saver.Restore">
<span class="sig-name descname"><span class="pre">Restore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#Saver.Restore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.Saver.Restore" title="Permalink to this definition"></a></dt>
<dd><p>Restore variables from a checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> – A session with tf.Graph under which this object is constructed.</p></li>
<li><p><strong>checkpoint_id</strong> – If None, restore from the latest checkpoint. Otherwise,
restore from the specific checkpoint.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If no checkpoint has been generated, returns (0, “”).  Otherwise, try to
restore from the specified or the latest checkpoint. If the checkpoint is
successfully restored, returns the checkpoint’s global step and file
prefix. Otherwise, raises an error.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingvo.core.saver.WriteNpArrays">
<span class="sig-prename descclassname"><span class="pre">lingvo.core.saver.</span></span><span class="sig-name descname"><span class="pre">WriteNpArrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmap</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#WriteNpArrays"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.WriteNpArrays" title="Permalink to this definition"></a></dt>
<dd><p>Writes a NestedMap of numpy arrays into a TF checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_prefix</strong> – A TF checkpoint filename prefix.</p></li>
<li><p><strong>nmap</strong> – A NestedMap of numpy arrays.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingvo.core.saver.ReadNpArrays">
<span class="sig-prename descclassname"><span class="pre">lingvo.core.saver.</span></span><span class="sig-name descname"><span class="pre">ReadNpArrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmap</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/saver.html#ReadNpArrays"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingvo.core.saver.ReadNpArrays" title="Permalink to this definition"></a></dt>
<dd><p>Reads from a tf checkpoint to fill in values of a NesteMap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_prefix</strong> – A TF checkpoint filename prefix.</p></li>
<li><p><strong>nmap</strong> – A NestedMap of numpy dtypes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A NestedMap with numpy arrays compatible w/ nmap.</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="lingvo.core.routing_config_helper.html" class="btn btn-neutral float-left" title="lingvo.core.routing_config_helper module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="lingvo.core.scatter_update.html" class="btn btn-neutral float-right" title="lingvo.core.scatter_update module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>