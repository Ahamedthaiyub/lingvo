

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>lingvo.tasks.car.base_extractor module &mdash; Lingvo  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="lingvo.tasks.car.breakdown_metric module" href="lingvo.tasks.car.breakdown_metric.html" />
    <link rel="prev" title="lingvo.tasks.car.base_decoder module" href="lingvo.tasks.car.base_decoder.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Lingvo
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="lingvo.html">lingvo package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="lingvo.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="lingvo.core.html">lingvo.core package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="lingvo.tasks.html">lingvo.tasks package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="lingvo.tasks.html#subpackages">Subpackages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lingvo.tools.html">lingvo.tools package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lingvo.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Lingvo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="lingvo.html">lingvo package</a> &raquo;</li>
        
          <li><a href="lingvo.tasks.html">lingvo.tasks package</a> &raquo;</li>
        
          <li><a href="lingvo.tasks.car.html">lingvo.tasks.car package</a> &raquo;</li>
        
      <li>lingvo.tasks.car.base_extractor module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/lingvo.tasks.car.base_extractor.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-lingvo.tasks.car.base_extractor">
<span id="lingvo-tasks-car-base-extractor-module"></span><h1>lingvo.tasks.car.base_extractor module<a class="headerlink" href="#module-lingvo.tasks.car.base_extractor" title="Permalink to this headline">¶</a></h1>
<p>Base extractor interface.</p>
<dl class="py function">
<dt id="lingvo.tasks.car.base_extractor._ParseSequenceExample">
<code class="sig-prename descclassname">lingvo.tasks.car.base_extractor.</code><code class="sig-name descname">_ParseSequenceExample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">record</span></em>, <em class="sig-param"><span class="n">feature_map</span></em>, <em class="sig-param"><span class="n">context_map</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_ParseSequenceExample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._ParseSequenceExample" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a SequenceExample, adding the context features to the features.</p>
</dd></dl>

<dl class="py function">
<dt id="lingvo.tasks.car.base_extractor._TextInput">
<code class="sig-prename descclassname">lingvo.tasks.car.base_extractor.</code><code class="sig-name descname">_TextInput</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">record</span></em>, <em class="sig-param"><span class="n">feature_map</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_TextInput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._TextInput" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="lingvo.tasks.car.base_extractor._BaseExtractor">
<em class="property">class </em><code class="sig-prename descclassname">lingvo.tasks.car.base_extractor.</code><code class="sig-name descname">_BaseExtractor</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_BaseExtractor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._BaseExtractor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="lingvo.core.base_input_generator.html#lingvo.core.base_input_generator.BaseInputGeneratorFromFiles" title="lingvo.core.base_input_generator.BaseInputGeneratorFromFiles"><code class="xref py py-class docutils literal notranslate"><span class="pre">lingvo.core.base_input_generator.BaseInputGeneratorFromFiles</span></code></a></p>
<p>The base extractor for all lingvo car task datasets.</p>
<p>Subclasses should define and pass in a custom dictionary of extractors to
select which fields from car datasets to output from an input
generator.</p>
<p>Preprocessors are applied to all the extracted outputs jointly, in the
specified sequence.</p>
<dl class="py method">
<dt id="lingvo.tasks.car.base_extractor._BaseExtractor.Params">
<em class="property">classmethod </em><code class="sig-name descname">Params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">extractors</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_BaseExtractor.Params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._BaseExtractor.Params" title="Permalink to this definition">¶</a></dt>
<dd><p>Defaults params.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>extractors</strong> – An hyperparams.Params of extractor names to Extractors. A few
extractor types are <em>required</em>:
‘labels’: A LabelExtractor.Params().</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A base_layer Params object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.base_extractor._BaseExtractor.FeatureMap">
<code class="sig-name descname">FeatureMap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_BaseExtractor.FeatureMap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._BaseExtractor.FeatureMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a mapping from feature names to feature tensors.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.base_extractor._BaseExtractor.ContextMap">
<code class="sig-name descname">ContextMap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_BaseExtractor.ContextMap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._BaseExtractor.ContextMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a mapping from context names to context tensors.</p>
<p>ContextMap() is used for tf.SequenceExample datasets to extract
context_features.  In that scenario, FeatureMap() is used to extract
the sequence_features.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A map from context keys to context features.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.base_extractor._BaseExtractor.Shape">
<code class="sig-name descname">Shape</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_BaseExtractor.Shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._BaseExtractor.Shape" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.base_extractor._BaseExtractor.DType">
<code class="sig-name descname">DType</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_BaseExtractor.DType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._BaseExtractor.DType" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.base_extractor._BaseExtractor.class_names">
<em class="property">property </em><code class="sig-name descname">class_names</code><a class="headerlink" href="#lingvo.tasks.car.base_extractor._BaseExtractor.class_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.base_extractor._BaseExtractor._DataSourceFromFilePattern">
<code class="sig-name descname">_DataSourceFromFilePattern</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_pattern</span></em>, <em class="sig-param"><span class="n">input_source_weights</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_BaseExtractor._DataSourceFromFilePattern"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._BaseExtractor._DataSourceFromFilePattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and return input batch from a string file_pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_pattern</strong> – A string file pattern.</p></li>
<li><p><strong>input_source_weights</strong> – A list of float input source weights to control
input example mix in the batch. The records will be sampled from inputs
proportionally to these weights. Defaults to None which should be
treated as an empty list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of tf.Tensors where the tensors which contain the input data and
have major dimension same as size of input batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.base_extractor._BaseExtractor.ProcessFeatures">
<code class="sig-name descname">ProcessFeatures</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">features</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_BaseExtractor.ProcessFeatures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._BaseExtractor.ProcessFeatures" title="Permalink to this definition">¶</a></dt>
<dd><p>Process extracted features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>features</strong> – A dict of extracted Tensors from the records.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>bucket_id: A scalar int Tensor.</p></li>
<li><p>extracted: a NestedMap of Tensors extracted.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A tuple of tensors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.base_extractor._BaseExtractor.ExtractUsingExtractors">
<code class="sig-name descname">ExtractUsingExtractors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">record</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_BaseExtractor.ExtractUsingExtractors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._BaseExtractor.ExtractUsingExtractors" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts Tensors from a tf.Example record using self.extractors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>record</strong> – A tf.Example input to pass to tf.io.parse_single_example.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>bucket_id: A scalar int Tensor.</p></li>
<li><p>extracted: a NestedMap of Tensors extracted.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A tuple of tensors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.base_extractor._BaseExtractor._InputBatch">
<code class="sig-name descname">_InputBatch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_BaseExtractor._InputBatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._BaseExtractor._InputBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>The current input batch, not preprocessed.</p>
<p>This is meant to be overridden by subclasses, but not called directly.
Callers should use <code class="xref py py-obj docutils literal notranslate"><span class="pre">GetPreprocessedInputBatch()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <a class="reference internal" href="lingvo.core.py_utils.html#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of input tensors. Each tensor’s dim-0 must be the same
and denotes the batch dimension.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.base_extractor._BaseExtractor.GetCpuPassthroughKeys">
<code class="sig-name descname">GetCpuPassthroughKeys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_BaseExtractor.GetCpuPassthroughKeys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._BaseExtractor.GetCpuPassthroughKeys" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of keys from the input to skip sending to the device.</p>
<p>When running on TPU, a user may want to avoid sending some inputs to the
device; either the type is not supported (e.g., string), or the input will
not be processed on the device at all.  However, these items may be still
useful to passthrough to the “output”, e.g., for decoding purposes.</p>
<p>This function should return a list of keys from InputBatch() that should not
be sent to the TPU, but can be combined with the outputs of Decode() before
passing to PostProcessDecodeOut().</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A list of keys from the input to filter from being sent to the device,</dt><dd><p>which may be combined with the output of Decode() prior to
PostProcessDecodeOut().</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.base_extractor._BaseExtractor._NestedMapFromBatchedOutputs">
<code class="sig-name descname">_NestedMapFromBatchedOutputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outputs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/base_extractor.html#_BaseExtractor._NestedMapFromBatchedOutputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.base_extractor._BaseExtractor._NestedMapFromBatchedOutputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a NestedMap from a tuple of outputs from generic_input_op.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="lingvo.tasks.car.breakdown_metric.html" class="btn btn-neutral float-right" title="lingvo.tasks.car.breakdown_metric module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lingvo.tasks.car.base_decoder.html" class="btn btn-neutral float-left" title="lingvo.tasks.car.base_decoder module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>