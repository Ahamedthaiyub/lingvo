

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>lingvo.tasks.car.input_extractor module &mdash; Lingvo  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="lingvo.tasks.car.input_preprocessors module" href="lingvo.tasks.car.input_preprocessors.html" />
    <link rel="prev" title="lingvo.tasks.car.geometry module" href="lingvo.tasks.car.geometry.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Lingvo
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="lingvo.html">lingvo package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="lingvo.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="lingvo.core.html">lingvo.core package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="lingvo.tasks.html">lingvo.tasks package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="lingvo.tasks.html#subpackages">Subpackages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lingvo.tools.html">lingvo.tools package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lingvo.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Lingvo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="lingvo.html">lingvo package</a> &raquo;</li>
        
          <li><a href="lingvo.tasks.html">lingvo.tasks package</a> &raquo;</li>
        
          <li><a href="lingvo.tasks.car.html">lingvo.tasks.car package</a> &raquo;</li>
        
      <li>lingvo.tasks.car.input_extractor module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/lingvo.tasks.car.input_extractor.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-lingvo.tasks.car.input_extractor">
<span id="lingvo-tasks-car-input-extractor-module"></span><h1>lingvo.tasks.car.input_extractor module<a class="headerlink" href="#module-lingvo.tasks.car.input_extractor" title="Permalink to this headline">¶</a></h1>
<p>Input extractors.</p>
<p>Input extractors are an API for parsing and processing a set of fields from
serialized records.</p>
<dl class="py class">
<dt id="lingvo.tasks.car.input_extractor.FieldsExtractor">
<em class="property">class </em><code class="sig-prename descclassname">lingvo.tasks.car.input_extractor.</code><code class="sig-name descname">FieldsExtractor</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#FieldsExtractor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.FieldsExtractor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="lingvo.core.base_layer.html#lingvo.core.base_layer.BaseLayer" title="lingvo.core.base_layer.BaseLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">lingvo.core.base_layer.BaseLayer</span></code></a></p>
<p>An API for parsing and processing a set of fields from serialized records.</p>
<p>Input generators often need to parse several fields from a serialized record.
This involves two stages: specifying the name and type of the fields to
extract from serialized records (tf.Example or tf.SequenceExample), and then
processing the raw output into a form to be consumed by higher-level callers.</p>
<p>This class attempts to modularize this processing within the Minecraft input
generators, so that users can easily create input generator pipelines that mix
and match the composition of different fields from the same dataset.</p>
<p>A descendant of this class will implement three functions:</p>
<blockquote>
<div><ol class="arabic">
<li><p>FeatureMap(): returning a dictionary of field names to field types, e.g.,
‘images’ to tf.io.VarLenFeature(tf.string).  For PlainTextIterator
datasets, FeatureMap() should be empty.</p></li>
<li><p>_Extract(features): Given a ‘features’ dictionary containing the result
from calling tf.io.parse_example or tf.parse_sequence_example on all
extractors’ features, produce a NestedMap of Tensors.</p>
<p>NOTE: The return of the overall pipeline is a NestedMap of batched
Tensors. However, the names and associations of the fields of each
extractor are lost on the boundary of the map fn.  At the moment, one
must implement _Extract() such that the names of the fields returned in
the NestedMap matches self.Shape()’s keys; this is checked during the
parent’s Extract() call.</p>
</li>
<li><p>Shape(): A NestedMap mapping names of outputs to their static shape,
without the batch dimension.  In _InputBatch, this shape will be used to
ensure that every output has a statically known shape.</p></li>
</ol>
</div></blockquote>
<p>The caller of Extractors calls each extractor’s FeatureMap() to populate the
schema passed to tf.io.parse_example() or tf.parse_sequence_example(). The
resulting dicationary of Tensors is then passed to each extractor’s _Extract()
function (via FieldsExtractor.Extract()) to return each extractor’s output.</p>
<p>It is the responsibility of the caller to maintain orders of outputs, since
NestedMaps do not have any inherent ordering during iteration.</p>
<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.FieldsExtractor.Params">
<em class="property">classmethod </em><code class="sig-name descname">Params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#FieldsExtractor.Params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.FieldsExtractor.Params" title="Permalink to this definition">¶</a></dt>
<dd><p>Defaults params.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.FieldsExtractor.FeatureMap">
<code class="sig-name descname">FeatureMap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#FieldsExtractor.FeatureMap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.FieldsExtractor.FeatureMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary from tf.Example feature names to Features.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.FieldsExtractor.ContextMap">
<code class="sig-name descname">ContextMap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#FieldsExtractor.ContextMap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.FieldsExtractor.ContextMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dict mapping tf.SequenceExample context names to Features.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.FieldsExtractor.Extract">
<code class="sig-name descname">Extract</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">features</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#FieldsExtractor.Extract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.FieldsExtractor.Extract" title="Permalink to this definition">¶</a></dt>
<dd><p>Given ‘feature’ (Sparse)Tensors, output Tensors for consumption.</p>
<p>NOTE: Implementation provided by subclasses’s _Extract() method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>features</strong> – A dictionary of (Sparse)Tensors which includes tensors from all
extractors.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A NestedMap of output Tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.FieldsExtractor.ExtractBatch">
<code class="sig-name descname">ExtractBatch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">features</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#FieldsExtractor.ExtractBatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.FieldsExtractor.ExtractBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Given ‘features’ batched Tensors, output Tensors for consumption.</p>
<p>NOTE: Implementation provided by subclasses’s _ExtractBatch() method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>features</strong> – A dictionary of Tensors which includes tensors from this
extractor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A NestedMap of batched output Tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.FieldsExtractor.Filter">
<code class="sig-name descname">Filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outputs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#FieldsExtractor.Filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.FieldsExtractor.Filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bucket based on the result of Extract().</p>
<p>This function should return 1 if the example should pass through without
being dropped, and a value in [BUCKET_UPPER_BOUND, inf) if the example
should be dropped.  Currently no other bucketing strategies are supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>outputs</strong> – The NestedMap returned by this extractor’s _Extract() function.
This is useful to implement filtering based on the values of the
extracted example.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A scalar bucket id.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.FieldsExtractor.FilterBatch">
<code class="sig-name descname">FilterBatch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outputs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#FieldsExtractor.FilterBatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.FieldsExtractor.FilterBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Like Filter but runs over batches of outputs.</p>
<p>This function should be called to decide whether the entire batch should be
dropped.  Downstream implementations that do not run within an input
pipeline must figure out how to handle these outputs, if filtering at the
batch level is desired.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>outputs</strong> – A NestedMap of preprocessed Tensors.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A scalar bucket id.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.FieldsExtractor.Shape">
<code class="sig-name descname">Shape</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#FieldsExtractor.Shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.FieldsExtractor.Shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a NestedMap of un-batched fully-specified tf.TensorShapes.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.FieldsExtractor.DType">
<code class="sig-name descname">DType</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#FieldsExtractor.DType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.FieldsExtractor.DType" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a NestedMap mapping names to tf.DType.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.FieldsExtractor._Extract">
<code class="sig-name descname">_Extract</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">features</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#FieldsExtractor._Extract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.FieldsExtractor._Extract" title="Permalink to this definition">¶</a></dt>
<dd><p>The subclass-defined implementation of Extract().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>features</strong> – A dictionary of (Sparse)Tensors which includes tensors from this
extractor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A NestedMap of output Tensors whose key names match self.Shape()’s keys.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.FieldsExtractor._ExtractBatch">
<code class="sig-name descname">_ExtractBatch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">features</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#FieldsExtractor._ExtractBatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.FieldsExtractor._ExtractBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>The subclass-defined implementation of ExtractBatch().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>features</strong> – A dictionary of batched Tensors including tensors from this
extractor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A NestedMap of output Tensors whose key names match self.Shape()’s keys.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lingvo.tasks.car.input_extractor.LaserExtractor">
<em class="property">class </em><code class="sig-prename descclassname">lingvo.tasks.car.input_extractor.</code><code class="sig-name descname">LaserExtractor</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#LaserExtractor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.LaserExtractor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lingvo.tasks.car.input_extractor.FieldsExtractor" title="lingvo.tasks.car.input_extractor.FieldsExtractor"><code class="xref py py-class docutils literal notranslate"><span class="pre">lingvo.tasks.car.input_extractor.FieldsExtractor</span></code></a></p>
<p>Interface for extracting laser data.</p>
<dl>
<dt>Must produce:</dt><dd><p>points_xyz: [max_num_points, 3] - XYZ coordinates of laser points.</p>
<dl class="simple">
<dt>points_feature: [max_num_points, num_features] - Features for each point in</dt><dd><p>points_xyz.</p>
</dd>
<dt>points_padding: [max_num_points]: Padding for points.  0 means the</dt><dd><p>corresponding point is the original, and 1 means there is no point
(xyz or feature) present.  Only present if max_num_points is not
None.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.LaserExtractor.Params">
<em class="property">classmethod </em><code class="sig-name descname">Params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#LaserExtractor.Params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.LaserExtractor.Params" title="Permalink to this definition">¶</a></dt>
<dd><p>Defaults params.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.LaserExtractor.Shape">
<code class="sig-name descname">Shape</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#LaserExtractor.Shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.LaserExtractor.Shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a NestedMap of un-batched fully-specified tf.TensorShapes.</p>
</dd></dl>

<dl class="py method">
<dt id="lingvo.tasks.car.input_extractor.LaserExtractor.DType">
<code class="sig-name descname">DType</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/input_extractor.html#LaserExtractor.DType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.input_extractor.LaserExtractor.DType" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a NestedMap mapping names to tf.DType.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="lingvo.tasks.car.input_preprocessors.html" class="btn btn-neutral float-right" title="lingvo.tasks.car.input_preprocessors module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lingvo.tasks.car.geometry.html" class="btn btn-neutral float-left" title="lingvo.tasks.car.geometry module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>