Search.setIndex({"docnames": ["index", "lingvo", "lingvo.base_runner", "lingvo.base_trial", "lingvo.compat", "lingvo.core", "lingvo.core.activations", "lingvo.core.adagraft", "lingvo.core.attention", "lingvo.core.attention_util", "lingvo.core.base_decoder", "lingvo.core.base_input_generator", "lingvo.core.base_layer", "lingvo.core.base_model", "lingvo.core.base_model_params", "lingvo.core.batch_major_attention", "lingvo.core.batch_utils", "lingvo.core.beam_search_helper", "lingvo.core.bfloat16_variables", "lingvo.core.bn_layers", "lingvo.core.build_data", "lingvo.core.builder", "lingvo.core.builder_layers", "lingvo.core.checkpointer", "lingvo.core.cluster", "lingvo.core.cluster_factory", "lingvo.core.computation_cost", "lingvo.core.conformer_layer", "lingvo.core.constants", "lingvo.core.conv_layers_builder", "lingvo.core.conv_layers_with_time_padding", "lingvo.core.datasource", "lingvo.core.decoder_lib", "lingvo.core.differentiable_assignment", "lingvo.core.distillation_task", "lingvo.core.distributed_shampoo", "lingvo.core.early_stop", "lingvo.core.egdd", "lingvo.core.entmax", "lingvo.core.favor_attention", "lingvo.core.flat_beam_search_helper", "lingvo.core.generic_input", "lingvo.core.gpipe", "lingvo.core.graddrop", "lingvo.core.gradient_combiner", "lingvo.core.gshard_builder", "lingvo.core.gshard_decode", "lingvo.core.gshard_layers", "lingvo.core.gshard_utils", "lingvo.core.hyperparams", "lingvo.core.hyperparams_pb2", "lingvo.core.inference_graph_exporter", "lingvo.core.inference_graph_pb2", "lingvo.core.input_generator_helper", "lingvo.core.input_policy", "lingvo.core.insertion", "lingvo.core.inspect_utils", "lingvo.core.layers", "lingvo.core.layers_with_attention", "lingvo.core.layers_with_gpipe", "lingvo.core.learner", "lingvo.core.lstm_frnn_layer", "lingvo.core.matrix_functions", "lingvo.core.metrics", "lingvo.core.ml_perf_bleu_metric", "lingvo.core.ml_perf_log", "lingvo.core.ml_perf_tokenizer", "lingvo.core.model_helper", "lingvo.core.multitask_model", "lingvo.core.nested_map", "lingvo.core.ops", "lingvo.core.ops.hyps_pb2", "lingvo.core.ops.record_pb2", "lingvo.core.ops.versioned_file_set_pb2", "lingvo.core.ops.x_ops", "lingvo.core.optimizer", "lingvo.core.plot", "lingvo.core.predictor", "lingvo.core.predictor_runner_base", "lingvo.core.program", "lingvo.core.program_utils", "lingvo.core.pruning_utils", "lingvo.core.py_utils", "lingvo.core.py_utils_flags", "lingvo.core.quant_test_lib", "lingvo.core.quant_utils", "lingvo.core.recurrent", "lingvo.core.repeat_layer", "lingvo.core.retry", "lingvo.core.reversible_layers", "lingvo.core.rnn_cell", "lingvo.core.rnn_layers", "lingvo.core.routing_config_helper", "lingvo.core.saver", "lingvo.core.scatter_update", "lingvo.core.schedule", "lingvo.core.scorers", "lingvo.core.self_attention_layer", "lingvo.core.sendrecv", "lingvo.core.spectrum_augmenter", "lingvo.core.spectrum_augmenter_on_device", "lingvo.core.step", "lingvo.core.steps", "lingvo.core.steps.attention_steps", "lingvo.core.steps.embedding_steps", "lingvo.core.steps.rnn_steps", "lingvo.core.stream_step_test_base", "lingvo.core.summary_utils", "lingvo.core.symbolic", "lingvo.core.target_sequence_sampler", "lingvo.core.task_scheduler", "lingvo.core.test_helper", "lingvo.core.test_trainer_utils", "lingvo.core.test_utils", "lingvo.core.thread_local_utils", "lingvo.core.tokenizers", "lingvo.core.tpu_embedding_layers", "lingvo.core.tpu_summary", "lingvo.core.trainer_test_utils", "lingvo.core.tshape", "lingvo.core.var_tmp_wrappers", "lingvo.core.wpm_encoder", "lingvo.datasets", "lingvo.eager_runners", "lingvo.executor", "lingvo.ipython_kernel", "lingvo.model_imports", "lingvo.model_registry", "lingvo.models_test_helper", "lingvo.pdb_wrapper", "lingvo.runners", "lingvo.tasks", "lingvo.tasks.asr", "lingvo.tasks.asr.contextualizer_base", "lingvo.tasks.asr.decoder", "lingvo.tasks.asr.decoder_metrics", "lingvo.tasks.asr.decoder_utils", "lingvo.tasks.asr.encoder", "lingvo.tasks.asr.eos_normalization", "lingvo.tasks.asr.frontend", "lingvo.tasks.asr.fusion", "lingvo.tasks.asr.input_generator", "lingvo.tasks.asr.levenshtein_distance", "lingvo.tasks.asr.metrics_calculator", "lingvo.tasks.asr.model", "lingvo.tasks.asr.model_test_input_generator", "lingvo.tasks.asr.params", "lingvo.tasks.asr.params.librispeech", "lingvo.tasks.asr.params.params", "lingvo.tasks.asr.tools", "lingvo.tasks.asr.tools.simple_wer", "lingvo.tasks.asr.tools.simple_wer_v2", "lingvo.tasks.image", "lingvo.tasks.image.classifier", "lingvo.tasks.image.input_generator", "lingvo.tasks.image.params", "lingvo.tasks.image.params.mnist", "lingvo.tasks.image.params.params", "lingvo.tasks.lm", "lingvo.tasks.lm.input_generator", "lingvo.tasks.lm.layers", "lingvo.tasks.lm.model", "lingvo.tasks.lm.params", "lingvo.tasks.lm.params.one_billion_wds", "lingvo.tasks.lm.params.params", "lingvo.tasks.lm.params.synthetic_packed_input", "lingvo.tasks.lm.params.wiki_bert", "lingvo.tasks.lm.tokenizer", "lingvo.tasks.lm.tools", "lingvo.tasks.lm.tools.download_lm1b", "lingvo.tasks.lm.tools.gshard_lm_decode", "lingvo.tasks.milan", "lingvo.tasks.milan.common_schema", "lingvo.tasks.milan.constants", "lingvo.tasks.milan.dataset_spec", "lingvo.tasks.milan.dual_encoder", "lingvo.tasks.milan.image_preprocessor", "lingvo.tasks.milan.input_generator", "lingvo.tasks.milan.labels", "lingvo.tasks.milan.params", "lingvo.tasks.milan.params.cxc", "lingvo.tasks.milan.params.dual_encoder_recipe", "lingvo.tasks.milan.params.generic_datasets", "lingvo.tasks.milan.params.params", "lingvo.tasks.milan.score_functions", "lingvo.tasks.milan.tf_hub_layers", "lingvo.tasks.milan.tools", "lingvo.tasks.milan.tools.prepare_coco", "lingvo.tasks.milan.tpu_utils", "lingvo.tasks.milan.transformers", "lingvo.tasks.milan.utils", "lingvo.tasks.mt", "lingvo.tasks.mt.base_config", "lingvo.tasks.mt.data_augmenter", "lingvo.tasks.mt.decoder", "lingvo.tasks.mt.encoder", "lingvo.tasks.mt.input_generator", "lingvo.tasks.mt.layers", "lingvo.tasks.mt.model", "lingvo.tasks.mt.params", "lingvo.tasks.mt.params.params", "lingvo.tasks.mt.params.wmt14_en_de", "lingvo.tasks.mt.params.wmtm16_en_de", "lingvo.tasks.mt.params.xendec", "lingvo.tasks.mt.params.xendec.wmt14_en_de", "lingvo.tasks.mt.text_input_pb2", "lingvo.tasks.mt.tools", "lingvo.tasks.punctuator", "lingvo.tasks.punctuator.input_generator", "lingvo.tasks.punctuator.model", "lingvo.tasks.punctuator.params", "lingvo.tasks.punctuator.params.codelab", "lingvo.tasks.punctuator.params.params", "lingvo.tasks.punctuator.tools", "lingvo.tasks.punctuator.tools.download_brown_corpus", "lingvo.tools", "lingvo.tools.audio_lib", "lingvo.tools.beam_utils", "lingvo.tools.bpe_word_tokenizer", "lingvo.tools.compare_params", "lingvo.tools.compute_stats", "lingvo.tools.count_records", "lingvo.tools.create_asr_features", "lingvo.tools.gke_launch", "lingvo.tools.keras2ckpt", "lingvo.tools.print_tf_records", "lingvo.tools.wpm_encode_file", "lingvo.trainer", "lingvo.trainer_utils", "modules"], "filenames": ["index.rst", "lingvo.rst", "lingvo.base_runner.rst", "lingvo.base_trial.rst", "lingvo.compat.rst", "lingvo.core.rst", "lingvo.core.activations.rst", "lingvo.core.adagraft.rst", "lingvo.core.attention.rst", "lingvo.core.attention_util.rst", "lingvo.core.base_decoder.rst", "lingvo.core.base_input_generator.rst", "lingvo.core.base_layer.rst", "lingvo.core.base_model.rst", "lingvo.core.base_model_params.rst", "lingvo.core.batch_major_attention.rst", "lingvo.core.batch_utils.rst", "lingvo.core.beam_search_helper.rst", "lingvo.core.bfloat16_variables.rst", "lingvo.core.bn_layers.rst", "lingvo.core.build_data.rst", "lingvo.core.builder.rst", "lingvo.core.builder_layers.rst", "lingvo.core.checkpointer.rst", "lingvo.core.cluster.rst", "lingvo.core.cluster_factory.rst", "lingvo.core.computation_cost.rst", "lingvo.core.conformer_layer.rst", "lingvo.core.constants.rst", "lingvo.core.conv_layers_builder.rst", "lingvo.core.conv_layers_with_time_padding.rst", "lingvo.core.datasource.rst", "lingvo.core.decoder_lib.rst", "lingvo.core.differentiable_assignment.rst", "lingvo.core.distillation_task.rst", "lingvo.core.distributed_shampoo.rst", "lingvo.core.early_stop.rst", "lingvo.core.egdd.rst", "lingvo.core.entmax.rst", "lingvo.core.favor_attention.rst", "lingvo.core.flat_beam_search_helper.rst", "lingvo.core.generic_input.rst", "lingvo.core.gpipe.rst", "lingvo.core.graddrop.rst", "lingvo.core.gradient_combiner.rst", "lingvo.core.gshard_builder.rst", "lingvo.core.gshard_decode.rst", "lingvo.core.gshard_layers.rst", "lingvo.core.gshard_utils.rst", "lingvo.core.hyperparams.rst", "lingvo.core.hyperparams_pb2.rst", "lingvo.core.inference_graph_exporter.rst", "lingvo.core.inference_graph_pb2.rst", "lingvo.core.input_generator_helper.rst", "lingvo.core.input_policy.rst", "lingvo.core.insertion.rst", "lingvo.core.inspect_utils.rst", "lingvo.core.layers.rst", "lingvo.core.layers_with_attention.rst", "lingvo.core.layers_with_gpipe.rst", "lingvo.core.learner.rst", "lingvo.core.lstm_frnn_layer.rst", "lingvo.core.matrix_functions.rst", "lingvo.core.metrics.rst", "lingvo.core.ml_perf_bleu_metric.rst", "lingvo.core.ml_perf_log.rst", "lingvo.core.ml_perf_tokenizer.rst", "lingvo.core.model_helper.rst", "lingvo.core.multitask_model.rst", "lingvo.core.nested_map.rst", "lingvo.core.ops.rst", "lingvo.core.ops.hyps_pb2.rst", "lingvo.core.ops.record_pb2.rst", "lingvo.core.ops.versioned_file_set_pb2.rst", "lingvo.core.ops.x_ops.rst", "lingvo.core.optimizer.rst", "lingvo.core.plot.rst", "lingvo.core.predictor.rst", "lingvo.core.predictor_runner_base.rst", "lingvo.core.program.rst", "lingvo.core.program_utils.rst", "lingvo.core.pruning_utils.rst", "lingvo.core.py_utils.rst", "lingvo.core.py_utils_flags.rst", "lingvo.core.quant_test_lib.rst", "lingvo.core.quant_utils.rst", "lingvo.core.recurrent.rst", "lingvo.core.repeat_layer.rst", "lingvo.core.retry.rst", "lingvo.core.reversible_layers.rst", "lingvo.core.rnn_cell.rst", "lingvo.core.rnn_layers.rst", "lingvo.core.routing_config_helper.rst", "lingvo.core.saver.rst", "lingvo.core.scatter_update.rst", "lingvo.core.schedule.rst", "lingvo.core.scorers.rst", "lingvo.core.self_attention_layer.rst", "lingvo.core.sendrecv.rst", "lingvo.core.spectrum_augmenter.rst", "lingvo.core.spectrum_augmenter_on_device.rst", "lingvo.core.step.rst", "lingvo.core.steps.rst", "lingvo.core.steps.attention_steps.rst", "lingvo.core.steps.embedding_steps.rst", "lingvo.core.steps.rnn_steps.rst", "lingvo.core.stream_step_test_base.rst", "lingvo.core.summary_utils.rst", "lingvo.core.symbolic.rst", "lingvo.core.target_sequence_sampler.rst", "lingvo.core.task_scheduler.rst", "lingvo.core.test_helper.rst", "lingvo.core.test_trainer_utils.rst", "lingvo.core.test_utils.rst", "lingvo.core.thread_local_utils.rst", "lingvo.core.tokenizers.rst", "lingvo.core.tpu_embedding_layers.rst", "lingvo.core.tpu_summary.rst", "lingvo.core.trainer_test_utils.rst", "lingvo.core.tshape.rst", "lingvo.core.var_tmp_wrappers.rst", "lingvo.core.wpm_encoder.rst", "lingvo.datasets.rst", "lingvo.eager_runners.rst", "lingvo.executor.rst", "lingvo.ipython_kernel.rst", "lingvo.model_imports.rst", "lingvo.model_registry.rst", "lingvo.models_test_helper.rst", "lingvo.pdb_wrapper.rst", "lingvo.runners.rst", "lingvo.tasks.rst", "lingvo.tasks.asr.rst", "lingvo.tasks.asr.contextualizer_base.rst", "lingvo.tasks.asr.decoder.rst", "lingvo.tasks.asr.decoder_metrics.rst", "lingvo.tasks.asr.decoder_utils.rst", "lingvo.tasks.asr.encoder.rst", "lingvo.tasks.asr.eos_normalization.rst", "lingvo.tasks.asr.frontend.rst", "lingvo.tasks.asr.fusion.rst", "lingvo.tasks.asr.input_generator.rst", "lingvo.tasks.asr.levenshtein_distance.rst", "lingvo.tasks.asr.metrics_calculator.rst", "lingvo.tasks.asr.model.rst", "lingvo.tasks.asr.model_test_input_generator.rst", "lingvo.tasks.asr.params.rst", "lingvo.tasks.asr.params.librispeech.rst", "lingvo.tasks.asr.params.params.rst", "lingvo.tasks.asr.tools.rst", "lingvo.tasks.asr.tools.simple_wer.rst", "lingvo.tasks.asr.tools.simple_wer_v2.rst", "lingvo.tasks.image.rst", "lingvo.tasks.image.classifier.rst", "lingvo.tasks.image.input_generator.rst", "lingvo.tasks.image.params.rst", "lingvo.tasks.image.params.mnist.rst", "lingvo.tasks.image.params.params.rst", "lingvo.tasks.lm.rst", "lingvo.tasks.lm.input_generator.rst", "lingvo.tasks.lm.layers.rst", "lingvo.tasks.lm.model.rst", "lingvo.tasks.lm.params.rst", "lingvo.tasks.lm.params.one_billion_wds.rst", "lingvo.tasks.lm.params.params.rst", "lingvo.tasks.lm.params.synthetic_packed_input.rst", "lingvo.tasks.lm.params.wiki_bert.rst", "lingvo.tasks.lm.tokenizer.rst", "lingvo.tasks.lm.tools.rst", "lingvo.tasks.lm.tools.download_lm1b.rst", "lingvo.tasks.lm.tools.gshard_lm_decode.rst", "lingvo.tasks.milan.rst", "lingvo.tasks.milan.common_schema.rst", "lingvo.tasks.milan.constants.rst", "lingvo.tasks.milan.dataset_spec.rst", "lingvo.tasks.milan.dual_encoder.rst", "lingvo.tasks.milan.image_preprocessor.rst", "lingvo.tasks.milan.input_generator.rst", "lingvo.tasks.milan.labels.rst", "lingvo.tasks.milan.params.rst", "lingvo.tasks.milan.params.cxc.rst", "lingvo.tasks.milan.params.dual_encoder_recipe.rst", "lingvo.tasks.milan.params.generic_datasets.rst", "lingvo.tasks.milan.params.params.rst", "lingvo.tasks.milan.score_functions.rst", "lingvo.tasks.milan.tf_hub_layers.rst", "lingvo.tasks.milan.tools.rst", "lingvo.tasks.milan.tools.prepare_coco.rst", "lingvo.tasks.milan.tpu_utils.rst", "lingvo.tasks.milan.transformers.rst", "lingvo.tasks.milan.utils.rst", "lingvo.tasks.mt.rst", "lingvo.tasks.mt.base_config.rst", "lingvo.tasks.mt.data_augmenter.rst", "lingvo.tasks.mt.decoder.rst", "lingvo.tasks.mt.encoder.rst", "lingvo.tasks.mt.input_generator.rst", "lingvo.tasks.mt.layers.rst", "lingvo.tasks.mt.model.rst", "lingvo.tasks.mt.params.rst", "lingvo.tasks.mt.params.params.rst", "lingvo.tasks.mt.params.wmt14_en_de.rst", "lingvo.tasks.mt.params.wmtm16_en_de.rst", "lingvo.tasks.mt.params.xendec.rst", "lingvo.tasks.mt.params.xendec.wmt14_en_de.rst", "lingvo.tasks.mt.text_input_pb2.rst", "lingvo.tasks.mt.tools.rst", "lingvo.tasks.punctuator.rst", "lingvo.tasks.punctuator.input_generator.rst", "lingvo.tasks.punctuator.model.rst", "lingvo.tasks.punctuator.params.rst", "lingvo.tasks.punctuator.params.codelab.rst", "lingvo.tasks.punctuator.params.params.rst", "lingvo.tasks.punctuator.tools.rst", "lingvo.tasks.punctuator.tools.download_brown_corpus.rst", "lingvo.tools.rst", "lingvo.tools.audio_lib.rst", "lingvo.tools.beam_utils.rst", "lingvo.tools.bpe_word_tokenizer.rst", "lingvo.tools.compare_params.rst", "lingvo.tools.compute_stats.rst", "lingvo.tools.count_records.rst", "lingvo.tools.create_asr_features.rst", "lingvo.tools.gke_launch.rst", "lingvo.tools.keras2ckpt.rst", "lingvo.tools.print_tf_records.rst", "lingvo.tools.wpm_encode_file.rst", "lingvo.trainer.rst", "lingvo.trainer_utils.rst", "modules.rst"], "titles": ["Welcome to lingvo\u2019s documentation!", "lingvo package", "lingvo.base_runner module", "lingvo.base_trial module", "lingvo.compat module", "lingvo.core package", "lingvo.core.activations module", "lingvo.core.adagraft module", "lingvo.core.attention module", "lingvo.core.attention_util module", "lingvo.core.base_decoder module", "lingvo.core.base_input_generator module", "lingvo.core.base_layer module", "lingvo.core.base_model module", "lingvo.core.base_model_params module", "lingvo.core.batch_major_attention module", "lingvo.core.batch_utils module", "lingvo.core.beam_search_helper module", "lingvo.core.bfloat16_variables module", "lingvo.core.bn_layers module", "lingvo.core.build_data module", "lingvo.core.builder module", "lingvo.core.builder_layers module", "lingvo.core.checkpointer module", "lingvo.core.cluster module", "lingvo.core.cluster_factory module", "lingvo.core.computation_cost module", "lingvo.core.conformer_layer module", "lingvo.core.constants module", "lingvo.core.conv_layers_builder module", "lingvo.core.conv_layers_with_time_padding module", "lingvo.core.datasource module", "lingvo.core.decoder_lib module", "lingvo.core.differentiable_assignment module", "lingvo.core.distillation_task module", "lingvo.core.distributed_shampoo module", "lingvo.core.early_stop module", "lingvo.core.egdd module", "lingvo.core.entmax module", "lingvo.core.favor_attention module", "lingvo.core.flat_beam_search_helper module", "lingvo.core.generic_input module", "lingvo.core.gpipe module", "lingvo.core.graddrop module", "lingvo.core.gradient_combiner module", "lingvo.core.gshard_builder module", "lingvo.core.gshard_decode module", "lingvo.core.gshard_layers module", "lingvo.core.gshard_utils module", "lingvo.core.hyperparams module", "lingvo.core.hyperparams_pb2 module", "lingvo.core.inference_graph_exporter module", "lingvo.core.inference_graph_pb2 module", "lingvo.core.input_generator_helper module", "lingvo.core.input_policy module", "lingvo.core.insertion module", "lingvo.core.inspect_utils module", "lingvo.core.layers module", "lingvo.core.layers_with_attention module", "lingvo.core.layers_with_gpipe module", "lingvo.core.learner module", "lingvo.core.lstm_frnn_layer module", "lingvo.core.matrix_functions module", "lingvo.core.metrics module", "lingvo.core.ml_perf_bleu_metric module", "lingvo.core.ml_perf_log module", "lingvo.core.ml_perf_tokenizer module", "lingvo.core.model_helper module", "lingvo.core.multitask_model module", "lingvo.core.nested_map module", "lingvo.core.ops package", "lingvo.core.ops.hyps_pb2 module", "lingvo.core.ops.record_pb2 module", "lingvo.core.ops.versioned_file_set_pb2 module", "lingvo.core.ops.x_ops module", "lingvo.core.optimizer module", "lingvo.core.plot module", "lingvo.core.predictor module", "lingvo.core.predictor_runner_base module", "lingvo.core.program module", "lingvo.core.program_utils module", "lingvo.core.pruning_utils module", "lingvo.core.py_utils module", "lingvo.core.py_utils_flags module", "lingvo.core.quant_test_lib module", "lingvo.core.quant_utils module", "lingvo.core.recurrent module", "lingvo.core.repeat_layer module", "lingvo.core.retry module", "lingvo.core.reversible_layers module", "lingvo.core.rnn_cell module", "lingvo.core.rnn_layers module", "lingvo.core.routing_config_helper module", "lingvo.core.saver module", "lingvo.core.scatter_update module", "lingvo.core.schedule module", "lingvo.core.scorers module", "lingvo.core.self_attention_layer module", "lingvo.core.sendrecv module", "lingvo.core.spectrum_augmenter module", "lingvo.core.spectrum_augmenter_on_device module", "lingvo.core.step module", "lingvo.core.steps package", "lingvo.core.steps.attention_steps module", "lingvo.core.steps.embedding_steps module", "lingvo.core.steps.rnn_steps module", "lingvo.core.stream_step_test_base module", "lingvo.core.summary_utils module", "lingvo.core.symbolic module", "lingvo.core.target_sequence_sampler module", "lingvo.core.task_scheduler module", "lingvo.core.test_helper module", "lingvo.core.test_trainer_utils module", "lingvo.core.test_utils module", "lingvo.core.thread_local_utils module", "lingvo.core.tokenizers module", "lingvo.core.tpu_embedding_layers module", "lingvo.core.tpu_summary module", "lingvo.core.trainer_test_utils module", "lingvo.core.tshape module", "lingvo.core.var_tmp_wrappers module", "lingvo.core.wpm_encoder module", "lingvo.datasets module", "lingvo.eager_runners module", "lingvo.executor module", "lingvo.ipython_kernel module", "lingvo.model_imports module", "lingvo.model_registry module", "lingvo.models_test_helper module", "lingvo.pdb_wrapper module", "lingvo.runners module", "lingvo.tasks package", "lingvo.tasks.asr package", "lingvo.tasks.asr.contextualizer_base module", "lingvo.tasks.asr.decoder module", "lingvo.tasks.asr.decoder_metrics module", "lingvo.tasks.asr.decoder_utils module", "lingvo.tasks.asr.encoder module", "lingvo.tasks.asr.eos_normalization module", "lingvo.tasks.asr.frontend module", "lingvo.tasks.asr.fusion module", "lingvo.tasks.asr.input_generator module", "lingvo.tasks.asr.levenshtein_distance module", "lingvo.tasks.asr.metrics_calculator module", "lingvo.tasks.asr.model module", "lingvo.tasks.asr.model_test_input_generator module", "lingvo.tasks.asr.params namespace", "lingvo.tasks.asr.params.librispeech module", "lingvo.tasks.asr.params.params module", "lingvo.tasks.asr.tools package", "lingvo.tasks.asr.tools.simple_wer module", "lingvo.tasks.asr.tools.simple_wer_v2 module", "lingvo.tasks.image package", "lingvo.tasks.image.classifier module", "lingvo.tasks.image.input_generator module", "lingvo.tasks.image.params namespace", "lingvo.tasks.image.params.mnist module", "lingvo.tasks.image.params.params module", "lingvo.tasks.lm package", "lingvo.tasks.lm.input_generator module", "lingvo.tasks.lm.layers module", "lingvo.tasks.lm.model module", "lingvo.tasks.lm.params namespace", "lingvo.tasks.lm.params.one_billion_wds module", "lingvo.tasks.lm.params.params module", "lingvo.tasks.lm.params.synthetic_packed_input module", "lingvo.tasks.lm.params.wiki_bert module", "lingvo.tasks.lm.tokenizer module", "lingvo.tasks.lm.tools package", "lingvo.tasks.lm.tools.download_lm1b module", "lingvo.tasks.lm.tools.gshard_lm_decode module", "lingvo.tasks.milan namespace", "lingvo.tasks.milan.common_schema module", "lingvo.tasks.milan.constants module", "lingvo.tasks.milan.dataset_spec module", "lingvo.tasks.milan.dual_encoder module", "lingvo.tasks.milan.image_preprocessor module", "lingvo.tasks.milan.input_generator module", "lingvo.tasks.milan.labels module", "lingvo.tasks.milan.params namespace", "lingvo.tasks.milan.params.cxc module", "lingvo.tasks.milan.params.dual_encoder_recipe module", "lingvo.tasks.milan.params.generic_datasets module", "lingvo.tasks.milan.params.params module", "lingvo.tasks.milan.score_functions module", "lingvo.tasks.milan.tf_hub_layers module", "lingvo.tasks.milan.tools namespace", "lingvo.tasks.milan.tools.prepare_coco module", "lingvo.tasks.milan.tpu_utils module", "lingvo.tasks.milan.transformers module", "lingvo.tasks.milan.utils module", "lingvo.tasks.mt package", "lingvo.tasks.mt.base_config module", "lingvo.tasks.mt.data_augmenter module", "lingvo.tasks.mt.decoder module", "lingvo.tasks.mt.encoder module", "lingvo.tasks.mt.input_generator module", "lingvo.tasks.mt.layers module", "lingvo.tasks.mt.model module", "lingvo.tasks.mt.params namespace", "lingvo.tasks.mt.params.params module", "lingvo.tasks.mt.params.wmt14_en_de module", "lingvo.tasks.mt.params.wmtm16_en_de module", "lingvo.tasks.mt.params.xendec namespace", "lingvo.tasks.mt.params.xendec.wmt14_en_de module", "lingvo.tasks.mt.text_input_pb2 module", "lingvo.tasks.mt.tools package", "lingvo.tasks.punctuator package", "lingvo.tasks.punctuator.input_generator module", "lingvo.tasks.punctuator.model module", "lingvo.tasks.punctuator.params namespace", "lingvo.tasks.punctuator.params.codelab module", "lingvo.tasks.punctuator.params.params module", "lingvo.tasks.punctuator.tools package", "lingvo.tasks.punctuator.tools.download_brown_corpus module", "lingvo.tools package", "lingvo.tools.audio_lib module", "lingvo.tools.beam_utils module", "lingvo.tools.bpe_word_tokenizer module", "lingvo.tools.compare_params module", "lingvo.tools.compute_stats module", "lingvo.tools.count_records module", "lingvo.tools.create_asr_features module", "lingvo.tools.gke_launch module", "lingvo.tools.keras2ckpt module", "lingvo.tools.print_tf_records module", "lingvo.tools.wpm_encode_file module", "lingvo.trainer module", "lingvo.trainer_utils module", "lingvo"], "terms": {"packag": [0, 82, 229], "subpackag": [0, 229], "core": [0, 1, 130, 178, 188, 218, 227, 229], "submodul": [0, 12, 131, 229], "task": [0, 1, 2, 11, 13, 14, 22, 24, 34, 41, 42, 43, 44, 45, 46, 51, 57, 59, 63, 68, 75, 79, 82, 110, 116, 118, 122, 124, 126, 127, 223, 227, 229], "tool": [0, 1, 51, 118, 131, 132, 158, 171, 176, 191, 207, 229], "base_runn": [0, 1, 3, 229], "modul": [0, 1, 5, 70, 102, 131, 132, 146, 149, 152, 155, 158, 162, 168, 171, 179, 186, 191, 199, 203, 207, 210, 213, 215, 229], "base_tri": [0, 1, 2, 79, 123, 227, 229], "compat": [0, 1, 8, 9, 11, 12, 13, 15, 22, 42, 47, 57, 59, 60, 69, 70, 82, 85, 87, 90, 91, 93, 101, 105, 107, 113, 116, 120, 139, 140, 175, 194, 195, 217, 218, 229], "dataset": [0, 1, 4, 11, 14, 31, 41, 79, 80, 127, 139, 147, 156, 159, 163, 165, 166, 169, 173, 174, 177, 178, 180, 181, 182, 187, 192, 196, 201, 202, 204, 208, 211, 221, 224, 227, 229], "eager_runn": [0, 1, 229], "executor": [0, 1, 14, 79, 147, 165, 166, 229], "ipython_kernel": [0, 1, 229], "model_import": [0, 1, 229], "model_registri": [0, 1, 51, 77, 122, 124, 181, 227, 229], "models_test_help": [0, 1, 229], "pdb_wrapper": [0, 1, 229], "runner": [0, 1, 2, 82, 123, 124, 227, 229], "trainer": [0, 1, 2, 24, 36, 60, 79, 82, 95, 112, 117, 118, 123, 130, 185, 196, 223, 229], "trainer_util": [0, 1, 229], "index": [0, 12, 13, 15, 17, 21, 22, 23, 24, 30, 34, 41, 45, 47, 58, 59, 69, 70, 82, 86, 94, 99, 104, 107, 118, 138, 144, 150, 151, 153, 160, 161, 175, 194, 196, 198], "search": [0, 10, 15, 17, 40, 64, 70, 79, 82, 121, 122, 134, 140, 194], "page": [0, 62], "op": [1, 2, 5, 7, 11, 12, 13, 15, 24, 35, 36, 37, 42, 46, 47, 48, 51, 57, 60, 63, 75, 77, 79, 81, 82, 85, 86, 90, 91, 93, 98, 99, 100, 113, 116, 120, 130, 133, 134, 140, 141, 159, 185, 193, 196, 218, 227], "step": [1, 2, 3, 5, 7, 8, 9, 10, 11, 12, 13, 15, 17, 19, 23, 27, 30, 31, 34, 36, 40, 43, 45, 46, 47, 57, 58, 60, 61, 63, 70, 75, 79, 81, 82, 85, 86, 89, 91, 93, 95, 99, 107, 109, 110, 113, 115, 118, 123, 124, 130, 133, 134, 140, 144, 147, 153, 160, 181, 192, 194, 198, 227], "activ": [1, 5, 8, 15, 17, 21, 27, 29, 42, 45, 47, 57, 58, 59, 70, 82, 85, 89, 90, 116, 134, 160, 192, 194, 223], "adagraft": [1, 5, 75], "attent": [1, 5, 9, 15, 17, 27, 29, 39, 40, 45, 47, 57, 58, 59, 70, 87, 91, 92, 97, 101, 103, 107, 133, 134, 160, 189, 192, 194, 195, 197, 198], "attention_util": [1, 5], "base_decod": [1, 5], "base_input_gener": [1, 5], "base_lay": [1, 5], "base_model": [1, 5], "base_model_param": [1, 5, 127], "batch_major_attent": [1, 5], "batch_util": [1, 5], "beam_search_help": [1, 5, 109, 135], "bfloat16_vari": [1, 5], "bn_layer": [1, 5], "build_data": [1, 5], "builder": [1, 5, 15, 29, 45, 47, 97, 181, 195], "builder_lay": [1, 5, 42, 45, 87, 101], "checkpoint": [1, 2, 5, 8, 11, 12, 13, 15, 18, 22, 42, 47, 51, 57, 59, 60, 77, 78, 79, 80, 82, 85, 87, 91, 93, 101, 105, 116, 118, 123, 124, 130, 140, 165, 170, 175, 181, 185, 194, 195, 224, 227], "cluster": [1, 5, 9, 11, 12, 15, 16, 25, 46, 51, 75, 82, 83, 92, 124, 130, 223, 227], "cluster_factori": [1, 5, 188], "computation_cost": [1, 5], "conformer_lay": [1, 5], "constant": [1, 5, 33, 39, 47, 51, 82, 85, 86, 95, 101, 110, 118, 131, 171, 190], "conv_layers_build": [1, 5, 15], "conv_layers_with_time_pad": [1, 5], "datasourc": [1, 5, 11, 141, 159, 196, 208], "decoder_lib": [1, 5], "differentiable_assign": [1, 5], "distillation_task": [1, 5], "distributed_shampoo": [1, 5], "early_stop": [1, 5], "egdd": [1, 5], "entmax": [1, 5], "favor_attent": [1, 5], "flat_beam_search_help": [1, 5], "generic_input": [1, 5], "gpipe": [1, 5, 15, 59, 160, 163], "graddrop": [1, 5], "gradient_combin": [1, 5], "gshard_build": [1, 5], "gshard_decod": [1, 5], "gshard_lay": [1, 5, 27, 45], "gshard_util": [1, 5], "hyperparam": [1, 3, 5, 12, 14, 15, 20, 46, 47, 50, 82, 124, 219], "hyperparams_pb2": [1, 5], "inference_graph_export": [1, 5, 77, 227], "inference_graph_pb2": [1, 5, 13, 34], "input_generator_help": [1, 5], "input_polici": [1, 5], "insert": [1, 5, 43, 47, 69, 85, 104, 126, 136, 150, 151, 194, 198], "inspect_util": [1, 5], "layer": [1, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 17, 19, 21, 22, 26, 27, 29, 30, 31, 34, 35, 39, 40, 42, 43, 44, 45, 47, 55, 58, 59, 60, 61, 67, 68, 75, 82, 84, 85, 86, 87, 89, 90, 91, 92, 95, 97, 99, 100, 101, 103, 104, 105, 106, 109, 116, 117, 118, 128, 131, 133, 134, 135, 137, 139, 140, 144, 153, 158, 161, 163, 165, 175, 176, 177, 184, 185, 187, 189, 190, 191, 192, 193, 194, 195, 198, 208], "layers_with_attent": [1, 5], "layers_with_gpip": [1, 5], "learner": [1, 5, 13, 185], "lstm_frnn_layer": [1, 5], "matrix_funct": [1, 5], "metric": [1, 2, 3, 5, 10, 13, 24, 26, 34, 36, 45, 60, 64, 70, 79, 82, 95, 116, 118, 134, 135, 143, 144, 153, 161, 175, 194, 196, 198], "ml_perf_bleu_metr": [1, 5], "ml_perf_log": [1, 5], "ml_perf_token": [1, 5], "model_help": [1, 5], "multitask_model": [1, 5], "nested_map": [1, 5, 190], "optim": [1, 5, 7, 9, 13, 15, 33, 34, 35, 37, 43, 47, 57, 60, 70, 82, 116, 118, 138, 165, 182, 192, 194], "plot": [1, 5, 107], "predictor": [1, 5, 37, 78], "predictor_runner_bas": [1, 5], "program": [1, 5, 8, 46, 60, 80, 124, 151, 217, 227], "program_util": [1, 5], "pruning_util": [1, 5], "py_util": [1, 5, 11, 12, 15, 41, 42, 45, 57, 58, 60, 69, 95, 116, 128, 141, 159, 196], "py_utils_flag": [1, 5], "quant_test_lib": [1, 5], "quant_util": [1, 5, 84], "recurr": [1, 5, 8, 12, 15, 22, 42, 47, 58, 61, 82, 87, 90, 91, 101, 105, 134, 137, 160], "repeat_lay": [1, 5], "retri": [1, 2, 5, 82], "reversible_lay": [1, 5], "rnn_cell": [1, 5, 61, 91, 103], "rnn_layer": [1, 5], "routing_config_help": [1, 5], "saver": [1, 5, 18, 23, 46, 51], "scatter_upd": [1, 5], "schedul": [1, 5, 14, 60, 75, 79, 82, 85, 109, 110, 134, 147, 165, 166], "scorer": [1, 5], "self_attention_lay": [1, 5, 195], "sendrecv": [1, 5], "spectrum_augment": [1, 5], "spectrum_augmenter_on_devic": [1, 5], "stream_step_test_bas": [1, 5], "summary_util": [1, 5], "symbol": [1, 5, 11, 12, 22, 49, 55, 58, 64, 70, 82, 86, 115, 119, 138, 194], "target_sequence_sampl": [1, 5], "task_schedul": [1, 5, 13], "test_help": [1, 5], "test_trainer_util": [1, 5], "test_util": [1, 5], "thread_local_util": [1, 5], "token": [1, 5, 9, 10, 11, 15, 17, 22, 40, 45, 47, 55, 57, 58, 64, 66, 70, 82, 90, 91, 92, 96, 99, 104, 121, 131, 135, 136, 147, 158, 159, 160, 161, 170, 187, 192, 194, 195, 196, 198, 208, 211, 218], "tpu_embedding_lay": [1, 5], "tpu_summari": [1, 5, 40], "trainer_test_util": [1, 5], "tshape": [1, 5, 6, 12, 15, 19, 21, 22, 29, 30, 42, 57, 58, 59, 70, 82], "var_tmp_wrapp": [1, 5], "wpm_encod": [1, 5, 226], "asr": [1, 126, 131], "imag": [1, 27, 29, 30, 42, 57, 76, 107, 126, 127, 131, 172, 173, 175, 176, 178, 180, 181, 182, 185, 194, 202, 223, 227], "lm": [1, 42, 45, 82, 126, 131, 134, 140], "milan": [1, 126, 131], "namespac": [1, 12, 131, 132, 152, 158, 191, 207], "mt": [1, 126, 131, 209], "punctuat": [1, 49, 64, 115, 126, 131, 150], "audio_lib": [1, 215], "beam_util": [1, 215], "bpe_word_token": [1, 215], "compare_param": [1, 215], "compute_stat": [1, 215], "count_record": [1, 215], "create_asr_featur": [1, 215], "gke_launch": [1, 215], "keras2ckpt": [1, 215], "print_tf_record": [1, 215], "wpm_encode_fil": [1, 215], "base": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 27, 29, 30, 31, 34, 35, 36, 37, 38, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 55, 57, 58, 59, 60, 61, 63, 64, 66, 67, 68, 69, 70, 71, 72, 73, 75, 76, 77, 78, 79, 80, 81, 82, 84, 85, 86, 87, 89, 90, 91, 92, 93, 95, 96, 97, 98, 99, 100, 101, 103, 104, 105, 106, 107, 108, 109, 110, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 127, 128, 130, 133, 134, 135, 137, 138, 139, 140, 141, 142, 144, 145, 147, 151, 153, 154, 156, 159, 160, 161, 163, 165, 166, 167, 170, 173, 174, 175, 176, 177, 178, 180, 181, 182, 184, 185, 187, 190, 192, 193, 194, 195, 196, 197, 198, 201, 202, 204, 205, 208, 209, 211, 217, 220, 223, 227], "class": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 27, 29, 30, 31, 34, 35, 36, 37, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 55, 56, 57, 58, 59, 60, 61, 63, 64, 66, 68, 69, 71, 72, 73, 75, 76, 77, 78, 79, 80, 81, 82, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 95, 96, 97, 98, 99, 100, 101, 103, 104, 105, 106, 107, 108, 109, 110, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 127, 128, 130, 133, 134, 135, 137, 139, 140, 141, 142, 144, 145, 147, 151, 153, 154, 156, 159, 160, 161, 163, 165, 166, 167, 170, 173, 174, 175, 176, 177, 178, 180, 181, 182, 184, 185, 187, 190, 193, 194, 195, 196, 197, 198, 201, 202, 204, 205, 208, 209, 211, 220, 225, 227], "all": [2, 3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 21, 22, 23, 24, 35, 36, 37, 39, 40, 41, 42, 43, 45, 47, 49, 51, 57, 58, 59, 60, 63, 64, 69, 70, 75, 79, 82, 85, 86, 87, 90, 91, 93, 96, 97, 99, 101, 103, 104, 105, 107, 110, 113, 115, 116, 117, 122, 124, 126, 130, 134, 135, 140, 141, 151, 159, 165, 174, 175, 178, 181, 185, 188, 190, 192, 194, 195, 196, 197, 198, 218, 221, 222, 223, 227], "job": [2, 11, 13, 24, 25, 31, 32, 46, 57, 79, 82, 103, 196, 223, 227], "baserunn": [2, 123, 124, 130, 227], "param": [2, 3, 6, 8, 9, 10, 11, 12, 13, 14, 15, 17, 19, 21, 22, 24, 27, 29, 30, 31, 34, 36, 42, 43, 45, 46, 47, 49, 51, 54, 55, 56, 57, 58, 59, 60, 61, 63, 66, 68, 75, 77, 79, 81, 82, 84, 85, 87, 89, 90, 91, 92, 95, 97, 99, 101, 103, 104, 105, 106, 107, 109, 110, 115, 116, 118, 123, 124, 126, 127, 131, 132, 134, 135, 137, 139, 140, 141, 143, 144, 145, 152, 153, 154, 158, 159, 160, 161, 167, 171, 175, 176, 177, 184, 185, 187, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 207, 208, 219, 227], "model_task_nam": [2, 51, 123, 130, 227], "logdir": [2, 23, 24, 36, 77, 93, 113, 123, 130, 223, 227], "tf_master": [2, 77, 78, 123, 227], "trial": [2, 3, 79, 123, 227], "nooptrial": [2, 3, 79, 123, 227], "object": [2, 3, 4, 6, 7, 8, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 27, 29, 30, 34, 35, 36, 37, 42, 43, 45, 46, 47, 48, 49, 50, 51, 52, 56, 57, 58, 59, 60, 61, 63, 64, 69, 70, 71, 72, 73, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 86, 89, 90, 91, 93, 96, 97, 98, 99, 101, 103, 104, 105, 107, 108, 109, 113, 116, 117, 118, 119, 120, 121, 123, 124, 127, 133, 134, 135, 137, 139, 140, 142, 143, 144, 151, 153, 160, 161, 165, 173, 174, 175, 177, 178, 182, 185, 187, 190, 192, 194, 195, 196, 197, 198, 205, 217, 220, 227], "sourc": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 51, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 126, 127, 128, 129, 130, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 147, 150, 151, 153, 154, 156, 159, 160, 161, 163, 165, 166, 167, 169, 170, 172, 173, 174, 175, 176, 177, 178, 180, 181, 182, 184, 185, 187, 188, 189, 190, 192, 193, 194, 195, 196, 197, 198, 201, 202, 204, 208, 209, 211, 214, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227], "properti": [2, 3, 11, 12, 13, 15, 19, 21, 22, 23, 24, 27, 30, 31, 36, 45, 47, 48, 49, 57, 58, 63, 64, 77, 79, 82, 85, 87, 90, 91, 96, 99, 106, 115, 116, 119, 120, 121, 137, 138, 139, 156, 174, 180, 181, 185, 190, 194, 227], "start": [2, 9, 11, 17, 22, 30, 33, 37, 46, 49, 57, 78, 79, 82, 85, 95, 99, 115, 123, 124, 130, 170, 178, 181, 192, 196, 208, 223, 227], "_createcheckpoint": 2, "train_dir": [2, 13, 23], "model": [2, 3, 8, 9, 10, 11, 12, 13, 14, 15, 17, 19, 21, 22, 23, 24, 25, 29, 36, 42, 43, 45, 46, 47, 48, 51, 53, 55, 57, 58, 63, 64, 67, 68, 70, 75, 77, 79, 82, 85, 86, 90, 92, 96, 107, 112, 115, 118, 121, 122, 123, 124, 126, 127, 128, 130, 131, 132, 133, 134, 135, 137, 139, 140, 145, 147, 148, 153, 156, 157, 158, 159, 160, 163, 164, 165, 166, 170, 175, 176, 177, 178, 181, 183, 184, 185, 187, 189, 191, 192, 194, 195, 200, 201, 202, 204, 207, 211, 212, 219, 223, 227], "wrapper": [2, 12, 15, 22, 23, 30, 45, 48, 75, 82, 90, 91, 92, 97, 98, 104, 115, 117, 120, 127, 129, 165, 178, 190, 193, 227], "method": [2, 3, 4, 7, 8, 9, 11, 12, 13, 14, 15, 18, 19, 21, 22, 30, 31, 35, 37, 41, 45, 47, 49, 56, 57, 58, 59, 61, 62, 64, 75, 79, 81, 82, 84, 85, 90, 91, 95, 101, 106, 110, 113, 116, 118, 122, 127, 128, 140, 144, 178, 180, 181, 185, 187, 196], "overrid": [2, 4, 7, 8, 10, 11, 12, 13, 15, 17, 18, 22, 30, 31, 35, 37, 42, 45, 47, 49, 56, 57, 59, 60, 75, 76, 78, 79, 82, 83, 85, 86, 87, 91, 101, 105, 110, 116, 134, 140, 144, 159, 170, 174, 175, 177, 180, 181, 194, 195, 208], "purpos": [2, 11, 15, 47, 51, 58, 85, 116, 138, 208], "classmethod": [2, 3, 6, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 27, 29, 30, 31, 34, 35, 36, 42, 43, 45, 47, 48, 49, 51, 55, 57, 58, 59, 60, 61, 63, 66, 68, 75, 76, 78, 79, 81, 82, 84, 85, 86, 87, 89, 90, 91, 95, 97, 99, 101, 103, 104, 105, 109, 110, 115, 116, 117, 118, 123, 127, 128, 130, 134, 135, 137, 139, 140, 141, 144, 145, 153, 154, 159, 160, 161, 165, 167, 175, 176, 177, 178, 182, 184, 185, 187, 193, 194, 195, 196, 197, 198, 208], "_getttldir": 2, "path": [2, 11, 12, 13, 15, 22, 23, 31, 51, 57, 70, 77, 79, 82, 93, 112, 123, 130, 156, 170, 174, 181, 217, 219], "durat": 2, "return": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 51, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 66, 67, 68, 69, 70, 75, 76, 77, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99, 101, 103, 104, 105, 106, 107, 108, 109, 110, 112, 113, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 127, 130, 133, 134, 135, 136, 137, 138, 139, 140, 141, 144, 145, 147, 150, 151, 153, 156, 159, 160, 161, 163, 165, 166, 167, 170, 172, 174, 175, 176, 177, 178, 180, 181, 182, 184, 185, 187, 188, 189, 190, 192, 193, 194, 195, 196, 197, 198, 201, 202, 204, 208, 209, 211, 216, 217, 218, 219, 222, 223, 227], "time": [2, 4, 8, 9, 12, 13, 15, 17, 19, 21, 23, 29, 30, 40, 45, 47, 57, 58, 59, 61, 63, 64, 70, 75, 76, 77, 79, 82, 85, 86, 90, 91, 95, 99, 101, 103, 104, 107, 110, 116, 124, 128, 130, 134, 137, 139, 140, 160, 161, 172, 194, 195, 196, 197, 198, 227], "limit": [2, 11, 40, 45, 63, 69, 82, 120], "directori": [2, 4, 13, 23, 78, 113, 122, 127, 187, 223, 227], "under": [2, 10, 14, 38, 45, 47, 51, 61, 93], "dir": [2, 36, 79], "requir": [2, 3, 8, 9, 10, 15, 31, 35, 47, 49, 57, 58, 63, 70, 75, 77, 79, 82, 85, 86, 101, 115, 116, 122, 134, 150, 151, 178, 182, 194, 221], "_formatstatusmessag": 2, "messag": [2, 4, 13, 34, 50, 52, 65, 70, 71, 72, 73, 82, 187, 205], "_setstatusmessag": 2, "fals": [2, 3, 7, 8, 9, 11, 12, 13, 15, 17, 19, 21, 22, 23, 25, 27, 29, 30, 35, 39, 45, 46, 47, 48, 49, 51, 55, 56, 57, 58, 59, 64, 69, 70, 75, 76, 77, 79, 82, 83, 85, 86, 91, 93, 95, 99, 106, 109, 113, 117, 120, 122, 123, 126, 127, 134, 135, 138, 140, 150, 156, 159, 160, 165, 166, 170, 182, 188, 192, 194, 195, 196, 197, 204], "updat": [2, 7, 9, 10, 12, 13, 15, 17, 19, 27, 34, 35, 36, 37, 40, 47, 49, 54, 56, 57, 58, 60, 63, 64, 69, 70, 75, 77, 79, 80, 81, 82, 85, 86, 90, 93, 94, 95, 98, 104, 110, 113, 116, 118, 120, 127, 134, 137, 140, 143, 144, 151, 153, 160, 161, 175, 185, 194, 198, 223, 227], "statu": [2, 70, 79, 80, 93], "thi": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 26, 27, 29, 30, 31, 33, 34, 35, 36, 37, 38, 41, 42, 43, 45, 47, 48, 49, 50, 51, 52, 55, 56, 57, 58, 59, 60, 61, 63, 64, 68, 69, 70, 71, 72, 73, 75, 76, 78, 79, 81, 82, 83, 84, 85, 86, 87, 89, 90, 91, 93, 95, 97, 99, 100, 101, 103, 104, 105, 110, 113, 115, 116, 117, 118, 120, 122, 124, 126, 130, 133, 134, 137, 138, 139, 140, 141, 144, 145, 150, 151, 153, 159, 160, 161, 165, 170, 174, 175, 177, 178, 180, 181, 182, 184, 185, 187, 188, 190, 192, 193, 194, 195, 196, 197, 198, 205, 208, 217, 221, 223, 227], "_exportmetr": 2, "kwarg": [2, 4, 6, 8, 9, 10, 11, 12, 13, 15, 17, 19, 22, 24, 27, 29, 30, 31, 34, 41, 42, 43, 44, 45, 47, 49, 51, 55, 56, 57, 58, 59, 60, 61, 63, 64, 66, 68, 69, 75, 76, 77, 78, 79, 82, 84, 85, 87, 89, 90, 91, 95, 97, 99, 100, 101, 103, 104, 105, 106, 107, 109, 110, 113, 115, 116, 117, 118, 123, 124, 130, 133, 134, 135, 137, 139, 140, 141, 144, 145, 153, 154, 159, 160, 161, 165, 167, 174, 175, 176, 177, 178, 181, 184, 185, 187, 193, 194, 195, 196, 197, 198, 208, 209, 217, 227], "export": [2, 12, 13, 24, 51, 70, 77, 79, 98], "extern": [2, 11, 13, 24, 31, 34, 101, 104, 105, 139], "_shouldearlystop": 2, "sess": [2, 11, 13, 18, 23, 24, 31, 45, 77, 79, 82, 93, 113, 115, 118, 123, 130, 159, 227], "none": [2, 3, 4, 6, 8, 9, 10, 11, 12, 13, 15, 17, 18, 19, 21, 22, 23, 24, 25, 27, 29, 30, 31, 34, 35, 36, 39, 40, 42, 45, 46, 47, 48, 49, 51, 55, 56, 57, 58, 59, 60, 61, 63, 65, 69, 70, 75, 76, 77, 78, 79, 80, 81, 82, 84, 85, 86, 87, 88, 90, 91, 93, 94, 95, 96, 97, 98, 99, 100, 101, 105, 107, 108, 109, 113, 115, 116, 117, 118, 120, 123, 128, 130, 134, 135, 137, 140, 141, 144, 150, 151, 159, 160, 161, 165, 166, 170, 172, 174, 175, 187, 188, 190, 192, 194, 195, 196, 197, 198, 217, 223, 227], "_shouldstop": [2, 79], "check_early_stop": 2, "true": [2, 4, 8, 10, 11, 12, 13, 15, 17, 18, 22, 23, 24, 25, 27, 30, 33, 36, 37, 38, 40, 41, 45, 47, 48, 49, 51, 55, 56, 57, 58, 59, 63, 64, 69, 70, 75, 76, 77, 79, 81, 82, 85, 86, 90, 91, 93, 95, 109, 113, 117, 120, 122, 126, 134, 138, 143, 150, 160, 165, 166, 170, 185, 188, 192, 194, 195, 196, 197, 204, 227], "check": [2, 6, 8, 11, 12, 31, 49, 56, 63, 69, 70, 79, 82, 93, 113, 116, 194], "should": [2, 3, 4, 8, 9, 11, 12, 13, 15, 17, 18, 19, 21, 22, 23, 26, 27, 29, 30, 31, 33, 34, 35, 39, 40, 42, 43, 45, 47, 49, 51, 56, 57, 58, 59, 60, 64, 69, 70, 75, 76, 78, 79, 80, 81, 82, 84, 85, 86, 87, 89, 90, 91, 97, 101, 103, 104, 105, 110, 116, 118, 122, 134, 135, 138, 139, 140, 141, 144, 145, 153, 159, 165, 170, 175, 177, 178, 180, 181, 182, 185, 187, 194, 195, 196, 208, 221], "stop": [2, 3, 33, 36, 40, 79, 82, 188, 223, 227], "paramet": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 51, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 66, 67, 69, 70, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 89, 90, 91, 92, 93, 94, 95, 97, 99, 101, 103, 104, 105, 107, 108, 109, 110, 112, 113, 115, 116, 117, 118, 119, 120, 122, 123, 124, 126, 127, 128, 130, 133, 134, 135, 136, 137, 138, 139, 140, 141, 143, 144, 147, 148, 150, 151, 153, 157, 159, 160, 161, 164, 165, 166, 170, 172, 174, 175, 176, 178, 181, 182, 184, 185, 187, 188, 189, 190, 192, 194, 195, 196, 197, 198, 200, 208, 212, 216, 217, 218, 219, 223, 227], "tf": [2, 4, 8, 9, 10, 11, 12, 13, 15, 18, 19, 21, 22, 23, 24, 25, 30, 31, 33, 35, 39, 40, 41, 42, 45, 46, 47, 48, 51, 55, 57, 58, 59, 60, 61, 63, 69, 70, 75, 76, 77, 79, 80, 81, 82, 84, 85, 86, 87, 90, 91, 93, 94, 95, 99, 100, 101, 105, 107, 113, 116, 117, 118, 119, 120, 130, 135, 140, 141, 159, 165, 172, 174, 175, 176, 177, 178, 185, 187, 188, 190, 194, 195, 196, 198, 208, 224, 225, 227], "session": [2, 8, 11, 13, 23, 36, 45, 46, 77, 79, 81, 82, 93, 107, 113, 115, 118, 130, 159], "The": [2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 27, 29, 30, 31, 33, 34, 35, 37, 39, 40, 41, 42, 43, 45, 46, 47, 48, 49, 50, 51, 52, 55, 56, 57, 58, 59, 60, 61, 63, 64, 66, 69, 70, 71, 72, 73, 75, 76, 77, 79, 82, 83, 84, 85, 86, 87, 89, 90, 91, 93, 94, 95, 96, 97, 98, 99, 101, 103, 104, 105, 107, 108, 109, 110, 113, 115, 116, 118, 119, 120, 122, 124, 127, 130, 134, 135, 137, 138, 139, 140, 141, 144, 145, 151, 153, 159, 160, 161, 165, 174, 175, 176, 177, 178, 182, 185, 187, 188, 189, 190, 192, 194, 195, 196, 198, 205, 208, 209, 218, 223, 227], "current": [2, 8, 10, 11, 12, 13, 15, 17, 19, 22, 23, 24, 25, 31, 36, 40, 41, 45, 46, 57, 58, 63, 64, 70, 73, 75, 77, 79, 81, 82, 83, 85, 86, 90, 94, 95, 101, 103, 107, 108, 110, 116, 117, 118, 134, 139, 144, 145, 165, 188, 193, 194, 196, 216], "globalstep": 2, "whether": [2, 3, 9, 10, 11, 12, 15, 16, 17, 23, 33, 35, 39, 45, 47, 49, 51, 55, 56, 57, 60, 64, 70, 79, 81, 82, 85, 86, 90, 94, 99, 113, 115, 116, 134, 135, 140, 143, 150, 170, 188, 192, 194, 223], "we": [2, 7, 8, 9, 13, 15, 21, 22, 23, 24, 30, 33, 35, 36, 38, 43, 45, 47, 48, 49, 51, 55, 57, 60, 62, 64, 69, 70, 75, 79, 82, 85, 86, 87, 90, 93, 103, 116, 118, 124, 127, 150, 151, 178, 190, 192, 194, 196, 208, 227], "want": [2, 11, 15, 82, 90, 151, 190], "earlystop": [2, 36], "condit": [2, 10, 19, 22, 30, 31, 46, 70, 82, 160, 178], "In": [2, 3, 8, 11, 13, 15, 22, 33, 34, 35, 40, 43, 45, 47, 57, 58, 60, 69, 75, 82, 85, 86, 87, 99, 103, 113, 124, 127, 139, 176, 178, 181, 188, 190, 196, 217, 227], "tpu": [2, 10, 11, 13, 15, 19, 25, 31, 35, 46, 47, 51, 57, 58, 60, 63, 75, 78, 79, 82, 90, 98, 116, 117, 118, 124, 130, 143, 145, 147, 165, 170, 176, 178, 188, 201, 202, 223, 227], "train": [2, 3, 8, 11, 12, 13, 14, 15, 18, 19, 23, 24, 25, 31, 34, 38, 42, 45, 46, 47, 49, 57, 58, 60, 61, 63, 70, 75, 77, 79, 82, 85, 86, 90, 93, 95, 109, 112, 118, 122, 123, 124, 130, 134, 140, 144, 147, 153, 154, 156, 161, 163, 165, 166, 172, 173, 174, 175, 176, 178, 181, 185, 187, 192, 196, 198, 201, 202, 204, 211, 223, 227], "don": [2, 6, 9, 11, 12, 13, 15, 19, 22, 30, 42, 45, 47, 49, 57, 58, 59, 82, 118, 185], "t": [2, 6, 9, 11, 12, 13, 15, 17, 19, 21, 22, 27, 30, 33, 36, 40, 42, 45, 47, 49, 57, 58, 59, 61, 69, 70, 75, 82, 85, 86, 87, 90, 101, 104, 110, 118, 160, 178, 182, 185, 194, 196], "everi": [2, 9, 15, 17, 22, 37, 41, 42, 45, 49, 57, 61, 63, 69, 70, 75, 82, 85, 86, 87, 91, 95, 101, 105, 113, 134, 161, 174, 196, 216], "granular": 2, "enqueu": [2, 11, 130, 227], "thread": [2, 46, 49, 79, 93, 108, 114, 227], "mai": [2, 3, 7, 8, 11, 12, 13, 15, 17, 22, 24, 30, 31, 33, 35, 37, 43, 45, 47, 48, 49, 57, 70, 75, 79, 82, 83, 85, 86, 93, 118, 122, 126, 127, 178, 187, 188, 190, 196], "starv": 2, "loop": [2, 3, 11, 13, 22, 45, 46, 47, 57, 60, 63, 75, 79, 82, 86, 87, 90, 95, 117, 118, 130, 134, 227], "which": [2, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 18, 19, 21, 22, 24, 27, 30, 34, 35, 37, 38, 42, 43, 45, 46, 47, 49, 51, 55, 56, 57, 58, 59, 60, 63, 64, 69, 70, 75, 76, 77, 79, 82, 84, 85, 86, 87, 89, 90, 91, 93, 95, 96, 99, 101, 103, 104, 107, 109, 116, 117, 118, 120, 128, 133, 134, 135, 137, 138, 139, 140, 141, 144, 151, 153, 159, 160, 175, 177, 178, 185, 187, 193, 194, 196, 218], "default": [2, 3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 19, 22, 24, 27, 30, 34, 35, 37, 40, 42, 45, 47, 48, 49, 51, 56, 57, 58, 59, 60, 61, 64, 66, 69, 70, 75, 77, 79, 82, 85, 86, 87, 90, 91, 93, 95, 101, 103, 105, 109, 115, 116, 118, 127, 134, 135, 140, 141, 145, 150, 154, 159, 160, 161, 165, 167, 174, 175, 176, 178, 180, 181, 185, 187, 190, 192, 194, 195, 196, 208], "oper": [2, 6, 7, 8, 11, 12, 13, 15, 18, 19, 22, 23, 24, 30, 33, 34, 35, 37, 42, 47, 57, 58, 59, 60, 70, 75, 81, 82, 85, 90, 93, 99, 124, 134, 139, 227], "1000": [2, 35, 124, 227], "_findnewcheckpoint": 2, "processed_ckpt": 2, "new": [2, 4, 8, 10, 11, 15, 17, 24, 25, 30, 40, 45, 47, 51, 55, 56, 57, 58, 70, 76, 77, 78, 79, 82, 86, 90, 93, 101, 104, 107, 113, 119, 134, 137, 138, 139, 151, 160, 181, 194, 198], "rais": [2, 8, 11, 12, 13, 14, 15, 18, 23, 24, 31, 41, 47, 49, 51, 55, 56, 57, 66, 67, 69, 75, 77, 78, 81, 82, 86, 91, 93, 115, 116, 117, 122, 124, 127, 134, 140, 151, 170, 181, 190, 217, 223], "runtimeerror": [2, 23, 24, 41, 75, 117], "_trainerfinish": 2, "infer": [2, 8, 10, 13, 15, 18, 34, 38, 51, 57, 58, 77, 79, 85, 90, 101, 105, 116, 118, 144, 153, 161, 175, 188, 194, 198, 209, 227], "finish": [2, 7, 17, 23, 49, 58, 70, 76, 79, 93, 227], "us": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 21, 22, 23, 24, 28, 29, 30, 31, 33, 34, 35, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 48, 49, 51, 54, 56, 57, 58, 59, 60, 61, 62, 63, 64, 66, 68, 69, 70, 75, 76, 77, 78, 79, 81, 82, 83, 85, 86, 87, 89, 90, 91, 92, 93, 95, 96, 99, 100, 101, 103, 104, 105, 107, 109, 110, 113, 115, 116, 117, 118, 120, 121, 122, 123, 126, 127, 130, 133, 134, 135, 139, 140, 141, 143, 144, 145, 147, 150, 151, 153, 159, 160, 161, 163, 165, 167, 174, 175, 176, 177, 178, 180, 181, 187, 189, 190, 192, 194, 195, 196, 198, 204, 208, 217, 223, 226, 227], "latest": [2, 23, 35, 79, 93, 130, 227], "_runonlatestcheckpoint": 2, "runner_fn": 2, "runner_dir": [2, 82], "execut": [2, 11, 63, 75, 77, 79, 82, 113, 124, 130, 217, 227], "produc": [2, 22, 31, 38, 47, 49, 63, 69, 70, 82, 90, 101, 103, 105, 118, 174, 178, 188, 190, 195, 223], "comput": [2, 6, 8, 9, 10, 12, 13, 15, 17, 19, 21, 22, 24, 26, 27, 30, 33, 34, 35, 37, 39, 40, 42, 43, 44, 45, 46, 47, 48, 57, 58, 59, 60, 61, 62, 63, 64, 70, 75, 81, 82, 84, 85, 86, 87, 89, 90, 91, 96, 97, 101, 103, 105, 107, 108, 113, 118, 133, 134, 135, 136, 139, 140, 142, 144, 150, 151, 153, 160, 161, 174, 175, 178, 184, 185, 194, 195, 198, 208, 219, 220], "callabl": [2, 11, 15, 41, 49, 56, 69, 75, 76, 79, 82, 86, 113, 174, 177, 178, 182, 185], "take": [2, 3, 8, 9, 12, 15, 21, 22, 33, 41, 47, 55, 57, 60, 63, 75, 76, 79, 82, 85, 86, 95, 103, 107, 108, 113, 115, 134, 167, 189, 190, 196, 217, 218], "appli": [2, 4, 6, 7, 8, 9, 10, 12, 13, 15, 19, 21, 22, 27, 29, 30, 31, 35, 37, 42, 43, 45, 47, 48, 54, 55, 57, 58, 59, 60, 61, 64, 69, 70, 75, 82, 84, 85, 86, 87, 89, 90, 91, 97, 99, 101, 105, 116, 134, 140, 174, 175, 185, 192, 194, 195, 197, 218], "save": [2, 11, 13, 21, 23, 34, 77, 79, 82, 86, 93, 118, 144, 153, 198], "log": [2, 8, 10, 17, 40, 55, 57, 65, 69, 82, 103, 122, 134, 143, 160, 161, 178, 187, 194, 198, 216, 227], "_runonallcheckpoint": 2, "_invizierstudi": 2, "_updateearlystopmetr": 2, "jobnam": [2, 36], "global_step": [2, 3, 13, 31, 35, 36, 45, 70, 75, 79, 81, 82, 84, 90, 93, 118, 123, 130], "metric_nam": 2, "metric_valu": [2, 82], "_writetolog": 2, "text": [2, 49, 64, 70, 76, 82, 107, 121, 150, 151, 159, 161, 163, 172, 173, 180, 181, 182, 187, 189, 196, 208, 219, 222, 225, 226], "filenam": [2, 4, 32, 82, 93, 150, 151], "_waituntilinit": 2, "start_up_delay_step": 2, "wait": [2, 23, 78, 79, 93], "until": [2, 33, 63, 70, 79, 82, 95], "i": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 27, 29, 30, 31, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 47, 48, 49, 51, 53, 55, 56, 57, 58, 59, 60, 61, 62, 63, 66, 67, 69, 70, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 89, 90, 91, 93, 94, 95, 96, 97, 99, 101, 103, 104, 105, 107, 109, 110, 113, 115, 116, 117, 118, 120, 121, 122, 124, 127, 133, 134, 135, 136, 137, 138, 139, 140, 141, 143, 144, 145, 150, 151, 153, 159, 160, 161, 165, 170, 174, 175, 176, 178, 181, 182, 185, 187, 188, 190, 192, 193, 194, 195, 196, 197, 198, 204, 208, 216, 217, 218, 219, 221, 227], "readi": [2, 15, 57], "_runloop": 2, "job_nam": [2, 11, 13, 24, 31, 79, 223, 227], "loop_func": 2, "loop_arg": 2, "cleanup_func": 2, "run": [2, 7, 8, 10, 11, 13, 15, 22, 31, 33, 35, 36, 42, 45, 46, 47, 57, 60, 61, 63, 70, 75, 77, 78, 79, 81, 82, 86, 90, 91, 93, 101, 103, 113, 115, 116, 118, 122, 123, 130, 134, 150, 151, 163, 165, 170, 175, 181, 185, 190, 198, 217, 223, 224, 227], "expect": [2, 8, 13, 15, 17, 21, 22, 29, 30, 34, 45, 47, 49, 56, 57, 58, 61, 68, 70, 79, 82, 84, 85, 86, 90, 91, 105, 110, 115, 118, 122, 134, 137, 139, 144, 153, 161, 175, 178, 190, 194, 195, 198], "error": [2, 3, 4, 12, 14, 62, 70, 79, 82, 89, 93, 136, 142, 147, 150, 151, 174, 190], "string": [2, 4, 7, 11, 12, 13, 14, 15, 22, 24, 29, 31, 34, 41, 45, 47, 49, 51, 57, 63, 64, 66, 69, 70, 75, 76, 77, 79, 82, 83, 90, 96, 101, 107, 110, 115, 116, 117, 118, 121, 122, 127, 134, 135, 136, 141, 144, 150, 151, 153, 159, 161, 167, 170, 175, 176, 178, 187, 194, 196, 198, 208, 216, 217, 218, 223], "name": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 27, 29, 30, 31, 34, 35, 37, 41, 42, 44, 45, 46, 47, 49, 50, 51, 56, 57, 58, 59, 60, 63, 69, 70, 75, 76, 78, 79, 80, 82, 83, 84, 85, 86, 87, 90, 91, 95, 97, 98, 99, 100, 101, 105, 107, 108, 110, 113, 116, 117, 118, 120, 122, 123, 124, 126, 127, 128, 130, 134, 135, 137, 139, 140, 141, 143, 144, 150, 153, 159, 160, 161, 165, 170, 173, 174, 175, 176, 177, 178, 181, 182, 185, 189, 190, 192, 194, 195, 196, 219, 223, 227], "list": [2, 4, 7, 8, 11, 12, 13, 15, 17, 21, 22, 23, 24, 27, 30, 31, 34, 35, 37, 41, 42, 43, 45, 46, 47, 48, 49, 51, 53, 56, 57, 58, 59, 60, 61, 63, 64, 69, 70, 75, 76, 77, 78, 79, 82, 84, 85, 86, 87, 89, 90, 91, 97, 101, 104, 105, 107, 108, 112, 113, 115, 116, 117, 118, 122, 134, 136, 140, 141, 142, 144, 145, 150, 151, 153, 159, 160, 161, 165, 170, 175, 185, 190, 194, 195, 196, 197, 198, 218, 219, 223, 227], "tupl": [2, 6, 8, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 30, 33, 41, 42, 43, 46, 47, 49, 51, 53, 55, 57, 58, 59, 61, 69, 70, 75, 76, 82, 85, 86, 89, 90, 91, 101, 107, 108, 115, 124, 134, 137, 138, 139, 150, 160, 161, 175, 187, 190, 194, 197, 208, 219, 227], "argument": [2, 7, 8, 13, 15, 21, 22, 31, 35, 37, 42, 46, 47, 49, 56, 57, 63, 64, 75, 76, 82, 85, 86, 90, 91, 101, 107, 117, 122, 160, 174, 177, 187, 190, 217, 223], "pass": [2, 7, 8, 10, 11, 12, 13, 15, 17, 21, 22, 30, 31, 35, 37, 39, 43, 45, 47, 49, 56, 57, 58, 61, 63, 70, 75, 76, 82, 85, 86, 89, 90, 91, 93, 101, 103, 104, 105, 107, 109, 113, 118, 139, 144, 160, 174, 188, 217], "befor": [2, 7, 8, 11, 13, 15, 17, 21, 22, 26, 35, 36, 37, 45, 46, 47, 49, 57, 69, 70, 79, 82, 90, 93, 99, 109, 113, 116, 128, 134, 140, 150, 151, 160, 177, 192, 198, 208, 217], "_dequeuethreadcomplet": 2, "_loopenqueu": [2, 130, 227], "session_overrid": 2, "_getsess": [2, 124, 130, 227], "gettraindir": 2, "_createsummarywrit": 2, "creat": [2, 4, 7, 8, 9, 10, 11, 12, 13, 15, 19, 22, 23, 27, 30, 31, 34, 35, 37, 41, 42, 45, 47, 48, 49, 53, 57, 58, 59, 60, 67, 70, 75, 76, 77, 79, 82, 84, 85, 86, 87, 90, 91, 93, 95, 101, 105, 107, 113, 116, 117, 118, 124, 127, 128, 133, 134, 135, 140, 144, 153, 165, 175, 178, 182, 185, 192, 194, 195, 198, 216, 223, 226, 227], "summari": [2, 13, 27, 63, 75, 76, 79, 80, 82, 90, 103, 107, 113, 117, 123, 130, 134, 140, 143, 153, 194, 227], "writer": [2, 113, 130, 217], "_createtf2summarywrit": 2, "tf2": [2, 4, 13, 75, 82, 113, 185], "_tf2summarycontext": 2, "_createtf2summaryop": 2, "_initializetf2summarywrit": 2, "_runtf2summaryop": 2, "_writesummari": [2, 79], "summary_writ": 2, "text_filenam": 2, "construct": [2, 13, 21, 22, 24, 34, 36, 39, 45, 47, 49, 55, 56, 57, 58, 63, 77, 78, 79, 82, 86, 93, 99, 101, 105, 113, 118, 124, 127, 139, 144, 153, 161, 175, 178, 198, 209, 223, 227], "write": [2, 13, 32, 49, 51, 79, 82, 93, 96, 120, 123, 151, 170, 217, 223, 227], "them": [2, 11, 12, 13, 15, 18, 45, 57, 75, 79, 82, 85, 116, 118, 161, 174, 182, 185, 190, 208, 218, 223, 227], "tri": [2, 47, 82, 163], "eval": [2, 3, 13, 19, 23, 34, 57, 63, 79, 82, 85, 90, 95, 116, 118, 123, 124, 130, 135, 140, 153, 159, 175, 227], "gener": [2, 8, 9, 10, 11, 12, 13, 14, 15, 31, 34, 36, 41, 47, 49, 51, 54, 56, 57, 58, 61, 70, 76, 78, 79, 82, 85, 86, 87, 89, 91, 93, 96, 98, 99, 103, 107, 110, 115, 118, 127, 130, 134, 139, 141, 145, 147, 150, 151, 154, 159, 165, 176, 177, 178, 181, 182, 187, 190, 196, 201, 202, 204, 208, 218, 223, 227], "dict": [2, 8, 10, 11, 12, 13, 14, 15, 17, 22, 24, 34, 42, 44, 45, 47, 48, 49, 51, 53, 56, 57, 58, 59, 60, 63, 69, 75, 76, 77, 79, 80, 81, 82, 85, 86, 87, 91, 101, 105, 107, 108, 113, 116, 117, 118, 124, 127, 128, 130, 134, 135, 137, 139, 140, 143, 144, 150, 151, 153, 160, 161, 172, 174, 175, 178, 181, 187, 188, 190, 194, 195, 198, 209, 219, 223, 227], "from": [2, 4, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 21, 22, 23, 24, 30, 31, 34, 35, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 51, 55, 56, 57, 58, 59, 60, 62, 63, 64, 69, 70, 75, 76, 77, 78, 79, 82, 83, 85, 86, 87, 90, 91, 93, 95, 96, 98, 99, 101, 103, 104, 105, 108, 109, 110, 113, 116, 117, 118, 120, 122, 123, 127, 128, 130, 133, 134, 135, 136, 137, 139, 140, 141, 144, 150, 153, 159, 161, 165, 170, 174, 175, 178, 180, 181, 182, 184, 185, 187, 188, 190, 194, 195, 196, 198, 208, 216, 217, 218, 219, 220, 222, 223, 226, 227], "kei": [2, 8, 9, 10, 11, 12, 13, 15, 21, 22, 23, 34, 36, 39, 40, 41, 42, 44, 45, 46, 47, 49, 50, 52, 53, 57, 58, 59, 60, 61, 63, 65, 69, 70, 72, 77, 79, 80, 82, 85, 86, 87, 90, 91, 99, 101, 103, 105, 106, 107, 113, 116, 118, 119, 127, 130, 134, 140, 141, 144, 151, 153, 159, 160, 161, 175, 187, 190, 194, 195, 196, 198, 208, 217, 219, 223, 227], "protobuf": [2, 50, 52, 71, 72, 73, 205], "If": [2, 3, 4, 6, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 21, 23, 30, 36, 41, 45, 46, 47, 48, 49, 51, 55, 56, 57, 58, 61, 63, 66, 69, 70, 75, 77, 79, 82, 85, 86, 90, 91, 93, 94, 95, 99, 105, 113, 115, 117, 120, 123, 124, 127, 130, 138, 140, 141, 143, 151, 159, 160, 174, 178, 181, 182, 188, 192, 194, 195, 196, 197, 217, 223, 227], "file": [2, 4, 10, 11, 13, 23, 31, 36, 64, 70, 77, 80, 82, 93, 95, 113, 115, 123, 126, 127, 130, 134, 141, 150, 151, 159, 160, 161, 170, 174, 178, 194, 196, 208, 211, 216, 217, 218, 220, 221, 222, 223, 226], "_writeinputdatastatsummari": 2, "summary_str": 2, "global_enqueue_step": 2, "input": [2, 4, 6, 8, 9, 10, 11, 12, 13, 14, 15, 17, 19, 21, 22, 24, 27, 29, 30, 31, 34, 38, 39, 41, 42, 43, 45, 46, 47, 48, 51, 54, 57, 58, 59, 60, 61, 63, 64, 70, 77, 78, 79, 82, 84, 85, 86, 87, 89, 90, 91, 97, 99, 101, 103, 104, 105, 106, 107, 109, 110, 113, 115, 116, 118, 134, 135, 137, 139, 141, 143, 144, 145, 147, 153, 154, 156, 159, 160, 161, 165, 170, 173, 174, 175, 176, 177, 178, 181, 185, 187, 188, 189, 190, 192, 193, 194, 195, 196, 197, 198, 201, 202, 204, 208, 217, 223], "data": [2, 4, 11, 14, 15, 19, 20, 21, 22, 30, 31, 32, 35, 39, 46, 47, 49, 57, 69, 70, 76, 78, 79, 82, 86, 99, 100, 101, 103, 117, 130, 133, 135, 139, 141, 144, 154, 156, 159, 163, 165, 170, 172, 174, 177, 182, 187, 193, 194, 196, 208, 211, 223, 227], "stat": [2, 11, 19, 57, 79, 145, 151, 181, 220], "merg": [2, 8, 15, 17, 49, 57, 58, 60, 70, 79, 82, 85, 96, 108], "scalar": [2, 4, 8, 9, 10, 13, 15, 17, 33, 40, 41, 47, 57, 58, 59, 60, 63, 70, 75, 82, 85, 86, 89, 91, 94, 95, 101, 103, 104, 105, 107, 109, 113, 117, 153, 178, 182, 190, 194, 208], "relat": [2, 8, 9, 106, 116, 140, 178, 194], "measur": [2, 3, 63, 79, 96, 151, 227], "how": [2, 7, 8, 13, 15, 27, 31, 43, 49, 57, 64, 82, 101, 113, 117, 127, 134, 151, 174, 178, 194, 196], "mani": [2, 11, 13, 21, 45, 64, 70, 82, 101, 151, 160, 178, 182, 196, 221], "global": [2, 3, 11, 12, 13, 16, 23, 30, 31, 36, 45, 47, 60, 70, 75, 79, 81, 82, 83, 93, 95, 118, 123, 126, 127, 130, 178, 181, 196], "ha": [2, 7, 8, 10, 11, 15, 17, 21, 22, 29, 30, 35, 37, 39, 40, 47, 49, 56, 57, 58, 59, 63, 67, 70, 75, 79, 80, 82, 85, 86, 87, 89, 90, 93, 95, 99, 103, 115, 116, 120, 127, 134, 135, 160, 161, 178, 182, 189, 190, 194, 197, 221], "been": [2, 7, 10, 12, 15, 35, 37, 49, 60, 75, 80, 82, 85, 90, 93, 99, 101, 103, 116, 127, 134, 194, 196, 208], "defin": [3, 8, 9, 11, 12, 13, 14, 15, 17, 31, 38, 41, 45, 47, 49, 56, 57, 58, 63, 79, 82, 85, 90, 91, 93, 99, 101, 103, 105, 106, 127, 128, 160, 172, 174, 178, 181, 187, 189, 190, 195, 196], "explor": [3, 60], "report_interval_second": 3, "objective_metric_kei": 3, "overridemodelparam": 3, "model_param": [3, 46, 51, 82, 170], "modifi": [3, 8, 10, 22, 31, 43, 47, 57, 70, 82, 105, 134, 192, 193, 194, 196], "accord": [3, 8, 9, 12, 13, 45, 47, 48, 49, 51, 54, 57, 58, 60, 70, 82, 85, 86, 95, 99, 100, 119, 178, 194], "through": [3, 8, 11, 12, 13, 15, 22, 25, 43, 45, 47, 58, 63, 82, 87, 90, 91, 98, 99, 101, 113, 118, 144, 153, 161, 174, 175, 177, 178, 181, 185, 190], "tweak": 3, "e": [3, 4, 6, 8, 9, 10, 11, 12, 13, 15, 19, 21, 22, 24, 25, 27, 30, 31, 33, 34, 41, 42, 43, 45, 47, 49, 55, 56, 57, 58, 59, 63, 64, 69, 70, 75, 76, 79, 80, 82, 84, 85, 86, 87, 89, 90, 95, 97, 99, 101, 109, 113, 118, 120, 122, 127, 134, 144, 150, 153, 161, 170, 174, 175, 178, 185, 190, 192, 195, 196, 198, 217, 223, 224], "g": [3, 6, 8, 9, 10, 11, 12, 13, 15, 19, 21, 22, 24, 25, 27, 30, 31, 34, 41, 42, 43, 45, 47, 49, 56, 57, 58, 59, 63, 64, 69, 70, 75, 76, 79, 80, 82, 84, 86, 87, 89, 90, 95, 97, 99, 101, 107, 109, 113, 120, 122, 127, 134, 144, 150, 153, 161, 170, 174, 175, 178, 185, 192, 195, 196, 198, 217, 223, 224], "learn": [3, 7, 8, 34, 37, 43, 44, 57, 60, 75, 95, 110, 118, 160, 178, 192, 218], "rate": [3, 7, 34, 37, 47, 60, 70, 75, 95, 107, 110, 118, 147, 150, 151, 160, 192, 216], "shape": [3, 6, 8, 9, 10, 11, 12, 15, 17, 18, 19, 21, 22, 27, 29, 30, 35, 39, 40, 42, 45, 47, 48, 52, 55, 57, 58, 59, 61, 66, 70, 75, 76, 81, 82, 85, 86, 87, 89, 90, 91, 98, 99, 101, 104, 105, 107, 109, 113, 115, 116, 117, 119, 120, 128, 133, 134, 135, 136, 137, 139, 140, 141, 159, 160, 161, 170, 172, 175, 176, 178, 184, 187, 189, 190, 194, 195, 196, 197, 198, 208], "depth": [3, 11, 57, 58, 61, 82, 85, 91, 103, 137, 194, 195, 197], "width": [3, 11, 19, 27, 29, 30, 45, 57, 76, 176], "network": [3, 8, 22, 24, 42, 43, 47, 49, 57, 58, 82, 86, 89, 90, 176, 187, 192], "origin": [3, 9, 10, 11, 33, 43, 45, 47, 48, 53, 57, 58, 70, 76, 82, 95, 96, 99, 115, 139, 176, 178, 196, 208], "shouldstop": 3, "reportdon": 3, "infeas": 3, "infeasible_reason": 3, "report": [3, 63, 79, 194, 227], "complet": [3, 57, 70, 79], "shouldstopandmaybereport": 3, "metrics_dict": [3, 79], "counter": [3, 47, 64, 78, 107], "contain": [3, 6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 18, 19, 22, 23, 24, 27, 29, 30, 31, 34, 42, 43, 44, 45, 47, 49, 51, 53, 56, 57, 58, 59, 60, 61, 62, 64, 67, 69, 70, 75, 76, 79, 81, 82, 84, 85, 86, 89, 90, 91, 92, 95, 97, 99, 101, 103, 104, 105, 107, 109, 113, 115, 116, 118, 122, 126, 133, 134, 135, 136, 137, 139, 140, 141, 144, 153, 159, 160, 161, 174, 175, 176, 178, 182, 185, 190, 192, 194, 195, 196, 197, 198, 208, 223], "do": [3, 7, 9, 10, 11, 12, 15, 21, 22, 43, 45, 47, 49, 63, 64, 68, 70, 75, 79, 82, 85, 86, 90, 91, 94, 103, 116, 117, 135, 182, 190, 208], "noth": [3, 47, 82, 117, 140, 160, 174, 178], "_doreporttrainingprogress": 3, "reportevalmeasur": 3, "checkpoint_path": [3, 18, 23, 82, 130, 181], "A": [3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 25, 27, 29, 30, 31, 32, 33, 34, 35, 37, 41, 42, 43, 44, 45, 47, 48, 49, 51, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 66, 69, 70, 75, 76, 77, 79, 81, 82, 84, 85, 86, 87, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99, 101, 103, 104, 105, 106, 107, 108, 109, 110, 112, 113, 115, 116, 117, 118, 120, 122, 124, 127, 130, 133, 134, 135, 136, 137, 139, 140, 141, 143, 144, 145, 150, 151, 153, 159, 160, 161, 165, 167, 172, 174, 175, 176, 178, 181, 184, 185, 187, 190, 192, 194, 195, 196, 197, 198, 208, 216, 217, 219, 222, 223, 227], "implement": [3, 4, 8, 9, 10, 11, 12, 13, 14, 15, 17, 19, 21, 22, 25, 27, 29, 30, 33, 34, 35, 38, 39, 42, 43, 45, 46, 47, 57, 58, 59, 63, 64, 70, 76, 78, 79, 82, 84, 85, 86, 89, 90, 91, 93, 95, 97, 100, 101, 103, 106, 117, 118, 120, 121, 134, 138, 139, 140, 141, 159, 161, 170, 174, 175, 176, 178, 181, 184, 185, 187, 188, 194, 195, 196, 198], "doe": [3, 8, 9, 10, 11, 12, 15, 24, 35, 47, 48, 49, 51, 56, 57, 64, 69, 70, 75, 76, 77, 82, 85, 86, 87, 90, 95, 104, 105, 115, 117, 124, 128, 138, 139, 140, 160, 170, 178, 185, 223, 227], "except": [3, 9, 11, 14, 15, 17, 41, 70, 75, 78, 86, 88, 91, 93, 95, 115, 122, 137, 178, 181, 185], "tunermanagederror": 3, "baseexcept": 3, "propag": [3, 11, 12, 13, 15, 22, 27, 30, 33, 42, 43, 45, 47, 57, 58, 59, 84, 85, 86, 89, 91, 97, 117, 153, 161, 178, 185, 195], "tuner": 3, "py": [3, 15, 19, 20, 29, 57, 80, 82, 109, 150, 151, 187, 188, 218, 223, 227], "catch": 3, "treat": [3, 8, 11, 14, 15, 49, 51, 70, 87, 122, 141, 159, 181, 196], "unknown": [3, 11, 66, 115, 178], "failur": [3, 48, 93], "howev": [3, 11, 15, 22, 43, 49, 75, 82, 93, 178, 194, 196, 221], "some": [3, 8, 9, 10, 11, 12, 13, 22, 31, 43, 45, 47, 48, 49, 57, 58, 67, 75, 82, 85, 90, 101, 103, 116, 117, 118, 127, 139, 178, 188, 190, 194, 221], "case": [3, 7, 11, 13, 15, 34, 35, 37, 39, 47, 48, 49, 57, 58, 59, 60, 69, 70, 75, 79, 82, 85, 86, 90, 115, 127, 134, 139, 150, 174, 178, 182, 196, 222], "pyglov": 3, "an": [3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 22, 24, 30, 31, 33, 34, 35, 37, 41, 42, 43, 44, 45, 47, 48, 49, 51, 54, 55, 56, 57, 58, 59, 60, 62, 63, 64, 69, 70, 75, 76, 77, 78, 79, 80, 81, 82, 83, 85, 86, 90, 91, 93, 96, 99, 101, 103, 104, 105, 107, 108, 110, 113, 115, 116, 118, 124, 133, 134, 136, 138, 139, 141, 144, 153, 159, 160, 161, 174, 175, 178, 187, 190, 192, 194, 195, 196, 208, 209, 217, 223, 227], "earlystoppingerror": 3, "signal": [3, 57, 121, 139], "earli": [3, 36, 40, 51, 62, 79, 227], "might": [3, 8, 33, 82, 93, 140, 178, 187], "place": [3, 7, 15, 24, 45, 47, 54, 79, 82, 86, 133, 187, 196], "ani": [3, 11, 12, 13, 15, 23, 30, 45, 49, 53, 55, 57, 60, 69, 70, 75, 76, 79, 82, 85, 86, 93, 103, 115, 118, 122, 126, 128, 134, 135, 140, 143, 178, 182, 185, 188, 190, 194, 221, 223], "moment": [3, 19, 57, 75, 181], "migrat": [4, 82], "_clone_modul": 4, "m": [4, 15, 37, 39, 45, 47, 62, 70, 90, 118, 121, 180], "shallow": [4, 69], "clone": 4, "summarize_tf2_statu": 4, "summar": [4, 79, 82, 150, 151, 194], "version": [4, 8, 9, 15, 27, 37, 39, 79, 90, 93, 101, 105, 137, 151, 161, 187, 194, 195, 223], "environ": [4, 85, 187, 223], "_cachedataset": 4, "input_dataset": 4, "unaryunchangedstructuredataset": 4, "cach": [4, 15, 80, 187], "element": [4, 8, 9, 10, 11, 15, 17, 21, 30, 31, 47, 53, 55, 57, 69, 70, 76, 78, 82, 99, 101, 103, 105, 107, 119, 120, 134, 150, 151, 160, 187, 190, 194, 219], "its": [4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 26, 27, 29, 30, 31, 35, 37, 42, 43, 47, 49, 56, 57, 58, 59, 61, 62, 69, 70, 75, 79, 82, 84, 85, 86, 87, 89, 90, 91, 95, 97, 99, 101, 103, 104, 105, 109, 110, 116, 128, 133, 134, 137, 139, 140, 144, 160, 178, 184, 185, 187, 190, 194, 195, 196, 197, 198, 216, 218], "_abc_impl": [4, 174, 182], "_abc": [4, 174, 182], "_abc_data": [4, 174, 182], "_shuffledataset": 4, "buffer_s": 4, "seed": [4, 10, 39, 51, 70, 82, 86, 89, 99, 109], "reshuffle_each_iter": 4, "randomli": [4, 46, 47, 57, 58, 70, 82, 99, 174, 176, 178, 196], "shuffl": [4, 47, 90, 174, 196], "stateless_shuffle_dataset": 4, "stateless": [4, 82, 86, 99, 101], "shuffledataset": 4, "uncondition": 4, "It": [4, 8, 10, 12, 15, 17, 22, 29, 30, 42, 43, 45, 47, 48, 49, 57, 58, 60, 61, 69, 70, 75, 82, 85, 86, 87, 90, 91, 93, 99, 101, 103, 105, 107, 113, 117, 127, 134, 137, 139, 165, 178, 185, 194, 195, 196, 198, 216, 221, 223], "can": [4, 7, 8, 9, 11, 12, 13, 15, 18, 19, 21, 22, 24, 25, 27, 30, 33, 34, 35, 37, 38, 41, 42, 43, 44, 45, 47, 49, 55, 56, 57, 58, 59, 60, 63, 70, 75, 76, 77, 79, 81, 82, 84, 85, 86, 87, 89, 90, 91, 95, 99, 101, 103, 104, 105, 108, 109, 113, 115, 116, 117, 118, 122, 126, 133, 134, 139, 140, 144, 150, 151, 153, 161, 165, 174, 175, 178, 185, 187, 190, 194, 195, 196, 197, 198, 217, 221, 223], "obtain": [4, 11, 15, 16, 31, 70, 82, 85, 99, 196, 208], "support": [4, 6, 11, 12, 13, 15, 21, 24, 30, 31, 45, 47, 49, 51, 56, 57, 58, 61, 69, 70, 79, 82, 85, 86, 90, 91, 93, 101, 105, 115, 116, 137, 139, 150, 178, 188, 193, 194, 195, 196], "tf1": [4, 82, 113, 185], "api": [4, 13, 30, 34, 49, 81, 82, 87, 105, 116, 133], "make_one_shot_iter": 4, "rubric": 4, "exampl": [4, 8, 9, 11, 12, 13, 15, 17, 21, 22, 27, 31, 33, 34, 41, 42, 43, 44, 45, 47, 49, 53, 57, 58, 59, 63, 69, 70, 75, 77, 79, 80, 82, 85, 90, 91, 96, 99, 101, 107, 116, 118, 120, 130, 134, 140, 141, 144, 150, 151, 153, 159, 161, 172, 174, 175, 177, 178, 181, 182, 185, 187, 188, 190, 194, 195, 196, 198, 208, 217, 223, 227], "rang": [4, 8, 9, 11, 12, 15, 22, 33, 40, 41, 47, 57, 61, 69, 70, 79, 82, 85, 87, 99, 101, 134, 176], "3": [4, 8, 9, 10, 15, 17, 33, 40, 45, 47, 51, 53, 55, 57, 58, 62, 70, 76, 82, 86, 89, 90, 91, 97, 99, 107, 115, 118, 134, 139, 140, 147, 150, 165, 166, 170, 176, 185, 188, 190, 192, 194, 196, 204, 219], "int64": [4, 47, 70, 136, 188], "tensor": [4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 18, 19, 21, 22, 27, 29, 30, 31, 33, 34, 35, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 53, 55, 57, 58, 59, 60, 61, 63, 64, 70, 75, 76, 79, 81, 82, 85, 86, 87, 89, 90, 91, 94, 95, 98, 99, 101, 103, 104, 105, 107, 108, 109, 113, 115, 116, 117, 118, 119, 120, 128, 130, 133, 134, 135, 136, 137, 138, 139, 140, 141, 143, 144, 145, 153, 159, 160, 161, 165, 170, 174, 175, 176, 178, 182, 184, 185, 187, 188, 190, 194, 195, 196, 197, 198, 208, 216, 227], "repres": [4, 6, 7, 8, 10, 11, 12, 13, 15, 17, 19, 22, 24, 30, 34, 35, 37, 40, 41, 42, 44, 45, 47, 48, 49, 55, 56, 57, 58, 59, 60, 69, 70, 75, 82, 85, 86, 87, 90, 98, 99, 101, 103, 104, 105, 109, 118, 119, 133, 134, 135, 136, 137, 144, 153, 178, 190, 192, 194, 195, 198, 208, 216], "number": [4, 6, 9, 10, 11, 12, 15, 17, 19, 22, 23, 24, 30, 31, 33, 36, 39, 40, 41, 42, 45, 47, 49, 51, 53, 55, 57, 58, 59, 62, 63, 70, 75, 76, 77, 79, 82, 85, 86, 87, 90, 92, 99, 101, 103, 105, 107, 110, 117, 118, 130, 134, 135, 136, 137, 139, 151, 160, 161, 170, 172, 174, 175, 178, 188, 189, 190, 192, 194, 196, 218, 221, 223, 227], "sampl": [4, 10, 11, 13, 15, 34, 38, 42, 47, 55, 63, 66, 70, 79, 82, 90, 91, 99, 109, 110, 115, 118, 130, 134, 139, 141, 144, 153, 159, 161, 163, 170, 175, 178, 194, 196, 198, 216], "option": [4, 8, 9, 10, 11, 12, 13, 15, 17, 22, 25, 27, 31, 40, 45, 46, 47, 48, 49, 51, 57, 58, 59, 60, 69, 70, 75, 76, 77, 79, 81, 82, 85, 86, 90, 91, 101, 103, 105, 107, 109, 117, 134, 135, 138, 150, 151, 160, 172, 174, 175, 190, 197, 198, 217, 227], "random": [4, 10, 39, 47, 51, 55, 70, 82, 89, 90, 99, 109, 134, 176, 185], "distribut": [4, 8, 10, 13, 15, 34, 35, 39, 41, 57, 59, 70, 82, 85, 109, 110, 144, 153, 161, 175, 178, 194, 198, 227], "see": [4, 7, 8, 10, 15, 17, 27, 33, 35, 37, 40, 41, 45, 47, 49, 57, 58, 59, 69, 70, 75, 77, 82, 85, 86, 89, 90, 91, 92, 101, 103, 105, 108, 109, 113, 115, 116, 120, 138, 139, 182, 185, 187, 189, 196, 197, 216, 223], "set_se": 4, "behavior": [4, 8, 11, 47, 49, 58, 59, 70, 76, 82, 85, 86, 93, 95, 113, 116, 134], "boolean": [4, 10, 57, 64, 69, 70, 79, 82], "indic": [4, 7, 9, 10, 11, 15, 22, 24, 33, 35, 37, 39, 45, 47, 49, 55, 57, 58, 59, 60, 62, 69, 70, 75, 79, 81, 82, 103, 115, 138, 144, 160, 178, 187, 197, 198], "pseudorandomli": 4, "reshuffl": 4, "each": [4, 8, 9, 10, 11, 12, 13, 15, 16, 17, 19, 22, 26, 31, 33, 34, 35, 39, 41, 42, 43, 44, 45, 47, 49, 51, 53, 55, 56, 57, 58, 59, 60, 63, 64, 69, 70, 75, 76, 79, 82, 85, 86, 87, 90, 91, 93, 99, 101, 103, 104, 105, 107, 110, 115, 116, 118, 121, 124, 127, 128, 133, 134, 137, 143, 144, 151, 153, 160, 161, 170, 172, 175, 178, 182, 187, 188, 189, 190, 192, 194, 196, 198, 208, 217, 218, 219, 223, 227], "iter": [4, 10, 11, 17, 24, 33, 47, 49, 51, 62, 63, 76, 79, 82, 85, 86, 87, 101, 134, 137, 139, 178, 187, 194], "over": [4, 8, 19, 22, 30, 47, 49, 57, 59, 63, 70, 75, 85, 90, 91, 101, 108, 144, 178, 190], "type": [4, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 22, 23, 24, 27, 30, 31, 34, 35, 37, 41, 42, 45, 47, 49, 50, 52, 55, 56, 57, 58, 59, 61, 62, 64, 66, 69, 70, 71, 72, 73, 75, 76, 79, 82, 85, 86, 87, 89, 90, 91, 99, 101, 103, 105, 107, 108, 115, 117, 118, 124, 134, 136, 138, 140, 144, 145, 150, 151, 153, 161, 170, 175, 176, 178, 181, 188, 194, 195, 196, 198, 205, 209, 217, 219, 223, 227], "stateless_cache_dataset": 4, "cachedataset": 4, "filesystem": 4, "provid": [4, 8, 10, 11, 12, 13, 15, 17, 18, 21, 22, 31, 42, 47, 49, 51, 57, 58, 59, 60, 63, 70, 75, 79, 82, 85, 86, 87, 90, 91, 101, 105, 108, 113, 115, 116, 134, 140, 175, 177, 178, 187, 190, 194, 195, 198, 217], "memori": [4, 8, 15, 45, 57, 70, 75, 86, 89, 93, 170, 187, 196, 223], "stateless_list_fil": 4, "file_pattern": [4, 11, 31, 41, 73, 82, 141, 159, 196, 217], "match": [4, 8, 10, 13, 24, 47, 57, 70, 75, 82, 85, 86, 96, 107, 116, 151, 163], "one": [4, 6, 8, 9, 11, 12, 13, 15, 17, 19, 21, 22, 24, 27, 30, 31, 34, 42, 43, 45, 47, 49, 57, 58, 59, 62, 64, 69, 70, 75, 76, 79, 82, 85, 86, 90, 91, 95, 99, 101, 103, 104, 105, 108, 109, 113, 116, 118, 134, 136, 137, 144, 150, 151, 153, 160, 161, 170, 174, 175, 176, 178, 180, 181, 182, 188, 190, 194, 195, 196, 198, 217, 227], "more": [4, 8, 15, 17, 21, 22, 41, 42, 43, 44, 47, 57, 58, 59, 64, 70, 75, 79, 82, 85, 86, 91, 93, 101, 103, 104, 110, 134, 138, 178, 182, 188, 190, 194, 196], "glob": 4, "pattern": [4, 9, 11, 13, 21, 29, 31, 47, 57, 70, 82, 99, 141, 159, 196], "note": [4, 8, 9, 10, 11, 12, 13, 15, 17, 22, 24, 31, 34, 45, 47, 49, 51, 55, 57, 63, 68, 70, 79, 82, 85, 90, 115, 116, 117, 134, 139, 150, 151, 178, 185, 187, 194, 196], "Then": [4, 12, 15, 58, 79, 82, 99, 117, 223], "some_file_pattern": 4, "vector": [4, 8, 9, 11, 15, 35, 39, 41, 47, 57, 58, 59, 66, 70, 81, 82, 87, 90, 91, 92, 94, 99, 101, 103, 104, 105, 115, 116, 133, 134, 144, 153, 160, 161, 170, 184, 185, 192, 194, 195, 198], "shell": 4, "wildcard": 4, "": [4, 9, 11, 12, 13, 15, 21, 22, 23, 24, 31, 34, 35, 39, 40, 41, 43, 45, 47, 49, 51, 53, 56, 57, 59, 61, 63, 64, 66, 69, 70, 76, 79, 80, 82, 85, 86, 87, 90, 91, 93, 98, 101, 103, 105, 106, 110, 113, 115, 119, 133, 138, 139, 153, 160, 161, 174, 175, 178, 185, 188, 190, 194, 196, 217], "correspond": [4, 6, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 29, 30, 39, 42, 47, 53, 56, 57, 58, 59, 70, 76, 77, 79, 82, 85, 86, 89, 90, 99, 109, 113, 115, 119, 134, 136, 140, 144, 151, 153, 161, 178, 187, 198, 208, 217, 218], "variable_scop": [4, 8, 9, 12, 13, 15, 19, 22, 30, 42, 47, 57, 58, 59, 60, 82, 84, 85, 87, 90, 91, 95, 101, 105, 116, 118, 140, 175, 185, 194, 195], "arg": [4, 6, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 27, 29, 30, 31, 34, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 55, 56, 57, 58, 59, 60, 61, 63, 66, 68, 69, 75, 76, 77, 79, 82, 84, 85, 87, 89, 90, 91, 93, 95, 97, 99, 100, 101, 103, 104, 105, 107, 109, 110, 113, 115, 116, 118, 123, 124, 130, 133, 134, 135, 137, 139, 140, 141, 144, 145, 153, 154, 159, 160, 161, 165, 167, 175, 176, 177, 184, 185, 187, 193, 194, 195, 196, 197, 198, 208, 209, 227], "v1": [4, 9, 23, 82, 113, 194], "addit": [4, 8, 10, 13, 15, 19, 41, 45, 47, 49, 57, 58, 75, 76, 77, 79, 82, 85, 86, 87, 89, 90, 101, 107, 110, 113, 133, 134, 144, 188], "hyps_pb2": [5, 70], "record_pb2": [5, 32, 70], "versioned_file_set_pb2": [5, 70], "x_op": [5, 41, 70], "attention_step": [5, 102], "embedding_step": [5, 102], "rnn_step": [5, 102], "getfn": 6, "activation_nam": [6, 47], "function": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 21, 22, 24, 26, 27, 29, 30, 31, 35, 37, 40, 41, 42, 43, 44, 45, 46, 47, 49, 51, 53, 55, 56, 57, 58, 59, 60, 61, 62, 63, 65, 69, 70, 75, 76, 77, 78, 79, 80, 82, 84, 85, 86, 87, 89, 90, 91, 93, 97, 99, 101, 106, 107, 108, 110, 113, 117, 122, 128, 131, 134, 135, 138, 141, 151, 159, 170, 171, 177, 182, 184, 185, 187, 188, 190, 192, 194, 195, 196, 208, 217, 227], "getflop": 6, "flop": [6, 12, 15, 19, 21, 22, 30, 42, 57, 58, 59], "issupport": 6, "activationlay": 6, "baselay": [6, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 27, 29, 30, 31, 42, 43, 44, 47, 55, 57, 58, 59, 60, 61, 75, 85, 87, 89, 91, 95, 97, 99, 101, 109, 110, 115, 116, 128, 133, 135, 137, 139, 140, 160, 175, 176, 184, 185, 187, 193, 195, 197], "fprop": [6, 8, 9, 10, 12, 13, 15, 19, 21, 22, 25, 26, 27, 29, 30, 40, 42, 43, 45, 47, 55, 57, 58, 59, 61, 82, 84, 86, 89, 90, 91, 97, 99, 101, 103, 104, 105, 106, 116, 118, 137, 139, 140, 144, 160, 176, 184, 185, 187, 195, 197], "theta": [6, 8, 9, 10, 12, 13, 15, 17, 19, 22, 27, 29, 30, 34, 42, 43, 45, 47, 55, 57, 58, 59, 61, 81, 82, 84, 85, 86, 87, 89, 90, 91, 97, 99, 101, 103, 104, 105, 116, 118, 133, 134, 137, 139, 140, 144, 153, 160, 161, 175, 184, 185, 194, 195, 197, 198], "pad": [6, 8, 9, 10, 11, 15, 17, 19, 27, 29, 30, 39, 45, 47, 48, 55, 57, 58, 59, 61, 70, 76, 82, 84, 85, 86, 90, 91, 97, 99, 101, 103, 104, 105, 106, 107, 109, 115, 116, 134, 137, 138, 139, 140, 144, 145, 160, 161, 170, 178, 187, 194, 195, 196, 197, 198, 208], "fn": [6, 12, 21, 22, 23, 69, 77, 79, 82, 85, 86, 87, 128, 190], "nestedmap": [6, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 27, 29, 30, 31, 32, 34, 41, 42, 43, 44, 45, 47, 51, 55, 57, 58, 59, 60, 61, 63, 69, 75, 79, 82, 84, 86, 87, 89, 90, 91, 93, 97, 99, 101, 103, 104, 105, 107, 109, 116, 118, 133, 134, 135, 137, 139, 140, 141, 144, 145, 153, 159, 160, 161, 165, 175, 184, 185, 188, 190, 194, 195, 196, 197, 198, 208], "weight": [6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 27, 29, 30, 31, 33, 34, 37, 42, 43, 44, 45, 47, 48, 49, 51, 55, 57, 58, 59, 60, 61, 63, 70, 75, 81, 82, 84, 85, 86, 89, 90, 91, 97, 99, 101, 103, 104, 105, 109, 110, 116, 118, 133, 134, 137, 139, 140, 141, 144, 153, 159, 160, 161, 175, 185, 192, 193, 194, 195, 196, 197, 198, 208], "valu": [6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 19, 22, 24, 27, 29, 30, 33, 34, 35, 36, 37, 39, 40, 42, 43, 44, 45, 46, 47, 49, 50, 51, 52, 53, 56, 57, 58, 59, 60, 61, 63, 64, 65, 69, 70, 72, 75, 76, 79, 82, 83, 84, 85, 86, 87, 89, 90, 91, 92, 93, 94, 95, 97, 99, 101, 103, 104, 105, 107, 108, 109, 113, 116, 117, 118, 119, 120, 130, 133, 134, 137, 139, 141, 144, 151, 153, 159, 160, 161, 175, 176, 178, 185, 187, 190, 192, 194, 195, 196, 197, 198, 208, 217, 219, 222, 223, 225, 226, 227], "children": [6, 8, 10, 12, 13, 15, 17, 19, 22, 27, 29, 30, 42, 43, 47, 57, 58, 59, 60, 61, 75, 84, 85, 87, 89, 90, 91, 97, 99, 101, 103, 104, 105, 109, 116, 133, 134, 137, 139, 140, 144, 160, 175, 184, 185, 190, 194, 195, 197, 198], "output": [6, 8, 9, 10, 11, 13, 15, 17, 19, 21, 22, 27, 29, 30, 31, 33, 34, 41, 42, 45, 47, 49, 51, 57, 58, 59, 60, 63, 64, 70, 78, 79, 81, 82, 85, 86, 87, 89, 90, 91, 99, 101, 103, 104, 105, 106, 107, 109, 113, 117, 118, 134, 135, 137, 138, 139, 140, 144, 153, 160, 161, 170, 175, 176, 177, 185, 187, 189, 190, 192, 194, 195, 197, 198, 218, 219], "els": [6, 9, 15, 19, 45, 55, 57, 82, 117], "just": [6, 12, 13, 15, 17, 22, 34, 43, 49, 51, 57, 70, 82, 85, 86, 90, 103, 139, 178, 223, 227], "same": [6, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 27, 29, 30, 41, 42, 43, 45, 46, 47, 49, 53, 57, 58, 59, 61, 63, 69, 70, 76, 79, 81, 82, 84, 85, 86, 87, 89, 90, 95, 97, 101, 107, 108, 109, 113, 115, 117, 134, 140, 178, 182, 185, 190, 194, 195, 196, 198], "fpropmeta": [6, 12, 15, 19, 22, 30, 42, 57, 58, 59], "p": [6, 8, 10, 11, 12, 13, 15, 17, 19, 22, 24, 25, 27, 30, 31, 33, 42, 45, 47, 57, 58, 59, 60, 62, 70, 82, 84, 85, 87, 90, 91, 95, 101, 104, 105, 116, 118, 121, 134, 140, 159, 160, 161, 175, 177, 178, 192, 194, 195, 196, 208], "metadata": [6, 11, 12, 15, 19, 22, 30, 31, 35, 42, 57, 58, 59, 65, 174, 221], "about": [6, 11, 12, 13, 15, 19, 22, 24, 30, 34, 42, 45, 57, 58, 59, 82, 118, 134, 144, 153, 161, 175, 178, 196, 198], "experiment": [6, 12, 15, 19, 21, 22, 30, 42, 57, 58, 59, 79, 82], "featur": [6, 10, 11, 12, 15, 19, 22, 27, 30, 39, 41, 42, 43, 47, 49, 57, 58, 59, 82, 85, 99, 103, 107, 116, 134, 137, 139, 141, 159, 172, 174, 177, 178, 180, 182, 185, 187, 189, 194, 195, 196, 216], "depend": [6, 8, 11, 12, 15, 19, 21, 22, 29, 30, 31, 42, 47, 57, 58, 59, 79, 82, 86, 90, 95, 101, 103, 113, 139, 185, 194, 195, 196], "without": [6, 9, 11, 12, 15, 19, 22, 30, 31, 41, 42, 47, 49, 51, 56, 57, 58, 59, 70, 79, 82, 86, 89, 93, 117, 122, 139, 178, 195, 218], "consult": [6, 12, 15, 19, 22, 30, 42, 57, 58, 59, 116], "author": [6, 12, 15, 19, 22, 30, 42, 57, 58, 59], "somecomplexlay": [6, 12, 15, 19, 22, 30, 42, 57, 58, 59], "meta": [6, 12, 15, 19, 22, 30, 42, 52, 57, 58, 59, 174], "cl": [6, 12, 14, 15, 19, 22, 25, 30, 42, 49, 56, 57, 58, 59, 60, 79, 122], "128": [6, 9, 12, 15, 19, 22, 30, 42, 45, 46, 57, 58, 59, 75, 165, 166, 196], "20": [6, 12, 15, 19, 22, 30, 42, 57, 58, 59, 69, 90, 165, 166], "50": [6, 12, 15, 19, 22, 30, 33, 38, 42, 57, 58, 59, 165, 166, 187, 218], "channel": [6, 12, 15, 19, 22, 29, 30, 42, 57, 58, 59, 85, 86, 90, 98, 99, 107, 137, 139], "give": [6, 12, 15, 19, 22, 30, 42, 57, 58, 59, 75, 82, 178, 194], "estim": [6, 12, 15, 19, 21, 22, 26, 30, 42, 57, 58, 59, 75], "count": [6, 12, 15, 17, 19, 22, 30, 42, 47, 57, 58, 59, 63, 64, 85, 142, 151, 161, 221], "float": [6, 8, 9, 10, 11, 12, 15, 19, 22, 30, 33, 38, 42, 49, 57, 58, 59, 63, 70, 75, 82, 85, 90, 99, 101, 103, 105, 115, 141, 153, 159, 160, 176, 187, 194, 196], "point": [6, 7, 8, 10, 12, 13, 15, 19, 21, 22, 24, 30, 35, 37, 42, 57, 58, 59, 75, 76, 99, 134, 160, 161, 181, 194, 223], "done": [6, 9, 12, 15, 19, 22, 30, 42, 57, 58, 59, 63, 70, 79, 90, 93, 160], "given": [6, 8, 9, 10, 11, 12, 13, 14, 15, 18, 19, 21, 22, 23, 24, 27, 30, 34, 35, 36, 41, 42, 43, 45, 47, 49, 51, 55, 56, 57, 58, 59, 60, 63, 64, 69, 70, 76, 77, 79, 82, 84, 85, 86, 89, 90, 95, 96, 97, 99, 101, 104, 109, 110, 116, 118, 126, 127, 134, 136, 138, 144, 153, 159, 160, 161, 172, 174, 175, 176, 181, 185, 187, 190, 194, 195, 196, 198, 217, 218, 223, 227], "out_shap": [6, 12, 15, 19, 22, 30, 42, 57, 58, 59], "tell": [6, 12, 15, 19, 22, 30, 42, 57, 58, 59], "you": [6, 9, 12, 13, 15, 19, 22, 30, 42, 43, 45, 56, 57, 58, 59, 68, 75, 82, 86, 90, 97, 117, 118, 150, 151, 161, 195, 197, 198, 221, 223], "what": [6, 7, 8, 12, 15, 19, 22, 30, 42, 57, 58, 59, 68, 82, 86, 90, 103, 117, 178, 194, 196], "replac": [6, 8, 9, 10, 11, 12, 15, 17, 19, 22, 24, 30, 42, 45, 51, 57, 58, 59, 69, 70, 76, 79, 82, 86, 90, 94, 100, 101, 113, 134, 137, 139, 177, 178, 190, 194, 196], "tensorshap": [6, 12, 15, 17, 19, 22, 30, 42, 57, 58, 59, 82, 109, 119, 175, 178, 190], "incur": [6, 12, 15, 19, 22, 30, 42, 57, 58, 59, 87], "th": [6, 9, 10, 11, 12, 15, 17, 19, 21, 22, 24, 30, 42, 53, 57, 58, 59, 62, 66, 70, 82, 86, 87, 107, 115, 141, 159, 161, 174, 178, 187, 196], "http": [7, 8, 9, 10, 15, 19, 22, 27, 29, 30, 33, 38, 39, 42, 43, 44, 55, 57, 58, 59, 62, 75, 82, 85, 89, 90, 92, 95, 97, 99, 100, 106, 110, 115, 121, 134, 151, 163, 169, 180, 185, 194, 195, 196, 197, 198, 204, 214], "arxiv": [7, 8, 9, 10, 15, 19, 22, 27, 29, 30, 33, 38, 39, 42, 43, 44, 55, 57, 58, 59, 75, 82, 85, 89, 90, 92, 95, 97, 99, 100, 106, 110, 115, 134, 180, 194, 195, 196, 197, 198, 204], "org": [7, 8, 9, 10, 15, 19, 22, 27, 29, 30, 33, 38, 39, 42, 43, 44, 55, 57, 58, 59, 62, 75, 82, 85, 89, 90, 92, 95, 97, 99, 100, 106, 110, 115, 134, 151, 169, 180, 185, 194, 195, 196, 197, 198, 204, 214], "ab": [7, 8, 9, 15, 19, 22, 27, 29, 30, 42, 43, 44, 57, 58, 59, 75, 82, 85, 89, 90, 92, 95, 97, 106, 115, 180, 194, 195, 197, 198, 204], "2002": [7, 57, 58, 75], "11803": [7, 75], "adagraftoptim": 7, "learning_r": [7, 35, 37, 75, 116, 118, 160, 165, 192, 204], "magnitude_optim": 7, "direction_optim": 7, "diagnost": 7, "use_global_norm": 7, "combin": [7, 8, 11, 15, 44, 47, 55, 57, 58, 59, 61, 70, 75, 79, 82, 90, 95, 103, 116, 160, 184, 192, 194, 195], "per": [7, 8, 9, 11, 13, 15, 16, 17, 24, 31, 35, 41, 45, 47, 53, 57, 63, 70, 75, 76, 79, 82, 85, 91, 93, 99, 101, 104, 105, 109, 116, 118, 130, 133, 134, 137, 139, 144, 151, 178, 185, 192, 194, 195, 196, 227], "direct": [7, 39, 67, 75, 91, 195], "magnitud": [7, 99], "two": [7, 9, 15, 24, 31, 35, 45, 47, 57, 58, 64, 69, 70, 75, 82, 85, 86, 90, 103, 139, 150, 151, 178, 182, 184, 194, 195, 196, 198, 218, 219, 223], "disentangl": [7, 75], "adapt": [7, 15, 37, 57, 58, 75, 87, 90, 98, 101, 110, 113, 178, 180, 187], "gradient": [7, 8, 12, 13, 21, 33, 34, 35, 37, 39, 43, 44, 57, 60, 75, 81, 82, 85, 86, 89, 107, 113, 116, 144, 147, 153, 161, 175, 181, 188, 198], "naman": [7, 75], "agarw": [7, 75], "rohan": [7, 35, 75], "anil": [7, 35, 75], "elad": [7, 75], "hazan": [7, 75], "tomer": [7, 35, 75], "koren": [7, 35, 75], "cyril": [7, 75], "zhang": [7, 75], "_create_slot": [7, 35, 37, 75, 165], "var_list": [7, 35, 37, 75, 116, 165], "slot": [7, 35, 37, 55, 70, 75, 103, 116, 165], "need": [7, 8, 9, 10, 11, 13, 15, 17, 21, 23, 34, 35, 36, 37, 39, 45, 47, 48, 51, 55, 57, 58, 59, 63, 69, 70, 75, 76, 79, 81, 82, 85, 86, 89, 90, 91, 97, 98, 106, 110, 116, 118, 124, 133, 134, 140, 165, 195, 196, 197, 198, 208, 217, 227], "variabl": [7, 8, 9, 12, 13, 15, 18, 19, 22, 23, 24, 30, 31, 33, 34, 35, 37, 42, 44, 45, 47, 48, 51, 57, 58, 59, 60, 68, 70, 75, 82, 84, 85, 87, 90, 91, 93, 95, 101, 105, 107, 116, 118, 120, 122, 128, 140, 144, 153, 161, 165, 172, 175, 181, 184, 185, 187, 194, 195, 198, 223], "_prepar": [7, 35, 37], "call": [7, 8, 11, 12, 13, 14, 15, 17, 21, 22, 26, 27, 30, 31, 33, 35, 36, 37, 40, 41, 42, 43, 45, 47, 49, 56, 57, 58, 59, 63, 70, 76, 77, 78, 79, 81, 82, 84, 86, 87, 89, 93, 96, 97, 101, 103, 104, 105, 113, 116, 117, 118, 122, 133, 134, 139, 141, 145, 150, 151, 159, 165, 177, 178, 181, 185, 187, 188, 190, 194, 195, 196, 217], "name_scop": [7, 35, 37, 82, 117], "user": [7, 11, 17, 31, 35, 37, 47, 51, 56, 75, 82, 85, 177, 187, 190], "have": [7, 8, 9, 11, 12, 13, 15, 21, 27, 34, 35, 37, 39, 41, 45, 47, 49, 51, 56, 57, 58, 59, 60, 64, 68, 69, 70, 79, 80, 82, 85, 86, 90, 93, 101, 103, 104, 113, 116, 120, 122, 134, 135, 139, 140, 160, 172, 175, 178, 181, 188, 189, 194, 196, 208, 218, 221, 223], "chosen": [7, 35, 37, 39, 113, 176, 178], "applic": [7, 23, 35, 37, 43, 62, 75, 82, 85, 99, 106, 113, 178], "_apply_dens": [7, 35, 37, 75], "grad": [7, 35, 37, 39, 44, 57, 60, 75, 82, 86, 161, 181], "var": [7, 12, 13, 18, 23, 24, 35, 37, 45, 46, 47, 48, 60, 75, 81, 82, 85, 93, 117, 120, 161, 185], "add": [7, 9, 10, 11, 12, 13, 15, 19, 21, 22, 26, 27, 29, 35, 37, 47, 48, 57, 58, 59, 75, 76, 81, 82, 85, 86, 90, 93, 107, 116, 117, 126, 127, 134, 138, 140, 143, 144, 153, 180, 181, 185, 194, 196, 223, 227], "dens": [7, 35, 37, 45, 57, 75, 116], "_resource_apply_dens": [7, 35, 37, 75], "handl": [7, 12, 35, 37, 41, 48, 63, 75, 79, 82, 85, 86, 90, 101, 107, 185, 190, 194], "dtype": [7, 9, 10, 11, 15, 18, 19, 35, 37, 40, 45, 47, 57, 58, 59, 70, 75, 81, 82, 85, 86, 90, 91, 93, 98, 99, 104, 113, 117, 134, 160, 172, 194], "resourc": [7, 31, 35, 37, 41, 75, 139, 187], "_internal_apply_dens": 7, "magnitude_optimizer_apply_fn": 7, "direction_optimizer_apply_fn": 7, "main": [7, 15, 46, 77, 78, 79, 86, 106, 113, 130, 150, 151, 169, 170, 178, 187, 214, 217, 218, 220, 221, 222, 223, 224, 225, 226, 227], "logic": [7, 11, 21, 45, 47, 48, 70, 79, 120, 138, 139, 140, 165, 178, 180, 181], "child": [7, 8, 12, 13, 15, 22, 26, 27, 31, 42, 47, 57, 59, 60, 85, 87, 90, 91, 101, 105, 116, 134, 140, 144, 175, 194, 195], "final": [7, 8, 11, 13, 15, 21, 22, 31, 34, 46, 57, 58, 59, 61, 63, 76, 79, 82, 85, 86, 87, 91, 95, 110, 134, 137, 144, 153, 161, 175, 189, 194, 197, 198, 208], "increment": [7, 22, 47, 70, 82, 107, 118], "graft": 7, "pseudocod": 7, "copi": [7, 12, 13, 22, 35, 45, 47, 48, 49, 56, 69, 82, 93, 116, 124, 144, 153, 161, 178, 185, 187, 196, 223, 227], "scratch": 7, "space": [7, 9, 13, 15, 34, 70, 86, 99, 150, 170], "scratch_copi": 7, "figur": [7, 76, 107, 113, 134], "out": [7, 12, 13, 15, 30, 34, 36, 47, 49, 57, 63, 69, 70, 79, 82, 85, 86, 90, 93, 99, 107, 113, 118, 123, 128, 130, 136, 144, 153, 161, 187, 194, 196, 198, 223, 227], "far": [7, 10, 70, 96], "move": [7, 9, 13, 19, 45, 57, 70, 82, 85], "magnitude_step": 7, "back": [7, 11, 12, 57, 58, 66, 82, 95, 96, 101, 115, 139, 161, 180, 181, 196], "along": [7, 8, 9, 10, 15, 30, 45, 47, 48, 53, 55, 57, 58, 70, 79, 82, 85, 91, 107, 134], "line": [7, 49, 70, 76, 80, 82, 96, 113, 151, 170, 196, 208, 218], "segment": [7, 8, 15, 45, 47, 59, 64, 70, 96, 115, 121, 170, 194, 195, 197], "_finish": 7, "update_op": 7, "_apply_spars": [7, 35, 37, 75], "_resource_apply_spars": [7, 35, 37, 75], "grad_valu": [7, 35, 37], "grad_indic": [7, 35, 37], "spars": [7, 15, 33, 35, 37, 38, 47, 75, 82], "similar": [7, 8, 31, 35, 37, 39, 41, 45, 47, 49, 58, 75, 82, 91, 117, 137, 151, 178, 180, 184, 194], "de": [7, 35, 37, 75, 201, 202, 204], "duplic": [7, 9, 11, 15, 35, 37, 75, 82, 178, 182], "deal": [7, 11, 15, 35, 37, 75, 85], "correctli": [7, 35, 37, 56, 75, 82, 185], "non": [7, 8, 9, 10, 11, 15, 17, 22, 24, 30, 33, 35, 37, 42, 45, 47, 49, 57, 58, 63, 70, 75, 76, 82, 99, 107, 110, 116, 117, 130, 136, 182, 185, 188, 192, 196], "uniqu": [7, 15, 22, 35, 37, 41, 49, 63, 75, 78, 82, 85, 101, 128, 178, 182, 223], "instead": [7, 8, 11, 15, 35, 37, 47, 49, 56, 57, 59, 63, 69, 75, 77, 79, 82, 85, 86, 90, 91, 95, 150, 174, 177, 178, 195, 196, 227], "_resource_apply_sparse_duplicate_indic": [7, 35, 37, 75], "avoid": [7, 8, 11, 12, 15, 35, 37, 47, 57, 75, 79, 82, 90, 116, 127, 188], "overhead": [7, 15, 35, 37, 75, 194], "affect": [7, 15, 35, 37, 47, 75, 223], "integr": [7, 9, 35, 37, 75], "nonzero": [7, 35, 37, 75], "ar": [7, 8, 9, 10, 11, 12, 13, 15, 17, 19, 22, 23, 27, 29, 30, 31, 34, 35, 36, 37, 39, 40, 41, 43, 45, 46, 47, 49, 51, 56, 57, 58, 59, 60, 61, 63, 66, 68, 69, 70, 75, 79, 80, 81, 82, 84, 85, 86, 87, 89, 90, 91, 93, 95, 96, 98, 99, 100, 101, 103, 105, 107, 109, 110, 113, 115, 116, 117, 118, 120, 122, 127, 133, 134, 137, 138, 139, 144, 150, 151, 153, 160, 174, 176, 177, 178, 181, 182, 185, 187, 189, 194, 195, 196, 208, 217, 218, 223], "indexedslic": [7, 35, 37, 82], "pre": [7, 30, 35, 37, 45, 49, 57, 79, 93, 101, 103, 105, 150, 195], "process": [7, 8, 11, 13, 15, 19, 34, 35, 37, 41, 47, 57, 58, 70, 79, 82, 85, 91, 101, 103, 104, 105, 115, 118, 121, 130, 134, 139, 143, 144, 150, 153, 169, 187, 194, 196, 198, 208, 214, 227], "_apply_sparse_duplicate_indic": [7, 35, 37], "remov": [7, 8, 12, 15, 30, 35, 37, 47, 48, 70, 82, 116, 135, 138, 150, 151, 194, 208], "docstr": [7, 35, 37, 41, 58], "detail": [7, 8, 11, 15, 17, 35, 37, 41, 47, 57, 58, 59, 76, 82, 86, 91, 101, 103, 113, 134, 138, 143, 178, 197, 223], "toler": [7, 35, 37, 85], "correct": [7, 8, 9, 35, 37, 57, 75, 82, 85, 196], "special": [7, 12, 35, 37, 47, 48, 57, 70, 82, 85, 174, 178, 182, 196], "repeat": [7, 11, 15, 21, 22, 31, 35, 37, 45, 47, 70, 82, 87, 174, 194], "_conditionalcalldefun": 8, "cond": [8, 82, 113, 117], "f": [8, 12, 15, 19, 22, 29, 70, 76, 89, 170], "_applyattentiondropout": 8, "x": [8, 9, 11, 12, 15, 21, 22, 25, 27, 30, 39, 42, 43, 45, 47, 48, 49, 50, 52, 53, 55, 57, 58, 59, 69, 70, 71, 72, 73, 76, 82, 84, 85, 86, 89, 90, 91, 94, 95, 97, 99, 101, 108, 113, 118, 124, 184, 185, 190, 194, 195, 196, 198, 205, 227], "dropout": [8, 15, 25, 27, 29, 43, 45, 47, 57, 58, 59, 82, 89, 160, 192, 195], "atten_dropout_determinist": 8, "set": [8, 10, 11, 12, 13, 15, 17, 22, 24, 25, 27, 30, 31, 34, 36, 41, 43, 45, 47, 48, 49, 51, 55, 57, 58, 60, 63, 69, 70, 76, 78, 79, 81, 82, 85, 86, 90, 91, 93, 94, 95, 99, 101, 103, 113, 118, 124, 127, 128, 133, 134, 139, 147, 154, 160, 161, 172, 174, 175, 177, 178, 185, 187, 188, 190, 192, 194, 195, 196, 208, 223, 227], "fulli": [8, 21, 57, 59, 82, 99, 197, 223], "determinist": [8, 15, 39, 59, 78, 82, 89, 110, 118, 134, 176], "safecumprod": 8, "cumprod": 8, "logspac": 8, "cumsum": [8, 82], "underflow": 8, "result": [8, 9, 10, 13, 15, 17, 31, 34, 51, 57, 58, 61, 63, 69, 70, 79, 81, 82, 85, 90, 91, 101, 103, 106, 108, 113, 118, 135, 140, 144, 153, 174, 178, 189, 194, 198, 226], "numer": [8, 10, 39, 82, 85, 87, 89, 113], "instabl": 8, "when": [8, 11, 12, 13, 15, 21, 23, 24, 30, 34, 36, 43, 45, 47, 48, 49, 57, 58, 59, 64, 69, 70, 75, 76, 78, 79, 82, 85, 86, 91, 95, 99, 103, 105, 108, 113, 116, 117, 118, 122, 134, 144, 145, 151, 160, 165, 177, 178, 185, 187, 190, 194, 196, 198, 217, 227], "veri": [8, 15, 21, 82, 86, 90, 91, 178], "small": [8, 39, 57, 76, 113, 115, 196, 201], "zero": [8, 15, 30, 33, 35, 46, 47, 57, 61, 70, 75, 82, 85, 87, 90, 91, 95, 99, 101, 103, 105, 133, 178, 187, 194], "As": [8, 12, 15, 57, 70, 82, 85, 106, 107, 117, 135, 138, 178, 194], "long": [8, 15, 51, 79, 86, 196], "posit": [8, 9, 10, 15, 22, 30, 39, 45, 47, 57, 58, 59, 62, 70, 76, 82, 85, 92, 99, 108, 115, 122, 138, 160, 178, 182, 192, 194, 195, 196, 208], "cumul": [8, 10, 70], "product": [8, 15, 35, 75, 184], "exp": [8, 110], "ident": [8, 21, 22, 24, 39, 43, 44, 45, 57, 70, 82, 85, 86, 87, 95, 135, 178, 196], "math": [8, 76, 82, 90, 196], "those": [8, 11, 13, 15, 34, 43, 45, 49, 69, 70, 82, 85, 86, 90, 101, 103, 134, 185], "monotonicattentionprob": 8, "p_choose_i": 8, "previous_attent": 8, "mode": [8, 11, 15, 23, 24, 25, 31, 41, 47, 57, 58, 63, 70, 75, 79, 82, 90, 93, 99, 107, 113, 116, 117, 120, 123, 176, 227], "monoton": 8, "choos": [8, 24, 43, 49, 82, 180, 181], "probabl": [8, 10, 15, 27, 38, 47, 57, 58, 59, 63, 70, 82, 90, 103, 107, 110, 134, 160, 178, 192, 194, 196], "impli": [8, 82, 95], "sequenc": [8, 9, 10, 11, 15, 17, 19, 22, 24, 29, 30, 41, 42, 46, 48, 51, 55, 57, 59, 61, 66, 69, 70, 76, 79, 82, 85, 86, 90, 91, 99, 101, 103, 105, 107, 109, 115, 116, 124, 134, 137, 138, 139, 140, 145, 159, 160, 161, 172, 189, 190, 192, 194, 196, 197, 208, 227], "explicitli": [8, 12, 51, 82, 85, 95, 99, 174, 192], "left": [8, 9, 15, 22, 57, 82, 85, 91, 92, 117, 160, 176, 194], "right": [8, 9, 15, 22, 47, 57, 63, 70, 82, 85, 90, 91, 92, 96, 106, 176, 196], "manner": [8, 15, 42, 124, 227], "onc": [8, 12, 13, 15, 17, 36, 45, 57, 70, 79, 85, 101, 116, 118, 124, 130, 227], "attend": [8, 9, 15, 45, 58, 107, 192], "timestep": [8, 10, 57, 58, 70, 86, 90, 101, 109, 134, 139], "occur": [8, 64, 93, 95, 178], "cannot": [8, 18, 22, 57, 79, 82, 122], "subsequ": [8, 79, 103], "assumpt": [8, 108], "For": [8, 9, 10, 11, 13, 15, 21, 22, 27, 33, 34, 43, 45, 47, 49, 57, 58, 59, 61, 63, 70, 75, 82, 86, 90, 91, 95, 99, 107, 110, 116, 134, 139, 141, 144, 153, 159, 161, 175, 177, 178, 181, 187, 188, 192, 196, 198, 223], "inform": [8, 10, 13, 15, 20, 21, 22, 33, 37, 42, 48, 58, 79, 82, 86, 91, 103, 105, 122, 127, 134, 151, 178, 194], "onlin": [8, 13, 34], "linear": [8, 12, 15, 21, 22, 27, 29, 30, 37, 42, 43, 44, 47, 57, 58, 59, 82, 84, 85, 89, 95, 97, 99, 185, 192, 194, 195], "enforc": [8, 15, 90], "align": [8, 47, 150, 151, 194, 196], "batch_siz": [8, 11, 15, 19, 27, 30, 33, 40, 42, 46, 53, 55, 58, 61, 70, 78, 82, 87, 90, 91, 95, 99, 101, 103, 104, 105, 106, 107, 118, 134, 137, 139, 140, 141, 154, 159, 160, 163, 166, 170, 174, 175, 176, 177, 178, 187, 189, 190, 194, 195, 196, 198], "input_sequence_length": 8, "0": [8, 9, 10, 11, 12, 13, 15, 17, 18, 22, 23, 24, 25, 27, 29, 30, 33, 35, 36, 37, 39, 40, 41, 42, 43, 45, 47, 49, 51, 53, 55, 57, 58, 59, 60, 62, 63, 65, 69, 70, 75, 76, 78, 79, 82, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 95, 96, 97, 99, 101, 103, 105, 107, 109, 113, 116, 118, 120, 121, 134, 136, 137, 138, 139, 147, 150, 151, 156, 160, 165, 166, 174, 176, 178, 181, 185, 188, 190, 192, 194, 195, 196, 197, 198, 204, 208], "1": [8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 25, 27, 29, 30, 31, 33, 35, 37, 38, 39, 40, 41, 42, 43, 45, 47, 48, 49, 51, 53, 55, 57, 58, 59, 60, 61, 62, 63, 69, 70, 75, 76, 78, 79, 81, 82, 84, 85, 86, 88, 89, 90, 91, 93, 95, 96, 97, 98, 99, 101, 103, 104, 105, 106, 107, 109, 110, 113, 115, 116, 118, 120, 121, 134, 136, 137, 138, 139, 140, 151, 160, 163, 165, 166, 170, 172, 174, 176, 178, 185, 188, 190, 192, 194, 195, 196, 197, 204, 208, 219, 223], "previou": [8, 15, 22, 25, 47, 57, 58, 59, 63, 70, 79, 81, 90, 93, 101, 103, 104, 105, 134, 194], "first": [8, 9, 10, 11, 13, 15, 22, 30, 34, 35, 42, 45, 47, 53, 56, 57, 58, 61, 66, 70, 75, 76, 79, 82, 85, 87, 90, 91, 93, 95, 99, 101, 103, 104, 105, 115, 117, 118, 134, 139, 144, 150, 151, 153, 160, 161, 170, 175, 194, 195, 196, 198, 217, 218, 219], "preevious_attent": 8, "n": [8, 9, 15, 19, 22, 45, 46, 47, 57, 58, 64, 70, 75, 82, 86, 90, 95, 96, 99, 101, 104, 107, 120, 136, 153, 174, 178, 190], "must": [8, 9, 10, 11, 12, 13, 15, 17, 22, 31, 33, 34, 41, 45, 47, 49, 55, 57, 59, 62, 63, 69, 70, 75, 76, 78, 82, 85, 86, 91, 99, 101, 104, 116, 117, 134, 139, 141, 159, 161, 176, 177, 178, 190, 194, 195, 196], "recurs": [8, 12, 43, 47, 49, 69, 82, 90], "parallel": [8, 22, 42, 45, 47, 61, 82, 86, 165, 174, 221, 227], "hard": [8, 47], "scan": [8, 82, 221], "slowest": 8, "exact": [8, 17, 69, 82, 178], "suffer": 8, "sum": [8, 10, 11, 15, 21, 33, 39, 57, 59, 70, 75, 79, 82, 103, 105, 117, 118, 160, 192, 194], "close": [8, 15, 33, 116], "form": [8, 13, 22, 30, 34, 48, 49, 57, 69, 70, 82, 85, 96, 103, 139, 144, 153, 161, 175, 178, 198], "solut": [8, 33, 57, 178], "make": [8, 9, 10, 11, 15, 17, 24, 30, 33, 42, 48, 51, 62, 76, 82, 86, 93, 101, 104, 120, 134, 137, 138, 139, 174, 178, 185], "effici": [8, 9, 15, 42, 57, 70, 82, 89, 90, 221], "than": [8, 9, 13, 15, 17, 33, 43, 44, 45, 47, 48, 49, 57, 58, 61, 70, 75, 82, 85, 86, 90, 99, 103, 104, 116, 117, 118, 151, 178, 194, 196, 221], "problem": [8, 33, 82], "particular": [8, 11, 18, 57, 58, 59, 79, 82, 87, 105, 178], "entri": [8, 11, 33, 44, 56, 63, 69, 76, 79, 82, 99, 107, 116, 194], "either": [8, 11, 12, 13, 17, 19, 22, 30, 34, 39, 41, 49, 56, 57, 58, 63, 70, 75, 79, 82, 85, 90, 101, 103, 105, 139, 144, 150, 153, 161, 175, 178, 195, 196, 198, 227], "batch": [8, 9, 10, 11, 13, 15, 16, 19, 21, 22, 27, 29, 30, 31, 34, 39, 40, 41, 45, 46, 47, 55, 57, 58, 59, 61, 66, 70, 75, 76, 78, 79, 82, 90, 91, 95, 99, 101, 103, 104, 105, 107, 109, 115, 116, 117, 118, 130, 133, 134, 135, 137, 138, 139, 140, 141, 144, 145, 147, 153, 159, 160, 161, 165, 170, 174, 175, 177, 178, 182, 184, 185, 190, 194, 195, 196, 197, 198, 208], "valueerror": [8, 11, 13, 15, 18, 23, 24, 31, 47, 49, 51, 55, 56, 57, 66, 67, 69, 82, 86, 91, 115, 116, 124, 134, 151, 170, 190, 217, 223], "baseattentionlay": 8, "quantizablelay": [8, 9, 15, 22, 30, 57, 84, 85, 90, 91, 194], "_createlayervari": [8, 9, 12, 15, 19, 22, 30, 47, 57, 58, 59, 84, 85, 90, 91, 95, 116, 118, 185], "legaci": [8, 9, 12, 13, 15, 19, 22, 30, 47, 57, 58, 59, 60, 84, 85, 90, 91, 95, 116, 118, 185], "directli": [8, 9, 11, 12, 15, 19, 22, 30, 43, 47, 48, 57, 58, 59, 76, 82, 84, 85, 90, 91, 95, 101, 116, 118, 139, 145, 165, 170, 177, 185, 195], "__init__": [8, 9, 12, 13, 15, 19, 22, 27, 30, 47, 56, 57, 58, 59, 69, 84, 85, 90, 91, 95, 116, 118, 181, 185], "insid": [8, 9, 11, 12, 15, 19, 21, 22, 30, 47, 57, 58, 59, 84, 85, 90, 91, 95, 108, 116, 117, 118, 178, 185], "self": [8, 9, 10, 11, 12, 13, 15, 17, 19, 22, 25, 27, 30, 39, 40, 42, 43, 45, 47, 48, 49, 56, 57, 58, 59, 61, 63, 69, 77, 78, 82, 84, 85, 89, 90, 91, 95, 97, 113, 116, 118, 134, 144, 161, 178, 181, 185, 194, 195, 196, 197], "_selfvariablescop": [8, 9, 12, 15, 19, 22, 30, 47, 57, 58, 59, 84, 85, 90, 91, 95, 116, 118, 185], "usual": [8, 9, 11, 12, 13, 15, 19, 22, 30, 31, 41, 43, 47, 56, 57, 58, 59, 60, 75, 79, 82, 84, 85, 90, 91, 95, 99, 116, 118, 134, 151, 173, 178, 185, 227], "initforsourcepack": [8, 91, 134], "source_vec": [8, 15, 58, 59], "source_context": [8, 58], "source_pad": [8, 15, 58, 59, 134, 140, 194, 196], "source_segment_id": [8, 15, 58, 59], "initi": [8, 10, 11, 12, 15, 17, 23, 30, 31, 46, 47, 49, 51, 57, 59, 61, 63, 75, 82, 85, 86, 90, 91, 95, 101, 104, 110, 115, 133, 134, 140, 144, 147, 159, 160, 185, 187, 192, 194, 217], "_source_init_don": 8, "present": [8, 47, 51, 69, 70, 96, 190, 196, 223, 227], "alwai": [8, 10, 11, 22, 30, 47, 49, 57, 58, 59, 70, 75, 76, 82, 85, 95, 115, 178, 194], "singl": [8, 9, 11, 13, 14, 15, 19, 21, 22, 24, 30, 31, 34, 40, 45, 47, 49, 51, 57, 59, 61, 69, 70, 75, 78, 79, 82, 85, 86, 90, 91, 101, 104, 107, 116, 123, 124, 140, 144, 153, 159, 161, 175, 176, 178, 188, 190, 194, 196, 198, 208, 221, 227], "source_dim": [8, 58, 91, 140, 194], "some_dim": [8, 91], "pack": [8, 15, 40, 41, 45, 51, 57, 61, 63, 69, 70, 82, 90, 91, 134, 159, 161, 170, 195, 196], "where": [8, 9, 10, 11, 12, 13, 15, 19, 22, 30, 31, 34, 39, 40, 41, 42, 43, 44, 45, 47, 48, 49, 51, 55, 57, 58, 60, 62, 69, 70, 75, 78, 82, 85, 86, 87, 89, 90, 91, 95, 99, 101, 103, 104, 105, 107, 109, 113, 118, 121, 134, 135, 136, 139, 144, 150, 151, 153, 160, 161, 174, 175, 178, 187, 189, 190, 194, 195, 196, 198, 208], "multipl": [8, 11, 12, 13, 15, 17, 21, 22, 31, 42, 43, 44, 45, 47, 49, 57, 60, 75, 79, 82, 90, 91, 95, 99, 101, 108, 116, 170, 178, 190, 196], "computecontextvectorwithsourc": [8, 194], "intern": [8, 9, 10, 11, 12, 45, 47, 49, 57, 76, 85, 98, 101, 105, 120, 121, 139], "structur": [8, 12, 14, 15, 17, 21, 22, 44, 46, 47, 58, 61, 63, 69, 70, 82, 87, 89, 90, 101, 105, 109, 175, 178, 190, 217], "consid": [8, 9, 11, 15, 30, 45, 69, 70, 85, 150, 151, 178, 196], "mechan": [8, 12, 15, 39, 58, 60, 178], "inspect": [8, 56], "caller": [8, 9, 11, 12, 15, 22, 27, 30, 42, 43, 47, 49, 57, 58, 59, 70, 76, 82, 84, 85, 86, 89, 97, 116, 117, 118, 145, 165, 174, 177, 178, 185, 195], "packsourc": 8, "chang": [8, 11, 15, 27, 33, 45, 47, 48, 63, 82, 83, 86, 105, 134, 144, 150, 159, 196], "state": [8, 10, 12, 15, 17, 18, 19, 25, 30, 39, 40, 47, 49, 58, 61, 63, 75, 78, 79, 81, 82, 85, 86, 87, 90, 91, 93, 101, 103, 104, 105, 106, 107, 133, 134, 137, 140, 144, 160, 185, 194], "packed_src": [8, 91, 101, 133, 134], "query_vec": [8, 15, 58], "attention_st": [8, 134], "per_step_source_pad": [8, 134], "query_segment_id": [8, 58, 134], "context": [8, 9, 11, 12, 15, 23, 30, 47, 48, 57, 58, 59, 76, 82, 86, 91, 92, 94, 101, 103, 105, 106, 108, 113, 117, 133, 134, 188, 192, 194, 197, 217], "queri": [8, 9, 15, 39, 57, 58, 59, 103, 133, 134, 174, 178], "query_dim": [8, 15, 134], "target_batch_s": [8, 15], "source_length": [8, 194, 198], "context_dim": [8, 58, 91, 133, 134], "possibli": [8, 49, 54, 56, 75, 82, 119, 134], "nest": [8, 12, 17, 19, 31, 45, 47, 49, 69, 82, 87, 108, 109, 116, 170, 188, 190, 194], "dimens": [8, 9, 11, 13, 15, 19, 21, 22, 27, 29, 30, 31, 34, 39, 41, 45, 47, 48, 53, 55, 57, 58, 61, 70, 75, 76, 79, 82, 86, 90, 91, 92, 99, 101, 104, 107, 115, 118, 120, 133, 134, 144, 153, 160, 161, 172, 175, 178, 189, 190, 192, 194, 198, 208], "target_batch": [8, 15, 58, 59, 134, 194], "computecontextvector": 8, "unlik": [8, 57, 69, 82, 85, 178], "ask": 8, "getinitializationsourcest": 8, "get": [8, 9, 10, 11, 12, 13, 15, 17, 19, 22, 23, 26, 31, 39, 41, 43, 45, 47, 49, 51, 57, 62, 63, 69, 70, 75, 81, 82, 83, 85, 90, 93, 99, 108, 109, 113, 116, 122, 123, 124, 127, 130, 134, 145, 178, 182, 194, 208, 218, 223, 227], "onli": [8, 10, 11, 12, 13, 15, 17, 22, 23, 27, 30, 31, 34, 35, 42, 43, 45, 47, 48, 49, 51, 57, 58, 59, 60, 63, 66, 69, 70, 75, 79, 82, 85, 86, 87, 90, 91, 93, 95, 101, 103, 105, 106, 113, 115, 116, 117, 120, 124, 126, 138, 139, 140, 160, 166, 175, 178, 194, 195, 196, 198, 208, 227], "preserv": [8, 49, 51], "concated_source_vec": 8, "concated_source_context": 8, "subclass": [8, 11, 12, 13, 15, 22, 27, 30, 31, 42, 43, 47, 57, 58, 59, 63, 75, 78, 84, 85, 87, 89, 90, 97, 101, 104, 110, 118, 127, 134, 141, 144, 145, 159, 165, 170, 177, 180, 181, 185, 194, 195, 196], "interact": 8, "code": [8, 49, 57, 69, 82, 86, 87, 113, 117, 118, 120, 122, 139, 178], "fetch": [8, 13, 21, 34, 42, 51, 52, 57, 77, 79, 82, 118, 144, 153, 161, 198, 209, 221], "reload": [8, 93, 223], "setinitializationsourcest": 8, "overridden": [8, 11, 12, 13, 15, 22, 42, 45, 47, 57, 59, 60, 77, 82, 85, 87, 91, 101, 105, 116, 118, 134, 140, 145, 165, 175, 194, 195], "reset": [8, 11, 12, 31, 46, 82, 90, 91, 159, 181], "via": [8, 11, 12, 13, 15, 34, 47, 70, 79, 82, 85, 86, 122, 126, 185, 187, 194, 196], "later": [8, 12, 70, 85, 95, 104], "allow": [8, 9, 11, 12, 13, 15, 17, 18, 41, 47, 49, 56, 57, 58, 63, 70, 75, 83, 85, 86, 87, 90, 91, 93, 95, 99, 101, 116, 117, 185, 187, 196], "span": [8, 15, 49, 82], "new_init_st": [8, 194], "wa": [8, 15, 22, 23, 45, 47, 70, 75, 79, 86, 103, 113, 144, 178], "_paddedsoftmax": 8, "logit": [8, 9, 10, 13, 15, 34, 40, 45, 47, 57, 59, 70, 82, 109, 134, 140, 144, 153, 160, 161, 175, 178, 194, 198], "perform": [8, 9, 10, 13, 15, 17, 33, 34, 36, 49, 57, 58, 61, 63, 70, 81, 82, 85, 86, 87, 90, 94, 99, 100, 101, 105, 113, 115, 139, 140, 176, 184, 196, 221], "softmax": [8, 12, 13, 15, 22, 27, 30, 34, 39, 42, 43, 45, 47, 55, 57, 58, 59, 82, 84, 85, 89, 97, 144, 153, 160, 161, 175, 178, 185, 194, 195, 198], "were": [8, 12, 18, 57, 85, 93, 101], "after": [8, 9, 11, 12, 13, 15, 17, 18, 19, 21, 30, 33, 43, 45, 47, 48, 49, 57, 60, 63, 70, 75, 79, 82, 85, 86, 90, 93, 95, 118, 133, 134, 140, 147, 151, 161, 178, 194], "exponenti": [8, 13, 37, 85, 95, 110, 192], "techniqu": 8, "approxim": [8, 35, 64, 75, 110, 167], "standard": [8, 10, 15, 57, 58, 82, 85, 89, 105, 133, 185, 190, 195], "nn": [8, 22, 45, 57, 82, 116, 178], "larg": [8, 15, 45, 57, 75, 82, 86, 166, 196], "neg": [8, 15, 33, 41, 79, 82, 108, 110, 178, 182], "defer": [8, 75, 82], "defun": [8, 12, 70, 82], "low": [8, 10, 82, 85, 93, 110], "_updatepaddingwithpackedinputmask": 8, "mask": [8, 9, 13, 15, 39, 40, 45, 47, 57, 58, 70, 81, 82, 89, 90, 91, 99, 161, 193, 196], "id": [8, 10, 11, 17, 22, 25, 31, 40, 47, 55, 57, 58, 59, 64, 66, 70, 71, 77, 82, 90, 91, 93, 99, 104, 109, 115, 116, 121, 123, 130, 134, 135, 138, 140, 144, 159, 160, 161, 167, 170, 175, 178, 180, 188, 194, 195, 196, 197, 198, 208, 218, 222], "invalid": [8, 49, 55, 67, 76, 77, 82, 124, 223], "assign": [8, 11, 22, 33, 35, 46, 47, 53, 76, 79, 85, 120, 130, 182, 227], "neighbor": 8, "assum": [8, 10, 21, 27, 31, 57, 58, 59, 61, 82, 85, 86, 90, 91, 101, 105, 176, 178, 182, 185, 190, 216, 223], "source_batch": [8, 15, 17, 58, 59, 194], "additiveattent": 8, "also": [8, 10, 11, 12, 13, 15, 22, 30, 34, 40, 41, 42, 43, 45, 48, 49, 57, 58, 64, 69, 70, 75, 76, 82, 85, 86, 87, 90, 91, 93, 101, 103, 105, 110, 115, 117, 118, 134, 135, 138, 139, 144, 151, 153, 160, 182, 185, 189, 194, 196, 197, 198, 223], "known": [8, 15, 36, 63, 82, 85, 190], "bahdanau": 8, "describ": [8, 9, 13, 15, 22, 29, 31, 34, 45, 47, 57, 58, 82, 85, 86, 87, 90, 101, 103, 110, 118, 121, 144, 153, 161, 174, 175, 178, 194, 198, 208, 217], "dzmitri": 8, "kyunghyun": 8, "cho": 8, "yoshua": 8, "bengio": 8, "neural": [8, 17, 42, 57, 58, 70, 82, 86, 90, 134, 192], "machin": [8, 15, 42, 194, 195, 196, 200, 201, 202, 204, 221], "translat": [8, 15, 42, 64, 96, 110, 194, 195, 196, 200, 201, 202, 204], "jointli": 8, "iclr": 8, "2015": [8, 57], "1409": 8, "0473": 8, "addglobalvn": [8, 12, 57, 90], "zeroattentionst": 8, "decoder_batch_s": 8, "score": [8, 33, 63, 64, 70, 71, 79, 91, 96, 110, 151, 178, 194, 196], "between": [8, 13, 15, 23, 30, 34, 47, 49, 57, 58, 59, 64, 68, 70, 75, 82, 86, 90, 93, 95, 99, 120, 136, 142, 144, 150, 151, 153, 161, 175, 178, 184, 198, 208, 219], "compos": [8, 21, 22, 42, 75, 90, 95, 99], "averag": [8, 9, 13, 15, 22, 47, 63, 70, 82, 85, 96, 150, 194], "simpli": [8, 43, 178, 221], "dotproductattent": 8, "dot": [8, 12, 15, 49, 184, 190], "luong": 8, "minh": 8, "thang": 8, "hieu": 8, "pham": 8, "christoph": 8, "d": [8, 9, 11, 15, 22, 27, 39, 45, 57, 58, 61, 69, 82, 93, 99, 104, 107, 140, 176], "man": 8, "effect": [8, 15, 57, 63, 70, 75, 82, 85, 86, 95, 120, 135, 182, 185, 196], "approach": [8, 49, 85], "emnlp": 8, "1508": 8, "04025": 8, "hidden_dim": [8, 27, 57, 61, 91, 92, 160, 165, 166, 189, 192, 204], "num_hyps_per_beam": [8, 10, 17, 70, 134, 135, 192, 194], "beamsearch": 8, "group": [8, 9, 15, 19, 47, 82, 90, 208], "consecut": [8, 10, 58, 70, 82, 99], "row": [8, 10, 15, 33, 39, 45, 47, 55, 70, 76, 86, 104, 196], "_recursivereshap": 8, "multiheadedattent": [8, 15, 194], "head": [8, 9, 15, 29, 39, 45, 47, 58, 59, 92, 160, 189, 192, 194, 197], "conceptu": [8, 22, 86], "algorithm": [8, 15, 30, 33, 37, 43, 44, 86, 89, 95, 103, 121], "work": [8, 11, 13, 33, 47, 51, 56, 57, 59, 70, 76, 77, 79, 82, 85, 86, 113, 134, 140, 182, 196, 221], "follow": [8, 9, 10, 15, 17, 33, 39, 43, 44, 45, 47, 49, 57, 58, 59, 61, 64, 69, 70, 79, 80, 82, 85, 86, 93, 94, 95, 98, 103, 106, 109, 110, 121, 134, 139, 144, 147, 150, 151, 153, 160, 170, 178, 185, 187, 194, 196], "project": [8, 9, 15, 22, 27, 39, 45, 47, 57, 58, 59, 61, 82, 84, 90, 175, 194], "dim": [8, 9, 11, 15, 19, 21, 22, 29, 30, 39, 41, 45, 47, 48, 57, 58, 59, 61, 70, 82, 86, 91, 92, 101, 105, 107, 117, 119, 120, 134, 136, 139, 140, 160, 190, 192, 194, 195, 197], "well": [8, 33, 37, 45, 55, 56, 82, 86, 92, 110, 134, 138, 192, 217], "unless": [8, 51, 68, 70, 82, 85, 115, 134], "enable_ctx_pre_proj": 8, "split": [8, 11, 13, 15, 16, 21, 22, 24, 25, 27, 34, 45, 47, 48, 53, 57, 58, 70, 82, 90, 91, 95, 118, 153, 160, 163, 165, 173, 174, 175, 187, 194, 208], "num_attention_head": [8, 189], "chunk": [8, 15, 17, 39, 70, 160], "inner": [8, 29, 82, 108, 160, 192], "atten": [8, 134, 194], "separ": [8, 12, 15, 43, 47, 48, 49, 57, 58, 61, 70, 76, 79, 82, 87, 90, 107, 115, 127, 170, 178, 196, 208, 223], "concaten": [8, 21, 22, 35, 41, 55, 57, 79, 82, 90, 91, 101, 105, 107, 160, 188, 218], "prob": [8, 9, 15, 17, 27, 29, 55, 57, 58, 63, 70, 71, 82, 134, 160, 161, 192, 194, 198], "setoutputcontextdim": 8, "out_dim": [8, 29], "extendsourcepack": 8, "processprojectionvec": 8, "projection_vec": 8, "projection_typ": 8, "computecontextvectorwithattenprob": 8, "packcachedsourc": 8, "cached_src": 8, "computecontextvectorwithcachedsourc": 8, "locationsensitiveattent": 8, "account": [8, 15, 85], "previous": [8, 40, 63, 70, 82, 85, 104], "locat": [8, 10, 15, 47, 82, 174, 223], "section": [8, 9, 15, 57, 89, 97], "2": [8, 9, 10, 11, 12, 15, 17, 21, 27, 29, 31, 33, 40, 45, 46, 47, 49, 51, 53, 55, 57, 58, 62, 65, 69, 70, 75, 82, 89, 90, 93, 95, 97, 99, 101, 110, 118, 124, 134, 136, 138, 139, 140, 147, 151, 156, 160, 165, 166, 170, 185, 188, 190, 192, 194, 196, 204, 219, 227], "paper": [8, 9, 10, 30, 57, 58, 89, 90, 92, 99, 100, 180, 195, 198], "descript": [8, 49, 57, 109, 192], "nip": 8, "cc": [8, 85, 98], "5847": 8, "speech": [8, 15, 57, 121, 133, 134, 135, 137, 140, 141, 144], "recognit": [8, 141], "pdf": [8, 9, 10, 15, 19, 33, 38, 39, 55, 57, 58, 62, 90, 95, 97, 99, 100, 110, 121, 134, 194, 196, 198], "_applyconv": [8, 30, 57], "location_filter_var": 8, "convolut": [8, 15, 29, 30, 45, 47, 57, 58, 85, 90, 91, 97, 99], "location_featur": 8, "prev_prob": 8, "cumulative_prob": 8, "src_len": [8, 17, 107, 194], "mergesourcepaddingwithperstepsourcepad": 8, "tb": 8, "sl": 8, "sb": [8, 21], "target": [8, 9, 10, 11, 15, 17, 33, 46, 55, 57, 58, 59, 63, 70, 82, 90, 103, 107, 108, 109, 115, 118, 134, 135, 140, 144, 160, 170, 178, 194, 196, 198, 208, 223], "size": [8, 9, 10, 11, 12, 13, 15, 16, 24, 29, 30, 33, 40, 41, 45, 46, 47, 48, 53, 57, 62, 70, 75, 76, 79, 81, 82, 86, 87, 90, 91, 92, 95, 99, 101, 104, 105, 107, 118, 119, 120, 133, 134, 136, 141, 145, 147, 159, 160, 161, 163, 170, 174, 178, 189, 190, 192, 194, 196], "monotonicattent": 8, "mononoton": 8, "1704": 8, "00784": 8, "exactli": [8, 10, 15, 41, 47, 57, 59, 68, 101], "wai": [8, 11, 47, 57, 70, 82, 85, 90, 101, 103, 120, 134, 139, 151, 165, 221], "both": [8, 9, 13, 15, 31, 41, 49, 57, 58, 59, 68, 70, 75, 81, 85, 86, 89, 101, 144, 153, 178, 194, 196, 198], "energi": [8, 216], "differ": [8, 9, 10, 11, 12, 15, 22, 31, 42, 43, 45, 47, 49, 57, 58, 59, 68, 70, 75, 76, 79, 82, 86, 90, 91, 93, 99, 110, 113, 134, 136, 150, 151, 176, 178, 181, 182, 188, 190, 192, 208, 219], "rather": [8, 82, 116], "feed": [8, 10, 11, 15, 21, 27, 47, 51, 52, 57, 58, 77, 101, 105, 135, 144, 153, 160, 161, 189, 192, 209], "soft": [8, 22, 160, 163, 178], "sigmoid": [8, 57, 82, 85, 95, 110], "bernoulli": 8, "interpret": [8, 122, 178], "dynam": [8, 11, 15, 30, 57, 70, 75, 82, 85, 97, 145], "intend": [8, 15, 19, 57, 120, 178, 181, 185], "hard_sigmoid": 8, "test": [8, 14, 47, 51, 58, 77, 79, 80, 82, 84, 85, 106, 112, 113, 118, 127, 128, 145, 147, 154, 156, 163, 166, 173, 181, 187, 192, 201, 202, 204, 211, 223], "decod": [8, 10, 11, 13, 15, 17, 32, 34, 40, 45, 46, 47, 57, 58, 59, 63, 64, 66, 68, 70, 79, 80, 82, 103, 109, 118, 121, 123, 124, 130, 131, 132, 133, 135, 136, 140, 142, 143, 144, 153, 165, 170, 175, 176, 191, 192, 198, 216, 223, 227], "To": [8, 11, 15, 43, 45, 47, 56, 57, 63, 70, 78, 82, 103, 117, 170, 180, 190, 227], "encourg": 8, "nois": [8, 10, 25, 82, 99, 136, 196], "ad": [8, 10, 11, 12, 15, 21, 29, 45, 47, 57, 58, 62, 64, 70, 82, 90, 105, 115, 117, 151, 160, 192, 194, 196], "dure": [8, 12, 13, 15, 17, 31, 34, 47, 57, 58, 63, 70, 79, 82, 85, 86, 95, 113, 124, 134, 140, 144, 153, 161, 175, 178, 194, 198, 227], "pre_sigmoid_nois": 8, "v": [8, 9, 11, 12, 15, 22, 39, 45, 47, 51, 57, 82, 90, 94, 107, 120, 134, 194], "tanh": [8, 15, 29, 45, 85], "w": [8, 9, 11, 15, 19, 21, 31, 45, 47, 57, 82, 85, 86, 93, 151, 178], "encoder_st": 8, "b": [8, 9, 10, 11, 15, 17, 19, 21, 22, 27, 30, 39, 45, 47, 49, 57, 61, 70, 75, 82, 90, 99, 100, 104, 107, 110, 115, 118, 120, 134, 138, 190, 194], "r": [8, 9, 15, 33, 82, 86, 150, 178], "l2": [8, 82, 192], "norm": [8, 15, 21, 27, 45, 57, 58, 60, 75, 82, 107, 181, 185], "These": [8, 10, 11, 45, 47, 49, 63, 85, 86, 90, 101, 120, 177, 178], "modif": [8, 140], "address": [8, 24], "fact": [8, 82], "sensit": [8, 82], "offset": [8, 11, 47, 75, 90, 115, 141, 159, 196], "bit": [8, 85], "harder": 8, "compar": [8, 13, 34, 47, 57, 79, 87, 103, 113, 123, 130, 144, 153, 161, 175, 194, 198, 219], "help": [8, 21, 22, 63, 82, 185], "bia": [8, 9, 10, 15, 21, 22, 29, 45, 47, 57, 70, 90, 194, 196], "hidden_bias_init": 8, "computeprob": 8, "merged_source_pad": 8, "emiss": 8, "again": [8, 95, 194], "gmmmonotonicattent": 8, "gmm": 8, "With": [8, 15, 59, 76, 82, 120, 147, 197], "alex": 8, "grave": 8, "eq": [8, 40, 57, 62, 82, 195], "46": [8, 165, 166], "51": [8, 165, 166], "1308": 8, "0850": 8, "num_mixtur": 8, "4": [8, 9, 15, 17, 19, 24, 30, 45, 47, 51, 57, 58, 61, 62, 64, 70, 82, 90, 92, 96, 99, 118, 124, 134, 139, 147, 163, 165, 166, 170, 185, 188, 190, 195, 218, 227], "varianc": [8, 19, 82], "prior": [8, 11, 13, 174, 181], "mergerlay": [8, 57, 59], "variou": [8, 13, 18, 85, 86, 116, 120, 134], "merger": [8, 91, 192], "merger_op": 8, "mean": [8, 9, 10, 15, 19, 24, 30, 47, 49, 57, 63, 70, 82, 86, 93, 101, 103, 105, 117, 174, 175, 178, 182, 194, 196], "concat": [8, 11, 15, 21, 47, 55, 81, 90], "last": [8, 9, 15, 21, 22, 29, 30, 33, 39, 47, 55, 57, 58, 63, 70, 82, 85, 86, 87, 90, 91, 95, 121, 138, 160, 178, 194, 196, 218], "up": [8, 10, 11, 15, 24, 27, 31, 47, 57, 58, 64, 70, 81, 82, 83, 86, 91, 95, 104, 113, 115, 116, 117, 128, 134, 160, 185, 192, 195, 196, 223], "weighted_sum": [8, 82], "learnt": [8, 57], "gated_avg": 8, "gate": [8, 15, 29, 47, 57, 58, 90, 160], "multi": [8, 13, 15, 44, 45, 47, 51, 57, 58, 59, 75, 76, 79, 99, 110, 124, 139, 175, 178, 194, 197, 227], "column": [8, 15, 33, 45, 70, 192, 196], "_child_variable_scope_overrid": [8, 12, 13, 15, 22, 42, 47, 57, 59, 60, 85, 87, 91, 101, 105, 116, 140, 175, 194, 195], "scope": [8, 12, 13, 15, 22, 42, 47, 51, 57, 59, 60, 63, 81, 82, 83, 85, 87, 91, 101, 105, 116, 120, 140, 175, 194, 195], "individu": [8, 12, 13, 15, 16, 17, 22, 40, 42, 47, 57, 59, 60, 70, 82, 85, 87, 91, 101, 105, 116, 120, 140, 175, 194, 195, 196, 208, 223], "backward": [8, 12, 13, 15, 22, 33, 39, 42, 45, 47, 57, 59, 60, 67, 70, 82, 85, 86, 87, 91, 101, 105, 116, 140, 175, 194, 195], "old": [8, 12, 13, 15, 22, 42, 47, 57, 59, 60, 82, 85, 87, 91, 93, 101, 105, 113, 116, 119, 140, 175, 194, 195], "By": [8, 12, 13, 15, 22, 24, 34, 42, 45, 47, 49, 57, 59, 60, 64, 70, 82, 85, 86, 87, 91, 101, 103, 104, 105, 116, 118, 134, 140, 174, 175, 178, 194, 195], "map": [8, 10, 11, 12, 13, 15, 17, 18, 19, 22, 23, 24, 31, 34, 39, 42, 47, 49, 51, 57, 59, 60, 63, 69, 70, 76, 82, 85, 86, 87, 91, 99, 101, 105, 108, 115, 116, 118, 127, 133, 134, 137, 139, 140, 144, 153, 161, 175, 177, 178, 190, 194, 195, 196, 198, 218, 222], "pre_proj_input_dim": 8, "specifi": [8, 9, 10, 11, 15, 17, 22, 23, 24, 27, 41, 45, 46, 47, 49, 51, 57, 58, 63, 75, 76, 77, 79, 82, 85, 86, 87, 91, 92, 93, 101, 103, 116, 119, 123, 130, 134, 137, 139, 141, 159, 174, 176, 178, 180, 181, 192, 196, 208, 223], "multisourceattent": [8, 15], "sub": [8, 12, 13, 15, 21, 22, 27, 30, 39, 42, 43, 47, 57, 58, 59, 69, 79, 82, 84, 87, 89, 95, 97, 101, 105, 106, 119, 124, 134, 136, 142, 150, 151, 160, 185, 192, 195, 216, 227], "associ": [8, 13, 15, 35, 39, 47, 79, 83, 85, 116, 124, 187, 217, 227], "source_seq_length": [8, 91], "_combinecontext": [8, 15], "context_map": [8, 133], "util": [9, 11, 16, 17, 23, 26, 47, 48, 51, 56, 67, 76, 80, 81, 82, 83, 85, 94, 107, 108, 109, 114, 122, 131, 136, 138, 140, 142, 171, 178, 188], "rel": [9, 15, 33, 45, 57, 70, 75, 82, 136], "embed": [9, 11, 15, 45, 47, 49, 57, 58, 59, 81, 82, 85, 90, 92, 104, 116, 133, 160, 172, 187, 189, 192, 194, 195, 198], "converttoblock": 9, "block_siz": [9, 35, 92], "padding_v": [9, 90], "turn": [9, 10, 11, 25, 82], "overlap": [9, 75, 90], "block": [9, 15, 29, 39, 57, 58, 79, 82, 89, 90, 92, 93, 192], "int": [9, 10, 11, 13, 15, 16, 17, 21, 24, 30, 31, 33, 38, 40, 41, 47, 48, 49, 59, 64, 69, 70, 79, 81, 82, 85, 91, 93, 101, 104, 105, 110, 115, 116, 123, 130, 134, 138, 145, 153, 160, 174, 178, 187, 188, 189, 190, 194, 197, 218], "frame": [9, 15, 57, 70, 82, 99, 134, 139, 216, 222], "num_block": [9, 57, 58, 82], "necessari": [9, 56, 57, 79, 82, 85, 178], "extractblockcontext": 9, "left_context": [9, 15, 57, 92], "right_context": [9, 15, 57, 92, 106], "extract": [9, 56, 60, 64, 69, 82, 90, 139, 174, 190, 196, 218], "tempor": [9, 58], "context_s": 9, "end": [9, 10, 11, 13, 15, 17, 30, 34, 47, 49, 55, 57, 60, 63, 70, 75, 79, 82, 85, 86, 95, 109, 115, 170, 174, 192, 198, 202, 208], "_dopad": 9, "l": [9, 15, 39, 45, 47, 82], "helper": [9, 11, 17, 22, 32, 40, 45, 53, 57, 63, 69, 76, 79, 82, 86, 96, 106, 109, 111, 112, 113, 127, 128, 181, 182, 185, 227], "front": [9, 208], "rear": 9, "axi": [9, 10, 15, 21, 22, 29, 30, 35, 38, 45, 47, 57, 81, 82, 85, 99, 101, 107, 178, 188, 190], "length": [9, 10, 11, 15, 17, 30, 31, 39, 40, 41, 42, 45, 46, 47, 53, 55, 57, 64, 66, 69, 70, 75, 76, 79, 82, 86, 90, 91, 99, 103, 107, 115, 135, 136, 138, 170, 172, 180, 187, 189, 194, 196, 208], "3d": [9, 15, 33, 57, 58, 76, 82, 107, 139], "extractblockcontextv2": 9, "restrict": [9, 69, 187], "free": [9, 90], "constraint": [9, 33, 85], "other": [9, 11, 13, 14, 15, 17, 31, 34, 42, 43, 45, 47, 49, 57, 58, 63, 69, 82, 86, 90, 103, 105, 117, 118, 120, 134, 135, 144, 153, 161, 175, 178, 181, 187, 190, 198, 221], "actual": [9, 11, 24, 57, 63, 70, 82, 85, 87, 99, 136, 177, 187, 194, 196], "info": [9, 10, 35, 82, 86, 127, 134, 140], "x_patch": 9, "x_pad": [9, 55, 198], "let": [9, 13, 15, 45, 47, 70, 118], "here": [9, 11, 13, 15, 30, 31, 33, 56, 58, 79, 80, 85, 90, 95, 134, 140, 141, 144, 159, 160, 178, 187, 194, 196], "u": [9, 15, 85, 93], "ceil": [9, 15, 30, 57, 99], "c": [9, 15, 22, 25, 30, 47, 57, 82, 90, 153, 170, 178, 190, 227], "full": [9, 15, 22, 35, 48, 57, 70, 75, 89, 127, 174, 178, 187, 218, 223, 227], "ret": [9, 24, 82, 86, 196], "2d": [9, 15, 24, 29, 30, 33, 47, 48, 57, 76, 82, 107, 139, 165], "procedur": 9, "begin": [9, 11, 15, 17, 70, 82, 86, 105, 121, 190], "extra": [9, 10, 11, 12, 15, 49, 51, 61, 76, 79, 86, 89, 90, 91, 93, 101, 113, 141, 150, 159, 160, 178, 181, 194, 196], "gather": [9, 45, 47, 57, 81, 82], "todo": [9, 11, 15, 21, 31, 42, 45, 47, 57, 58, 60, 79, 82, 139], "yqw": 9, "verfii": 9, "benchmark": [9, 66, 79, 163, 169], "makelocalmask": 9, "seq_len": [9, 27, 57, 70, 82, 92, 107, 134, 140], "query_strid": [9, 15, 27], "float32": [9, 15, 18, 40, 46, 57, 63, 70, 82, 85, 99, 104, 116, 117, 139, 172, 175, 176, 184, 208], "reflect": [9, 12, 63, 82, 86, 127, 176], "1st": [9, 53, 80, 86], "2nd": [9, 47, 82, 86, 194], "2st": 9, "stride": [9, 15, 27, 29, 30, 57, 85, 97, 106, 139], "pool": [9, 15, 29, 30, 57, 58, 90], "funnel": [9, 15], "j": [9, 10, 11, 15, 22, 24, 33, 37, 62, 70, 82, 94, 99, 107, 115, 161], "access": [9, 12, 21, 25, 31, 43, 47, 69, 75, 82, 86, 116, 126, 185, 217], "relshift": 9, "shift": [9, 45, 47, 57, 70, 82, 91, 99, 110, 196], "4d": [9, 57, 76, 139], "content": [9, 13, 31, 32, 34, 49, 70, 82, 93, 118, 144, 153, 198, 216, 222, 223, 225], "abov": [9, 22, 40, 57, 70, 82, 90, 99, 113, 163, 194], "attenlogit": 9, "h": [9, 11, 15, 17, 19, 31, 39, 47, 57, 70, 150], "attencontext": 9, "encod": [9, 10, 13, 15, 17, 34, 45, 49, 58, 59, 68, 75, 91, 92, 96, 97, 103, 109, 121, 131, 132, 134, 135, 139, 144, 166, 175, 176, 178, 180, 181, 184, 187, 189, 190, 191, 192, 194, 196, 198, 216, 218, 222, 226], "positionalattenlogit": 9, "transform": [9, 12, 15, 31, 39, 40, 42, 43, 45, 47, 48, 55, 57, 58, 59, 66, 69, 82, 85, 90, 91, 92, 95, 101, 131, 160, 163, 166, 171, 174, 176, 177, 192, 194, 195, 197, 198, 201], "xl": [9, 15], "languag": [9, 11, 42, 57, 66, 115, 140, 159, 160, 161, 163, 164, 167], "beyond": [9, 58], "fix": [9, 12, 15, 51, 57, 70, 82, 86, 90, 95, 99, 105, 110, 113, 115, 178], "1901": [9, 15, 29, 30, 58, 59, 97], "02860": [9, 15], "represent": [9, 11, 22, 32, 43, 49, 82, 85, 119, 170, 184], "1803": [9, 15, 19, 57], "02155": [9, 15, 57], "relpositionbia": 9, "abs_pos_emb": 9, "skip_term_b": 9, "subroutin": 9, "variant": [9, 57, 59, 82, 139, 195, 198], "num": [9, 15, 17, 29, 45, 46, 53, 70, 82, 95, 119, 150, 151, 194], "2t": 9, "absolut": [9, 57, 82], "emb": [9, 15, 57, 58, 59, 90, 134, 195, 198], "distanc": [9, 15, 99, 136, 142, 150, 151], "skip": [9, 11, 49, 57, 60, 70, 82, 113, 170], "term_b": 9, "equat": [9, 45, 47, 62, 85, 90], "_validatebias": 9, "content_bia": 9, "positional_bia": 9, "_attenlogit": [9, 15], "transformerxl": 9, "rpe": [9, 15], "sinusoid": [9, 57, 195], "1706": [9, 15, 58, 59, 97, 194, 195, 197, 198], "03762": [9, 15, 58, 59, 97, 194, 195, 197, 198], "attenlogitsxl": 9, "attenlogitsrp": 9, "trainabl": [9, 15, 47, 57, 82, 90, 185], "embd": 9, "attenlogitsxlonestep": 9, "attenlogitsrpeonestep": 9, "kmeansclusteringforatten": 9, "k": [9, 10, 15, 33, 37, 39, 42, 45, 47, 57, 58, 69, 70, 82, 107, 121, 153], "mini": [9, 194], "2003": [9, 15, 92], "05997": [9, 15, 92], "capit": [9, 15], "letter": [9, 15, 49, 115], "denot": [9, 12, 15, 33, 57, 82, 99], "refer": [9, 11, 17, 22, 29, 31, 33, 37, 42, 46, 49, 55, 57, 64, 79, 85, 86, 90, 91, 99, 135, 136, 138, 139, 142, 143, 150, 151, 190, 194, 195, 198], "elsewher": [9, 180, 181], "layernorm": [9, 57, 90], "epsilon": [9, 19, 33, 35, 62, 70, 110, 136, 165, 192], "1e": [9, 35, 39, 62, 75, 82, 165, 194], "06": [9, 35, 39, 47, 62], "normal": [9, 10, 15, 19, 27, 30, 39, 40, 45, 47, 57, 58, 59, 70, 82, 90, 110, 138, 178, 185, 192, 194, 197, 198], "scale": [9, 15, 33, 35, 39, 45, 57, 60, 75, 82, 85, 90, 95, 99, 139], "tini": [9, 11, 163], "guard": 9, "against": [9, 64, 85, 113, 196], "rsqrt": [9, 95], "centroid": [9, 15], "dist": [9, 85], "bool": [9, 11, 12, 15, 16, 33, 38, 45, 47, 48, 49, 51, 69, 70, 77, 79, 81, 82, 85, 90, 115, 122, 138, 143, 160, 177, 182, 188, 194], "k_means_loss": 9, "squar": [9, 62, 69, 82], "euclidean": [9, 15], "closest": [9, 15], "computesparseattent": 9, "q": [9, 15, 22, 39, 178], "sparsity_indic": 9, "sparsiti": [9, 194], "window": [9, 15, 30, 36, 57, 92, 95, 139, 187], "batch_idx": 9, "head_idx": 9, "7": [9, 47, 57, 118, 163, 165, 166, 218], "8": [9, 40, 45, 57, 62, 70, 76, 82, 85, 118, 143, 147, 160, 163, 165, 166, 170, 204], "valid": [9, 11, 12, 17, 19, 23, 30, 49, 55, 57, 66, 69, 70, 76, 77, 82, 112, 115, 116, 122, 194, 223], "reserv": [9, 70, 86], "distinct": [9, 13, 34, 85, 178, 182], "degener": 9, "sort": [9, 10, 23, 49, 82], "flexibl": 9, "complex": [9, 15, 85], "pleas": [9, 15, 17, 21, 57, 58, 70, 90, 109, 150], "subset": [9, 13, 15, 45, 55, 60, 85, 113, 118, 185], "atten_prob": [9, 15, 17, 27, 58, 70, 91, 103, 134, 194, 198], "common": [10, 11, 15, 17, 30, 47, 49, 57, 79, 82, 83, 87, 101, 106, 107, 136, 139, 142, 160, 172, 173, 177, 178, 180, 192, 208, 219, 228], "interfac": [10, 12, 15, 22, 23, 27, 30, 42, 43, 47, 57, 58, 59, 78, 84, 86, 89, 91, 97, 103, 113, 116, 120, 139, 185, 195], "decoderoutput": 10, "predict": [10, 13, 34, 45, 57, 58, 59, 63, 64, 70, 77, 118, 134, 144, 153, 161, 175, 194, 198], "per_sequ": [10, 134], "_asdict": [10, 17, 24, 51, 76, 82, 86, 101, 134, 137, 139], "field": [10, 11, 15, 17, 24, 45, 49, 50, 51, 52, 57, 59, 61, 63, 70, 71, 72, 73, 76, 77, 82, 83, 86, 90, 101, 105, 134, 137, 139, 160, 190, 194, 195, 196, 205, 223], "_field_default": [10, 17, 24, 51, 76, 82, 86, 101, 134, 137, 139], "_field": [10, 17, 24, 51, 76, 82, 86, 101, 134, 137, 139], "_make": [10, 17, 24, 51, 76, 82, 86, 101, 134, 137, 139], "_replac": [10, 17, 24, 51, 76, 82, 86, 101, 134, 137, 139], "kwd": [10, 17, 24, 51, 76, 82, 86, 101, 134, 137, 139], "alia": [10, 17, 24, 51, 57, 76, 82, 85, 86, 101, 134, 135, 137, 139, 143], "basedecod": 10, "updatetargetvocabs": [10, 13, 134, 160, 161, 194], "vocab_s": [10, 13, 17, 40, 45, 70, 81, 109, 134, 140, 160, 161, 163, 165, 166, 192, 194, 201, 202, 204], "wpm_model": [10, 13, 134, 160, 161, 194], "vocab": [10, 11, 13, 17, 55, 57, 70, 115, 134, 147, 160, 161, 163, 194, 204, 211, 218], "wpm": [10, 13, 96, 115, 121, 134, 147, 160, 161, 194, 201, 202], "vocabulari": [10, 13, 70, 81, 115, 134, 160, 161, 192, 194], "prefix": [10, 12, 13, 23, 31, 39, 40, 46, 47, 48, 57, 58, 64, 69, 82, 93, 121, 134, 160, 161, 194, 196], "wordpiec": [10, 13, 121, 134, 160, 161, 167, 194], "encoder_output": [10, 17, 109, 134, 194, 198], "being": [10, 11, 15, 21, 47, 57, 63, 70, 82, 85, 107, 117, 177, 178, 196], "namedtupl": [10, 13, 34, 49, 69, 82, 117, 134, 135, 139, 143, 144, 153, 161, 175, 198], "computepredict": [10, 13, 34, 45, 118, 134, 144, 153, 161, 175, 194, 198], "computeloss": [10, 13, 34, 43, 45, 47, 60, 82, 118, 134, 144, 153, 161, 175, 194, 198], "_keeptopp": 10, "sorted_log_prob": 10, "keep": [10, 17, 57, 70, 79, 80, 82, 104, 113, 142, 190, 192, 194], "top": [10, 17, 24, 47, 58, 59, 70, 82, 85, 101, 105, 107, 153, 180], "mass": [10, 70, 193, 196], "includ": [10, 11, 13, 15, 30, 34, 42, 43, 47, 51, 57, 70, 75, 79, 82, 85, 87, 90, 105, 109, 120, 121, 133, 138, 144, 151, 153, 160, 161, 170, 172, 175, 181, 190, 198, 208], "large_negative_numb": 10, "kept": [10, 15], "descend": [10, 12, 69, 70], "order": [10, 11, 12, 15, 27, 30, 35, 47, 48, 64, 70, 75, 77, 78, 82, 86, 91, 96, 98, 161, 170, 188, 196], "threshold": [10, 13, 40, 47, 81], "item": [10, 11, 22, 50, 69, 82, 91, 101, 105, 119, 140, 175, 178], "like": [10, 11, 12, 15, 17, 22, 49, 75, 82, 85, 90, 104, 113, 118, 172, 178, 181, 187, 190, 194, 196, 217, 218, 223], "outsid": [10, 47, 63, 90, 91, 117, 185], "_batchscatt": 10, "default_tensor": 10, "tensor_scatter_nd_upd": 10, "_batchlookup": 10, "table_kei": 10, "table_valu": 10, "look": [10, 57, 58, 70, 83, 104, 115, 116, 118, 160, 195, 196, 217, 223], "tabl": [10, 57, 81, 104, 116, 225], "hold": [10, 49, 82, 117, 178, 187], "whose": [10, 11, 21, 47, 60, 62, 70, 82, 86, 99, 219, 223], "_batchsamplegumbel": 10, "batch_se": 10, "time_step": [10, 15, 57, 194], "src_id": [10, 70, 118], "src_pad": [10, 91, 99, 107, 141], "gumbel": 10, "determin": [10, 11, 15, 23, 34, 63, 70, 75, 79, 82, 86, 101, 103, 115, 117, 134, 178, 196], "secondari": 10, "src_seq": 10, "_samplegumbelwithmax": 10, "phi": 10, "target_max": 10, "maximum": [10, 12, 15, 17, 33, 45, 62, 64, 70, 76, 82, 85, 99, 103, 107, 115, 118], "equal": [10, 15, 17, 47, 55, 57, 61, 70, 82, 91, 178], "stabl": [10, 49, 62], "appendix": [10, 90], "1903": 10, "06059": 10, "tgt_batch": [10, 17, 47, 194], "thtat": 10, "max": [10, 12, 17, 33, 40, 46, 57, 70, 82, 85, 86, 95, 99, 138, 160, 163, 170, 196], "src_batch": [10, 17, 194], "within": [10, 11, 15, 23, 24, 31, 33, 47, 49, 57, 63, 70, 82, 85, 86, 93, 99, 108, 178, 208], "second": [10, 15, 35, 45, 47, 49, 58, 59, 61, 70, 75, 77, 82, 91, 109, 115, 150, 151, 196, 219], "almost": [10, 82, 96], "basebeamsearchdecod": [10, 134, 194], "beam": [10, 15, 17, 40, 47, 64, 70, 79, 134, 140, 194, 217, 221], "addextradecodinginfo": [10, 194], "encoded_output": [10, 194], "encoder_ouput": [10, 194], "beamsearchdecod": [10, 17, 194], "num_hyps_per_beam_overrid": [10, 17], "ignor": [10, 11, 15, 17, 49, 55, 56, 57, 70, 79, 82, 115, 137, 150, 178, 202], "beamsearchdecodeoutput": [10, 17, 135, 194], "beamsearchdecodewiththeta": 10, "greedysearchdecod": [10, 17], "greedi": [10, 17], "greedysearchdecodewiththeta": 10, "_postprocesssampl": 10, "is_tpu": 10, "topk_hyp": [10, 17, 70, 77, 135], "topk_id": [10, 17, 40], "topk_len": [10, 17, 40], "topk_scor": [10, 17, 40, 170], "empti": [10, 11, 17, 22, 51, 70, 82, 86, 90, 101, 105, 133, 134, 136, 141, 150, 159, 170, 194, 196, 223], "sampletargetsequ": 10, "random_se": [10, 51, 82, 109], "int32": [10, 40, 41, 46, 47, 57, 58, 59, 70, 82, 104, 109, 133, 134, 160, 167, 170, 175, 194, 208], "max_target_length": [10, 109, 134], "target_sos_id": [10, 17, 109], "mayb": [10, 11, 12, 82, 109, 177], "target_eos_id": [10, 109], "beamsearchdecodebias": 10, "while": [10, 15, 19, 30, 33, 47, 57, 77, 82, 85, 91, 101, 117, 134, 178, 196, 218], "bias": [10, 57], "toward": [10, 82, 85], "stochasticbeamsearchdecodebias": 10, "stochast": [10, 58], "advanc": [10, 15], "auxiliari": [10, 15, 47, 58, 59, 116], "label": [10, 11, 38, 45, 47, 57, 59, 63, 64, 70, 76, 82, 103, 113, 115, 131, 134, 144, 153, 160, 161, 171, 174, 182, 192, 194, 198, 208], "seq": [10, 15, 140, 196], "forc": [10, 11, 21, 55, 57], "filter": [10, 11, 30, 57, 69, 70, 82, 85, 136, 196, 223], "ensur": [10, 11, 12, 31, 45, 63, 75, 77, 82, 85, 89, 178, 185, 194], "qualiti": [10, 96, 194, 196], "slight": [10, 196], "coverag": [10, 70], "penalti": [10, 64, 70], "perturb": [10, 113], "stochastic_beam_search": 10, "top_p_threshold": 10, "satisfi": [10, 70, 178], "high": [10, 47, 58, 70, 75, 82, 93, 124, 182], "divers": 10, "drawn": [10, 82], "_wrapinitbeamsearchstatecallback": 10, "callback": [10, 17, 40, 79, 86, 109], "wrap": [10, 13, 15, 45, 47, 54, 57, 63, 79, 82, 86, 101, 103, 113, 177, 178, 185, 190], "_initbeamsearchstatecallback": [10, 109, 134, 194], "attach": [10, 48, 91, 178, 185], "consist": [10, 13, 22, 27, 31, 47, 57, 60, 70, 75, 82, 85, 87, 134, 139, 144, 153, 195, 196], "track": [10, 12, 17, 57, 63, 70, 82, 85, 93, 107, 120, 142, 187, 194], "hypothesi": [10, 64, 70, 71, 134, 150, 151], "so": [10, 11, 13, 15, 30, 42, 45, 47, 48, 49, 57, 63, 70, 79, 81, 82, 85, 86, 90, 93, 96, 99, 103, 109, 115, 118, 159, 170, 176, 178, 181, 182, 185, 190, 194, 208], "cumulative_log_prob": 10, "unperturb": 10, "perturbed_cumulative_log_prob": 10, "counterpart": 10, "footnot": 10, "desir": [10, 42], "sinc": [10, 13, 45, 57, 64, 79, 82, 93, 116, 118, 139, 181], "divid": [10, 47, 58, 82], "tmp_state": 10, "prebeamsearchstepcallback": [10, 17], "postbeamsearchstepcallback": [10, 17], "_wrapprebeamsearchstepcallback": 10, "_prebeamsearchstepcallback": [10, 109, 134, 194], "log_prob": [10, 17, 160, 194], "maintain": [10, 17, 56, 69, 70, 80, 82], "_wrappostbeamsearchstepcallback": 10, "_postbeamsearchstatecallback": 10, "_postbeamsearchstepcallback": [10, 109, 134, 194], "inferenceadditionalencod": 10, "graph": [10, 11, 12, 13, 21, 22, 23, 27, 34, 35, 42, 45, 46, 47, 48, 51, 70, 75, 77, 79, 82, 86, 87, 90, 93, 101, 103, 105, 113, 116, 118, 124, 130, 144, 153, 175, 185, 196, 198, 209, 227], "There": [11, 15, 31, 47, 69, 90, 101, 178], "three": [11, 17, 57, 58, 87, 101, 105, 150, 151, 216], "devic": [11, 13, 15, 21, 22, 24, 25, 27, 41, 42, 45, 46, 47, 48, 51, 57, 63, 77, 79, 82, 85, 86, 90, 93, 98, 100, 153, 161, 198], "baseinputgener": [11, 118, 159, 165, 177, 208], "basesequenceinputgener": [11, 14, 141, 145, 159, 196], "bucket_batch_limit": [11, 41, 147], "globalbatchs": [11, 145], "infeedbatchs": 11, "global_batch_s": [11, 16, 79, 116], "num_infeed_host": [11, 24], "num_tpu_host": [11, 24, 25], "host": [11, 16, 31, 41, 45, 82, 86, 117, 178, 196], "infe": [11, 16, 41, 46, 79, 118, 141, 145, 159, 165, 178, 188, 196], "otherwis": [11, 12, 13, 15, 22, 23, 45, 47, 51, 57, 58, 59, 69, 75, 80, 82, 85, 86, 90, 91, 93, 95, 99, 138, 160, 174, 190, 195, 196, 197], "rpang": [11, 60], "packed_input": [11, 15, 165, 197, 204], "_perhostinfeedtpuordinalfunct": 11, "use_per_core_infe": 11, "task_id": [11, 15, 24, 58, 59, 195, 196], "shard_index_in_host": 11, "ordin": 11, "shard": [11, 15, 27, 35, 45, 47, 48, 57, 58, 75, 79, 82, 85, 90, 116, 118, 120, 145, 165, 192], "_reordertensortolog": 11, "tensor_list": [11, 76, 82], "reorder": [11, 70], "_rorderpartitionedtensortolog": 11, "tpu_number_of_shard": 11, "partit": [11, 35, 42, 48, 85, 160], "input_batch": [11, 13, 34, 41, 45, 57, 101, 113, 116, 118, 134, 135, 139, 144, 153, 161, 175, 177, 195, 198], "abstract": [11, 12, 13, 22, 30, 44, 47, 78, 101, 160, 174], "defineinfeedparam": 11, "createdatasourc": [11, 208], "commoninputoparg": 11, "getbpropvariablefilt": 11, "getinputsourceonehot": 11, "bprop": [11, 13, 34, 82, 116, 145], "getbatchs": 11, "calcul": [11, 15, 16, 38, 45, 57, 85, 135, 143, 144, 178, 182, 194], "implicit": [11, 56, 82, 86], "side": [11, 22, 85, 86, 91, 104, 135, 178, 185, 187], "captur": [11, 55, 82, 86, 178, 194, 198], "229158150": 11, "Or": [11, 13, 19, 34, 76, 107, 118, 150, 153, 175], "spilt": [11, 13, 34, 118, 153, 175], "preprocess": [11, 118, 145, 150, 151, 165, 176, 177, 178, 181, 187, 189], "total": [11, 15, 17, 24, 45, 55, 60, 63, 82, 89, 99, 107, 134, 136, 145, 150, 151, 161, 188, 196], "_inputbatch": [11, 118, 145, 159, 165, 177], "meant": [11, 57, 90, 93, 118, 145, 165], "getpreprocessedinputbatch": [11, 118, 145, 165, 177], "_preprocessinputbatch": [11, 177], "format": [11, 15, 24, 41, 45, 47, 49, 65, 70, 76, 80, 82, 101, 107, 115, 134, 139, 150, 151, 165, 172, 174, 178, 182, 185, 187, 188, 190, 194, 196, 217, 221, 225], "fed": [11, 57, 90, 91, 101, 105, 144, 153, 177, 190], "createtpuenqueueop": 11, "benchmark_onli": 11, "outer": [11, 108], "wire": 11, "tpudequeuebatch": 11, "dequeu": [11, 13, 79], "createtpuembeddingenqueueop": 11, "tpuembed": [11, 116], "instanti": [11, 12, 25, 47, 49, 54, 56, 79, 117, 124, 159, 177, 182, 185, 190, 195, 227], "monolith": [11, 116], "tpuembeddinglay": [11, 116], "_gettpuembeddingenqueuedata": 11, "tpu_embed": [11, 116], "num_split": [11, 53, 82], "feature_nam": [11, 116], "tpu_embedding_lib": 11, "enqueuedata": 11, "infeedsetupgraph": 11, "cpu_passthrough": 11, "pipelin": [11, 15, 31, 41, 42, 45, 47, 82, 135, 141, 159, 174, 196, 217], "deviceloopsetupeag": 11, "level": [11, 12, 47, 57, 63, 69, 82, 85, 115, 124, 163, 174, 182, 187, 227], "preprocesstpuembeddinginputbatch": 11, "hook": [11, 113, 128], "manipul": [11, 12, 13, 82, 196], "getcpupassthroughkei": 11, "send": [11, 13, 45, 47, 79, 86, 98, 118], "still": [11, 21, 63], "passthrough": [11, 79], "inputbatch": 11, "sent": [11, 49, 101], "postprocessdecodeout": [11, 13, 34, 118, 144, 153, 175, 198], "createcpupassthroughenqueueop": 11, "cpu": [11, 25, 35, 41, 57, 78, 79, 82, 116, 223, 227], "dequeuecpupassthrough": 11, "tpu_infeed_op": 11, "merged_input_data_summary_op": 11, "input_data_summary_layout": 11, "splitinputbatch": 11, "input_gener": [11, 13, 31, 131, 132, 152, 158, 171, 191, 207], "reproduc": [11, 82, 159], "fresh": [11, 159], "tensorflow": [11, 12, 13, 19, 24, 30, 42, 50, 52, 71, 72, 73, 79, 81, 82, 85, 86, 113, 139, 150, 151, 159, 176, 185, 196, 205, 223], "_map_arg": [11, 31], "maybeoffsetdatasourceid": 11, "source_id": [11, 41, 59, 141, 159, 196], "configur": [11, 12, 24, 27, 31, 47, 49, 57, 63, 67, 75, 82, 83, 85, 118, 134, 174, 175, 177, 178, 181, 189, 223, 227], "partitionfilepatternsintodatasourc": 11, "batch_mixing_partition_boundari": 11, "document": [11, 77, 85, 101, 103, 105], "simpledatasourc": [11, 31], "filepatterntodatasourc": 11, "deprec": [11, 15, 59, 79, 82, 90], "file_datasourc": 11, "baseinputgeneratorfromfil": 11, "read": [11, 12, 27, 31, 45, 49, 82, 93, 95, 103, 120, 144, 153, 159, 170, 174, 178, 182, 187, 196, 208, 217, 218, 221, 222], "_datasourcefromfilepattern": [11, 141, 159, 196], "_inputopbucketingarg": 11, "input_source_weight": [11, 141, 159, 196], "input_source_id_offset": [11, 141, 159, 196], "extra_input_kwarg": [11, 141, 159, 196], "control": [11, 43, 47, 49, 57, 75, 76, 82, 85, 86, 116, 130, 134, 141, 159, 178, 187, 196, 227], "mix": [11, 15, 31, 81, 82, 141, 159, 196], "record": [11, 12, 20, 32, 36, 41, 70, 72, 82, 85, 95, 141, 159, 174, 196, 217, 221, 225], "proportion": [11, 31, 141, 159, 196], "custom": [11, 13, 15, 23, 31, 57, 82, 85, 86, 89, 90, 134, 141, 159, 196], "genericinputv2": [11, 41, 141, 159, 196], "generic_input_v2_kei": [11, 41, 141, 159, 196], "_builddatasourcewithmetadata": 11, "bprop_variable_filt": [11, 13, 31, 82], "togeth": [11, 21, 31, 70, 82, 90, 174], "source_select": [11, 144], "selected_bprop": 11, "_builddatasourc": 11, "basic": [11, 12, 57, 90, 194], "infeed_bucket_batch_limit": 11, "bucket": [11, 15, 31, 41, 45, 141, 147, 159, 196, 208], "use_per_host_infe": [11, 16, 31], "stringstoid": [11, 115], "str": [11, 12, 13, 31, 34, 44, 45, 49, 60, 69, 79, 80, 82, 85, 96, 110, 115, 116, 118, 122, 135, 142, 143, 144, 150, 153, 160, 161, 167, 170, 174, 175, 178, 181, 187, 189, 190, 198, 225], "is_sourc": 11, "external_max_length": 11, "external_append_eo": [11, 115], "source_max_length": [11, 17, 196, 208], "max_length": [11, 82, 99, 115, 167, 189, 190], "append_eo": [11, 70, 115, 167], "eo": [11, 17, 55, 70, 82, 115, 135, 138, 170, 194, 198, 208], "maxlen": [11, 70, 82, 115], "iff": [11, 30, 36, 70, 82, 93, 115], "That": [11, 70, 82], "ground": [11, 57], "truth": [11, 57], "teacher": [11, 13, 34, 144, 153, 161, 175, 198], "respect": [11, 47, 57, 70, 81, 82, 86, 89, 93, 110, 175, 178, 194, 196, 219], "stringstoidswithoffset": [11, 115], "byte": [11, 13, 24, 32, 34, 96, 115, 118, 143, 144, 153, 198, 216], "start_offset": [11, 115], "end_offset": [11, 115], "idstostr": [11, 66, 115, 167], "len": [11, 15, 53, 66, 70, 82, 113, 115, 135, 167, 196], "convert": [11, 15, 31, 41, 48, 51, 57, 63, 66, 69, 70, 76, 80, 82, 96, 104, 115, 119, 120, 121, 135, 187, 219, 224], "matrix": [11, 15, 35, 39, 57, 58, 62, 66, 70, 75, 76, 82, 90, 91, 99, 107, 115, 150, 151, 161, 178, 194], "seqlen": [11, 15, 27, 61, 66, 82, 107, 115], "idstotoken": [11, 115], "cast": [11, 57, 59, 63, 82, 85, 97, 116], "fprop_dtyp": [11, 15, 27, 40, 45, 47, 58, 82], "basetinydatasetinput": [11, 154], "store": [11, 14, 15, 22, 49, 56, 57, 70, 75, 82, 86, 89, 104, 110, 113, 134, 172, 174, 178, 182, 187], "height": [11, 19, 27, 29, 30, 57, 76, 99, 176], "raw": [11, 12, 47, 91, 154, 181, 216], "real": [11, 47, 82, 113, 135, 140, 198], "_preprocess": [11, 154, 226], "tfdatasequenceinputgener": 11, "inherit": [11, 82, 85, 178], "drop": [11, 12, 31, 41, 57, 58, 70, 82, 90, 94, 156, 178, 182, 196], "exist": [11, 12, 13, 15, 22, 23, 35, 47, 49, 69, 70, 79, 82, 85, 116, 139, 161, 190], "unus": [11, 12, 22, 23, 57, 70, 101, 103, 104, 105, 110, 144, 160], "convertfilepatterntodatasourc": 11, "loaddataset": 11, "load": [11, 18, 23, 24, 31, 45, 47, 48, 51, 77, 79, 80, 82, 116, 165, 174, 181, 185], "lead": [11, 12, 15, 31, 47, 48, 82, 120, 172, 190, 208], "takeevalsampl": 11, "processdataset": 11, "getsequencelength": 11, "integ": [11, 25, 45, 47, 49, 53, 55, 62, 70, 75, 79, 82, 85, 86, 99, 104, 107, 115, 121, 150, 160, 170, 178, 192, 208], "_inputshap": [11, 208], "_inputpaddingvalu": [11, 208], "tensorspec": [11, 82, 113, 174, 208], "basedataexampleinputgener": 11, "proto": [11, 48, 49, 51, 63, 70, 76, 77, 82, 117, 174, 187, 196, 227], "getfeaturespec": 11, "spec": [11, 22, 24, 48, 101, 113, 187, 190], "io": [11, 41, 82, 172, 196, 223], "parse_exampl": [11, 172], "_additionalpreprocessinputbatch": 11, "addition": [11, 47, 77, 93], "get_next": 11, "_initdataset": 11, "definetfdatainput": 11, "func": [11, 12, 56, 79, 82], "ignore_arg": 11, "map_arg": 11, "base_class": 11, "inputgener": [11, 13, 31, 78, 134, 145], "bind": [11, 56, 119], "boilerpl": [11, 76], "behav": 11, "shot": 11, "design": [11, 113], "similarli": [11, 82, 85], "automat": [11, 47, 49, 79, 82, 85, 101, 113, 208, 217, 223], "analys": [11, 56], "signatur": [11, 13, 22, 29, 40, 56, 76, 82, 86, 101, 178, 185, 187, 189, 190], "confus": 11, "identifi": [11, 24, 41, 45, 69, 82, 116, 178, 182, 192, 223], "def": [11, 12, 17, 25, 41, 82, 86, 87, 101, 144, 181, 187, 190], "my_dataset": 11, "10": [11, 12, 37, 47, 62, 69, 76, 86, 118, 150, 165, 166], "from_tensor_slic": 11, "lambda": [11, 21, 22, 41, 45, 57, 82, 101, 113, 190, 194, 195, 196], "myinput": 11, "assert": [11, 12, 69, 70, 82, 86, 160], "ig": 11, "isinst": [11, 69], "tfv1": 11, "tfv2": 11, "yield": [11, 31, 78, 82, 96, 99], "explicit": [11, 30, 41, 56, 82, 86], "would": [11, 17, 27, 45, 48, 49, 57, 68, 82, 85, 86, 90, 93, 99, 103, 118, 139, 178, 194], "collect": [11, 12, 22, 45, 47, 49, 51, 56, 57, 79, 81, 82, 91, 93, 116, 185, 190, 220], "specif": [11, 12, 14, 15, 18, 19, 22, 23, 24, 25, 31, 43, 45, 57, 79, 82, 85, 93, 107, 113, 134, 138, 140, 178, 181, 188], "typic": [11, 12, 14, 15, 21, 45, 47, 55, 56, 57, 70, 76, 85, 95, 127, 133, 139, 174, 178, 181, 185, 192, 196, 217, 218], "super": [11, 12, 139, 144, 181], "func_param": 11, "layer_param": [11, 67, 190], "pair": [11, 12, 13, 19, 22, 29, 30, 34, 41, 44, 45, 49, 56, 57, 60, 63, 69, 70, 75, 78, 82, 86, 96, 99, 118, 119, 134, 139, 144, 150, 151, 153, 161, 174, 175, 178, 182, 184, 194, 195, 196, 198, 216, 219], "won": [11, 196], "definit": [11, 14, 22, 62, 82, 172, 173, 174, 181, 183, 195, 223], "invok": [11, 12, 35, 70, 82, 85, 86, 87, 128, 187], "accumul": [12, 19, 22, 26, 47, 63, 64, 75, 82, 85, 86, 89, 91, 96, 101, 134, 181, 220], "regist": [12, 26, 31, 118, 124, 127, 128, 219], "persist": [12, 93, 134], "suppli": [12, 57, 101], "defaultvalu": [12, 19, 85], "import": [12, 43, 47, 57, 99, 103, 116, 122, 126, 151], "leak": [12, 15, 43], "enabl": [12, 15, 42, 45, 47, 51, 57, 70, 75, 82, 90, 177, 192, 194, 196], "disabl": [12, 15, 40, 45, 51, 57, 82, 85, 86, 174], "silent": 12, "setvalu": 12, "touch": 12, "bracket": [12, 69], "care": [12, 47, 134], "taken": [12, 39, 70, 85, 113, 134, 174, 176], "across": [12, 15, 24, 35, 41, 45, 47, 61, 63, 68, 70, 75, 79, 82, 87, 90, 96, 113, 134, 188, 194], "boundari": [12, 15, 31, 57, 82, 91, 95, 99, 194], "retriev": [12, 22, 82, 85, 103, 116, 123, 127, 130, 178, 190, 227], "getaccumulatorvalu": 12, "marshal": 12, "setaccumulatorvalu": 12, "revers": [12, 82, 86, 89, 91], "is_dis": 12, "balanc": [12, 47], "getvalu": 12, "_baselayerinitwrapp": 12, "decor": [12, 70, 82, 85, 86, 88, 113, 127, 190], "instanc": [12, 13, 22, 25, 31, 33, 43, 47, 49, 51, 57, 69, 78, 79, 86, 122, 127, 135, 139, 174, 178, 187, 192], "hierarchi": [12, 85], "recursivefindlayerparam": 12, "baselayermeta": 12, "dct": 12, "metaclass": 12, "abclayermeta": 12, "abcmeta": 12, "proper": 12, "constitu": 12, "reachabl": 12, "member": [12, 17, 22, 36, 69, 85, 134, 151], "carri": [12, 46, 47, 57, 63, 86, 93], "_inference_driver_nam": 12, "instantiableparam": [12, 14, 49], "baselayert": 12, "static": [12, 13, 24, 36, 47, 63, 69, 70, 82, 85, 91, 93, 95, 108, 121, 127, 139, 190, 196], "copybaseparam": 12, "from_param": 12, "to_param": 12, "getvariablesdict": 12, "visit": [12, 49], "_getselfvariablesdict": [12, 13, 75, 116], "exclud": [12, 13, 75], "fpropdefaulttheta": [12, 13, 58], "forward": [12, 13, 15, 21, 22, 27, 30, 39, 42, 43, 45, 47, 57, 58, 59, 61, 67, 70, 82, 84, 85, 86, 89, 90, 91, 97, 101, 144, 153, 160, 161, 178, 185, 189, 192, 195], "central": [12, 15, 22, 27, 30, 42, 43, 47, 57, 58, 59, 84, 89, 97, 116, 176, 185, 195], "dictionari": [12, 13, 15, 18, 22, 27, 30, 34, 42, 43, 47, 51, 53, 57, 58, 59, 63, 69, 75, 77, 82, 84, 89, 97, 118, 134, 143, 144, 151, 153, 161, 185, 194, 195, 198, 218, 219, 223], "foo": [12, 15, 21, 22, 25, 27, 30, 42, 43, 47, 49, 57, 58, 59, 69, 82, 84, 89, 97, 177, 185, 190, 195, 223], "instanceofasubclassoffoo": [12, 15, 22, 27, 30, 42, 43, 47, 57, 58, 59, 84, 89, 97, 185, 195], "y": [12, 15, 21, 22, 25, 27, 30, 42, 43, 45, 47, 55, 57, 58, 59, 69, 70, 76, 82, 84, 86, 89, 95, 97, 113, 184, 185, 190, 195], "a0": [12, 15, 22, 27, 30, 42, 43, 47, 57, 58, 59, 84, 89, 97, 185, 195], "a1": [12, 15, 22, 27, 30, 42, 43, 47, 57, 58, 59, 84, 89, 97, 185, 195], "twice": [12, 15, 22, 27, 30, 42, 43, 47, 57, 58, 59, 84, 89, 97, 185, 195], "a2": [12, 15, 22, 27, 30, 42, 43, 47, 57, 58, 59, 84, 89, 97, 185, 195], "keyward": [12, 15, 22, 27, 30, 42, 43, 47, 57, 58, 59, 82, 84, 89, 97, 185, 195], "upon": [12, 21, 79, 82, 99], "built": [12, 21, 63, 78, 82, 217, 223], "do_ev": [12, 24, 25, 177, 194, 197], "parent": [12, 116, 178], "root": [12, 26, 31, 36, 47, 62, 82, 190, 217], "layer_typ": [12, 137], "getdescend": 12, "keyerror": [12, 69, 77], "found": [12, 22, 33, 47, 49, 70, 82, 90, 123, 130, 223], "indexerror": [12, 69], "request": [12, 79, 85, 145, 223], "typeerror": [12, 69, 82, 122], "attempt": [12, 22, 31, 57, 82, 126], "though": [12, 21, 70, 86, 217], "ema": [12, 13, 23, 79, 82], "_transformvarsintern": 12, "_private_var": 12, "_undotransformvarsintern": 12, "undo": 12, "transformvarstempcontext": 12, "enter": [12, 49, 70], "temporarili": 12, "_internalgettheta": 12, "view": [12, 24, 79, 82, 85, 103, 161, 178], "local": [12, 15, 37, 47, 70, 78, 82, 92, 108, 114, 163, 178, 188, 196, 223, 227], "attribut": [12, 31, 45, 48, 49, 82, 190], "notat": [12, 22], "librari": [12, 21, 81, 85, 86, 109, 150, 151, 216, 219], "addfunct": 12, "Such": [12, 45, 82, 85], "python": [12, 13, 14, 15, 21, 24, 31, 41, 46, 47, 49, 51, 53, 81, 82, 85, 86, 98, 113, 115, 122, 126, 150, 151, 160, 190, 194], "facil": 12, "organ": [12, 47, 127], "collis": 12, "bodi": [12, 21, 22, 45, 46, 47, 63, 82, 87, 117], "attributeerror": [12, 49], "alreadi": [12, 13, 15, 22, 31, 47, 49, 60, 61, 69, 194, 221], "_checknam": 12, "registeraccumul": 12, "acc": 12, "futur": [12, 15, 58, 79, 86, 127, 196], "act": [12, 21, 27, 57, 61, 85, 90, 101, 105], "part": [12, 13, 22, 24, 34, 51, 69, 70, 85, 90, 91, 101, 103, 107, 134, 139, 208, 227], "posttrainingstepupd": [12, 19, 85, 90], "arbitrarili": [12, 190], "cross": [12, 15, 47, 57, 59, 75, 82, 87, 178, 188, 194, 197], "uniformli": [12, 39, 57, 70, 139], "myaccumul": 12, "min": [12, 85, 95, 99, 110, 138], "convert_to_tensor": 12, "state1": [12, 15, 27, 30, 47, 57, 61, 86, 90, 91, 101, 103, 105, 140, 160], "state0": [12, 15, 19, 27, 30, 47, 57, 61, 86, 90, 91, 101, 103, 104, 105, 137, 140, 160, 195], "stack": [12, 15, 21, 45, 47, 57, 58, 59, 79, 82, 83, 86, 87, 89, 91, 92, 97, 99, 101, 103, 105, 107, 108, 113, 120, 134, 160, 189, 195, 197, 216], "minimum": [12, 70, 75, 85, 192], "mytrack": 12, "batch_min": 12, "batch_max": 12, "acc_valu": 12, "someth": [12, 13, 34, 45, 118, 144, 153, 161, 175, 198, 223], "share": [12, 17, 21, 22, 23, 43, 45, 47, 49, 51, 57, 58, 63, 68, 75, 82, 87, 91, 124, 227], "new_values_nmap": 12, "getvariablesymbolicshap": 12, "var_nam": [12, 82, 116], "createvari": [12, 82, 128], "var_param": [12, 82, 116], "constructor": [12, 22, 49, 76, 174, 178, 181, 217], "weightparam": [12, 45, 82], "100": [12, 37, 62, 70, 82, 151, 165, 166], "keyword": [12, 41, 42, 49, 76, 82, 85, 91, 107, 160, 187], "enter_name_scop": 12, "_emavariablescop": 12, "reus": [12, 22, 82, 187], "addextratheta": 12, "theta_nam": 12, "theta_valu": 12, "doesn": [12, 30, 33, 57, 75, 86, 90], "addvn": [12, 82], "per_step": [12, 15, 45, 82], "_createchildcontext": 12, "createchild": 12, "foo_param": 12, "createchildren": 12, "union": [12, 13, 15, 57, 82, 174, 178], "addchild": 12, "sublay": [12, 22, 42, 45], "_autoaddchild": 12, "_removechild": 12, "earlier": [12, 43, 75], "larger": [12, 15, 33, 70, 110, 151, 196], "your": [12, 13, 43, 45, 49, 118, 151, 181, 192], "own": [12, 31, 79, 82, 116, 128, 151, 178], "risk": 12, "_removechildren": 12, "_verifychildren": 12, "verifi": [12, 22, 68, 85], "ren": 12, "_verifyvarsandtheta": 12, "_casttofpropdtyp": 12, "islayerparam": 12, "decodefinalizearg": 13, "decode_out_path": 13, "decode_out": 13, "basetask": [13, 14, 34, 45, 60, 82, 118, 144, 153, 161, 175, 198], "decodefin": 13, "written": [13, 15, 49, 99, 106, 113, 217], "aggreg": [13, 26, 44, 57, 63, 79, 82, 95], "decodeemailopt": 13, "train_executions_per_ev": [13, 79], "emaildecodesummari": 13, "_variablesforema": 13, "model_var_list": 13, "One": [13, 86, 134, 163, 190, 196, 223], "train_op": [13, 45, 79, 118], "eval_metr": [13, 60], "etc": [13, 14, 25, 35, 45, 47, 49, 57, 59, 69, 76, 79, 82, 85, 90, 160, 178, 188, 196], "_setlearnerfromlegacyparam": 13, "tp": [13, 60], "probablist": [13, 34, 144, 153, 161, 175, 198], "discret": [13, 24, 34, 57, 99, 144, 153, 161, 175, 198], "mixtur": [13, 15, 34, 45, 47, 144, 153, 160, 161, 175, 198], "logist": [13, 34, 82, 144, 153, 161, 175, 198], "continu": [13, 34, 57, 75, 78, 95, 144, 153, 161, 175, 198], "regress": [13, 34, 82, 118, 144, 153, 161, 175, 198], "evalu": [13, 15, 30, 34, 57, 63, 79, 82, 108, 113, 116, 118, 130, 144, 150, 151, 153, 161, 175, 176, 196, 198], "loss": [13, 15, 34, 38, 43, 44, 45, 47, 57, 60, 75, 82, 86, 118, 134, 144, 153, 160, 161, 175, 178, 182, 185, 190, 194, 198, 208], "student": [13, 34, 144, 153, 161, 175, 198], "distil": [13, 34, 57, 144, 153, 161, 175, 198], "perhap": [13, 34, 144, 153, 161, 175, 198], "tower": [13, 34, 45, 118, 144, 153, 161, 175, 198], "arbitrari": [13, 34, 45, 47, 87, 89, 118, 124, 134, 144, 153, 161, 175, 190, 194, 198, 227], "filterperexampletensor": [13, 45, 118], "per_exampl": [13, 45, 82, 118], "processfpropresult": [13, 45, 118], "becaus": [13, 15, 45, 47, 57, 63, 82, 91, 118, 178, 192, 208, 223], "expens": [13, 15, 45, 118], "basemodel": [13, 14, 45, 118, 127], "put": [13, 45, 118, 127], "wherev": [13, 45, 70, 118], "most": [13, 15, 43, 45, 57, 58, 59, 75, 85, 95, 101, 103, 105, 116, 118, 134, 160, 178, 182, 221], "conveni": [13, 14, 45, 65, 70, 75, 76, 79, 85, 87, 118, 127], "Be": [13, 45, 118], "sure": [13, 15, 45, 118, 138], "plan": [13, 45, 48, 118], "tpu_steps_per_loop": [13, 45, 118], "higher": [13, 15, 45, 57, 70, 118, 124, 160, 196, 227], "fproptow": [13, 45, 118, 153, 161], "synchron": [13, 24, 70, 82, 93, 95], "asynchron": [13, 24, 93, 147], "_fproptpu": 13, "_fpropsplitinputbatch": 13, "_fpropresult": 13, "getinputbatch": 13, "adjustgradi": [13, 60, 161], "vars_gradi": 13, "clip": [13, 57, 60, 82, 85, 90, 161], "posttrainingloop": 13, "outfe": [13, 46, 79, 130, 227], "post": [13, 15, 34, 57, 79, 91, 118, 134, 143, 144, 153, 198], "queue": [13, 46], "_bpropgentrainop": [13, 45], "vmap": [13, 44, 45, 60, 75, 82, 161], "add_summari": [13, 24, 25, 143], "popul": [13, 70, 76, 79, 194, 196], "_bpropforvari": 13, "_computegradientmask": 13, "per_input_gradient_mask": 13, "regex": [13, 75, 82, 107], "applyexponentialmovingaverag": 13, "decodewiththeta": [13, 118, 144, 153], "subgraph": [13, 34, 51, 52, 77, 144, 153, 161, 194, 209], "public": [13, 34, 38, 85, 121, 122], "independ": [13, 15, 22, 34, 47, 76, 178], "convent": [13, 27, 34, 49, 104], "drive": [13, 34], "fashion": [13, 34, 134], "often": [13, 21, 34, 57, 86, 95, 110, 151, 185, 192], "broken": [13, 34], "piec": [13, 34, 64, 96, 115, 147, 208, 211], "inferencegraph": [13, 34, 51, 52, 77, 227], "inferenceeag": 13, "concretefunct": [13, 82], "genericfunct": 13, "concret": [13, 21, 41, 113], "createdecodermetr": [13, 34, 118, 144, 153, 175, 198], "basemetr": [13, 34, 63, 64, 118, 144, 153, 175, 198], "decode_out_dict": [13, 34, 79, 118, 144, 153, 198], "decode_metrics_dict": [13, 34, 118, 144, 153, 198], "could": [13, 22, 31, 34, 47, 48, 56, 63, 70, 75, 79, 82, 86, 118, 144, 153, 196, 198], "output_key_value_pair": [13, 34, 118, 144, 153, 198], "unicod": [13, 34, 118, 144, 153, 198], "decode_finalize_arg": 13, "email": [13, 79], "config": [13, 16, 35, 46, 51, 59, 75, 79, 82, 83, 116, 137, 139, 165, 195, 197, 219, 223, 227], "trigger": [13, 57, 70, 95, 185], "post_training_loop_op": 13, "per_example_tensor": [13, 79, 118, 130, 175, 194, 227], "addevalmetr": 13, "raise_if_already_ad": 13, "addperexampletensor": 13, "_updatevnconfig": 13, "vn": [13, 82], "flag": [13, 15, 47, 51, 58, 63, 70, 78, 79, 82, 83, 86, 113, 127, 217, 223, 227, 228], "_getmaskupdateop": 13, "prune": [13, 51, 70, 81, 90, 185, 227], "disk": [13, 49, 79, 93, 182], "variables_for_ema": 13, "_makeemavariablesdict": 13, "constructfpropbpropgraph": [13, 68, 117], "constructfpropgraph": 13, "apply_ema": 13, "constructdecodegraph": 13, "task_nam": [13, 227], "constructposttrainingloop": 13, "gettask": 13, "cn": [13, 227], "singletaskbas": 13, "_task": 13, "sampletask": 13, "singletaskmodel": [13, 14, 79, 118, 124, 227], "task_param": [13, 79, 124], "multitasksubmodel": [13, 79, 124, 227], "entir": [13, 47, 55, 57, 58, 61, 70, 82, 99, 140], "appear": [13, 57, 82, 117, 151, 180], "multitaskmodel": [13, 14, 68, 79, 124, 227], "tasknam": 13, "cur_prob": [13, 110], "basemodelparam": 14, "dataseterror": 14, "_basemodelparam": [14, 127], "experi": [14, 21, 147, 181, 204], "getalldatasetparam": [14, 181], "enumer": [14, 181], "dev": [14, 36, 80, 95, 122, 147, 156, 163, 173, 181, 185, 187, 192, 201, 202, 204, 223], "dataset_param": [14, 181], "dataset_nam": [14, 79, 80, 127, 181, 227], "getalldatasetparamsnotimplementederror": [14, 122, 181], "getdatasetparam": 14, "singletaskmodelparam": [14, 124, 127, 147, 156, 163, 165, 166, 181, 201, 202, 204, 211, 227], "develop": [14, 147, 156, 163, 201, 202, 204], "emul": [14, 85], "multitaskmodelparam": [14, 124, 127, 227], "programschedul": [14, 79, 127, 144, 147, 165, 166], "rethink": 15, "favor": [15, 39, 49, 57], "2009": [15, 39], "14794": [15, 39], "causalsegmentmask": 15, "segment_id": [15, 45, 47, 59, 61, 70, 91, 115, 170, 194, 195, 196, 197], "causal": [15, 29, 30, 39, 45, 47, 58], "slen": [15, 86], "belong": [15, 63, 70, 90, 184, 187], "causalpad": 15, "crossattentionpaddingwithtimestamp": 15, "timestamp": [15, 187], "per_step_pad": 15, "stamp": 15, "around": [15, 30, 47, 57, 76, 78, 82, 86, 90, 104, 115, 196], "itself": [15, 22, 31, 45, 48, 49, 87, 144, 153, 178], "simpl": [15, 21, 22, 31, 44, 45, 49, 57, 69, 79, 84, 85, 86, 90, 101, 104, 110, 115, 118, 145, 178, 182, 196], "a3": 15, "a4": 15, "5": [15, 17, 27, 38, 47, 49, 51, 53, 57, 62, 70, 82, 86, 88, 90, 99, 118, 134, 139, 147, 165, 166, 170, 175, 190, 196, 204], "b0": 15, "b1": 15, "b2": 15, "b3": 15, "shall": 15, "target_seq_len": [15, 17, 109], "source_seq_len": 15, "out_pad": [15, 27, 29, 30, 57, 197], "getdtypemin": 15, "segmentmask": 15, "apply_dtype_min": 15, "nan": [15, 57, 60, 82], "issu": [15, 31, 63, 82, 93], "segment_mask": [15, 59, 97], "perdimscalelay": 15, "outpu": 15, "multiheadedprojectionlay": 15, "below": [15, 47, 58, 59, 69, 70, 79, 196, 216, 223], "num_head": [15, 27, 29, 92, 160, 165, 166, 192, 194, 195, 204], "dim_per_head": [15, 27, 194], "hidden_s": [15, 90], "reshapedmultiheadedprojectionlay": 15, "reshap": [15, 21, 22, 45, 47, 48, 57, 58, 82, 85, 90, 107, 139, 174, 190], "md": [15, 57, 58], "dim_reshape_seg": [15, 48, 57, 58], "heavili": 15, "einsum": [15, 45, 47, 57, 82, 100], "certain": [15, 21, 42, 82, 90, 208], "sketch": [15, 57], "intermedi": [15, 21, 40, 42, 61, 69, 85, 86, 90, 91, 176, 187], "annot": [15, 45, 47, 48, 85, 120, 178], "wq": [15, 45], "wk": [15, 45], "wv": [15, 45], "wout": 15, "input_dim": [15, 22, 27, 29, 47, 57, 59, 61, 82, 106, 189, 194, 198], "key_dim": 15, "value_dim": 15, "q_proj": 15, "btd": 15, "dnh": 15, "btnh": 15, "k_proj": 15, "bsd": 15, "bsnh": 15, "v_proj": 15, "bnt": 15, "sqrt": [15, 39, 82, 95], "_multiheadedattent": 15, "_caplogit": [15, 45], "cap": [15, 45, 82, 85, 90, 95], "atten_logit_cap": [15, 27, 45, 165, 166], "_attenlogitsonestep": 15, "attenprob": 15, "uniform": [15, 82, 90, 185], "ideal": [15, 85, 182], "simultan": 15, "accordingli": [15, 47], "downstream": [15, 43, 51, 57, 85], "prevent": [15, 30, 58], "flow": [15, 21, 22, 47, 58, 82, 101], "probs_sum": 15, "_attencontext": 15, "_attencontextonestep": 15, "_dotatten": 15, "_maybescalequeri": 15, "_dotattenonestep": 15, "use_short_seq_opt": [15, 194], "short": [15, 70, 86, 194, 221], "_headsproj": 15, "key_vec": 15, "value_vec": 15, "_postproj": 15, "initst": [15, 47], "target_max_length": [15, 196, 208], "extendstep": [15, 57, 58, 87, 194], "cached_st": [15, 87], "autoregress": [15, 45, 58], "fast": [15, 58, 194], "updated_key_vec": 15, "updated_value_vec": 15, "reshapedmultiheadedattent": 15, "multiheadedfavorattent": 15, "multihead": [15, 39], "multiheadedattentionxl": 15, "notic": 15, "multiheadedattentionrp": 15, "_relativepositionvalueemb": 15, "tgt_time": [15, 107], "src_time": [15, 107], "attention_dim": 15, "localselfattent": 15, "slide": 15, "canon": [15, 27, 173], "reduc": [15, 45, 47, 57, 58, 75, 82, 86, 87, 89], "o": [15, 45, 47, 57], "practic": [15, 33, 35, 43, 75, 103, 178], "observ": [15, 55, 196], "hbm": [15, 87], "usag": [15, 18, 22, 41, 47, 55, 76, 82, 87, 96, 108, 112, 113, 127, 133, 150, 151, 170, 181, 185, 187, 196, 217, 223], "speed": 15, "gain": [15, 21, 37], "semant": [15, 178, 180], "cover": [15, 49, 70, 75, 134], "weihan": 15, "_streamattenlogit": 15, "query_proj": 15, "now": [15, 18, 47, 58, 65, 70, 82, 90], "Not": [15, 39, 113, 137, 160], "oppos": [15, 70, 85, 107], "streamstep": [15, 19, 27, 30, 106], "much": [15, 33, 43, 57, 82, 117, 194], "smaller": [15, 33, 45, 48, 57, 58, 70, 194, 196], "effic": 15, "bigger": [15, 70], "notimplementederror": [15, 81, 122, 140], "zero_st": [15, 19, 27, 30, 61, 90, 91, 104, 105, 137, 140, 160, 195], "_zero_state_static_length_input": 15, "inference_step_max_length": 15, "circular_tail": 15, "use_3d_recurrent_st": 15, "tail": 15, "pointer": [15, 70], "circular": [15, 47], "buffer": [15, 40, 47, 70, 174], "_zero_state_static_length_key_valu": 15, "_zero_state_dynamic_length": 15, "context_len": 15, "out_mask": 15, "isinferencestepstat": 15, "query_pad": 15, "key_pad": 15, "streamstepaddskipconnect": 15, "input_to_add": 15, "_streamstepdimens": 15, "commonli": [15, 21, 29, 75, 178], "head_dimens": 15, "state_length": 15, "num_queries_in_query_vec": 15, "_streamstepstaticcomputekeyvalueminim": 15, "minimize_state_s": 15, "_streamstepstaticcomputekeyvalue3d": 15, "scatter_nd_upd": 15, "cheaper": 15, "even": [15, 21, 70, 82, 86, 90], "re": [15, 33, 47, 49, 82, 85, 93, 103, 185], "_streamstepstaticcomputekeyvalueclass": 15, "classic": 15, "transfer": [15, 43, 98], "cheap": 15, "although": [15, 47], "interest": [15, 70, 85], "_streamstepstaticcomputekeyvalu": 15, "_streamstepstaticlength": 15, "staticli": 15, "_streamstepdynamiclength": 15, "localselfattentionxl": 15, "po": [15, 45, 47, 138], "reli": [15, 82, 196], "chunkwiseselfattent": 15, "bounari": 15, "chunkwis": 15, "therefor": [15, 30, 45, 47, 185], "essenti": [15, 79, 221], "regardless": [15, 58, 59, 63, 70], "sec": [15, 47, 79], "2010": [15, 43], "10759": 15, "stage": [15, 31, 45, 47, 139], "2005": [15, 27, 106], "08042": 15, "recomput": [15, 86], "receipt": 15, "_paramcheck": 15, "chunkwiseselfattentionxl": 15, "attention_logit": 15, "routingattent": 15, "rout": [15, 47, 58, 92], "clustert": 15, "zhouwk": [15, 58], "miss": 15, "select": [15, 22, 31, 36, 43, 47, 70, 82, 95, 144, 190, 196], "attention_window": [15, 92], "find": [15, 23, 43, 47, 82, 101], "know": [15, 49, 57, 68, 85, 178], "causal_mask": 15, "key_dist": 15, "henc": [15, 57, 70, 90], "cache_st": 15, "fast_path": 15, "thei": [15, 22, 45, 49, 51, 70, 82, 85, 86, 90, 101, 123, 130, 139, 176, 178, 185, 190, 208, 218], "major": [15, 59, 85, 104, 161, 172, 194, 195], "obei": [15, 127], "updated_st": [15, 87], "_dotattenslowpath": 15, "q_dist": 15, "k_dist": 15, "query_relative_position_shift": 15, "slow": 15, "basi": [15, 70, 82], "impact": [15, 58, 93], "yet": [15, 82, 90], "_dotattenfastpath": 15, "guarante": [15, 36, 49, 51, 70, 82, 138, 161], "enc_map": 15, "transformerattentionlay": [15, 58, 59, 192], "And": [15, 22, 38, 58, 86], "residu": [15, 29, 45, 57, 58, 89, 105, 134, 160, 192], "connect": [15, 21, 22, 42, 45, 57, 58, 59, 101, 105, 134, 160, 187, 197], "atten_tpl": [15, 58], "scenario": [15, 43, 58], "come": [15, 58, 59, 70, 75, 103], "rightward": [15, 58], "is_mask": [15, 58], "commonparam": [15, 27, 160], "use_relative_atten": [15, 27], "relative_pos_emb_dim": [15, 27], "local_context": 15, "dropout_prob": [15, 27], "extend": [15, 17, 55, 57, 58, 61, 85, 86, 101, 180, 194, 221], "omnipot": 15, "further": [15, 45, 58, 59], "lean": [15, 90], "cautious": 15, "setfpropdtyp": [15, 27, 45, 58], "_initattentionparam": 15, "per_step_padding_overrid": 15, "cross_attent": 15, "thu": [15, 40, 47, 116], "cur_output": [15, 58], "stream": [15, 27, 57, 82], "input_vec": 15, "funneltransformerattentionlay": 15, "funnel_pool": 15, "caus": [15, 48, 177, 178], "reduct": [15, 57], "202530591": 15, "complic": [15, 21, 178], "transformermultisourceattentionlay": [15, 58], "comment": [15, 17, 41, 57, 82, 139, 151], "transformerlay": [15, 58, 59], "setcanonicalshardingparam": [15, 27], "reshape_dim": 15, "shard_atten_w": 15, "spmd": [15, 27, 45, 47, 79], "topologi": [15, 82, 85], "1d": [15, 30, 47, 82, 165, 208], "num_partit": [15, 35, 42, 46], "split_dims_map": [15, 48], "fflayer": [15, 27, 58], "df": [15, 223], "blf": 15, "fd": 15, "bld": 15, "rank": [15, 17, 19, 30, 47, 53, 57, 58, 70, 82, 119, 139, 190], "anoth": [15, 21, 49, 56, 57, 63, 69, 75, 90, 93, 105, 108, 145, 151, 194, 196], "better": [15, 33, 47, 70, 86, 110, 117, 138, 194, 196], "blnh": 15, "auto": [15, 47, 48, 76, 82, 120], "reshapedim": [15, 48], "trick": [15, 33, 58, 90], "setreshapedlay": 15, "atten_num_head": [15, 27], "atten_is_rel": 15, "atten_local_context": [15, 27], "atten_left_context": [15, 27], "atten_right_context": [15, 27], "has_aux_atten": [15, 58, 59], "mask_self_atten": 15, "fflayer_hidden_dim": [15, 27], "fflayer_output_dim": 15, "setnuminputnod": 15, "num_input_nod": [15, 82, 105], "numoutputnod": [15, 27, 57, 58], "_getsourcebatchs": 15, "aux_vec": [15, 58, 59, 87, 197], "_getsourcelength": [15, 58], "aux_pad": [15, 58, 59, 197], "aux_per_step_padding_overrid": 15, "aux_segment_mask": 15, "target_tim": [15, 58, 59, 194], "source_tim": [15, 58, 59, 194], "arrang": [15, 57, 188, 190], "self_atten": 15, "aux_atten": [15, 58], "compute_atten_prob": 15, "aux_": [15, 58, 59], "batch_multipli": 15, "warn": [15, 30, 82, 122, 123, 130], "transformerflop": 15, "ff_dim": [15, 45], "atten_dim": 15, "model_dim": [15, 27, 45, 47, 92, 95, 160, 165, 166, 192, 194, 195, 198, 204], "incl": 15, "6": [15, 21, 29, 57, 62, 70, 82, 118, 134, 160, 165, 166, 170, 190, 195, 204], "bdnh": 15, "bntd": 15, "proj": 15, "ff": [15, 58, 170], "ff_hidden": 15, "feedforward": [15, 45, 47, 57, 58, 92, 192], "hidden": [15, 57, 58, 61, 87, 92, 160, 189, 192], "multisourcetransformerlay": 15, "primary_source_kei": 15, "userelativeattentionintransformerlay": 15, "transformer_param": 15, "rel_pos_emb_dim": 15, "atten_typ": 15, "transformer_xl": 15, "mt_attention_lay": 15, "clearrelativeattentionintransformerlay": 15, "transformerdecoderlay": 15, "multisourcetransformerdecoderlay": 15, "repeatedtransformerlay": 15, "genericrepeatlay": [15, 87], "repeatlay": [15, 22, 45, 82, 87], "stackedtransformerlay": 15, "getsplitforlay": 15, "layer_index": [15, 137], "_getdeviceoflay": 15, "layer_idx": 15, "our": 15, "collect_per_layer_output": 15, "xformer": [15, 46, 82], "all_layer_output": 15, "context_vector": 15, "x_layer": 15, "pipelinedtransformerlay": 15, "wrappedstageclass": 15, "transformerfeedforwardlayerwithtaskid": 15, "transformerfeedforwardlay": [15, 58, 189], "gpipebatchmajortransformerlay": 15, "majortransform": 15, "gpipebatchmajortransformerstack": [15, 59], "target_vec": [15, 59], "target_pad": [15, 57, 59, 194, 196], "encoder_self_atten_segment_mask": [15, 59], "decoder_self_atten_segment_mask": [15, 59], "decoder_cross_atten_segment_mask": [15, 59], "setupdeterministicdropout": [15, 59], "ones": [15, 59, 108, 116], "residualaddlay": 15, "paddinglay": [15, 30], "stridelay": 15, "funnelpoolinglay": 15, "2006": [15, 62], "03236": 15, "begin_intact": 15, "trunc_seq": 15, "few": [15, 17, 21, 22, 42, 49, 70, 75, 95, 134], "first_n": [15, 97], "funnelupsamplelay": 15, "upsampl": 15, "all_hidden": 15, "vec": [15, 45, 97], "meshsplitlay": 15, "meshsplit": [15, 45, 48], "_dropout": [15, 21, 45, 57], "drop_prob": 15, "dropoutlay": [15, 21, 45, 57], "_add": [15, 29, 45, 86], "residual_weight": [15, 27, 29, 45], "apply_residu": 15, "_defaultln": 15, "_expanddim": [15, 29], "_squeez": [15, 29], "_glu": [15, 27, 29], "_pad": [15, 29], "tensor_split_dims_map": [15, 45, 47, 48, 82, 85], "_multiheadedatten": 15, "gatedgelufeedforward": 15, "is_caus": [15, 27, 29], "ff_hidden_dim": [15, 27, 195], "gatedfeedforward": 15, "activation_fn": [15, 45], "relu": [15, 21, 22, 29, 39, 45, 47, 57, 85, 160, 192], "use_pad": 15, "qdomain": [15, 21, 29, 85, 90], "_maybesplit": [15, 47], "_depthwiseconv2d": 15, "filter_s": 15, "depthwis": [15, 27, 30, 45, 47, 57], "lightweight": [15, 27, 29, 92, 97], "conv": [15, 27, 29, 30, 45, 57, 90, 137], "_normalizeddepthwiseconv2d": 15, "kernel_s": [15, 27, 29, 45, 47], "lconv": [15, 27, 29], "convolution_fn": 15, "linear_qdomain": 15, "conv_qdomain": 15, "10430": [15, 29, 30, 97], "pytorch": [15, 29, 38], "l587": [15, 29], "github": [15, 19, 29, 38, 163], "com": [15, 19, 29, 38, 57, 121, 163], "fairseq": [15, 29], "blob": [15, 19, 29], "v0": [15, 29], "lightconv": [15, 29], "altern": [15, 63, 117], "kernel": [15, 29, 30, 39, 45, 57], "lightweightconvlayerblock": 15, "lconvblock": 15, "sequenti": [15, 21, 22, 42, 87, 110], "lconvstack": 15, "_stride": 15, "_stridedattent": 15, "omit": 15, "divis": 15, "_pool": 15, "_funnelattent": 15, "funnelencoderlay": 15, "ff_gated_fn": 15, "num_ffn": 15, "silu": [15, 166], "gelu": 15, "ffn": [15, 27, 45], "transformerencoderlay": 15, "output_all_layer_hidden": 15, "transformerencoderstack": 15, "num_lay": [15, 89, 92, 97, 106, 160, 189, 192, 194], "performerbuild": 15, "gshard": [15, 27, 45, 46, 47, 48, 120, 170], "mesh": [15, 27, 45, 47, 48, 85, 165], "memoryaddlay": 15, "sketchmemtransformerbuild": 15, "sketchmem": 15, "_memoryadd": 15, "add_memori": 15, "output_dim": [15, 47, 57, 58, 82, 139, 180, 189, 194], "lmbuilder": 15, "langang": 15, "_var": [15, 45, 47], "_shardedvar": [15, 45], "mesh_split": [15, 45, 48, 85], "_linearweight": 15, "_linear": [15, 21], "matmul": [15, 21, 57, 81, 82, 85], "idim": [15, 21], "odim": [15, 21], "_biasweight": 15, "_bia": [15, 21, 29], "_attent": 15, "scale_infeed_to_glob": 16, "infeed_batch_s": 16, "scale_global_to_infe": 16, "scale_split_to_infe": 16, "split_batch_s": 16, "topk_decod": [17, 135, 170], "other_st": 17, "beamsearchsharedparam": 17, "beamsearchhelp": 17, "initbeamsearchst": 17, "hyp": [17, 40, 70, 82, 96, 134, 135, 136, 144, 150, 151, 192, 194], "sentenc": [17, 47, 70, 96, 115, 136, 150, 151, 194, 195, 196, 205], "initial_result": [17, 194], "step_id": [17, 134, 194], "hyp_per_beam": 17, "fill": [17, 55, 70, 93, 135, 138], "client": [17, 24, 194], "beam_search_step": [17, 70], "in_stat": 17, "cur_step": [17, 70, 134, 194], "out_stat": [17, 194], "minim": [17, 36, 45, 70, 75, 76, 139], "is_last_chunk": [17, 70], "transduc": [17, 70, 134], "new_step_id": [17, 134, 194], "next": [17, 22, 31, 70, 78, 82, 85, 86, 87, 90, 101, 103, 104, 105, 117, 118, 134, 160, 194], "final_st": [17, 91], "_beamsearchstep": 17, "core_bs_st": 17, "pre_beam_search_step_callback": 17, "post_beam_search_step_callback": 17, "num_beam": [17, 70], "num_hyp": [17, 194], "src_seq_len": 17, "tgt_seq_len": 17, "manag": [17, 43, 47, 63, 76, 78, 82, 85, 86, 113, 116, 117, 127, 227], "header": 17, "all_don": [17, 70], "init_beam_search_st": 17, "max_step": [17, 40, 47], "mostli": [17, 47, 177, 188], "opaqu": [17, 85], "seq_length": [17, 57, 70, 82, 99], "source_batch_s": 17, "_getshap": [17, 109], "none_shap": [17, 109], "mergebeamsearchoutput": 17, "max_hyps_per_beam": 17, "beam_search_output": 17, "less": [17, 45, 57, 70, 97, 99], "hypothes": [17, 70, 136, 142, 143, 150, 151, 194], "greedysearchhelp": 17, "_greedysearchstep": 17, "hyp_id": [17, 136], "hyp_len": 17, "done_hyp": [17, 70], "src_batch_siz": 17, "encount": 17, "bfloat16": [18, 47, 70, 82, 116], "bfloat16variablesav": 18, "saveabl": 18, "restor": [18, 23, 51, 77, 79, 82, 93, 190], "sai": [18, 86], "variable_nam": [18, 82], "original_dtyp": 18, "bfloat16_var": 18, "use_resourc": 18, "slice_spec": 18, "restore_sequenti": 18, "orig_dtyp": 18, "saveableobject": 18, "restored_tensor": 18, "restored_shap": 18, "conform": [18, 27, 82, 106], "get_saver_spec_for_variables_with_bf16_overrid": 18, "variables_to_restor": 18, "bf16": 18, "addingaccumul": 19, "suffici": [19, 82], "statist": [19, 35, 57, 63, 64, 70, 75, 85, 96, 185, 194], "computemo": 19, "reduce_over_dim": 19, "cumulative_axi": 19, "enable_cross_replica_sum_on_tpu": 19, "keepdim": [19, 82], "batchnormlay": [19, 30], "_getweightshap": [19, 30, 57], "_getdefaultpad": 19, "_getbetagamma": 19, "getcurrentmo": 19, "beta": [19, 37, 192], "gamma": [19, 82], "computeandupdatemo": 19, "_computebn": 19, "norm_mean": 19, "norm_vari": 19, "_maybeexpandpad": 19, "categoricalbn": [19, 30], "categor": [19, 57], "bn": [19, 57, 156], "akin": 19, "1809": 19, "11096": 19, "categori": [19, 82, 85, 87], "agnost": 19, "awar": [19, 30, 55], "class_emb": [19, 30], "emb_dim": [19, 30, 160, 194, 198], "batchnormlayernopad": 19, "batchnorm": [19, 57], "moving_mean": 19, "moving_vari": 19, "_moment": 19, "group_siz": [19, 47], "master": 19, "offici": [19, 64], "amoeba_net": 19, "network_util": 19, "l550": 19, "groupnormlay": 19, "08494": 19, "num_group": [19, 27, 47, 90], "_normal": [19, 27], "grouped_input": 19, "group_mean": 19, "group_vari": 19, "output_pad": [19, 47, 57], "_streammoment": 19, "cached_sum": 19, "cached_count": 19, "cached_var": 19, "new_cached_sum": 19, "new_cached_count": 19, "new_cached_var": 19, "build": [20, 21, 23, 27, 41, 46, 47, 79, 82, 86, 93, 103, 113, 122, 141, 159, 187, 196, 223, 227], "builddata": 20, "binari": [20, 33, 63, 78, 82, 107, 170, 196], "composit": [21, 58, 75], "discuss": [21, 57, 89], "teammat": 21, "conv2dlay": [21, 57], "facilit": [21, 47, 57, 61, 90], "_seq": [21, 101], "zhifengc": 21, "_rep": 21, "sa": 21, "sc": 21, "sa1": 21, "sb1": 21, "sc1": 21, "sa2": 21, "sb2": 21, "sc2": 21, "_graph": 21, "input_endpoint": [21, 45], "output_endpoint": [21, 45], "signature_sub_param_list": 21, "_id": 21, "t_1": 21, "t_n": 21, "t1": 21, "_arg": 21, "pick": [21, 43, 47, 75], "t_": 21, "_par": 21, "f1": [21, 63, 151], "f2": 21, "_fn": 21, "fn_out": [21, 87], "fn_flop": 21, "prototyp": 21, "advic": 21, "establish": 21, "fnlayer": [21, 22, 190], "serial": [21, 32, 49, 70, 82, 117, 159, 174], "_save": [21, 82], "_addfetch": 21, "_layer": 21, "layer1": 21, "layer1_out": 21, "layer2": 21, "layer2_out": 21, "_output": [21, 86], "input1": [21, 82], "input2": 21, "inputn": 21, "fetch1": 21, "fetchm": 21, "_remateri": 21, "remateri": [21, 22, 82, 87], "_batchparallel": 21, "batchparallel": 21, "_printshap": 21, "print": [21, 22, 49, 82, 96, 107, 123, 130, 219, 220, 223, 225, 227], "_createnestedmap": 21, "_bn": 21, "_ln": [21, 45], "use_fused_layernorm": 21, "keep_prob": [21, 45, 70, 82], "noise_shape_broadcast_dim": [21, 45], "device_mesh": [21, 27, 45, 47, 48, 57, 58, 82, 85, 165, 166], "weight_split_dims_map": 21, "_activ": [21, 29], "_fc": 21, "_mlp": 21, "_conv2d": 21, "filter_shap": [21, 29, 30, 57], "filter_strid": [21, 30], "conv2d": [21, 29, 30, 57], "_reshap": 21, "_concat": 21, "firstnlay": 22, "argindexlay": 22, "_totupl": [22, 42, 47], "_maybestackextratheta": [22, 87], "all_var": [22, 82], "createnestedmaplay": 22, "_bodi": [22, 47, 87], "_unrolled_fprop": [22, 47], "softcondlay": 22, "sum_i": [22, 178], "w_i": 22, "theta_i": 22, "num_expert": [22, 27], "coeffici": [22, 33, 63, 70, 82], "expert": [22, 45, 47, 160], "yang": 22, "bender": 22, "le": 22, "ngiam": 22, "1904": [22, 57, 99, 100], "04971": 22, "_getexpertdist": 22, "parallelrepeatlay": 22, "_inferoutshap": 22, "slice": [22, 48, 82, 86, 124, 178, 187, 188, 227], "becom": [22, 70, 82, 178], "output_tensor": [22, 82], "sequentiallay": [22, 42], "unarysequentiallay": 22, "besid": 22, "graphtensor": 22, "storetensor": 22, "named_tensor": 22, "equival": [22, 51, 61, 63, 82, 83, 178, 185, 196], "overwritten": [22, 82], "gettensor": 22, "seri": [22, 70], "graphsignatur": [22, 101], "graphlay": [22, 29, 45, 101], "out1": 22, "myvar": 22, "out2": 22, "thing": [22, 31, 82, 85, 99, 217], "in1": 22, "in2": 22, "syntax": [22, 110], "bnf": 22, "za": [22, 69], "z_": [22, 69], "z0": [22, 69], "9_": [22, 69], "path_seq": 22, "item_seq": 22, "map_pair_seq": 22, "map_pair": 22, "_parseoutput": 22, "comma": [22, 223], "delimit": [22, 70, 115, 170], "pars": [22, 24, 41, 48, 77, 82, 151, 159, 170, 174, 227], "_tokenizeinput": 22, "spefici": 22, "_consumepath": 22, "_consumekei": 22, "_consumesymbol": 22, "_maybeconsumesymbol": 22, "consum": [22, 70, 187, 195], "_consumeitem": 22, "whatev": 22, "_consumemap": 22, "_consumelist": 22, "_parseinput": 22, "grammar": 22, "parallellay": 22, "maplay": 22, "linearlay": 22, "biaslay": [22, 29], "plu": [22, 29, 178], "branchlay": 22, "batchparallellay": 22, "rematerializationlay": 22, "printshapelay": 22, "debug": [22, 40, 69, 82, 138, 163, 165, 166, 208, 225], "reshapelay": 22, "inp": [22, 47, 57, 58, 82], "concatlay": 22, "slicelay": 22, "numpi": [22, 27, 45, 47, 63, 76, 85, 93, 138], "slicehelp": 22, "sortcheckpointpath": 23, "ckpt": [23, 47, 77, 80, 93], "saverwrapp": 23, "train_param": 23, "variables_to_restore_dict": 23, "async_sav": [23, 93], "gstep": 23, "sync": [23, 70, 79, 93, 201, 227], "outstand": [23, 93], "async": [23, 79, 93], "save_onli": 23, "checkpoint_dir": 23, "_getsav": 23, "async_checkpoint": 23, "_buildinitfromcheckpointrul": 23, "init_from_checkpoint_rul": 23, "restorefrompath": 23, "shouldsav": 23, "maybesav": 23, "_updatenextsavetim": 23, "_restorefromlatestcheckpoint": 23, "_getuninitializedvarnam": 23, "force_reiniti": 23, "avail": [23, 24, 35, 79, 82, 85, 221], "restoreifneed": 23, "restoreglobalstepifneed": 23, "_getsaveablevariablesdict": 23, "stripepd": 23, "trail": [23, 82, 138], "_eagercheckpoint": 23, "eager": [23, 41, 75, 79, 82, 107, 113, 117, 123], "_maybebuildinitfromcheckpointrul": 23, "_maybeoverwritemodelvariableswithema": 23, "overwrit": [23, 49, 101], "shadow": 23, "eagercheckpointerv1": 23, "_getrestor": 23, "_wraprestoreerrorwithgraphmodewarn": 23, "err": [23, 150], "eagercheckpointerv2": 23, "v2": [23, 113, 147], "getspecificcheckpoint": 23, "load_checkpoint_from": 23, "infeedcontext": 24, "infeed_host_index": 24, "infeedcontextscop": 24, "getinfeedcontext": 24, "makedevicestr": 24, "replica_id": 24, "device_nam": 24, "device_id": 24, "_cluster": 24, "whole": [24, 82, 86, 124, 160, 178, 227], "_jobspec": 24, "replica": [24, 41, 45, 63, 75, 82, 95, 188], "initdevic": 24, "initdeviceseag": 24, "listdevic": 24, "job_spec": 24, "np": [24, 76, 82, 138], "arrai": [24, 31, 47, 51, 63, 76, 82, 93, 99, 115, 134, 138, 165, 166, 216], "exportmetr": 24, "_checkinvari": 24, "invari": 24, "setup": [24, 46, 57, 63, 79, 81, 85, 92, 113, 128, 160, 187, 192], "worker": [24, 25, 42, 46, 147], "coloc": [24, 51, 82], "is_executor_tpu": 24, "num_replica": [24, 41, 95], "tpus_per_replica": 24, "num_devices_per_replica": 24, "total_worker_devic": 24, "num_devices_per_split": [24, 165], "acceler": [24, 51, 61, 82, 223], "num_splits_per_replica": 24, "num_splits_per_cli": 24, "visibl": [24, 185], "available_devic": 24, "input_devic": 24, "all_worker_nam": 24, "input_target": 24, "workerdeviceinmodelsplit": [24, 25], "device_index": 24, "model_split": 24, "onto": [24, 85], "split_id": [24, 25], "incorrectli": [24, 82, 182], "getplac": 24, "strategi": [24, 85, 110], "placement": [24, 70, 82], "least": [24, 45, 47, 49, 70, 82, 176, 178], "polici": [24, 45, 54, 93], "tf_data_service_address": [24, 31], "in_unit_test": 24, "require_sequential_input_ord": [24, 25], "worker_cluster_def": 24, "clusterdef": [24, 82], "reporting_job": 24, "varplac": 24, "placer": [24, 45], "_assignvar": 24, "_": [24, 47, 57, 61, 77, 82, 86, 137, 169, 176, 185, 187, 196, 214, 217, 218, 220, 222, 225, 226], "devicefunct": 24, "_leastloadedplac": 24, "var_op": [24, 82], "parsedevicestr": 24, "device_str": 24, "parsed_devic": 24, "factori": 25, "setclust": 25, "cluster_param": [25, 46, 51, 124], "fortestingwork": 25, "gpu": [25, 77, 82, 147, 163, 223, 227], "split_siz": [25, 82], "unittest": [25, 111, 113], "setev": [25, 113], "off": [25, 55, 57, 75, 82, 99, 198], "z": [25, 45, 82], "bar": [25, 69, 82, 190, 223], "setrequiresequentialinputord": 25, "setmodelsplit": 25, "cost": [26, 35, 42, 47, 86, 89], "prepar": [26, 30, 101, 103, 105, 107, 135, 187, 193], "_hasaccumul": 26, "cost_metric_nam": 26, "_getaccumul": 26, "08100": [27, 106], "lconvlay": 27, "architectur": [27, 82, 90], "ln": [27, 45, 58], "glu": [27, 45, 47], "depthwise_conv_1d": 27, "conv_activ": 27, "swish": 27, "gated_input": 27, "act_input": 27, "_applyactiv": 27, "act_nam": [27, 85], "dim0": [27, 82], "_normalizestep": 27, "struct": [27, 30, 57], "_attenctxisset": 27, "atten_context": [27, 91, 103, 194], "gshardmoelayerparam": 27, "num_devic": [27, 47, 48, 79, 130, 227], "per_expert_capacity_dim": 27, "use_densebuild": 27, "conformerlay": 27, "mhsa": 27, "atten_chunk_s": 27, "fflayer_activ": 27, "fflayer_residual_weight": 27, "layer_ord": 27, "mhsa_before_conv": 27, "conv_norm_layer_tpl": 27, "use_moe_in_fflayer_start": 27, "use_moe_in_fflayer_end": 27, "moe_num_partit": 27, "moe_num_expert": 27, "moe_num_group": 27, "moe_per_capacity_dim": 27, "fflayer_start_tpl": 27, "fflayer_end_tpl": 27, "trans_atten_tpl": 27, "lconv_tpl": 27, "list_regex_dtyp": [27, 82], "_configselfattencontext": 27, "configfflay": 27, "tpl": 27, "configmoeparam": 27, "moe": [27, 45, 46, 47, 58], "has_lconv": 27, "has_mhsa": 27, "has_fflayer_start": 27, "_configfflayerormoeparam": 27, "fflayer_tpl": 27, "name_prefix": 27, "_selfatten": 27, "_lconv": 27, "_moeorfflay": 27, "fflayer_nam": 27, "aux_loss": [27, 45, 47, 82], "fflayer_end": 27, "moe_lay": 27, "_moe": 27, "_fprop": [27, 106, 194], "in_nmap": 27, "_addattentionsummari": 27, "_addattenprobshistogramsummari": [27, 194], "histogram": [27, 90, 107, 194], "_addattenprobsimagesummari": [27, 194], "applygshard": 27, "conformer_tpl": 27, "proj_w_split_list": 27, "proj_activation_split_list": 27, "atten_dnh_w_split": 27, "atten_blnh_activation_split": 27, "atten_bld_activation_split": 27, "lconv_df_w_split": 27, "lconv_hwim_w_split": 27, "lconv_fd_w_split": 27, "lconv_blf_activation_split": 27, "lconv_bld_activation_split": 27, "moe_device_mesh_shap": 27, "moe_emh_split": 27, "moe_ehm_split": 27, "moe_eah_split": 27, "moe_eam_split": 27, "moe_egcm_split": 27, "moe_gecm_split": 27, "moe_gsec_split": 27, "moe_blm_split": 27, "ndarrai": [27, 48, 85, 107, 138, 187], "in_channel": [27, 30], "channel_multipli": [27, 30, 47], "emh": 27, "ehm": 27, "eah": [27, 47], "egcm": [27, 47], "gecm": [27, 47], "gsec": [27, 47], "blm": [27, 47], "causalpoolinglay": 29, "frequenc": [29, 30, 57, 76, 99], "_biasnopad": 29, "_norm": 29, "_normorbia": 29, "_maybenorm": 29, "_rawconv2d": 29, "in_dim": 29, "dilat": [29, 30], "_rawdepthwiseconv2d": 29, "depth_multipli": [29, 57], "_globalpool": 29, "pooling_typ": 29, "conv_last": [29, 57], "depthwiseconv2d": 29, "separableconv2d": 29, "normalizeddepthwiseconv2d": 29, "dropconnect_prob": 29, "deterministic_dropout": 29, "glu_with_tanh": 29, "_lconvcommon": 29, "residual_dropout_prob": [29, 92, 160, 192, 204], "unit": [29, 57, 82, 85, 90, 154], "normalizedlconv": 29, "2004": [29, 38, 180], "11886": 29, "buggi": 30, "v2_pad": 30, "computeconvoutputshap": 30, "in_shap": [30, 57], "t_stride": 30, "f_stride": 30, "outc": 30, "computeconvoutputpad": 30, "padding_algorithm": [30, 57], "prefer": [30, 57, 82, 85, 86], "computeconvoutputpaddingv2": 30, "in_pad": 30, "adjac": 30, "computeexplicitpaddingforcausalconv": 30, "dilation_r": [30, 57], "out_channel": [30, 57], "axis": 30, "pad_top": 30, "pad_bottom": 30, "pad_left": 30, "pad_right": 30, "explicit_pad": 30, "_computeconvoutputpaddingv2": 30, "shrink": 30, "unnecessarili": 30, "_padforlengthcompatiblestridesv2": 30, "constant_valu": 30, "incompat": [30, 48, 115], "padded_length": 30, "potenti": [30, 31, 45, 57, 79, 89, 93, 194, 221], "baseconv2dlayerwithpad": 30, "outputchannel": 30, "output_channel": [30, 57], "input_channel": 30, "outshap": [30, 57], "_rescaleboundari": 30, "conv_input": 30, "_maybecausalpad": 30, "_evaluateconvkernel": [30, 57], "conv2dlayerwithpad": 30, "outputshap": [30, 57], "_getweight": [30, 47, 57], "causalconv2dlayerwithpad": 30, "input_tensor": [30, 43], "depthwiseconv2dlay": [30, 57], "1610": [30, 33, 57], "02357": [30, 57], "causaldepthwiseconv2dlay": 30, "normalizeddepthwiseconv2dlay": 30, "causalnormalizeddepthwiseconv2dlay": 30, "convbatchnormlay": 30, "regular": [30, 33, 47, 57, 82, 90, 104, 137, 185, 190, 192], "convcategoricalbn": 30, "globalpoolinglay": 30, "spatial": [30, 57], "broad": 31, "metasourc": 31, "met": [31, 36], "setinputgener": 31, "getnext": 31, "getmeta": 31, "input_common": 31, "record_yield": 31, "record_batch": 31, "crossbatchmixingdatasourc": 31, "curriculumdatasourc": 31, "not_support": 31, "rosenberg": 31, "prefixeddatasourc": 31, "prepend": [31, 70, 82], "tfdatasetsourc": [31, 208], "num_host": 31, "host_id": [31, 116], "getdataset": [31, 122, 208], "_inititer": 31, "tfdatasetadaptor": 31, "tfdatasettransform": 31, "customtfdatasettransform": 31, "repeatabletfdatasettransform": 31, "sentinel": 31, "tfdatasetfninput": 31, "tfdataset": 31, "tfdsinput": 31, "tfd": 31, "tfdatasetbatchbysequencelength": [31, 208], "bucket_kei": [31, 41, 141, 159, 196, 208], "seqlen_fn": 31, "On": [31, 33, 47, 57], "partial": [31, 70, 82, 119, 120], "finit": [31, 39], "tfdatasetprefetch": 31, "tfdatasetmix": 31, "gettfdataservicedataset": 31, "bucket_upper_bound": [31, 147, 196], "processing_mod": 31, "dataset_id": 31, "element_spec": 31, "servic": [31, 79], "uuid": 31, "upper": [31, 33, 85, 99, 222], "bound": [31, 33, 56, 75, 85, 99], "dataet": 31, "tfdataservicesourc": 31, "remot": 31, "phase": [32, 57, 95], "writekeyvaluepair": 32, "key_value_pair": 32, "serializeoutput": 32, "nmap": [32, 82, 86, 93], "differenti": [33, 47, 82], "csisz": 33, "2008": 33, "algoirthm": 33, "geometri": 33, "background": [33, 46], "cuturi": 33, "2013": 33, "lightspe": 33, "transport": [33, 47], "schmitzer": 33, "2019": [33, 35, 75, 82], "stabil": [33, 39, 82], "entropi": [33, 57, 59, 82, 178, 194], "max_assign": 33, "elementwise_upper_bound": 33, "row_sum": 33, "col_sum": 33, "num_iter": 33, "use_epsilon_sc": 33, "margin": [33, 39, 194], "n_row": 33, "n_column": 33, "upper_bound": 33, "01": [33, 37], "enough": [33, 47, 70, 85], "converg": [33, 85], "solv": 33, "dual": [33, 175, 178, 180, 181, 184, 187], "06519": 33, "decreas": 33, "factor": [33, 36, 57, 60, 70, 75, 82, 90, 95, 194, 196], "reach": [33, 57, 70, 109], "used_it": 33, "ep": [33, 57], "delta": [33, 37, 70, 82, 107, 113, 120], "knowledg": [34, 178], "distillationtask": 34, "computedistillationloss": 34, "dec_out_dict": [34, 118, 135, 144, 153, 198], "dec_metrics_dict": [34, 118, 135, 143, 144, 153, 198], "shampoo": [35, 70], "partitionconfig": 35, "max_dim_s": 35, "partition_s": 35, "partitionmetadata": 35, "split_sizes_per_dim": 35, "num_splits_per_dim": 35, "tensorpartition": 35, "involv": [35, 49, 79, 85], "movement": 35, "partition_metadata": 35, "partition_info": 35, "reform": 35, "partition_tensor": 35, "reform_tensor": 35, "partitioned_tensor": 35, "distributedshampoo": [35, 75], "momentum": [35, 37, 75], "initial_accumulator_valu": 35, "start_preconditioning_step": 35, "statistics_computation_frequ": 35, "matrix_epsilon": 35, "synchronous_precondit": 35, "second_moment_averag": 35, "fallback_to_diagonal_dim": 35, "4096": [35, 45, 166, 174], "max_any_dim": 35, "6656": 35, "block_partition_threshold_s": 35, "1000000": 35, "exponent_multipli": 35, "adagrad": [35, 75, 116], "kroneck": [35, 75], "matric": [35, 70, 75, 76, 82, 90, 99, 115, 192, 198], "made": [35, 47, 49, 75], "vineet": [35, 75], "gupta": [35, 75], "kevin": [35, 75], "regan": [35, 75], "yoram": [35, 75], "singer": [35, 75], "_fallback_to_diagonal_for_shap": 35, "fallback": [35, 139], "diagon": [35, 57, 82], "_preconditioner_available_for_dim": 35, "precondition": [35, 70], "_preconditioner_indic": 35, "_make_named_slot": 35, "val": [35, 49, 50, 63, 70, 82, 120], "slot_nam": 35, "make_named_zeros_slot": 35, "_generalized_inverse_pth_root": 35, "input_t": 35, "expon": [35, 62, 70, 75], "12": [35, 165, 166], "_specialized_inverse_pth_root": 35, "_inverse_pth_root_graph": 35, "invoke_async_preconditioner_comput": 35, "global_step_int32": 35, "svd": 35, "assign_preconditioner_to_host_var": 35, "grab": [35, 57], "_statistics_key_for_partition_and_dim": 35, "dim_index": 35, "partition_index": 35, "_preconditioner_key_for_partition_and_dim": 35, "_key_for_var": 35, "_updated_statist": 35, "partitioned_grad": 35, "l_t": 35, "r_t": 35, "_compute_preconditioned_raw_grad": 35, "precondit": [35, 70], "_preconditioned_upd": 35, "diagonal_grad_upd": 35, "metrichistori": 36, "versu": [36, 37, 95, 139], "histori": [36, 70, 73, 95, 104], "setlogdirinmetrichistori": 36, "_metric_histories_map": 36, "_kei": 36, "hist_fil": [36, 70], "tfevent_fil": 36, "conditionalappend": 36, "append": [36, 46, 55, 70, 82, 107, 115], "hasn": 36, "improv": [36, 58, 95], "metric_histori": 36, "best_step": [36, 70, 95], "last_step": [36, 95], "criterion": 36, "9": [37, 47, 49, 57, 62, 118, 165, 166, 192, 196, 218], "gain_learning_r": 37, "scale_learning_r": 37, "001": [37, 39, 75, 165], "initial_gain": 37, "min_gain": 37, "max_gain": 37, "initial_scal": 37, "min_scal": 37, "max_scal": 37, "use_direct": 37, "use_sign": 37, "gd": 37, "lr_scale": 37, "rule": [37, 82, 85], "mu": 37, "unnorm": [37, 57, 59, 110], "kw97": 37, "tba": 37, "kivinen": 37, "warmuth": 37, "descent": [37, 147], "1997": 37, "demonstr": [38, 84], "02644": 38, "deep": [38, 43, 49, 58, 69], "spin": 38, "hope": [38, 103], "meena2": 38, "unifi": 38, "framework": [38, 55, 82, 113], "_calculate_prob": 38, "alpha": [38, 62, 70, 82, 110], "entmax_support": 38, "n_iter": 38, "ensure_sum_on": 38, "entmax_loss": 38, "valerii": 39, "likhosherstov": 39, "next_se": 39, "current_se": 39, "create_projection_matrix": 39, "nb_random_project": 39, "orthogon": 39, "chi": 39, "latter": [39, 57, 58, 178], "dimension": [39, 45, 134], "gaussian": [39, 82, 99], "covari": 39, "renorm": [39, 194], "relu_kernel_transform": 39, "is_queri": 39, "projection_matrix": 39, "numerical_stabil": 39, "oor": 39, "stand": [39, 150, 151], "pairwis": [39, 178, 184], "softmax_kernel_transform": 39, "cossim_kernel_transform": 39, "cossim": 39, "co": [39, 57, 178, 182], "noncausal_numer": 39, "noncaus": 39, "av": 39, "query_prim": 39, "key_prim": 39, "noncausal_denomin": 39, "causal_numer": 39, "a_": 39, "causal_denomin": 39, "chunked_causal_numerator_func": 39, "chunked_causal_numerator_grad": 39, "res_grad": 39, "chunked_causal_numer": 39, "chunked_causal_denominator_func": 39, "chunked_causal_denominator_grad": 39, "chunked_causal_denomin": 39, "kernel_transform": 39, "use_chunked_caus": 39, "faster": [39, 57, 61, 82, 90, 103, 194, 221], "flat": [40, 69, 82, 170], "beam_siz": [40, 70, 194], "query_s": 40, "key_siz": [40, 46], "buf_siz": 40, "dec_callback": 40, "tgt_id": [40, 45, 46, 59, 70, 170], "tgt_segment_id": [40, 45, 46, 70, 170], "tgt_po": [40, 45], "tgt_mask": [40, 45, 46], "dec_stat": [40, 45], "tgt_semgent_id": 40, "max_len": [40, 45, 46, 47, 138, 170], "einsum_i32": 40, "update_nbest": 40, "nbest_hyp": 40, "cur_hyp": 40, "nbest": 40, "flat_beam_search": [40, 47], "bos_id": 40, "eos_id": [40, 55, 70, 82, 109, 135, 138], "length_norm_alpha": 40, "beam_gap": 40, "top_k_fn": 40, "top_k": [40, 82], "prefix_len": [40, 47], "ext_siz": 40, "nbest_siz": 40, "prefix_max": 40, "extens": [40, 52, 69, 70], "vlaue": 40, "loop_var": [40, 117], "setallowgenericinputv2ineag": 41, "isgenericinputv2allwedineag": 41, "_parseprocessor": 41, "processor": [41, 208], "genericinput": [41, 115], "parserecord": 41, "feature_map": 41, "parse_single_exampl": 41, "field1": 41, "field2": 41, "bucketing_kei": 41, "pure": [41, 82, 139], "genericinputv2cr": 41, "passs": 41, "genericinputv2getnext": 41, "out_typ": 41, "output_tmpl": 41, "generic_input_v2_cr": 41, "seen": [41, 63, 101], "replicatedgenericinput": 41, "replica_device_fn": 41, "replic": [41, 47, 48, 57], "giant": 42, "1811": 42, "06965": 42, "gpipetransformerlm": [42, 160], "billion": [42, 163], "word": [42, 57, 59, 64, 70, 96, 115, 121, 136, 147, 150, 151, 160, 163, 196, 208, 211, 218], "one_billion_wd": [42, 158, 162], "onebwdsgpipetransform": 42, "classif": [42, 57, 63, 153, 156], "getoverwriteglobalstep": 42, "setoverwriteglobalstep": 42, "generatestepseedpair": [42, 82], "unused_global_step": 42, "op_se": [42, 82], "cellfnfpropopreplacementwrapp": 42, "hack": [42, 64, 82], "unwant": [42, 82], "featureextractionlay": 42, "extrac": 42, "capabl": [42, 90], "endpoint": [42, 82], "huangyp": [42, 79], "partitionsequentiallay": 42, "routin": [42, 82], "strive": 42, "roughli": [42, 86, 127, 194], "seqlay": 42, "round": [42, 53, 85], "robin": [42, 53], "cell": [42, 61, 67, 81, 82, 85, 86, 90, 91, 105, 192], "cell_tpl": 42, "among": [42, 70, 82, 151, 178], "feature_height": 42, "feature_width": 42, "pipelininglay": [42, 59], "_calculateoutputshap": 42, "input_shap": [42, 48, 90, 137], "calcuat": 42, "recov": [42, 57, 82], "stackedrecurr": [42, 86], "_get_state_dtyp": 42, "_get_input_shap": 42, "sign": [43, 85], "emit": [43, 55, 57, 70, 104, 134, 194], "At": [43, 47, 57, 103], "backpropag": [43, 89], "setloss": 43, "ratio": [43, 47, 70, 99, 110, 192, 194, 196, 198], "multitask": [43, 57, 58, 68, 79], "neurip": 43, "2020": 43, "06808": 43, "leak_ratio": 43, "clearli": 43, "unchang": [43, 47, 70, 82, 134, 188, 194], "sometim": [44, 57, 86], "benefit": 44, "sophist": 44, "surgeri": 44, "2001": [44, 58], "06782": 44, "gradnorm": 44, "1711": [44, 95, 196], "02257": 44, "gradientcombin": 44, "losses_and_gradi": 44, "loss_and_grad": 44, "loss_metr": 44, "xla_shard": [45, 47, 48], "_toint32": 45, "moebuild": 45, "densespars": 45, "introduc": [45, 82], "enc": [45, 226], "encoderlayerstack": 45, "selfattent": [45, 97], "self_attent": 45, "densereludens": 45, "dense_relu_dens": 45, "dec": [45, 47], "decoderlayerstack": [45, 47], "decselfattent": 45, "dec_self_attent": 45, "decencattent": 45, "dec_enc_attent": 45, "ultim": 45, "encoderlay": 45, "decoderlay": 45, "natur": [45, 85], "24": [45, 163, 165, 166], "segment_po": [45, 47, 196], "subseg": 45, "encoder_segment_id": 45, "appropri": [45, 49, 79, 82, 85, 115, 185, 223], "univers": 45, "layerstack": 45, "xlashardingbuild": 45, "lepikhin": [45, 47], "_device_mesh": 45, "_model_dim_reshape_seg": 45, "_adjustmsplit": 45, "m_dim": 45, "adjust": [45, 47, 60, 75, 82, 85, 90, 95, 99, 161, 194], "model_dim_reshape_seg": [45, 47, 165, 166], "_adjustmsplitbynam": 45, "p_split_nam": 45, "_onehotencod": 45, "shared_var_collection_suffix": 45, "shardedweightparam": [45, 47], "_shardedvaron1ddevicearrai": 45, "_embeddingweight": 45, "vocab_dim": 45, "w_mesh_split": 45, "_getropefn": 45, "enable_rop": 45, "rope_emb_max_timescal": 45, "rotari": [45, 57], "rope": 45, "timescal": [45, 57], "sharedembsoftmax": 45, "logits_abs_max": 45, "z_loss_coef": 45, "0001": [45, 62, 113], "use_tgt_labels_size_as_loss_denomin": 45, "softmaxweight": 45, "_encoderlayerinmapkei": 45, "sub_lay": 45, "use_repeat_lay": [45, 165, 166], "spmd_pipeline_stag": 45, "spmd_pipeline_microbatch": 45, "clean": [45, 86], "layer_000": 45, "wo": 45, "layer_001": 45, "shardabl": 45, "microbatch": [45, 47], "conv_kernel_s": 45, "norm_typ": 45, "norm_polici": 45, "normalz": 45, "_decoderlayerinmapkei": 45, "start_layer_id": 45, "has_final_lay": 45, "per_layer_var": 45, "shardablepipelin": 45, "layerwiseshardablepipelinedlay": [45, 47], "_layerstack": 45, "imap_kei": 45, "layer_fn": 45, "final_norm_typ": 45, "_densereludenseweight": 45, "wi_mesh_split": 45, "wo_mesh_split": 45, "use_bia": 45, "_densereludenseweightsgatedgelu": 45, "densereludenseg": 45, "densereludensegatedgelu": 45, "densereludensegatedsilu": 45, "scalar_aux_loss": 45, "attention_key_value_dim": [45, 165, 166], "_computeattenoutput": 45, "_encnotvis": 45, "decoder_segment_id": 45, "w_qkv_mhd_mesh_split": 45, "wo_hdm_mesh_split": 45, "transformerencod": [45, 195], "_decnotvis": 45, "_deccomputebiasgraphedg": 45, "edg": [45, 86], "attenion": 45, "transformerdecod": [45, 194], "qkv": 45, "weigtht": 45, "decmultidconvheadattent": 45, "_relativepositionbucket": 45, "relative_posit": 45, "bidirect": [45, 91], "_addrelativebia": 45, "query_segment_po": 45, "key_segment_po": 45, "relative_bias_weight": 45, "_encoderaddrelativebia": 45, "selfattentionrelativebia": 45, "decselfattentionrelativebia": 45, "_relativeattentionbiasweight": 45, "32": [45, 92, 163, 165, 166], "meena": 45, "64b": 45, "relative_bucket": 45, "decmultidconvheadattentionrelativebia": 45, "primer": 45, "dconv": 45, "rb": 45, "_zero_aux_loss": 45, "causaldepthwiseconv": 45, "depthwiseconvautoregress": 45, "mesh_tensorflow": 45, "sublayer_depthwise_conv_autoregress": 45, "sum_k": 45, "roll": 45, "_lnnoscal": 45, "_lnconv": 45, "_lnintern": 45, "ln_weight_reshap": 45, "_trueln": 45, "_jaxreplicaln": 45, "jax": 45, "_pn": 45, "_ident": 45, "_attentionweight": 45, "_computeqkv": 45, "_computeqkvcombin": 45, "_top2gatingweight": 45, "_computeg": 45, "_shardedfeedforwardnetworksweight": 45, "net": [45, 58, 86], "_feedforwardnetworksapplyg": 45, "_shardedmoepositionwisefeedforwardnetwork": 45, "_attentionst": 45, "_overrid": [45, 47], "_softmax": 45, "dec_out": [45, 198], "tgt": [45, 57, 70, 134, 170, 196, 198, 208], "label_smooth": [45, 165, 166], "smoothedsoftmax": 45, "smooth": [45, 57, 192, 194, 198], "densebuild": [45, 165, 166], "desns": 45, "layr": 45, "_reshapedmodeldim": 45, "_reshapem": 45, "_einsumwithmodeldim": 45, "nm": [45, 47], "gsm": [45, 47], "me": [45, 47], "gse": [45, 47], "16": [45, 47, 70, 85, 117, 137, 147, 160, 163, 165, 166, 174, 192, 202, 218], "rewritten": [45, 47, 57], "gsnol": 45, "nole": 45, "contract": [45, 47], "maybe_modified_equ": [45, 47], "einsumwithmodeldim": [45, 47], "_meshsplit": 45, "_attention_output_hdm_w_split": 45, "paralleldecselfattentionrelativebiasffn": 45, "hidden_dim_reshape_seg": [45, 166], "ffnwithconv": 45, "_computeqkvh": 45, "_computecombinedoutput": 45, "o1": 45, "o2": 45, "wo1": 45, "wo2": 45, "_moeweightsgatedgelu": 45, "_shardedmoeglu": 45, "moegat": 45, "recurrentdensebuilderparalleldecod": 45, "recurrentdensebuild": 45, "micro": [45, 75, 160], "proj_weight_hdim": 45, "d_kv": 45, "wi_o": 45, "1024": [45, 160, 163, 165, 166], "120": [45, 165], "16k": 45, "64k": 45, "4byte": 45, "491gb": 45, "exceed": [45, 70, 196], "memoeri": 45, "64": [45, 78, 165, 166], "8x": 45, "_num_input_proj_weight": 45, "_num_output_proj_weight": 45, "_ffw_var_h_dim_s": 45, "_atten_q_var_head": 45, "_atten_kv_var_head": 45, "_decoderlayerinputprojweight": 45, "_decoderlayeroutputprojweight": 45, "unitransform": 45, "transformermodel": [45, 198], "_getdecoderlayerstackparam": 45, "layer_type_dict": 45, "_computedecoderinput": 45, "read_vars_from_theta": 45, "_computenonpad": 45, "_computesoftlabel": 45, "computepertokenloss": 45, "_top_k_fn": 45, "decodeid": 45, "_splitdecoderoutputandsoftmax": 45, "all_dec_output": 45, "_flatbeamsearchcallback": 45, "tunableunitransform": 45, "tunabl": [45, 82], "berttransform": [45, 166], "gspmd": 45, "_computeencinput": 45, "mlm_logit": 45, "masked_po": [45, 159], "preload_zero": 46, "preload_unpack": 46, "get_zero_batch": 46, "return_tgt_mask": 46, "tgt_segment_po": [46, 70, 170], "tgt_label": [46, 70, 170], "tgt_sample_temperatur": 46, "infinite_repeat": 46, "body_fn": 46, "infeed_queu": 46, "infinit": 46, "daemon": 46, "closur": [46, 51], "gsharddecod": [46, 170], "worker_job_nam": 46, "prefix_max_len": 46, "is_cloud_tpu_nod": [46, 170], "attr": [46, 69, 70, 82], "addresss": 46, "node": [46, 51, 69, 77, 81, 82, 128, 135, 160, 170], "compile_op": 46, "compil": [46, 47, 48, 57, 79, 93, 117], "init_vars_op": 46, "init": [46, 47, 82, 91, 109, 118, 133], "infeed_op": 46, "infeed_arg": 46, "placehold": [46, 82, 113, 161], "outfeed_op": 46, "poll": 46, "decode_loop": 46, "num_batch": [46, 170], "spm": [46, 48, 96], "sentencepiecemodel": 46, "load_spm": 46, "reset_tpu_clust": 46, "get_sess": 46, "_no_opt_sess_cfg": 46, "reset_sess": 46, "run_init_sequ": 46, "_configure_cluster_param": 46, "tpu_cor": [46, 188], "cpu_host": 46, "_start_heartbeat": 46, "heartbeat": 46, "_config_infe": 46, "device_assign": 46, "use_partitioned_infeed_queu": 46, "_init_tpu": 46, "device_order_mod": 46, "init_graph": 46, "_config_outfe": 46, "infeed_batch": 46, "varlay": 47, "_get_var_from_collect": 47, "vp": 47, "xla": [47, 48, 57, 75, 79], "shardedvarlay": 47, "num_stag": 47, "num_microbatch": 47, "achiev": [47, 68, 120, 147], "manual": [47, 48, 120, 217], "stage_parallel_bodi": 47, "vectorized_map": 47, "convers": [47, 57, 60, 70, 120, 196], "variableshapeprefixcontext": [47, 82], "single_stage_bodi": 47, "shard_stages_1d": 47, "fail": [47, 49, 70, 82, 151], "per_stage_var": 47, "pipeline_stage_mesh_dim": 47, "reliabl": 47, "reshard": 47, "idea": 47, "commun": [47, 98], "shown": 47, "padded_input": 47, "expand_dim": 47, "shifted_st": 47, "in_mask": 47, "stages_in": 47, "fpropfn": 47, "padded_per_stage_st": 47, "bubbl": 47, "padmicrobatch": 47, "thie": 47, "circular_repeat": 47, "expand": [47, 79, 82, 85, 178, 190], "circular_repeat_000_stage_0": 47, "circular_repeat_000_stage_1": 47, "circular_repeat_000_stage_2": 47, "circular_repeat_000_stage_3": 47, "circular_repeat_001_stage_0": 47, "circular_repeat_001_stage_1": 47, "circular_repeat_001_stage_2": 47, "circular_repeat_001_stage_3": 47, "goe": [47, 122], "rotat": [47, 188], "interleav": [47, 79], "pad_as_abov": 47, "rotated_st": 47, "circularrepeatit": 47, "_findperstagevarshardingdim": 47, "bodyfprop": 47, "fn_name": 47, "kwargs_no_batch": 47, "bodyfpropnomicrobatch": 47, "_microbatchandrepeatid": 47, "_bodyfpropintern": 47, "layer_theta": [47, 128], "repeat_idx": 47, "stage_idx": 47, "per_layer_st": 47, "_padmicrobatchesintern": 47, "pad_stag": 47, "statelay": 47, "newstat": 47, "_step": 47, "travers": [47, 49, 69, 128], "theta0": 47, "updatetheta": 47, "updatest": 47, "beam_search_tpu_help": 47, "multiheadattentionstatelay": 47, "x_full": 47, "_use_flat_beam_search": 47, "use_xla_dynamic_update_slic": 47, "conv1dstatelay": 47, "conv1d": 47, "2021": [47, 106, 180], "max_siz": 47, "kernel_width": 47, "underli": [47, 57, 82, 174], "layout": [47, 52, 76], "_processprefixorsuffix": 47, "suffix": [47, 85], "properli": [47, 51, 82, 86], "overridelay": 47, "my_lay": 47, "out_with_overrid": 47, "clear": [47, 60, 69, 77], "reshapeinputlay": 47, "unused_theta": 47, "sharedembeddingsoftmaxlay": 47, "embemd": 47, "lookup": [47, 57, 58, 81, 104, 116, 194], "causaldepthwiseconv1dlay": 47, "_doconv": 47, "channel_s": 47, "rank4": 47, "top2gatingonlogit": 47, "experts_dim": 47, "expert_capacity_dim": 47, "use_xla_shard": 47, "second_expert_polici": 47, "second_expert_threshold": 47, "legacy_mtf_behavior": 47, "capacity_factor": 47, "mask_dtyp": 47, "dispatch": 47, "cheat": 47, "sheet": 47, "group_dim": 47, "group_size_dim": 47, "capac": 47, "batch_dim": [47, 59, 82], "sequence_length_dim": 47, "local_dispatch": 47, "sm": 47, "se": 47, "minibatch": 47, "datatyp": [47, 85], "greedili": 47, "ii": 47, "iii": 47, "iz": 47, "best": [47, 70, 198], "proport": [47, 70, 82, 87], "mtf": 47, "increas": [47, 57, 85, 95, 178], "big": [47, 192], "problemat": 47, "rid": 47, "combine_tensor": 47, "dispatch_tensor": 47, "scatter": [47, 76, 90, 94], "hashgatingonlogit": 47, "expert_id": 47, "hash": [47, 82], "tokenshufflingonlogit": 47, "advantag": [47, 86], "ec": 47, "tokenshufflingonlogitsv2": 47, "nonpad": 47, "optimaltransportonlogit": 47, "computeg": 47, "gating_func": 47, "top_2": 47, "gating_logits_dtyp": 47, "token_shuffl": 47, "go": 47, "decid": [47, 82, 103, 117], "hashgat": 47, "karg": 47, "top2gat": 47, "tokenshuffleg": 47, "tokenshufflegatingv2": 47, "optimaltransportg": 47, "feedforwardnetworksapplyg": 47, "reshaped_input": 47, "wi_split": 47, "wo_split": 47, "bi_split": 47, "bo_split": 47, "dropout_r": [47, 166], "gsm_split": 47, "egcm_split": 47, "gecm_split": 47, "gsec_split": 47, "gecs_split": 47, "gec_split": 47, "eah_split": 47, "eam_split": 47, "use_glu": 47, "nd": 47, "gec": 47, "eam": 47, "gatherk": 47, "selected_po": 47, "topk": [47, 82, 134, 135], "largest": [47, 75, 194], "value_2d": 47, "11": [47, 165, 166], "13": [47, 118, 147, 165, 166], "15": [47, 147, 150, 165, 166], "17": [47, 70, 165, 166], "19": [47, 165, 166], "21": [47, 165, 166], "23": [47, 165, 166, 170], "25": [47, 165, 166], "27": [47, 165, 166], "29": [47, 70, 165, 166], "31": [47, 82, 165, 166], "33": [47, 165, 166], "35": [47, 165, 166, 218], "37": [47, 165, 166], "39": [47, 165, 166], "getsentenceembed": 47, "float64": [47, 82], "41258181": 47, "61071571": 47, "63777673": 47, "65571443": 47, "54297766": 47, "10288261": 47, "8577837": 47, "81915847": 47, "61996602": 47, "46897136": 47, "92662692": 47, "32942232": 47, "60162383": 47, "3385829": 47, "3408632": 47, "40774807": 47, "86139635": 47, "00927162": 47, "56126334": 47, "51748817": 47, "07791397": 47, "06595223": 47, "95529216": 47, "34458149": 47, "1238971": 47, "49897169": 47, "25216722": 47, "11221774": 47, "50284604": 47, "84106974": 47, "sentence_embed": 47, "sentencetop2g": 47, "embedding_typ": 47, "wise": [47, 57, 99, 184], "tasktop2g": 47, "task_embed": 47, "_einsumeqwithmodeldim": 47, "gsnom": 47, "nome": 47, "split_dimens": 48, "use_sharding_op": 48, "gen_xla_op": 48, "hyoukle": 48, "outcom": 48, "lost": 48, "past": [48, 58, 95], "due": [48, 57, 82, 116], "todai": 48, "condition": 48, "getmeshsplitshard": 48, "mesh_split_shard": 48, "unspecified_dim": 48, "meshsplitdimprefixcontext": 48, "prefix_mesh_dim": 48, "getmeshsplitdimprefixcontext": 48, "manualmeshdimcontext": 48, "mesh_dim": 48, "zigzagorderondevicemesh": 48, "zigzag_mesh_dim": 48, "permut": [48, 196], "zigzag": 48, "getnonpod2dmesh": 48, "device_mesh_shap": [48, 165, 166], "physical_mesh_shap": 48, "pod": 48, "tensorshardingspec": 48, "uneven_pad": 48, "fromfullshap": 48, "full_shap": 48, "tile": [48, 57], "uneven": 48, "applytotensor": 48, "applytovari": 48, "variablev1": [48, 185], "shardshap": 48, "manualtoautopartit": 48, "autotomanualpartit": 48, "toxlaopshard": 48, "opshard": 48, "fromxlaopshard": 48, "op_sharding_proto": 48, "addleadingdim": 48, "num_dim": 48, "removeleadingdim": 48, "removedim": 48, "replicatedspec": 48, "is_repl": 48, "mesh_dim_to_tensor_dim_map": 48, "getvarshard": 48, "loadspm": 48, "model_fil": 48, "sentencepieceprocessor": 48, "_quotestr": 49, "quot": 49, "escap": [49, 75], "lite": 49, "enclos": 49, "quotat": 49, "mark": [49, 82, 150, 151, 178, 182], "doubl": [49, 85], "backslash": 49, "newlin": 49, "verbatim": 49, "multilin": 49, "_unquotestr": 49, "_endswithterminalquot": 49, "quote_char": 49, "termin": [49, 62, 70, 86], "_isnamedtupl": 49, "42": [49, 69, 165, 166, 170, 177, 181], "hi": 49, "_sorteddict": 49, "__repr__": [49, 69], "_param": [49, 82], "default_valu": 49, "tostr": 49, "nested_depth": 49, "getdefault": 49, "copyfieldsto": 49, "from_p": 49, "to_p": 49, "ignore_unknown_kei": 49, "destin": [49, 99], "_tostr": [49, 69], "_similarkei": 49, "_keyerrorstr": 49, "paramst": 49, "_copyto": 49, "mergecommonkeysfrom": 49, "lowercas": [49, 208], "underscor": [49, 69], "freez": [49, 51], "immut": 49, "isimmut": 49, "_getnest": 49, "navig": 49, "ban": 49, "altogeth": [49, 187], "delet": [49, 93, 136, 150, 151], "iterparam": 49, "getkei": 49, "toproto": 49, "themselv": 49, "fingerprint": 49, "totext": [49, 219], "fromproto": 49, "param_pb": 49, "visit_fn": 49, "enter_fn": 49, "exit_fn": 49, "dataclass": 49, "shouldn": 49, "never": [49, 63, 70, 79, 86, 93], "subkei": 49, "abl": [49, 70, 85], "include_typ": 49, "liter": [49, 69], "trivial": [49, 140, 160], "whichev": 49, "charact": [49, 70, 115, 208, 218], "fromtext": 49, "type_overrid": 49, "wrong": [49, 82, 122, 182], "totextwithtyp": 49, "fromtextwithtyp": 49, "textdiff": 49, "instantiableparamsclst": 49, "myobject": 49, "obj": [49, 145], "anyth": [49, 101, 122, 190], "parameter": [49, 95, 160], "aren": [49, 178, 182], "realli": [49, 160, 221], "lock": 49, "obj_a": 49, "obj_b": 49, "_b": [50, 52, 71, 72, 73, 205], "cmessag": [50, 52, 71, 72, 73, 205], "descriptor": [50, 52, 71, 72, 73, 82, 205], "googl": [50, 52, 71, 72, 73, 121, 185, 205], "pyext": [50, 52, 71, 72, 73, 205], "_messag": [50, 52, 71, 72, 73, 205], "messagedescriptor": [50, 52, 71, 72, 73, 205], "itemsentri": 50, "hyperparamrep": 50, "hyperparamvalu": 50, "bool_val": 50, "dict_val": 50, "dtype_v": 50, "enum_v": 50, "float_val": 50, "int_val": 50, "list_val": 50, "named_tuple_v": 50, "param_v": 50, "proto_v": 50, "string_repr_v": 50, "string_val": 50, "symbolic_v": 50, "tuple_v": 50, "type_v": 50, "protov": 50, "enumv": 50, "namedtuplev": 50, "inferencedeviceopt": 51, "retain_device_plac": 51, "var_opt": 51, "gen_init_op": 51, "dtype_overrid": 51, "fprop_dtype_overrid": 51, "guaranteeconstgett": 51, "next_creat": [51, 82], "constguaranteescop": 51, "noconstguaranteescop": 51, "disallow": [51, 194], "const": [51, 82, 90], "_dummyscop": 51, "_getvarnam": 51, "_makevariabledictionari": 51, "istpu": 51, "device_opt": 51, "shouldforcebfloat16forweightsandactiv": 51, "shouldforcebfloat16foractiv": 51, "convertsubgraphdicttoproto": 51, "subgraphs_dict": 51, "getoutputopnam": 51, "inference_graph_proto": 51, "preserve_colocation_nod": 51, "preserve_saver_restore_nod": 51, "preserve_extra_op": 51, "saver_def": [51, 52], "_paramexist": 51, "param_obj": 51, "param_nam": [51, 79], "_freezegraphfromcheckpoint": 51, "output_op_nam": 51, "graphdef": [51, 70], "_freezedefault": 51, "inferencegraphexport": [51, 77], "model_cfg": 51, "inference_fn_nam": 51, "inference_fn_kwarg": 51, "freeze_checkpoint": 51, "freeze_default": 51, "export_path": 51, "subgraph_filt": 51, "disable_packed_input": 51, "prune_graph": [51, 227], "export_graph_collect": 51, "piecewis": [51, 82, 95, 99, 110], "enable_assert": [51, 83], "pin_vars_to_cpu": 51, "getparam": [51, 77, 126, 127], "modelnam": 51, "serv": [51, 57], "ascii": [51, 70], "_setclusterparam": 51, "_devicesupportsfreez": 51, "collectiondefentri": 52, "feedfetchmeta": 52, "data_typ": 52, "dispatch_stride_axi": 52, "quantized_max_const": 52, "quantized_max_tensor": 52, "quantized_min_const": 52, "quantized_min_tensor": 52, "quantized_num_bit": 52, "feedsentri": 52, "feedsmetaentri": 52, "fetchesentri": 52, "fetchesmetaentri": 52, "feeds_meta": 52, "fetches_meta": 52, "subgraphmeta": 52, "subgraphsentri": 52, "asset_file_def": 52, "collection_def": 52, "graph_def": [52, 77], "hyperparamet": [52, 81, 82, 85, 110], "computesplit": 53, "floor": [53, 82], "remaind": 53, "splittensor": 53, "evenli": [53, 70, 82], "dimenion": 53, "splitdictoftensor": 53, "t_dict": 53, "input_param": 54, "kermit": [55, 194, 198], "1906": [55, 194, 198], "01604": [55, 194, 198], "1902": [55, 57, 194, 198], "03249": [55, 194, 198], "sequencetrimlasttoken": 55, "trim": [55, 82, 107], "x_len_max": 55, "sequenceappendtoken": 55, "sequenceconcat": 55, "y_pad": 55, "y_len_max": 55, "symbolinsertionlay": 55, "rollin": 55, "canva": [55, 198], "force_sample_last_token": 55, "groundtruth": [55, 63], "english": [55, 201, 202, 204], "time_dim": [55, 194, 198], "rollin_polici": [55, 198], "c_dim": [55, 198], "canvas_indic": [55, 198], "canvas_pad": [55, 198], "target_indic": [55, 194, 198], "num_target": 55, "gather_nd": [55, 194, 198], "target_weight": [55, 82, 134, 194, 196, 198], "_isdefinableparamet": 56, "kind": 56, "positional_or_keyword": 56, "keyword_onli": 56, "var_posit": 56, "var_keyword": 56, "positional_onli": 56, "_extractparamet": 56, "defineparam": 56, "statement": [56, 82], "yourself": 56, "_makearg": 56, "callwithparam": 56, "constructwithparam": 56, "deconvlay": 57, "deconv": 57, "transpos": [57, 91, 107, 190], "convtransposelay": 57, "simpler": [57, 70, 79, 93], "deconvolut": 57, "height_strid": 57, "width_strid": 57, "identitylay": 57, "baseconv2dlay": 57, "filter_output_shap": 57, "arithmet": [57, 63, 82, 85], "_is_bn_fold": 57, "fold": 57, "filter_w": 57, "data_format": 57, "lower": [57, 75, 76, 115, 150], "depthwise_conv2d": 57, "convolution_lambda": 57, "folded_bn_pad": 57, "cast_dtyp": 57, "fuse": [57, 61, 140], "sens": [57, 85, 104, 124, 178, 227], "cnn": [57, 137, 153], "_comput": 57, "conv_pad": 57, "prop": [57, 90], "_computeconvlast": 57, "convnn2dlay": 57, "atrou": 57, "space_to_batch": 57, "batch_to_spac": 57, "tflite": [57, 82], "convlay": 57, "separableconv2dlay": 57, "term": [57, 82, 194], "deleg": [57, 82, 101, 105, 145], "cin": 57, "cout": 57, "pointwis": 57, "reconfigur": 57, "projectionlay": 57, "_getblockedmatmulinputoutputmultipli": 57, "_getblockedweightmatrix": 57, "_getblockdiagonalinitscal": 57, "dense_shap": 57, "output_qact_nam": 57, "qact": [57, 85, 90], "quantiz": [57, 82, 84, 85, 90], "fpropfullsequ": [57, 91, 195], "weight_norm": 57, "batch_norm": 57, "_applyprojectionkernel": 57, "with_activ": 57, "quant": 57, "mix_kernel": [57, 82], "engin": [57, 85], "esp": [57, 151], "recogn": [57, 64], "_applyactivationfunct": 57, "fclayer": 57, "feedforwardnet": 57, "fpropalllay": 57, "hidden_layer_dim": 57, "stackingovertim": 57, "learnabl": 57, "windows": 57, "window_s": 57, "_applystack": 57, "pad_valu": [57, 91], "stacking_window_length": 57, "unstack": [57, 99], "invert": 57, "this_lay": 57, "reconstruct": 57, "longer": [57, 77, 82, 150, 196], "shorter": [57, 70], "rnn_dim": [57, 160], "rnn_out": [57, 134], "rnn": [57, 61, 67, 70, 82, 85, 86, 90, 91, 103, 105, 134, 137, 160, 194, 195], "back_projected_rnn_out": 57, "padortrimto": [57, 82], "getshap": [57, 82], "respons": [57, 91, 139, 178], "feature_dim": [57, 137, 190], "poolinglay": 57, "preced": [57, 108], "blurpoollay": 57, "blurpool": 57, "11486": 57, "blur": 57, "subsampl": [57, 139], "afterward": 57, "2x1": 57, "2x2": [57, 118], "singleshardembeddinglay": 57, "medium": 57, "50k": 57, "unif": 57, "embeddinglay": [57, 81, 104], "simpleembeddinglay": 57, "cleanup": [57, 79], "nmt": [57, 196, 198, 201, 202, 204, 218], "tt": 57, "deeprank": 57, "changetosimpleembed": 57, "switch": [57, 82, 160], "simpleembed": 57, "lose": 57, "scale_by_sqrt_dim": 57, "1k": 57, "emblookupdefaulttheta": 57, "emblookup": [57, 58, 104, 116], "min_params_per_shard": 57, "262144": [57, 166], "toco": 57, "use_matmul": 57, "use_gath": 57, "neither": [57, 178], "comparison": [57, 196], "_fpropimpl": 57, "ids_vec": 57, "emblookupdefaultthetaoncpu": 57, "_flatfprop": 57, "flatten": [57, 69, 82, 107, 113, 178, 188, 190], "einsumembeddinglay": 57, "onehotembeddinglay": 57, "hot": [57, 82, 144, 178, 195], "uncertainti": [57, 192], "positionalembeddinglay": 57, "tensor2tensor": 57, "common_attent": 57, "_posembeddingsfromposit": 57, "fpropwithposit": 57, "embedding_dim": [57, 104, 116, 163, 192], "positionanl": 57, "precursor": 57, "possibl": [57, 70, 82, 93, 101], "sin": 57, "express": [57, 139], "geometr": [57, 96], "min_timescal": 57, "max_timescal": 57, "position_tensor": 57, "learnablepositionalembeddinglay": 57, "relativepositionalembeddinglay": 57, "relative_dist": 57, "sinusoidalpositionalembeddinglay": 57, "tune": [57, 76, 181, 185], "blog": 57, "ron": 57, "colab": 57, "kazemnejad": 57, "transformer_architecture_positional_encod": 57, "softmaxlay": [57, 160], "wm_transpos": 57, "wm": [57, 90], "denseweight": 57, "xentlossfromlogit": 57, "xent": [57, 134, 160, 194], "xentloss": 57, "_fprop2d": 57, "class_weight": [57, 59, 160], "class_id": [57, 59, 160], "class_prob": [57, 59, 160], "num_class": [57, 59, 63, 82, 134, 178], "membership": [57, 59, 160], "per_example_argmax": [57, 59], "argmax": [57, 59, 82], "per_example_x": [57, 59], "per_example_weight": [57, 59], "total_x": [57, 59], "total_weight": [57, 59, 63, 82], "avg_xent": [57, 59], "total_loss": [57, 59], "simplefullsoftmax": [57, 59], "somewhat": 57, "_getinput": [57, 106], "_logitsusingconcatenatedweightshelp": 57, "_logitsusingconcatenatedweight": 57, "simplelogit": 57, "_xentlossbychunk": 57, "simplefullsigmoidcrossentropi": 57, "focalfullsoftmax": 57, "focal": [57, 82], "1708": [57, 82], "02002": [57, 82], "scone": 57, "2205": 57, "00704": 57, "einsumsoftmax": 57, "sharedsoftmaxlay": 57, "ty": 57, "singleshardfullsoftmax": 57, "xentlossbychunk": 57, "singleshardsharedembeddingsoftmax": 57, "convsoftmax": 57, "1x1": 57, "noise_shap": [57, 82], "deterministicdropoutlay": 57, "1607": [57, 90], "06450": [57, 90], "_getscaleandbia": 57, "reshapedlayernorm": 57, "resp": [57, 58], "augment": [57, 58, 86, 90, 99, 100, 133, 187], "categoricallayernorm": 57, "class_index": 57, "_biasvarnam": 57, "_scalevarnam": 57, "convsetlay": 57, "time_mod": 57, "frequency_mod": 57, "out_channel_1": 57, "out_channel_2": 57, "out_channel_i": 57, "localizedlabelsmooth": 57, "1612": 57, "02695": 57, "nearbi": 57, "strong": 57, "target_label": [57, 134, 194, 196], "target_id": [57, 59, 70, 115, 134, 194, 196], "1hot": 57, "neighborhood": 57, "uniformlabelsmooth": 57, "confid": 57, "1512": 57, "00567": 57, "highwayskiplay": 57, "highwai": 57, "open": 57, "srivastava": 57, "1505": 57, "00387v2": 57, "transformed_x": 57, "layer_out": 57, "gatinglay": 57, "w_1": 57, "w_2": 57, "gradnormtrack": 57, "grad_norm": 57, "has_nan": 57, "avg": [57, 63, 82], "excess": [57, 70, 75], "abort": 57, "weightedsumlay": [57, 59], "gatedaveragelay": 57, "x_1": 57, "x_n": 57, "g_1": 57, "g_n": 57, "gm": 57, "num_nod": 57, "lhuclay": 57, "contribut": [57, 82, 161], "lhuc": 57, "propos": [57, 58, 95], "aclweb": [57, 198], "anthologi": [57, 198], "n18": 57, "2080": 57, "frozen": 57, "residualadapterlay": 57, "nlp": [57, 188], "fine": [57, 76, 85, 178, 181, 182, 185], "bert": [57, 166, 167, 172, 180, 187], "00751": 57, "vanilla": 57, "distinguish": 57, "conv2dflop": 57, "mult": 57, "four": [57, 151], "conv2dlayernopad": 57, "laurenzo": [57, 139], "dedup": 57, "fetchlay": 57, "_returnsinglevalueorlist": 57, "lst": [57, 69, 96], "glulay": 57, "08083": 57, "multitaskadapterbaselay": 57, "multilingu": 57, "domain": [57, 85, 99], "down": [57, 75, 82, 95, 150, 151, 223], "wherea": [57, 188], "multitaskadapterlay": 57, "tbc": 57, "btc": 57, "substanti": 57, "multitaskadaptereinsumlay": 57, "175464137": 57, "cctgatingnetwork": [57, 58], "07106": [57, 58], "condscaleshiftffnlay": 57, "pub": [57, 121], "2018": 57, "statisticalpoolinglay": 57, "deviat": [57, 82, 85], "lshmemoryrankkonehottasklay": 57, "lsh": 57, "proceed": 57, "mlr": 57, "press": 57, "v130": 57, "panigrahy21a": 57, "html": [57, 99, 150, 151], "_computegridlshbucketid": 57, "lshtaskwithmultiplierlay": 57, "multipli": [57, 95, 99], "perframestatisticalpoolinglay": 57, "streamingstep": 57, "order1": 57, "order2": 57, "nframe": 57, "maskedlmdataaugment": 57, "1810": [57, 58], "04805": 57, "new_input": 57, "had": [57, 85], "undergon": 57, "rotarypositionalembeddinglay": 57, "2104": 57, "09864": 57, "jtensor": 57, "stochasticresiduallay": 58, "stocahst": 58, "branch": 58, "convnet": 58, "1603": 58, "09382": 58, "_dropconnect": 58, "surviv": 58, "five": 58, "context_vec": 58, "mask_typ": 58, "ey": 58, "leftward": 58, "gram": [58, 64, 96], "ngram": [58, 64, 70, 96], "mask_ngram_ord": 58, "04589": 58, "_initattent": [58, 134], "eg": [58, 59, 79, 124, 227], "_finishextendstep": 58, "unnormalized_query_vec": 58, "extended_packed_src": 58, "isol": 58, "triplet": 58, "new_stat": [58, 134, 194], "prefix_st": [58, 194], "moefeedforwardlay": 58, "hybridfeedforwardlay": 58, "hybrid": [58, 198], "choosen": 58, "hybrid_p": 58, "fflayer_p": 58, "moe_p": 58, "sub_kei": 58, "hybrid_fflay": 58, "symboltovaluemap": [58, 108], "static_valu": 58, "outputs_mo": 58, "transformershardedmoelay": 58, "ln_input": 58, "moe_output": 58, "drop_output": 58, "upstream": [58, 178], "compon": [58, 70, 135], "reshapedtransformerfeedforwardlay": 58, "transformerfeedforward": 58, "aux_segment_id": [58, 59, 197], "scheme": [58, 59, 82, 90], "source_": [58, 59], "fork": [58, 59, 188], "aux_tim": [58, 59, 197], "aux_batch": [58, 59], "evolvedtransformerencoderbranchedconvslay": 58, "evolv": [58, 59], "portion": [58, 82, 99], "11117": [58, 59], "evolvedtransformerdecoderbranchedconvslay": 58, "evolvedtransformerbaselay": 58, "evolvedtransformerencoderlay": [58, 59], "evolvedtransformerdecoderlay": [58, 59], "stylelay": 58, "style": [58, 85, 90, 151, 176, 185], "styleembfromprob": 58, "feedin": 58, "num_styl": 58, "style_emb": 58, "transformerlayerwithmultitaskadapt": 58, "source_task_id": [58, 59], "cctattentionlay": 58, "cct": 58, "cctfeedforwardlay": 58, "transformerwithcontextlay": 58, "third": [58, 61, 82, 91], "newli": 58, "tertiary_atten": 58, "03581": 58, "tertiary_vec": 58, "tertiary_pad": 58, "tertiary_segment_id": 58, "tertiary_tim": 58, "tertiary_batch": 58, "tertiari": 58, "selfattentivelay": 58, "1703": [58, 90, 134], "03130": 58, "_common_gpipe_transformer_param": 59, "_common_gpipe_transformer_init": 59, "_common_gpipe_transformer_encoder_fprop": 59, "layer_class": 59, "target_segment_id": [59, 194], "transparent_acc": 59, "transparent_acc_help": 59, "target_task_id": 59, "_common_gpipe_transformer_decoder_fprop": 59, "_common_gpipe_transformer_fprop_meta": 59, "gpipetransformerlay": 59, "transformerstack": [59, 97, 195, 197], "gpipeevolvedtransformerencoderlay": 59, "_attentionsetupdeterministicdropout": 59, "tr_atten_tpl": 59, "_transformersetupdeterministicdropout": 59, "transformer_tpl": 59, "et": [59, 180], "gpipeevolvedtransformerdecoderlay": 59, "gpipetransformersoftmaxlay": 59, "gpipetransformerembeddinglay": 59, "getembed": 59, "emb_theta": 59, "pos_emb_theta": 59, "pos_emb": 59, "dropout_theta": 59, "input_id": [59, 78, 91], "input_segment_po": 59, "task_emb_theta": 59, "task_emb": [59, 195], "getencoderembeddingsdefaulttheta": 59, "getdecoderembeddingsdefaulttheta": 59, "source_segment_po": 59, "target_segment_po": 59, "gpipetransformerstack": 59, "getencod": 59, "getdecod": 59, "encoderembedfpropdefaulttheta": 59, "decoderembedfpropdefaulttheta": 59, "tgt_task_id": 59, "encoderfpropdefaulttheta": 59, "source_input": 59, "target_input": 59, "label_weight": 59, "transformer_output": 59, "gpipeevolvedtransformerstack": 59, "evolvedtransformerstack": 59, "deterministicweightslay": 59, "num_sourc": 59, "gpipebatchmajortransformersoftmaxlay": 59, "gpipebatchmajortransformerembeddinglay": 59, "gipe": 59, "disjoint": 60, "getvargrad": 60, "gettrainablevari": [60, 82], "applyposttrainingloop": [60, 75], "trainin": [60, 75], "learningr": 60, "gradient_mask": 60, "gradient_adjust": 60, "loss_nam": 60, "mutat": [60, 187], "var_grad": [60, 75, 82, 161], "_customcomputegradientsfn": 60, "compute_gradients_fn": [60, 82], "computegradi": [60, 75, 82], "_computelossesandgradi": 60, "_getglobalgradscal": 60, "all_grad_norm": 60, "has_nan_or_inf": 60, "inf": [60, 82], "represet": 60, "scalegradi": 60, "final_var_grad": 60, "grad_scal": [60, 82], "_addevalmetr": 60, "extractlearnerfromlegacyparam": 60, "Its": [60, 101, 113, 116], "lstm": [61, 81, 85, 90, 91, 161, 192], "frnn": [61, 91], "lstmcellext": 61, "projectinputsequ": 61, "notabl": 61, "reason": [61, 70, 75, 82, 178], "wm_i": 61, "wm_h": 61, "_mixwithprojectedinput": 61, "_mix": [61, 90], "fpropwithprojectedinput": 61, "proj_input": 61, "reset_mask": [61, 90, 91], "backprop": [61, 82, 86, 90], "lstmcellsimpleext": 61, "lstmcellsimpl": [61, 90, 160], "layernormalizedlstmcellsimpleext": 61, "layernormalizedlstmcellsimpl": [61, 90, 160], "layernormalizedlstmcellleanext": 61, "layernormalizedlstmcelllean": [61, 90], "lstmfrnn": 61, "exploit": 61, "cardin": [61, 91], "inputs_ar": [61, 91], "matrix_square_root": 62, "mat_a": 62, "mat_a_s": 62, "iter_count": 62, "ridge_epsilon": 62, "nichola": 62, "higham": 62, "231": [62, 165], "6b": 62, "citeseerx": 62, "ist": 62, "psu": 62, "edu": [62, 99], "viewdoc": 62, "download": [62, 169, 187, 214], "doi": 62, "8799": 62, "rep": 62, "rep1": 62, "symmetr": [62, 85], "psd": 62, "ridg": 62, "inlined_matrix_inverse_pth_root": 62, "mat_g": 62, "mat_g_siz": 62, "error_toler": 62, "schur": 62, "newton": 62, "invers": [62, 70, 82, 85, 95, 110, 190], "chun": 62, "hua": 62, "guo": 62, "siam": 62, "journal": 62, "analysi": [62, 227], "vol": 62, "28": [62, 165, 166], "No": [62, 70, 82, 89, 101], "pp": 62, "788": 62, "804": 62, "semanticscholar": 62, "0abe": 62, "7f77433cf5908bfe2b79aa91af881da83858": 62, "power": [62, 70], "createscalarsummari": 63, "simple_valu": 63, "tag": [63, 65, 79, 85, 90, 130, 135, 144, 223, 227], "configurablemetr": 63, "averagemetr": 63, "gettotalvalu": 63, "settotalvalu": 63, "total_valu": 63, "gettotalweight": 63, "settotalweight": 63, "uniqueaveragemetr": 63, "mismatch_is_error": 63, "f1metric": 63, "updatetrueposit": 63, "updatefalseposit": 63, "updatefalseneg": 63, "mccmetric": 63, "matthew": 63, "correl": 63, "updatetrueneg": 63, "corpusbleumetr": 63, "corpu": [63, 163, 211, 214, 218], "bleu": [63, 64, 96], "ref_str": [63, 64, 96, 136], "hyp_str": [63, 64, 96, 136], "unsegment": [63, 96], "tpuevalmetr": 63, "max_metr": 63, "256": [63, 165, 166], "hardcod": 63, "setmetr": 63, "metric_dict": 63, "step_arg": 63, "_metric": 63, "initial_valu": [63, 95], "_zip": 63, "finalizemetr": 63, "loop_result": 63, "batch_parallel": 63, "packmetricsvalu": 63, "toaveragemetr": 63, "aucmetr": 63, "roc": 63, "auc": [63, 82], "_precisionatrecal": 63, "recal": [63, 151], "_recallatprecis": 63, "precis": [63, 85, 96, 153, 178], "precisionatrecal": 63, "recall_threshold": 63, "recallatprecis": 63, "precision_threshold": 63, "multiclassaucmetr": 63, "mauc": 63, "multiclass": 63, "multilabel": 63, "perspect": [63, 85], "pr": [63, 82], "curv": [63, 76, 82], "teh": 63, "correlationmetr": 63, "pearson": 63, "pred": [63, 77], "averagekeyedcorrelationmetr": 63, "bypass_nan": 63, "samplingmetr": 63, "_createsummari": 63, "decoded_output": 63, "mlperf": [64, 65, 66, 70, 159, 166, 196], "is_unicod": 64, "to_unicod": 64, "ignore_error": 64, "native_to_unicod": 64, "_get_ngram": 64, "max_ord": 64, "compute_bleu": 64, "reference_corpu": 64, "translation_corpu": 64, "use_bp": 64, "breviti": 64, "bleu_scor": 64, "unused_kwarg": [64, 79, 187], "glue": 64, "gold": 64, "approx": 64, "unicoderegex": 64, "hoc": 64, "property_char": 64, "bleu_token": 64, "bleu_wrapp": 64, "ref_lin": 64, "hyp_lin": 64, "case_sensit": 64, "mlperfbleumetr": 64, "impelment": 64, "complianc": 65, "stdout": 65, "get_cal": 65, "stack_index": 65, "root_dir": 65, "mlperf_format": 65, "stack_offset": 65, "mlperf_print": 65, "mlperftoken": 66, "basetoken": [66, 115, 135, 167], "createunidirectionalrnnparam": 67, "cell_param": 67, "uni": [67, 195], "unidi_rnn_typ": 67, "createbidirectionalrnnparam": [67, 137], "forward_cell_param": 67, "backward_cell_param": 67, "bi": [67, 195], "bidi_rnn_typ": 67, "sharedencodermodel": 68, "sharedencoderdecodermodel": 68, "regexsharedvariablemodel": 68, "NOT": 68, "try": [68, 69, 80, 82, 86, 93, 126, 134, 194], "inde": [68, 85], "_fromnesteddict": 69, "_has_dynamic_attribut": 69, "_reserved_kei": 69, "frozenset": 69, "__class__": 69, "__class_getitem__": 69, "__contains__": 69, "__delattr__": 69, "__delitem__": 69, "__dir__": 69, "__doc__": 69, "__eq__": 69, "__format__": 69, "__ge__": 69, "__getattribute__": 69, "__getitem__": 69, "__gt__": 69, "__hash__": 69, "__init_subclass__": 69, "__ior__": 69, "__iter__": 69, "__le__": [69, 196], "__len__": 69, "__lt__": 69, "__ne__": 69, "__new__": 69, "__or__": 69, "__reduce__": 69, "__reduce_ex__": 69, "__reversed__": 69, "__ror__": 69, "__setattr__": 69, "__setitem__": 69, "__sizeof__": 69, "__str__": 69, "__subclasshook__": 69, "fromkei": 69, "pop": 69, "popitem": 69, "setdefault": 69, "_delet": 69, "deepcopi": 69, "nestedmapt": 69, "leaf": [69, 87], "fromnesteddict": 69, "tonesteddict": 69, "relev": [69, 82, 194], "checkkei": 69, "squarebracketindex": 69, "getitem": 69, "idx": [69, 79], "wasn": 69, "referenc": 69, "throw": 69, "key_part1": 69, "key_part2": 69, "key_partn": 69, "key_part": 69, "_recursivemap": 69, "flattenitem": 69, "baz": [69, 190], "transformwithkei": 69, "iscompat": [69, 82, 90], "vice": [69, 178], "versa": [69, 178], "filterkeyv": 69, "debugstr": 69, "vlog": 69, "assert_shape_match": [70, 82], "msg": [70, 79, 113], "assert_same_dim0": [70, 82], "random_permutation_sequ": 70, "epoch": [70, 174], "outofrangeerror": [70, 174], "tol": 70, "event": [70, 113], "path_to_fil": 70, "tfevent": 70, "greater": 70, "amount": [70, 75, 86, 92, 223], "beam_search_step_deprec": 70, "best_scor": 70, "cumulative_scor": 70, "in_scor": 70, "in_hyp": 70, "in_prev_hyp": 70, "in_done_hyp": 70, "in_atten_prob": 70, "eoc_id": 70, "valid_eos_max_logit_delta": 70, "local_eos_threshold": 70, "merge_path": 70, "allow_empty_terminated_hyp": 70, "ensure_full_beam": 70, "force_eos_in_last_step": 70, "beamsearchstepv2": 70, "beam_independ": 70, "out_best_scor": 70, "out_cumulative_scor": 70, "out_scor": 70, "out_hyp": 70, "out_prev_hyp": 70, "out_done_hyp": 70, "out_atten_prob": 70, "in_beam_don": 70, "force_eos_in_top_k": 70, "force_last_chunk_eoc_in_top_k": 70, "merged_topk_buffer_size_factor": 70, "atten_vecs_in_hypothesis_proto": 70, "alloc": [70, 160], "cur": [70, 90], "s_len": 70, "invoc": [70, 86, 101, 103, 105], "source_len": [70, 107, 134, 194], "explain": [70, 194], "exce": [70, 75, 115, 170], "threashold": 70, "awai": 70, "candid": [70, 90], "nt": [70, 134], "okai": [70, 196], "utter": [70, 143, 222], "silenc": 70, "embr": [70, 134], "prone": 70, "absenc": 70, "AND": 70, "inject": [70, 90, 133], "eoc": 70, "beam_id": [70, 71], "atten_vec": [70, 71], "out_beam_don": 70, "top_k_terminated_hyp": 70, "src_seq_length": 70, "length_norm": 70, "coverage_penalti": 70, "target_seq_length_ratio": 70, "src": [70, 87, 103, 170, 196, 198, 208], "highest": 70, "unpack_hyp": 70, "max_seq_length": [70, 103, 134], "unpack": [70, 82], "out_id": 70, "out_seq_len": 70, "deriv": [70, 89, 99, 135, 187], "longest": 70, "input_hyp": 70, "hyps_from_beam_search_out": 70, "prev_hyp": 70, "eos_scor": 70, "eos_atten_prob": 70, "fix_hyp_atten_vec": 70, "obsolet": [70, 93], "top_k_from_beam_search_out": 70, "cumulative_atten_prob": 70, "populate_topk_hyp": 70, "hypsfrombeamsearchout": 70, "topkterminatedhyp": 70, "unpackhyp": 70, "div": 70, "mod": 70, "assembl": [70, 101], "summat": 70, "strictli": 70, "cached_cal": 70, "memor": 70, "vocab_token_to_id": 70, "load_token_ids_from_vocab": 70, "colum": 70, "vocab_id_to_token": 70, "token_in_vocab": 70, "ascii_to_token_id": 70, "300": [70, 165], "pad_to_maxlen": 70, "token_id": [70, 115], "str_to_vocab_token": 70, "vocab_filepath": [70, 218], "white": [70, 99], "filepath": [70, 218], "id_to_ascii": 70, "ml_perf_subword_id_to_str": 70, "subword": [70, 218], "ngram_id_to_token": 70, "ngram_vocab_filepath": 70, "ngram_separ": 70, "join": 70, "bpe_ids_to_word": 70, "bpe": [70, 96, 115, 218], "conjunct": 70, "bpewordstoid": 70, "inbetween": 70, "bpe_words_to_id": 70, "tokenization_filepath": 70, "sos_id": [70, 82], "especi": 70, "sequenec": 70, "bpeidstoword": 70, "receiv": [70, 98], "aaron": 70, "10005": 70, "3466": 70, "aaronson": 70, "447": [70, 165], "static_map_string_int": 70, "unk": 70, "static_map_int_str": 70, "static_map_int_int": 70, "get_precondition": 70, "preconditioner_compute_graphdef": 70, "status": 70, "compute_precondition": 70, "pack_sequ": 70, "src_actual_seq_len": 70, "tgt_actual_seq_len": 70, "packed_batch_s": 70, "packed_src_seq_len": 70, "packed_tgt_seq_len": 70, "packsinglesequ": 70, "src_segment_id": [70, 91, 197], "src_segment_po": 70, "src_indices_in_input": 70, "tgt_indices_in_input": 70, "too": [70, 82, 196], "output_shap": 70, "remain": [70, 82, 95], "packed_": 70, "_seq_len": 70, "src_input_seq_len": 70, "tgt_input_seq_len": 70, "disambigu": [70, 196], "pack_single_sequ": 70, "input_length": 70, "max_packed_length": 70, "require_sequential_ord": 70, "indices_in_input": 70, "apply_pack": 70, "rearrang": 70, "packsequ": 70, "applypack": 70, "packed_seq_len": 70, "actual_seq_len": [70, 193], "mask_id": 70, "mask_ratio": 70, "mask_minlen": 70, "span_len": 70, "100000": 70, "random_start_prob": 70, "rand_prob": 70, "mask_prob": 70, "mask_target": 70, "first_unreserved_id": 70, "max_seq_len": [70, 187], "mask_len": 70, "tgt_weight": 70, "s1": 70, "s2": 70, "s3": 70, "bo": 70, "s4": 70, "s5": 70, "attenvec": 71, "normalized_scor": 71, "fieldsentri": 72, "versionedfileset": 73, "fileset": 73, "create_timestamp": 73, "getlrvalu": 75, "lr_or_cal": 75, "getoptim": [75, 165], "lr": [75, 95, 165], "addsummari": 75, "varreuseforslotvar": 75, "auto_reus": 75, "getlrschedulevalu": 75, "lr_schedule_cal": 75, "dynamicaccumul": 75, "suppos": [75, 190], "vari": [75, 82, 134], "did": 75, "compositeoptim": 75, "optimizer_map": 75, "default_optim": 75, "adam": [75, 116, 165, 181, 192], "sgd": [75, 116], "thrown": [75, 79], "rmsprop": 75, "adadelta": 75, "paramsa": 75, "paramsb": 75, "adamv2": 75, "accum_weight": 75, "happen": [75, 82, 86, 93, 120, 134, 140], "min_accum_weight": 75, "_stepnum": 75, "_adafactordecayratepow": 75, "decai": [75, 82, 85, 95, 192], "grow": [75, 87], "step_num": 75, "_adafactordecayrateadam": 75, "beta2": [75, 165], "subsum": 75, "xlashardingadafactoroptim": 75, "multiply_by_parameter_scal": 75, "decay_r": 75, "beta1": [75, 165, 166], "clipping_threshold": 75, "epsilon1": 75, "30": [75, 165, 166], "epsilon2": 75, "min_dim_size_to_factor": 75, "use_lock": [75, 120, 165], "cond_is_finit": 75, "adafactor": 75, "_factored_dim": 75, "_parameter_scal": 75, "chanc": [75, 178], "imput": 75, "try_apply_dens": 75, "xlashardingadafactor": 75, "gradientaggregationoptim": 75, "opt": [75, 170, 227], "num_micro_batch": [75, 160, 163, 165], "apply_crs_to_grad": 75, "hardwar": [75, 116], "demand": [75, 79], "difficult": 75, "simul": [75, 85], "caveat": [75, 116], "trade": 75, "compute_gradi": 75, "apply_gradi": [75, 82], "grads_and_var": 75, "get_slot": 75, "get_slot_nam": 75, "xlashardingadafactoraccugrad": 75, "matplotlib": [76, 107], "tounicod": 76, "addplot": 76, "unused_fig": 76, "ax": [76, 82, 85, 107, 190], "titl": 76, "xlabel": 76, "ylabel": 76, "fontsiz": 76, "xlim": 76, "ylim": 76, "suppress_xtick": 76, "suppress_ytick": 76, "addimag": [76, 107], "fig": [76, 107], "cmap": 76, "bone_r": 76, "clim": 76, "show_colorbar": 76, "aspect": [76, 85], "vmin": 76, "vmax": 76, "addscatterplot": 76, "_subplotmetadata": 76, "plot_func": 76, "matplotlibfiguresummari": [76, 107], "figsiz": 76, "max_output": [76, 107], "subplot_grid_shap": 76, "gridspec_kwarg": 76, "shared_subplot_kwarg": 76, "sever": [76, 138, 192], "subplot": 76, "fig_help": 76, "summary_nam": [76, 79], "addsubplot": [76, 107], "tensor1": 76, "tensor2": 76, "image_summari": 76, "plot_fun": 76, "realiz": 76, "data1": 76, "data2": 76, "datan": 76, "finalizeimag": 76, "creation": [76, 82], "overal": [76, 96, 107, 189], "_renderonematplotlibfigur": 76, "numpy_data_list": 76, "_rendermatplotlibfigur": 76, "render": 76, "unconvent": 76, "py_func": 76, "inch": 76, "uint8": 76, "figuretosummari": 76, "setter": 76, "accept": [76, 79, 82, 101, 139, 187], "pyplot": 76, "imshow": 76, "xtick": 76, "visual": 76, "addmulticurvesubplot": 76, "legend": 76, "_addmulticurverowplot": 76, "x_label_overrid": 76, "row_label": 76, "cut": [76, 86], "mymodel": [77, 144], "inference_graph": [77, 78], "tmp": [77, 82, 163, 201, 202, 204, 211, 227], "00000000": 77, "src_string": 77, "hello": 77, "world": [77, 198], "loadinferencegraph": 77, "clear_device_plac": 77, "subgraph_nam": [77, 144, 153, 161, 209], "device_typ": [77, 78], "session_config": 77, "load_graph_def_from_inference_graph": 77, "_load_graph_from_inference_graph": 77, "fetch_kei": 77, "feed_kei": 77, "fetch_shap": 77, "feed_shap": 77, "_get_subgraph": 77, "_get_subgraph_fetch": 77, "_get_subgraph_fe": 77, "subgraph_fetch_kei": 77, "subgraph_feed_kei": 77, "subgraph_fetch_shap": 77, "subgraph_feed_shap": 77, "_create_new_sess": 77, "_sess": 77, "_maybe_create_new_sess": 77, "sess_id": 77, "_run_with_valid_sess": 77, "_loadcheckpoint": 77, "validate_fetch": 77, "session_run_opt": 77, "run_metadata": 77, "time_session_run": 77, "dict_kei": 77, "runopt": 77, "runmetadata": 77, "invalidargumenterror": [77, 82], "meet": [77, 86], "predictorrunnerbas": 78, "runbatch": 78, "xla_devic": 78, "url": 78, "server": 78, "inference_thread": 78, "num_tpu_cor": 78, "output_dir": [78, 187], "inference_subgraph_nam": 78, "output_num_shard": 78, "output_shard_id": 78, "max_input": 78, "input_id_filt": 78, "prediction_step_interv": 78, "3000": 78, "fromflag": 78, "_shouldprocessinputid": 78, "_outputfilenam": 78, "_output_num_shard": 78, "_predictonecheckpoint": 78, "_predictcontinu": 78, "monitor": 78, "baseprogram": 79, "shared_model": 79, "inspir": [79, 198], "tenanc": 79, "jit": 79, "signific": 79, "delai": 79, "steps_per_loop": 79, "_setprogramdir": 79, "_initializevizi": 79, "vizier": 79, "_summary_writ": 79, "filewrit": 79, "_summarizevalu": [79, 130, 227], "tensorboard": [79, 82, 194, 223], "_writeinputdatastat": 79, "_infeedloopforinput": 79, "inp_inst": 79, "_infeedloop": [79, 130, 227], "_reportviziermetr": 79, "bee": 79, "vizier_early_stop": 79, "buildtpusubgraph": 79, "tpu_funct": 79, "on_device_training_loop": 79, "setstatusmessagefn": 79, "workaround": 79, "setstatusmessag": 79, "borglet": 79, "initinput": 79, "threadpool": 79, "shutdown": 79, "saveprogramst": 79, "loadprogramst": 79, "restored_checkpoint_path": 79, "_instantiatetaskmodel": 79, "_outfeedenqueu": [79, 130, 227], "getmodel": 79, "inputbenchmark": 79, "trainprogram": 79, "_outfeeddequeueloop": [79, 130, 227], "num_loop": [79, 130, 227], "tputrainstep": [79, 130, 227], "tputrain": [79, 130, 227], "infeedtffunc": 79, "_shouldwritesummari": 79, "task_global_step": 79, "evalprogram": 79, "tpuevalstep": 79, "evalfunc": 79, "_updatecpupassthroughdata": 79, "cpu_pt": 79, "_fetchdecodeout": 79, "tpu_out": 79, "decodeprogram": 79, "_datasetsummarywrit": 79, "unused_dataset_nam": 79, "finalizecallback": 79, "unused_finalize_ret": 79, "_finalizedecod": 79, "decodefunc": 79, "decodefn": 79, "split_compile_and_shard": 79, "_decodeuntiloutofrangeinfeedloop": 79, "infeed_step_queu": 79, "outofrang": 79, "_decodestep": [79, 194], "dec_metr": [79, 198], "buffered_decode_out": 79, "postprocess_futur": 79, "_runpostprocess": 79, "decode_out_obj": 79, "postprocess": [79, 135, 143], "_postprocessstep": 79, "start_tim": 79, "runforinput": 79, "multiinputsdecodeprogram": 79, "finalize_ret": 79, "_inferstepsperloop": 79, "num_sampl": [79, 82, 139, 160, 163, 204], "drop_remaind": 79, "experimentaldecodeprogram": 79, "decodeloop": 79, "_outfeeddequeu": 79, "decode_nm": 79, "_decodeloop": 79, "_postprocess": 79, "elapsed_sec": 79, "_threadcal": 79, "break": [79, 93, 150, 151], "waitthread": 79, "mlperftraindecodeprogram": 79, "mlperfprogram": 79, "_trainanddecod": 79, "multitaskprogramschedul": 79, "simpleprogramschedul": 79, "train_program": 79, "eval_program": 79, "_createprogramparam": 79, "program_nam": 79, "decode_num_sampl": 79, "_checklengthorexpand": 79, "param_per_dataset": 79, "expected_len": 79, "simpleprogramschedulefortask": 79, "train_dataset_nam": 79, "train_steps_per_loop": [79, 118, 165, 166], "eval_dataset_nam": 79, "eval_steps_per_loop": 79, "decode_steps_per_loop": 79, "experimental_decod": 79, "multi_inputs_decod": 79, "train_program_cl": 79, "eval_program_cl": 79, "summary_exporter_cl": 79, "async_postprocess": 79, "experimental_async_postprocess": 79, "decode_until_out_of_rang": 79, "postprocess_all_at_onc": 79, "train_summary_interval_step": 79, "deocder": 79, "concurr": [79, 86], "But": [79, 86, 134, 196], "older": 79, "decodeout": 79, "flush": 79, "wether": 79, "_clearspecifiedprogram": 79, "program_list": 79, "program_cls_to_clear": 79, "updateprogramschedul": 79, "ps_param": 79, "dataset_list": 79, "decode_summary_email": 79, "oneoff_checkpoint_to_load": 79, "overriden": 79, "testset": 79, "checkpoint_to_load": 79, "mlperfprogramschedul": 79, "ml": 79, "perf": 79, "mlperfprogramschedulefortask": 79, "decode_dataset_nam": 79, "summarytocsv": 80, "csv": 80, "csvtosummari": 80, "decodestatuscach": 80, "program_dir": 80, "123": [80, 165], "rest": [80, 82, 120], "updateckpt": 80, "ckpt_kei": 80, "updatedataset": 80, "tryloadcach": 80, "success": [80, 96, 101], "_isincollect": 81, "addtopruningcollect": 81, "old_weight": 81, "old_old_weight": 81, "usepruninginterfac": 81, "pruning_hparams_dict": 81, "applycompress": 81, "compress": 81, "flatembeddinglookup": 81, "emb_tabl": 81, "flat_id": 81, "matmul_axi": 81, "fprop_mod": 81, "number_id": 81, "pruningop": 81, "encapsul": [81, 82, 134, 178], "_pruning_hparams_dict": 81, "_global_step": 81, "_pruning_obj": 81, "_pruning_hparam": 81, "applyprun": 81, "lstmobj": 81, "weight_nam": [81, 85], "wm_pc": 81, "getmixresult": 81, "prune_opt": 81, "first_order_gradi": 81, "second_order_gradi": 81, "getlastcompressionop": 81, "getembeddinglookupresult": 81, "layer_obj": 81, "getpruningupd": 81, "applytensorflowupd": 81, "applypythonupd": 81, "applytensorflowandpythonupd": 81, "runpythonupd": 81, "assert_equ": 82, "assert_greater_equ": 82, "assert_great": 82, "assert_less_equ": 82, "assert_less": 82, "assert_between": 82, "assert_even_divid": 82, "denorm": 82, "assertidshap": 82, "expected_ids_shape_pattern": 82, "ids_shap": [82, 175], "_checknumer": 82, "checknumer": 82, "with_depend": 82, "_varincollect": 82, "_printopt": 82, "_print": 82, "simplifi": [82, 90, 181], "dbg": 82, "py_utils_test": 82, "429": [82, 165], "filename_prefix": [82, 93], "hasrank": 82, "expected_rank": 82, "syntact": 82, "sugar": 82, "hasatleastrank": 82, "getrank": 82, "ndim": 82, "hasshap": 82, "expected_shap": 82, "runtim": [82, 180, 181], "hassameshap": 82, "ref": [82, 96, 135, 136, 144, 150, 151], "getsiz": 82, "causalselfattenpad": 82, "linalg": 82, "band_part": 82, "outside_all_rewrit": 82, "runontpuhost": 82, "tpu_host": 82, "computew": [82, 136, 150], "wer": [82, 150, 151], "settpudeviceassign": 82, "tpu_device_assign": 82, "cleartpudevic": 82, "gettpudeviceassign": 82, "seteagermod": 82, "eager_mod": 82, "test_mod": 82, "iseagermod": [82, 113], "seteagerrngadapt": 82, "rng": 82, "gradienttap": [82, 113], "createemaformodel": 82, "sessionconfig": 82, "soft_plac": 82, "inlin": 82, "cluster_def": 82, "disable_meta_optim": 82, "allow_soft_plac": 82, "do_function_inlin": 82, "grappler": 82, "metagraph": 82, "assertiscompat": 82, "setshap": 82, "dst_nmap": 82, "src_nmap": 82, "nmap_list": 82, "tmpl": 82, "convertnonegradienttozero": 82, "dx": [82, 113], "sanit": 82, "lh": [82, 85], "rh": [82, 85], "_uniqu": 82, "uniqifi": 82, "touniquelist": 82, "readonlyattrdictview": 82, "tostaticshap": 82, "uniformsampl": 82, "reservoir": 82, "sampler": 82, "en": [82, 99, 121, 151, 201, 202, 204], "wikipedia": [82, 99, 151], "wiki": [82, 99, 151], "reservoir_sampl": 82, "rnncellstateinit": 82, "randomnorm": 82, "defaultrnncellstateinit": 82, "initrnncellst": 82, "is_ev": [82, 90, 140, 147, 201, 202], "implemetaiton": 82, "dype": 82, "stateless_vars_init": 82, "weightinit": 82, "custom_v_init": 82, "uniformposit": 82, "xavier": 82, "xavierwithfixupparam": 82, "layers_per_residual_block": 82, "fixup": 82, "geomeanxavi": [82, 90], "truncatedgaussian": 82, "truncated_norm": 82, "gaussiansqrtdim": 82, "gaussiansqrtfanin": 82, "fan_in": 82, "gaussiansqrtfanout": 82, "fan_out": 82, "gaussiansqrtfanavg": 82, "uniformsqrtdim": 82, "uniformunitsc": 82, "uniformunitscalingfanavg": 82, "variance_scaling_initi": 82, "kera": [82, 190, 224], "variancesc": 82, "truncatedgaussiansqrtdim": 82, "truncatedgaussiansqrtfanin": 82, "truncatedgaussiansqrtfanout": 82, "kaiminguniformfaninrelu": 82, "kaiminguniformfaninleakyrelu": 82, "23606797749979": 82, "customvarinit": 82, "customconstantvarinit": 82, "scaleddeltaorthogon": 82, "defaultparaminit": 82, "isdefaultparaminit": 82, "findneed": 82, "_collectiongett": 82, "default_factori": 82, "sanitizescopekei": 82, "unittestsessionscop": 82, "getunittestsess": 82, "opportunisticvariablereusescop": 82, "enable_opportunistic_reus": 82, "getopportunisticvariablereus": 82, "disablevariablenamecheck": 82, "taskcallscopenam": 82, "taskcallscop": 82, "gettaskcallscop": 82, "variablerenamescop": 82, "renam": [82, 86, 174], "regexp": 82, "new_name_format": 82, "interpol": [82, 95, 194, 195, 198], "getvariablenam": [82, 116], "untransform": 82, "scope_nam": 82, "variablelistdtyperegexscop": 82, "finddatatyp": 82, "generateseedfromnam": 82, "maybegenerateseedfromscop": 82, "generateseedfromid": 82, "obj_id": 82, "getvarleadingdimsascombinedlay": 82, "shape_prefix": 82, "getvariableshapeprefix": 82, "getvariablenumleadingdimsforcombinedlayerscontext": 82, "getfaninfanout": 82, "prefix_dims_to_skip": 82, "variablestor": 82, "default_stor": 82, "mimic": [82, 93, 116], "get_vari": 82, "regard": 82, "outermost": 82, "_getvariablestor": 82, "_defaultvariablecr": 82, "_getvariablecr": 82, "variablecreatorscop": 82, "variable_cr": 82, "creator": 82, "variable_creator_scop": 82, "upgrad": 82, "custom_gett": 82, "resolv": 82, "innermost": 82, "placeontpucor": 82, "core_id": 82, "maybereusefromvariablestor": 82, "maybepinvarstocpu": 82, "maybeopportunisticvariablereus": 82, "getlingvovariablecr": 82, "default_se": 82, "variablesynchron": 82, "variableaggregationv2": 82, "param_config": 82, "graphkei": 82, "global_vari": [82, 185], "distributionstrategi": 82, "variableaggreg": 82, "_createvariablest": 82, "_createvariablestateless": 82, "_randomxavieruniforminiti": 82, "_createvarinitst": 82, "init_dtyp": 82, "_generatestatelessrngse": 82, "aim": 82, "pseudo": [82, 87], "_deterministicrandomnormaliniti": 82, "stddev": [82, 99], "_deterministicrandomuniforminiti": 82, "minval": [82, 185], "maxval": [82, 185], "_deterministicrandomtruncatednormaliniti": 82, "truncat": [82, 99, 115, 170, 194], "_deterministicrandomuniformunitscalinginiti": 82, "_deterministicrandomvariancescalinginiti": 82, "_deterministicrandomxavieruniforminiti": 82, "_createvarinitstateless": 82, "getglobalvariablescop": 82, "variablescop": 82, "globalstepcontext": 82, "global_step_tensor": 82, "warnonglobalstepaccess": 82, "_maybewarnaboutpotentiallyincorrectevalu": 82, "unexpect": 82, "easili": 82, "triag": 82, "getglobalstep": [82, 95], "getorcreateglobalstepvar": 82, "logmultilin": 82, "_logplac": 82, "createlocaltheta": 82, "device_list": 82, "leav": 82, "intact": 82, "_getvarstoload": 82, "variable_loading_rul": 82, "var_ignore_rul": 82, "ckpt_path": 82, "suppress_log": 82, "overridevarsfromcheckpoint": 82, "pretrain": [82, 187, 193], "ckpts_loading_rul": 82, "collid": 82, "computegradientssimpl": 82, "loss_or_activ": 82, "grad_aggregation_method": 82, "colocate_gradients_with_op": 82, "gate_gradi": 82, "activations_grad": 82, "_computegradientstpu": 82, "skip_zero_gradi": 82, "use_bf16_gradients_ar": 82, "defer_crs_to_apply_grad": 82, "is_activ": 82, "tpu_embedding_activ": 82, "yonghui": 82, "_vargrad": 82, "vargrad": 82, "skipnonegradi": 82, "skip_none_gradi": 82, "aggregationmethod": 82, "race": 82, "switchabl": 82, "reduce_sum": 82, "tpu_embedding_var_grad": 82, "maskgradi": 82, "grad_mask": 82, "applygradmultipli": 82, "vs_g": [82, 107], "hasnanorinf": 82, "hasnanorinfgradi": 82, "applygradnormclip": 82, "scaled_gradi": 82, "adjustgradientswithlploss": 82, "lp_regularizer_weight": 82, "lp": 82, "lp_loss": 82, "regul": 82, "splitrecurs": 82, "nestmap": 82, "sublist": 82, "concatrecurs": 82, "weightedavg": 82, "sum_reduction_fn": 82, "weightedavgofmetr": 82, "ret_dict": 82, "concatperexampletensor": 82, "combinemetr": 82, "loss_metric_weight_pair": 82, "variat": 82, "subparam": 82, "variationalnoiseparam": 82, "global_vn": 82, "per_step_vn": 82, "start_step": 82, "defaultvn": 82, "disablevn": 82, "stepseedincrementcontext": 82, "_step_seed_incr": 82, "getstepse": 82, "step_se": 82, "resetstepse": 82, "mayberesetstepseedfromscop": 82, "seend": 82, "129159299": 82, "mayberesetstepse": 82, "getincstepse": 82, "transpar": [82, 113], "is_infer": 82, "stateless_random": 82, "deterministicdropout": 82, "deterministicvn": 82, "std": 82, "updatebatchnormvar": 82, "batch_norm_var": 82, "batch_norm_stat": 82, "findrelevantbatchnormupd": 82, "batch_norm_upd": 82, "samplestep": 82, "decodeonestep": 82, "_getsamplestep": 82, "adddebugtensor": 82, "print_debug_tensor": 82, "_ensurematrixshap": 82, "clip_by_valu": 82, "clip_value_min": 82, "clip_value_max": 82, "_transformandsum": 82, "sumsquar": 82, "sumab": 82, "reducerm": 82, "piecewiseconst": 82, "x_in": [82, 134, 194], "vdtype": 82, "padsequencedimens": 82, "pad_val": 82, "padsequenceto": 82, "applypad": 82, "use_select": 82, "ensure_shap": 82, "equiv": 82, "asid": 82, "easier": [82, 182], "friendli": 82, "necessarili": 82, "broadcast": 82, "platform": 82, "lengthsfrompad": 82, "isn": 82, "paddingsfromlength": 82, "unpad": 82, "trimtrailingpad": 82, "reversepaddedsequ": 82, "concatenatepaddedsequ": 82, "input0": 82, "padding0": 82, "padding1": 82, "seq_dim": 82, "reverse_sequ": 82, "shiftleft": 82, "shift_siz": 82, "createidsandlabel": 82, "lenght": 82, "retryontransienttferror": 82, "pad_after_cont": 82, "expandto": 82, "target_rank": 82, "expandandpadortrimto": 82, "target_shap": [82, 145], "thereaft": 82, "repeatdim": 82, "stacktensorsrecurs": 82, "mixbyweight": 82, "choic": [82, 139, 181], "probabilist": 82, "checkshap": 82, "fpropdtyp": 82, "updatefpropdtyp": 82, "updatedtyp": 82, "namescopedecor": 82, "foobar": 82, "myfoobarmethod": 82, "sequencestodebugstr": 82, "rematerializefn": 82, "statefulrandomopsindefun": 82, "inconsist": 82, "_definedfunct": 82, "toplacehold": 82, "extra_logit": 82, "softmaxcrossentropyfocalloss": 82, "label_id": 82, "label_prob": 82, "stop_gradient_on_focal_loss_coeffici": 82, "multinomi": 82, "focus": 82, "fl": 82, "p\u209c": 82, "\u03b1\u209c": 82, "\u02e0log": 82, "sigmoidcrossentropyfocalloss": 82, "recordformatfromfilepattern": 82, "tfrecord": [82, 159, 174, 182, 196, 204, 217, 220, 221, 222], "record_format": [82, 217], "filepattern": 82, "readfilelin": 82, "file_path": 82, "par": 82, "bazel": [82, 113, 122, 170, 224, 227], "workspac": 82, "exclus": 82, "use_einsum": 82, "08": [82, 165], "projectlastdim": 82, "removeassertcontext": 82, "_assertinputsmatch": 82, "implicit_captur": [82, 86], "implicitli": [82, 86, 178], "mismatch": [82, 91, 113], "keep_shap": 82, "_definedefun": 82, "fwd": [82, 91], "fwd_sig": 82, "bak": [82, 91], "bak_as_funct": 82, "dy": [82, 113], "dcaptur": [82, 86], "output_dtyp": 82, "stateful_op": 82, "op_nam": 82, "op_typ": 82, "captured_input": 82, "_sharedrendezvousscop": 82, "shared_rendezv": 82, "_getsharedrendezv": 82, "rendezv": 82, "_applysharedrendezv": 82, "_wrapfunct": 82, "input_signatur": [82, 113], "_definefunct": 82, "tffunctionscop": 82, "use_tf_funct": 82, "_usetffunct": 82, "extrem": [82, 90], "mention": 82, "del": [82, 136, 142, 150, 151], "then_branch": 82, "else_branch": 82, "definedfunct": 82, "trace": [82, 113], "addframeworkinput": 82, "__call__": 82, "suitabl": [82, 103, 178], "calldefun": 82, "_ityp": 82, "whileloop": 82, "loop_stat": 82, "forloop": 82, "readvari": 82, "varhandleop": 82, "_gettpusummarytensor": 82, "tpusummarytensorcontext": 82, "addtpusummarytensor": 82, "situat": 82, "gettpusummarytensor": 82, "cleartpusummarytensor": 82, "addsavedmodelasset": 82, "asset": 82, "getsavedmodelasset": 82, "computationshap": 82, "topologyproto": 82, "ll": 82, "getextravar": 82, "getextrainput": 82, "getextraarg": 82, "shardedfilepatterntoglob": 82, "computenceandauc": 82, "nce": 82, "gathertensorvaluesbyseqindic": 82, "class_indic": 82, "dim1": 82, "inclus": 82, "getsoftmaxprobsbyseqindic": 82, "dividenonan": 82, "divide_no_nan": 82, "sequencepad": 82, "appenddim": 82, "maybesoftcaplogit": 82, "gettpuembeddinggraphcollect": 82, "tpuembeddingcollect": [82, 116], "auxlosscontext": 82, "reentrant": [82, 117], "aux": 82, "_global_stack": [82, 117], "addloss": 82, "bprop_variable_exclus": 82, "var_path": 82, "blockdiagonalmatmul": 82, "input_num_block": 82, "blockdiagonalmatmulwithmix": 82, "linearli": [82, 95], "blockdiagonalprojectlastdim": 82, "blockdiagonalprojectlastdimwithmix": 82, "getprocessedcheckpoint": 82, "updateprocessedcheckpoint": 82, "mergedictswithvaluecheck": 82, "dict1": 82, "dict2": 82, "mergeduplicateid": 82, "extra_tensor": 82, "ret_id": 82, "dedupl": [82, 178], "ret_pad": 82, "ret_tensor": 82, "decodeprotofield": 82, "serialized_proto": 82, "message_typ": 82, "field_nam": [82, 83, 190], "output_typ": 82, "decode_proto": [82, 196], "descriptor_sourc": [82, 196], "alwayslink": 82, "cc_librari": 82, "decoderepeatedprotofield": 82, "link": [82, 85, 86, 178], "field_name_s": 82, "_fromglob": 83, "allow_override_from_clust": 83, "enable_check_numer": 83, "use_xla": 83, "use_tpu": [83, 143], "testonly_skip_norm_lay": 83, "tpu_compat": 83, "use_stateless_vars_init": 83, "lib": 84, "samplequantizedprojectionlay": [84, 85], "quantutilsbasetest": 84, "methodnam": [84, 106, 113, 128], "runtest": [84, 106, 113, 128], "testcas": [84, 106, 112, 113, 128], "no_qdomain_expect": 84, "00071405": 84, "03868543": 84, "01999986": 84, "00994987": 84, "08905827": 84, "13636404": 84, "03180931": 84, "06056439": 84, "0208858": 84, "17595209": 84, "05192588": 84, "02618068": 84, "02125708": 84, "10454545": 84, "01147466": 84, "06903321": 84, "0276652": 84, "14823943": 84, "09726462": 84, "01415125": 84, "no_qdomain_expected_eag": 84, "00321277": 84, "0081814": 84, "02552385": 84, "01066932": 84, "01345658": 84, "06873785": 84, "07171492": 84, "06641106": 84, "1642895": 84, "04410084": 84, "02281524": 84, "00583461": 84, "20509389": 84, "02709481": 84, "09852847": 84, "01793884": 84, "11026311": 84, "01846472": 84, "08576044": 84, "06027214": 84, "_testlayerhelp": 84, "test_cas": 84, "not_expect": 84, "qdistribut": 85, "enum": 85, "unsign": 85, "log_softmax": 85, "random_uniform": [85, 90], "relu6": 85, "isposit": 85, "_generate_next_value_": 85, "last_valu": 85, "_member_names_": 85, "_member_map_": 85, "_member_type_": 85, "_value2member_map_": 85, "safe": 85, "emploi": [85, 178], "fall": [85, 87, 95, 180, 181, 196], "fake": [85, 154], "quantifi": 85, "apriori": 85, "passiv": 85, "constrain": 85, "mul": 85, "quit": 85, "system": 85, "thought": 85, "think": [85, 103], "alter": 85, "strongli": 85, "loos": 85, "honor": 85, "qweight": 85, "qract": 85, "terminologi": 85, "concept": [85, 135, 178], "8bit": 85, "16bit": 85, "rare": 85, "mirror": 85, "qout_nam": [85, 90], "trackqact": 85, "qmin": 85, "qmax": 85, "qtanh": 85, "qsigmoid": 85, "qsoftmax": 85, "qrelu": 85, "qrelu6": 85, "qlogsoftmax": 85, "fakeqdomain": 85, "qrandom_uniform": 85, "qadd": 85, "qsubtract": 85, "qmultipli": 85, "qlog": 85, "feature_ax": 85, "grain": [85, 178], "trackqweight": 85, "feature_axi": 85, "legacy_aqt_weight_nam": 85, "eval_onli": 85, "pressur": 85, "_validateargnam": 85, "op_arg_nam": 85, "qmatmul": 85, "lhs_name": 85, "rhs_name": 85, "lhs_dist": 85, "rhs_dist": 85, "ensure2d": 85, "op_kwarg": 85, "qconv1d": 85, "inputs_nam": 85, "filters_nam": 85, "inputs_dist": 85, "filters_dist": 85, "qconv2d": 85, "is_depthwis": 85, "qeinsum": 85, "einsum_kwarg": 85, "_validateweight": 85, "w_name": 85, "toaqtweight": 85, "expected_scale_shap": 85, "aqt": 85, "fromaqtweight": 85, "merge_feature_ax": 85, "rescal": 85, "toaqtconv": 85, "w_feature_axi": 85, "act_distribut": 85, "w_expected_scale_shap": 85, "quantizable_lay": 85, "fromaqtconv": 85, "depthwiseconv": 85, "toaqtinput": 85, "ot": 85, "fromaqtmatmul": 85, "toaqtactactinput": 85, "act_lh": 85, "act_rh": 85, "act_lhs_distribut": 85, "act_rhs_distribut": 85, "hand": 85, "fromaqtactactmatmul": 85, "_getqdomain": 85, "getqdomainparam": 85, "Will": 85, "_addquantizationfunct": 85, "unquant": 85, "quantizeweight": 85, "out_nam": 85, "fromaqtoutput": 85, "quantizeconstantrang": 85, "min_valu": 85, "max_valu": 85, "quantizenaturalrang": 85, "quantizeact": 85, "fake_quant_with_": 85, "_maybenarrowtoasymbitdepth": 85, "baseclippingcapschedul": 85, "is_quant": 85, "getendrang": 85, "slightli": [85, 196], "lie": [85, 99], "getquantizedendrang": 85, "tightli": 85, "coupl": [85, 90, 160], "applyconstantclip": 85, "getstat": 85, "applyclippingwithst": 85, "applyclip": [85, 194, 195], "identityclippingcapschedul": 85, "dummi": [85, 108, 128], "linearclippingcapschedul": 85, "_valu": 85, "fakequantizationschedul": 85, "mobil": [85, 90], "fakequantizedlstmcel": 85, "exhaust": 85, "end_cap": 85, "_getquantizedrangeforcap": 85, "current_cap": 85, "_getcurrentminmax": 85, "start_cap": 85, "fixate_to_end_st": 85, "satur": [85, 196], "fixat": 85, "0d": 85, "ramp": [85, 95], "symmetricscheduledclipqdomain": 85, "aid": 85, "_countedminmaxaccumul": 85, "new_valu": 85, "passiveasymqdomain": 85, "asymmetr": 85, "1712": 85, "05877": 85, "_maybefakequ": 85, "min_v": 85, "max_v": 85, "num_bit": 85, "_getaccumulatornamefortensor": 85, "_getqstatevarnam": 85, "_createqstatevar": 85, "_getqstatevar": 85, "_summarizetensor": 85, "_recordtensor": 85, "_copyshap": [85, 87], "from_t": 85, "to_t": 85, "cell_fn": 86, "cell_grad": 86, "dstate1": 86, "dtheta": 86, "dstate0": 86, "dinput": 86, "bunch": 86, "accumulate_st": 86, "while_loop": [86, 117], "lot": 86, "why": 86, "my_tensor": 86, "allow_implicit_captur": 86, "devicepair": 86, "recv": [86, 98], "_assertsametensor": 86, "list_a": 86, "list_b": 86, "_index": 86, "_updat": 86, "nmap_acc": 86, "nmap_x": 86, "_seqlendim": 86, "flattenpad": 86, "_seqpaddinglength": 86, "inputs_nmap": 86, "_emptyacc": 86, "_emptywithfixshap": 86, "_emptylik": 86, "nmap_i": 86, "_transformdtyp": 86, "_recurr": 86, "stop_fn": 86, "cell_typ": 86, "accumulator_lay": 86, "unused_acc_st": 86, "backward_cleanup": 86, "return_acc_extra": 86, "_reflectoncellfn": 86, "check_stateful_op": 86, "allowed_tensor_captur": 86, "_getcellgrad": 86, "_augmentst": 86, "allow_overwrit": 86, "_wrapaccumulatorcellfn": 86, "_wrapaccumulatorcellgradfn": 86, "_wrapcellfnwithstepse": 86, "_wrapcellgradfnwithstepse": 86, "_wrapcellfnwithsymbolvalu": 86, "symbol_to_tensor_map": 86, "_wrapcellgradfnwithsymbolvalu": 86, "_decoratecellfn": 86, "_decoratecellgrad": 86, "_issingletimestep": 86, "_recurrentsingletimestep": 86, "stash": [86, 90], "unsupport": [86, 217], "expans": 86, "should_stop": 86, "_link": 86, "dpair": 86, "_createlink": 86, "_join": 86, "_input": 86, "cell_out": 86, "cell_out_grad": 86, "out_link": 86, "_middl": 86, "in_link": 86, "slen_dim": 86, "per_step_input": 86, "middl": 86, "_dependson": 86, "init_st": 86, "zip": 86, "shink": 86, "acc_stat": [86, 91], "num_t": 86, "_stackedrecurr": 86, "_repeat": 87, "common_input": 87, "layerwise_input": 87, "layerwis": 87, "iterative_input_0": 87, "layerwise_output": 87, "dst": 87, "layerwise_output_0": 87, "retry_valu": 88, "max_retri": 88, "initial_delay_sec": 88, "delay_growth_factor": 88, "delay_growth_fuzz": 88, "max_delay_sec": 88, "60": [88, 165, 166], "1707": [89, 90], "04585": 89, "revnetlay": 89, "y1": [89, 95], "x1": [89, 95], "x2": 89, "y2": 89, "retain": [89, 95, 96], "reverseandgrad": 89, "d_output": 89, "f_seed": 89, "g_seed": 89, "extra_input": 89, "revnet": 89, "split1": 89, "split2": 89, "dy1": 89, "dy2": 89, "reverse_grad": 89, "d_input": 89, "dx1": 89, "dx2": 89, "d_theta": 89, "stackedrevnetlay": 89, "peak": [89, 95], "footprint": 89, "\u03b8": 89, "activation_size_per_lay": 89, "param_size_per_lay": 89, "implment": 89, "gru": 90, "_histogramsummari": 90, "rnncell": [90, 101, 105], "getoutput": [90, 105], "furthermor": 90, "_gate": 90, "_resetst": 90, "reset_cell_st": 90, "good": [90, 182, 187], "dai": 90, "guten": 90, "thank": 90, "dank": 90, "facili": 90, "_zoneout": 90, "prev_v": 90, "cur_v": 90, "zo_prob": 90, "zoneout": 90, "regularl": 90, "1606": 90, "01305": 90, "zone": [90, 223], "cell_nod": 90, "input_nod": 90, "output_s": 90, "num_gat": 90, "_getbia": 90, "forget_gate_bia": 90, "elimin": [90, 139], "xmw": 90, "_retrieveandsplitg": 90, "_gatesintern": 90, "i_i": 90, "i_g": 90, "f_g": 90, "o_g": 90, "_processnewc": 90, "new_c": 90, "_applyzoneout": 90, "new_m": 90, "lstmcellgroup": 90, "10722": 90, "shufflenet": 90, "01083": 90, "child_cell_cl": 90, "_shuffleshard": 90, "num_shuffle_shard": 90, "0_0": 90, "0_1": 90, "0_2": 90, "0_3": 90, "1_0": 90, "1_1": 90, "1_2": 90, "1_3": 90, "2_0": 90, "2_1": 90, "2_2": 90, "2_3": 90, "quantizedlstmcel": 90, "output_nonlinear": 90, "layernormalizedlstmcel": 90, "weightnormalizedlstmcellsimpl": 90, "1602": 90, "07868": 90, "normalizedlstmcellsimpl": 90, "incomplet": 90, "c_state": 90, "enable_ln_on_c": 90, "ln_scale": 90, "_layernormg": 90, "gate_nam": 90, "embeddingaugmentedlayernormalizedlstmcellsimpl": 90, "inject_emb_method": 90, "prev_id": [90, 104], "num_token": [90, 187], "doubleprojectionlstmcel": 90, "wm_": 90, "_processinputproj": 90, "input_proj": 90, "convlstmcel": 90, "cell_shap": 90, "srucel": 90, "sru": 90, "1709": 90, "02755": 90, "unrol": [90, 91, 134, 140], "qrnnpoolingcel": 90, "quasi": [90, 91], "1611": 90, "01576": 90, "fc": 90, "qrnn": 90, "num_rnn_matric": 90, "grucel": 90, "gru_bias": 90, "gru_cel": 90, "1412": 90, "3555": 90, "w_n": 90, "w_u": 90, "w_r": 90, "b_n": 90, "b_u": 90, "b_r": 90, "output_cell_nod": 90, "hidden_cell_nod": 90, "actiav": 90, "generatepackedinputresetmask": 91, "is_revers": 91, "identityseqlay": 91, "stackedrnnbas": 91, "_getcelltpl": 91, "stackedfrnnlayerbylay": 91, "stackedbifrnnlayerbylay": 91, "bidirectionalfrnn": 91, "bidi": 91, "rcell_forward": 91, "rcell_backward": 91, "bidirectionalrnn": 91, "bidirectionalrnnv2": 91, "_padsequencetolength": 91, "t_input": 91, "_concatlastdim": 91, "_shiftright": 91, "x0": [91, 95], "_shiftrightwithmask": 91, "frnnwithattent": 91, "intertwin": 91, "src_enc": [91, 103], "src_context": 91, "src_end": 91, "atten_state_dim": 91, "zero_atten_st": 91, "reset_atten_st": 91, "accumulatest": 91, "accumulated_st": 91, "side_info": 91, "postprocessst": 91, "fulfil": 91, "rnn_output": 91, "rcell": 91, "num_output_nod": [91, 105], "multisourcefrnnwithattent": 91, "initattent": [91, 133], "source_nam": 91, "contrain": 91, "bidirectionalfrnnquasi": 91, "fwd_rnn": 91, "bak_rnn": 91, "templat": [92, 165, 166, 174, 175, 178, 223], "routingtransformerencoderparam": 92, "routing_factor": 92, "setuproutingtransformerencod": 92, "num_routing_lay": 92, "num_routing_head": 92, "num_clust": 92, "atten_dropout_prob": [92, 160, 192, 204], "relu_dropout_prob": [92, 160, 192, 204], "meanwhil": 93, "saniti": [93, 194], "sanitycheck": 93, "inrang": 93, "isfinit": 93, "_varkei": 93, "sanity_check": 93, "keep_latest_n": 93, "keep_every_n_hour": 93, "emption": 93, "indefinit": [93, 174], "garbag": 93, "gced": 93, "live": 93, "forev": 93, "re_pattern": 93, "_addshardedsaveop": 93, "checkpoint_prefix": 93, "var_key_fn": 93, "_buildsav": 93, "_buildrestor": 93, "_getstat": 93, "_setstat": 93, "getcheckpointid": 93, "_garbagecollect": 93, "ids_to_garbage_collect": 93, "_dosanitycheck": 93, "_saveasync": 93, "till": 93, "_savesync": 93, "_finalizesav": 93, "_updatest": 93, "checkpoint_id": [93, 123, 130], "successfulli": 93, "writenparrai": 93, "file_prefix": 93, "readnparrai": 93, "nestemap": 93, "setinplaceupd": 94, "inplace_upd": 94, "useinplaceupd": 94, "inplace_op": 94, "alias_inplace_upd": 94, "aka": 94, "inplaceupd": 94, "inplac": 94, "baseschedul": 95, "getstep": 95, "constanton": 95, "piecewiseconstantschedul": 95, "continuousschedul": 95, "polynomialschedul": 95, "polynomi": 95, "y0": 95, "linearschedul": 95, "linearrampupdecayschedul": 95, "annealingschedul": 95, "anneal": 95, "pow": 95, "lower_bound": 95, "exponentialschedul": [95, 110], "stepwiseexponentialschedul": 95, "combinedminimumschedul": 95, "transformerschedul": [95, 160, 192], "warmup_step": [95, 160, 166, 192, 204], "transformermlperfschedul": 95, "warmup": [95, 160, 192], "transformerschedulenowarmup": 95, "decay_start": 95, "warm": [95, 192], "linearrampupexponentialdecayscaledbynumsplitschedul": 95, "stai": [95, 101, 110], "linearrampupexponentialdecai": 95, "warmup_init": 95, "linearrampupsqrtdecai": 95, "linearrampupsqrtdecaybybatchsizeandreplica": 95, "warmup_exampl": 95, "linearrampuppiecewiseconstantschedul": 95, "linearrampupcosineschedul": 95, "cosin": 95, "rampup": 95, "devbasedschedul": 95, "lack": 95, "optimum": 95, "ref_step": 95, "recent": 95, "cur_factor": 95, "min_factor": 95, "cosineschedul": 95, "1608": 95, "03983": 95, "cycl": [95, 101], "angl": 95, "pi": 95, "peopl": 95, "09224": 95, "cyclic": 95, "gone": 95, "current_step": [95, 107, 110], "total_step": 95, "decay_gap": 95, "final_valu": 95, "piecewiseschedul": [95, 110], "sqrtdecai": 95, "sqrtdecaytozero": 95, "cycleschedul": 95, "inversesigmoid": 95, "1506": 95, "03099": 95, "_tounicod": 96, "_token": 96, "separator_typ": 96, "un": [96, 192], "surfac": 96, "_bpe_separ": 96, "_wpm_separ": 96, "_unsegmentwpm": 96, "_unsegmentbp": 96, "bleuscor": 96, "max_ngram": 96, "addsent": 96, "computeoverallscor": 96, "6687": 96, "pai": 97, "_transformerlayerblock": 97, "_stridedtransformerlayerblock": 97, "transformerstackv2": 97, "final_layer_first_n": 97, "final_layer_strid": 97, "stackedtransformerencoderlay": 97, "_send": 98, "_recv": 98, "python_op_gen_main": 98, "printallpythonop": 98, "_tpucor": 98, "send_devic": 98, "recv_devic": 98, "spectrum": [99, 100], "_random_uniform_op": 99, "use_stateless_op": 99, "_random_normal_op": 99, "_global_seed_from_input": 99, "input_float": 99, "_hat": 99, "hat": 99, "spectrumaugment": [99, 100], "specaug": [99, 100], "08779": [99, 100], "einsumbbmbm": [99, 100], "einsumbmtbmbt": [99, 100], "einsumbxycbybxyc": [99, 100], "einsumbxycbxbxyc": [99, 100], "einsumbxybxbxi": [99, 100], "einsumbxycbzxbzyc": [99, 100], "einsumbxycbzybxzc": [99, 100], "augment_weight": 99, "_getmask": 99, "choose_rang": 99, "mask_siz": 99, "global_se": 99, "masks_per_fram": 99, "max_ratio": 99, "region": 99, "proce": 99, "_getwarpmatrix": 99, "matrix_s": 99, "max_warp_fram": 99, "warp": 99, "displac": 99, "interv": 99, "warp_matrix": 99, "_constructwarpmatrix": 99, "coordin": 99, "anchor": 99, "singular": 99, "slope": 99, "slope_0": 99, "slope_1": 99, "slope_2": 99, "orig_i": 99, "n_i": 99, "pixel": 99, "warped_pixel": 99, "sum_j": 99, "_frequencymask": 99, "domain_id_index": 99, "degre": 99, "time_length": 99, "num_freq": 99, "_timemask": 99, "noisifi": 99, "gaussian_nois": 99, "_frequencywarp": 99, "_timewarp": 99, "_frequencynois": 99, "logmel": 99, "rational": 99, "freq": 99, "period": [99, 127], "imit": 99, "ccrma": 99, "stanford": 99, "jo": 99, "sasp": 99, "filtered_white_nois": 99, "white_nois": 99, "time_white_nois": 99, "unstackfeatur": 99, "src_input": [99, 137, 139, 141], "_augmentationnetwork": 99, "domain_id": 99, "num_channel": [99, 176], "augmented_input": 99, "spectrumaugmenterondevic": 100, "portabl": 100, "bm": 100, "bmt": 100, "bt": 100, "bxyc": 100, "bx": 100, "bxy": 100, "bzx": 100, "bzyc": 100, "bzy": 100, "bxzc": 100, "processseq": 101, "external_input": [101, 103, 105], "prepared_input": [101, 103, 104, 105], "prepareexternalinput": [101, 103, 104, 105], "zerost": [101, 103, 104, 105], "step_input": [101, 103, 104, 105, 106], "step_output": 101, "statelesslayerstep": 101, "stackstep": [101, 104, 105], "primari": 101, "lowest": 101, "parallelstep": 101, "substep": 101, "external_signatur": 101, "graphstep": [101, 104], "layer_0": 101, "layer_1": 101, "step_param": 101, "n_batch": 101, "output_signatur": 101, "iteratorstep": 101, "recurrentstepwrapp": 101, "attentionstep": 103, "attention_prob": 103, "_getmaxseqlength": 103, "cum_atten_prob": 103, "attentionblockstep": 103, "atten_queri": 103, "embeddingstep": 104, "statefulembeddingstep": 104, "num_prev_token": 104, "rnnstep": 105, "unmodifi": 105, "external_input_dim": 105, "rnnstackstep": 105, "residual_start": [105, 160], "residual_strid": 105, "jun": 106, "streamsteptestbas": 106, "input_rank": 106, "_getparam": 106, "_getfpropoutput": 106, "max_seqlen": 106, "full_seq": 106, "_padinput": 106, "num_fram": [106, 139], "_normalizestreamstepoutput": 106, "query_funnel_pool_strid": 106, "_streamstep": 106, "step_pad": 106, "fprop_out": 106, "_teststreamstephelp": 106, "_buildstackingbasegraph": 106, "_buildstackingstreamgraph": 106, "_testrightcontextstackinglayershelp": 106, "_test_params_repr": 106, "_shouldaddsummari": 107, "scalar_input_stat": 107, "scalar_v2": 107, "histogram_v2": 107, "image_v2": 107, "text_v2": 107, "sequencelength": 107, "plot_tensor": 107, "trimpaddingandplotsequ": 107, "seq_matrix": 107, "num_row": 107, "trimpaddingandplotattent": 107, "atten_matrix": 107, "tgt_len": [107, 194], "transcript": [107, 135, 136, 150, 151, 222], "addattentionsummari": 107, "attention_tensor": 107, "tgt_pad": 107, "show": [107, 194], "target_len": [107, 194], "addattentionsummarybatchmajor": 107, "addnormsummari": 107, "collectvarhistogram": 107, "preparesequenceforplot": 107, "subcapt": 107, "reshaped_tensor": 107, "sequence_length": [107, 165, 166], "plotsequencefeatur": 107, "caption": [107, 150, 172, 178, 180, 182, 187, 202], "statscount": 107, "incbi": 107, "stepratetrack": 107, "computestepr": 107, "total_exampl": 107, "modelanalysi": 107, "topn": 107, "part_pattern": 107, "gettensornam": 107, "name_eag": 107, "i_eag": 107, "dummy_index": 108, "_explicit_class_assumpt": 108, "_prop_handl": 108, "extended_neg": 108, "expr": 108, "_eval_is_extended_neg": 108, "extended_posit": 108, "_eval_is_extended_posit": 108, "_eval_is_neg": 108, "_eval_is_posit": 108, "default_assumpt": 108, "issymbol": 108, "isexpr": 108, "_localsymboltovaluestack": 108, "_local": [108, 114], "value_typ": 108, "symbol_to_value_map": 108, "symbol1": 108, "value1": 108, "symbol2": 108, "value2": 108, "evalexpr": 108, "symbolic_expr": 108, "_local_stack": 108, "sympi": 108, "tostat": 108, "totensor": 108, "ocd": 109, "deliber": 109, "_computepad": 109, "targetsequencesampl": 109, "decoder_theta": [109, 144], "init_state_callback": 109, "pre_step_callback": 109, "post_step_callback": 109, "init_step_id": 109, "taskschedul": 110, "expos": [110, 190, 194], "adaptiveschedul": 110, "getmetrichistori": 110, "simpleadaptiveschedul": 110, "inverseratioadaptiveschedul": 110, "weigh": 110, "shiftedexponentialschedul": 110, "kiperwass": 110, "ballestero": 110, "1804": 110, "08915": 110, "eack": 110, "constantschedul": 110, "p_0": 110, "p_1": 110, "sigmoidschedul": 110, "roundrobinschedul": 110, "sequentialschedul": 110, "test_src_dir_path": 111, "relative_path": 111, "_modeltupl": 112, "model_class": 112, "makemodelvalidatortestcas": 112, "myregisteredmodel1": 112, "myregisteredmodel2": 112, "_skipif": 113, "test_func": 113, "skipifeag": 113, "skipifnoneag": 113, "tapeifeag": 113, "adaptor": 113, "watch": 113, "wrt": 113, "defineandtrac": 113, "tensor_specs_or_placehold": 113, "_placeholderadapt": 113, "redirect": 113, "_eagersessionadaptor": 113, "run_fn": 113, "feed_dict": 113, "function_or_fetch": 113, "_run_impl": 113, "disableeageradapt": 113, "tensorflowtestcas": 113, "fixtur": [113, 128], "exercis": [113, 128], "_create_sess": 113, "getscalarsummaryvalu": 113, "is_tf2_writ": 113, "value_dict": 113, "step_numb": 113, "_replaceonelineinfil": 113, "fpath": 113, "linenum": 113, "replacegoldensinglefloat": 113, "float_valu": 113, "replacegoldenstackanalysi": 113, "new_float_valu": 113, "analyz": 113, "golden": 113, "comparetogoldensinglefloat": 113, "testobj": 113, "update_golden": 113, "site": [113, 139], "liner": 113, "3232": 113, "pickeveryn": 113, "np_arr": 113, "computenumericgradi": 113, "extra_feed_dict": 113, "checker": 113, "computenumericgradienteag": 113, "fy": 113, "threadlocalstack": 114, "threadlocaldict": 114, "stringstoidswithseg": 115, "_stringstoidsimpl": [115, 167], "_stringstoidswithoffsetsimpl": 115, "_stringstoidswithsegmentsimpl": 115, "asciitoken": 115, "graphem": [115, 147, 208], "digit": 115, "vocabfiletoken": 115, "_vocab_file_param": 115, "_checkparam": 115, "bpetoken": 115, "wpmtoken": 115, "explan": 115, "sentencepiecetoken": 115, "sentencepiec": 115, "1808": 115, "06226": 115, "tf_text": 115, "191804185": 115, "_istputrain": 116, "_removeprivatevar": 116, "addtablevari": 116, "table_nam": 116, "is_inference_with_bfloat16": 116, "table_vari": 116, "inference_with_bfloat16_var_nam": 116, "addloadretrieveop": 116, "load_op": 116, "retrieve_op": 116, "_validatetaskscop": 116, "task_call_scop": 116, "addactiv": 116, "getactiv": 116, "addsummarytensor": 116, "summary_tensor": [116, 117], "setgradientmultiplierschedul": 116, "multiplier_schedul": 116, "settaskmod": 116, "shouldstopgradi": 116, "applygradi": 116, "feature_to_gradient_dict": 116, "_tpuembeddingoptim": 116, "tpuembeddingt": 116, "createoptimizerparamet": 116, "optimzi": 116, "createslotvariablesandop": 116, "table_var": 116, "tpu_embedding_t": 116, "tpuembeddingsgdoptim": 116, "tpuembeddingadagradoptim": 116, "tpuembeddingadamoptim": 116, "tpuembeddingftrloptim": 116, "ftrl": 116, "input_kei": 116, "declar": 116, "upfront": 116, "createoptimizerslotvari": 116, "slot_var_dict": 116, "getdevicenam": 116, "table_config": 116, "auxiliary_vari": 116, "max_sequence_length": 116, "_sequenceemblookup": 116, "dense_id": 116, "partition_strategi": 116, "_combineremblookup": 116, "sparse_id": 116, "sparsetensor": 116, "cpuemblookup": 116, "ids_map": 116, "cpuemblookupspars": 116, "embedding_lookup_spars": 116, "_checktpuembeddingconfig": 116, "table_to_config_dict": 116, "feature_to_config_dict": 116, "_tpuemblookup": 116, "_checkidsmap": 116, "monoloth": 116, "emblookupspars": 116, "getidsmap": 116, "getauxiliaryvari": 116, "my_model": 117, "my_model_param": 117, "merge_al": 117, "rewrite_while_loop": 117, "greedydecodeid": 117, "rewrit": 117, "tpusummaryscalar": 117, "plain": [117, 159], "while_loop_reduc": 117, "pwtpusummarytensor": 117, "tpusummarycontext": 117, "rewriteloopcontext": 117, "max_loop_var": 117, "pw_tensor": 117, "merge_all_pw_tensor": 117, "loop_vars_dtyp": 117, "toi": 118, "countinginputgener": 118, "identityregressionmodel": 118, "identityregressiontask": 118, "modeltrackingfpropresult": 118, "registeridentityregressionmodel": 118, "weight_init_valu": 118, "max_train_step": 118, "eval_decode_steps_per_loop": 118, "eval_decode_samples_per_summari": 118, "varialb": 118, "num_el": 119, "substitut": [119, 136, 150, 151], "totensorshap": 119, "temporari": 120, "varwrappertrackassign": 120, "previous_assign": 120, "control_after_assign": 120, "raw_var": 120, "read_valu": 120, "assign_add": 120, "assign_sub": 120, "stackedvarwrapperwithmanualshard": 120, "physic": 120, "_to_manu": 120, "_to_auto": 120, "collaps": [120, 139, 190], "paragraph": 121, "5150": 121, "schuster": 121, "nakajima": 121, "japanes": 121, "korean": 121, "voic": 121, "2012": 121, "ieee": 121, "confer": 121, "acoust": 121, "googleusercont": 121, "media": 121, "research": 121, "archiv": 121, "37842": 121, "wpmencod": 121, "wpm_filepath": 121, "merge_prob": 121, "_tokentostr": 121, "_stringtotoken": 121, "tokstr": 121, "_mergetoken": 121, "_encodetoid": 121, "sentence_start_id": 121, "sentence_start_str": 121, "sentence_end_id": 121, "sentence_end_str": 121, "unk_id": 121, "datasetfunctionerror": 122, "warn_on_error": 122, "apart": 122, "non_dataset_memb": 122, "registersingletaskmodel": [122, 127, 181], "getdatasetsast": 122, "base_dir": 122, "ast": 122, "accur": 122, "trainsummari": [123, 227], "eval_typ": [123, 130], "_getevalfunc": 123, "write_summari": 123, "_evalonc": [123, 130], "_getcheckpointidfordecodeout": [123, 130], "ckpt_id_from_fil": [123, 130], "diverg": [123, 130], "decoder_typ": [123, 130, 223], "_getdecodefunc": 123, "getdecodeoutpath": [123, 130], "decoder_dir": [123, 130], "_decodeonc": 123, "unsetunusedtrainparam": 124, "getexecutorparam": [124, 227], "model_nam": [124, 126, 227], "modelregistri": 124, "ps_params_dict": [124, 227], "programscheduleparam": [124, 227], "train_cfg": [124, 227], "executortpu": [124, 227], "overview": [124, 227], "mega": [124, 227], "cooper": [124, 227], "_maybeconstructsharedmodel": [124, 227], "share_model_object": [124, 227], "_loop": [124, 130, 227], "hyper": [126, 157, 164, 200, 212], "modelparam": [126, 127], "_import": 126, "_insertparam": 126, "everywher": 126, "importallparam": 126, "task_root": 126, "task_dir": 126, "require_success": 126, "registri": [126, 127, 128], "importparam": 126, "_modelregistryhelp": 127, "_model_params_allow_redef": 127, "_model_param": 127, "_registered_modul": 127, "_classpathprefix": 127, "_modelparamsclasskei": 127, "src_cl": 127, "mnist": [127, 152, 154, 155, 224, 227], "lenet5": [127, 156, 227], "conflict": 127, "_getsourceinfo": 127, "_registermodel": 127, "wrapper_cl": 127, "_createwrapperclass": 127, "maybeupdateparamsfromflag": 127, "cfg": [127, 223, 227], "registermultitaskmodel": 127, "getallregisteredclass": 127, "getclass": 127, "class_kei": 127, "lookuperror": 127, "getparamsfrommodelparamsobject": 127, "model_params_obj": 127, "model_params_overrid": 127, "model_params_file_overrid": 127, "getprogramschedulefrommodelparamsobject": 127, "getprogramschedul": 127, "models_test": 128, "_stuboutcreatevari": 128, "variable_cach": 128, "stub": 128, "spend": 128, "traverselay": 128, "tree": 128, "basemodelstest": 128, "_validateema": 128, "mdl": 128, "_testonemodelparam": 128, "createtestmethodsforallregisteredmodel": 128, "task_regex": 128, "exclude_regex": 128, "programmat": 128, "pdb": 129, "catch_post_mortem": 129, "startshel": 130, "local_n": 130, "startenqueueop": [130, 227], "trainertpu": [130, 227], "_cleanup": [130, 227], "evallatestcheckpoint": 130, "last_path": 130, "evalcheckpoint": 130, "ckpt_id": 130, "_removescalarsummari": 130, "getdecoderdir": 130, "getckptidfromfil": 130, "decodecheckpoint": 130, "samples_per_summari": 130, "decodelatestcheckpoint": 130, "contextualizer_bas": [131, 132], "decoder_metr": [131, 132], "decoder_util": [131, 132], "eos_norm": [131, 132], "frontend": [131, 132, 144], "fusion": [131, 132, 134], "levenshtein_dist": [131, 132], "metrics_calcul": [131, 132], "model_test_input_gener": [131, 132], "classifi": [131, 152], "common_schema": [131, 171], "dataset_spec": [131, 171], "dual_encod": [131, 171, 188], "image_preprocessor": [131, 171], "score_funct": [131, 171], "tf_hub_lay": [131, 171], "tpu_util": [131, 171], "base_config": [131, 191], "data_augment": [131, 191], "text_input_pb2": [131, 191], "librispeech": [132, 146], "simple_w": [132, 149], "simple_wer_v2": [132, 149, 150], "contextualizerbas": 133, "contextu": [133, 194, 198], "setcontextmap": 133, "attn": 133, "zeroattent": 133, "queryattent": 133, "la": 133, "accessor": 133, "getcontextdim": 133, "misc_stat": [133, 134], "dec_b": [133, 134], "audio_context": 133, "aud_dim": 133, "audio": [133, 139, 172, 173, 216, 222], "attn_queri": 133, "nullcontextu": 133, "_totensorarrai": 134, "clear_after_read": 134, "tensorarrai": 134, "_newtensorarrai": 134, "asrdecoderbas": 134, "decoderstepst": 134, "cur_target_info": 134, "targetstobefedatcurrentdecodestep": 134, "singledecodestep": 134, "step_out": 134, "poststepdecoderstateupd": 134, "old_stat": 134, "displai": 134, "addadditionaldecodersummari": [134, 140], "seq_out_ta": [134, 140], "computehypswithbeamsearch": 134, "misczerost": 134, "targetinfo": 134, "createtargetinfomisc": 134, "_getattencontextdim": 134, "_createatten": 134, "basezerost": 134, "_getinitialseqstatetensorarrai": 134, "intiti": 134, "computepredictionsdynam": 134, "_getnewattenprob": 134, "misc": [134, 140], "sequenceouttensorarrai": [134, 140], "confidence_logit": 134, "_applydropout": 134, "extra_se": 134, "intial": 134, "_getencoderpad": 134, "misc_zero_st": 134, "softmax_input": [134, 140, 194, 198], "decoderstepzerost": 134, "_adddecoderactivationssummari": 134, "additional_atten_prob": 134, "target_align": 134, "max_source_length": 134, "rnn_output_dim": 134, "_computemetr": 134, "target_prob": 134, "per_sequence_loss": 134, "initdecod": 134, "accuraci": [134, 153, 194], "decoder_step_state_zero_fusion_flat": 134, "decoder_step_state_zero_misc_flat": 134, "decoder_step_st": 134, "_updatesequenceouttensorarrai": 134, "_getattenprobsfromsequenceouttensorarrai": 134, "_getpredictionfromsequenceouttensorarrai": 134, "_getinitialtargetinfo": 134, "target_emb": [134, 194, 198], "computepredictionsfunct": 134, "_computelogit": 134, "_extractconfidencefeatur": 134, "atten_dist": 134, "lm_output": [134, 140], "per_step_src_pad": 134, "use_deterministic_random": 134, "source_enc": [134, 140, 194], "new_decoder_st": 134, "miscellan": [134, 140], "target_info_ta": 134, "asrdecod": 134, "_computeattent": 134, "state_dim": 134, "1609": 134, "08144": 134, "08581": 134, "_getnumhypsforbeamsearch": 134, "_postprocessattenprobsforbeamsearch": 134, "noop": 134, "decodertopk": 135, "beamsearchdecodeoutputtodecodertopk": 135, "decoder_out": [135, 144], "ids_to_strings_fn": 135, "feed_encoder_out": 135, "encoder_out": [135, 144], "top_k_decod": 135, "top_k_scor": 135, "decodermetr": [135, 143], "gettopk": 135, "computenormalizedw": 135, "addadditionaldecodermetricstograph": 135, "filtered_hyp": 135, "filtered_ref": 135, "computemetr": 135, "createmetr": 135, "filterrealexampl": 135, "utt": 135, "detokenizedecoderout": 135, "preparepostprocess": 135, "postprocess_input": [135, 143], "_issymbolorposit": 136, "setrnncellnod": 136, "decoder_param": 136, "rnn_cell_param": 136, "word_err": 136, "editdist": 136, "levenshtein": [136, 142], "edit": [136, 142, 150, 151], "ins": [136, 142, 150, 151], "editdistanceinid": 136, "ref_id": [136, 143], "filterepsilon": 136, "filternois": 136, "convlstmblock": 137, "asrencod": [137, 144], "_use_funct": 137, "forward_p": 137, "backward_p": 137, "createconvlstmlayerparam": 137, "firstlstmlayerinputdimandpad": 137, "conv_output_shap": 137, "pad_to_multipl": 137, "supports_stream": 137, "conv_lstm": 137, "fillpaddingpo": 138, "id_len": 138, "padding_valu": 138, "new_id": [138, 194], "normalizetrailingeo": 138, "need_trailing_eo": 138, "id_len_eos_norm": 138, "max_label_len": 138, "numpynormalizetrailingeo": 138, "reader": [138, 217], "understand": 138, "asrfrontendconfig": 139, "is_nul": 139, "src_type": 139, "src_pcm_scale": 139, "src_pcm_sample_r": 139, "input_frame_ratio": 139, "_nextpoweroftwo": 139, "baseasrfrontend": [139, 144], "precomput": [139, 180, 187], "waveform": 139, "getconfigfromparam": 139, "vital": 139, "nullasrfrontend": 139, "melasrfrontend": 139, "asrfrontend": 139, "mel": [139, 216], "pcm": 139, "framer": 139, "fft": 139, "filterbank": [139, 216], "meanstddev": 139, "packet_s": 139, "channel_count": 139, "mono": 139, "glueless": 139, "influenc": 139, "refactor": 139, "_createwindowfunct": 139, "window_frame_s": 139, "window_frame_step": 139, "_removechanneldim": 139, "pcm_audio_data": 139, "_reshapetomono2d": 139, "rework": 139, "int16": 139, "32768": [139, 166], "_fpropdefault": 139, "_stacksign": 139, "stack_siz": 139, "_padandreshapespec": 139, "mel_spectrogram": 139, "mel_spectrogram_pad": 139, "_applypreemphasi": 139, "framed_sign": 139, "_getmelpad": 139, "pcm_audio_pad": 139, "_fpropchunk": 139, "pcm_audio_chunk": 139, "_melspectrogram": 139, "spectrogram": 139, "f32": 139, "mel_channel": 139, "fusionbas": 140, "_fproplmintern": 140, "lm_state": 140, "_fproplm": 140, "am_output": 140, "base_model_logits_dim": 140, "fused_output": 140, "_modifylmbeforefprop": 140, "computelogitswithlm": 140, "am": 140, "nullfus": 140, "asrinput": 141, "buildinputbatch": [141, 159, 196], "features_list": [141, 159, 196], "_maybepadsourceinput": 141, "errorstat": 142, "tot": 142, "levenshteindist": 142, "lst_ref": 142, "lst_hyp": 142, "postprocessinput": 143, "getrefid": 143, "ref_pad": 143, "calculatemetr": 143, "log_utf8": 143, "utf": 143, "asrmodel": 144, "_decodermetricsparam": 144, "_getdecodertarget": 144, "forwar": 144, "_makedecodertheta": 144, "ridden": 144, "ride": 144, "child_onehot": 144, "frontendandencoderfprop": 144, "input_batch_src": 144, "initial_st": 144, "_gettopk": 144, "_computenormalizedw": 144, "_gettargetfordecodermetr": 144, "_computedecodermetr": 144, "_inferencesubgraph_default": [144, 153, 161, 209], "offlin": 144, "testinputgener": 145, "_check_pad": 145, "getbpropparam": 145, "getbproptyp": 145, "sampleid": 145, "_sourc": 145, "_target": 145, "_getsourceinputsandlabel": 145, "data_sourc": 145, "setbproptyp": 145, "librispeech960bas": 147, "960": 147, "hour": 147, "_commoninputparam": [147, 201, 202], "setbuckets": 147, "devoth": 147, "testoth": 147, "librispeech960graphem": 147, "8x2": 147, "853": 147, "2k": [147, 202], "grapheme_target_sequence_length": 147, "620": 147, "grapheme_vocab_s": 147, "76": [147, 165], "initializetoken": 147, "librispeech960graphemetpuv2": 147, "librispeech960wpm": 147, "632": 147, "6k": 147, "wpm_symbol_table_filepath": 147, "wpm_16k_librispeech": 147, "wpm_target_sequence_length": 147, "140": [147, 165], "wpm_vocab_s": 147, "16328": 147, "embedding_dimens": 147, "96": [147, 165, 166], "num_training_work": 147, "librispeech960wpmtpuv2": 147, "alon": [150, 151], "script": [150, 151, 221, 223], "evalut": [150, 151], "NO": 150, "file_hypothesi": [150, 151], "file_refer": [150, 151], "diagnosis_html": 150, "diagnos": [150, 151], "averagew": 150, "computeeditdistancematrix": [150, 151], "preprocesstxtbeforew": 150, "txt": [150, 151, 163], "cacul": [150, 151], "_generatealignedhtml": 150, "err_typ": [150, 151], "highlight": [150, 151], "disagr": [150, 151], "green": [150, 151], "yellow": [150, 151], "generatesummaryfromerr": 150, "nref": 150, "diagnosi": 150, "diff": 150, "diagnoi": [150, 151], "verbos": 150, "argv": [150, 151, 221, 223, 224], "file_keyphras": 151, "phrase": 151, "_diagnoi": 151, "simplew": 151, "addhypref": 151, "getwer": 151, "getsummari": 151, "getkeyphrasestat": 151, "jaccard": 151, "jaccard_index": 151, "precision_and_recal": 151, "txtpreprocess": 151, "removecommenttxtpreprocess": 151, "brancket": 151, "highlightalignedhtml": 151, "nother": 151, "hyp_word": 151, "ref_word": 151, "key_phras": 151, "html_handler": 151, "preprocess_handl": 151, "aligned_html": 151, "hyp_keyphrase_count": 151, "ref_keyphrase_count": 151, "matched_keyphrase_count": 151, "hyp_keyphras": 151, "wer_info": 151, "insers": 151, "nw": 151, "percentag": [151, 196], "getbreakdownw": 151, "breakdown": 151, "f1_keyphras": 151, "prec": 151, "matched_keyphras": 151, "ref_keyphras": 151, "jaccard_similar": 151, "str_detail": 151, "str_str_keyphrases_info": 151, "kerphras": 151, "str_sum": 151, "topkaccuraci": 153, "baseclassifi": 153, "_addsummari": 153, "_accuraci": 153, "modelv1": 153, "maxpool": 153, "modelv2": 153, "_mnistinputbas": 154, "mnisttraininput": 154, "mnisttestinput": 154, "_getrandomimag": 154, "_getrandomlabel": 154, "fakemnistdata": 154, "tmpdir": 154, "train_siz": 154, "60000": 154, "test_siz": 154, "10000": [154, 166], "lenet": 156, "synthetic_packed_input": [158, 162, 170], "wiki_bert": [158, 162], "download_lm1b": [158, 168], "gshard_lm_decod": [158, 168], "lminput": 159, "lm1b": [159, 163, 169], "packedtextinputgener": 159, "_processsingleexampl": 159, "_datasetofexampl": 159, "_getpaddingvalu": 159, "add_segment_field": 159, "unbatch": 159, "_pack": [159, 196], "batch_in": 159, "tf_session": 159, "tfrecordbertinput": 159, "_parserecord": 159, "_padtobatchs": 159, "masked_id": 159, "baselanguagemodel": 160, "xent_output": 160, "stepoutputdimens": 160, "last_hidden": 160, "getfeeddict": 160, "combinest": 160, "switch_cond": 160, "nulllm": 160, "_rnnoutputs": 160, "computexentoutput": 160, "softmax_lay": 160, "softmax_theta": 160, "crossentropi": 160, "rnnlmnoembed": 160, "direct_featur": 160, "direct_feature_dim": 160, "rnnlm": 160, "2048": [160, 163, 165, 166, 204], "rnn_hidden_dim": 160, "layer_norm": 160, "softmax_max_alloc": 160, "couple_input_forget_g": 160, "forget": 160, "conditionalrnnlm": 160, "condition_dim": 160, "moelm": 160, "transformerlmnoembed": 160, "transformerlm": 160, "input_dropout_prob": [160, 192, 204], "attention_hidden_dim": 160, "micro_batch_s": 160, "num_shard": [160, 192], "languagemodel": 161, "_trimifpossiblethentranspos": 161, "max_lstm_gradient_norm": 161, "log_pplx_per_token": 161, "log_pplx_per_sampl": 161, "num_oovs_per_sampl": 161, "tokens_from_label": 161, "fixedshapeinputlanguagemodel": 161, "batchmajorlanguagemodel": 161, "_trimifposs": 161, "packedbatchmajorlanguagemodel": 161, "wordlevelonebwdsbas": 163, "wd": 163, "rafaljozefowicz": 163, "corpus_dir": 163, "r13output": 163, "max_token": 163, "num_embedding_shard": 163, "8192": [163, 165], "num_softmax_shard": 163, "rnn_state_dim": 163, "793472": 163, "word_vocab": 163, "wordlevelonebwdssimplesampledsoftmax": 163, "wordlevelonebwdssimplesampledsoftmaxtini": 163, "onebwdsgpipetransformerwpm": 163, "32000": [163, 165, 166, 192, 201, 204], "1bw": 163, "synthet": 165, "synthetictrain": 165, "denselmtempl": 165, "batch_dim_per_devic": 165, "0625": 165, "65536": 165, "num_transformer_lay": [165, 166, 197], "gated_gelu": [165, 166], "positional_embed": [165, 166], "denselm8b2x2": 165, "8b": 165, "125": [165, 166], "denselm8b2x2decod": [165, 170], "denselm128b8x8": 165, "128b": 165, "14": [165, 166, 201, 204, 218], "34": [165, 166], "36": [165, 166], "38": [165, 166], "40": [165, 166], "44": [165, 166], "47": [165, 166], "45": [165, 166], "43": [165, 166, 218], "41": [165, 166], "66": [165, 166], "68": 165, "70": 165, "72": 165, "74": 165, "78": 165, "79": 165, "77": 165, "75": 165, "73": 165, "71": 165, "69": 165, "67": [165, 181], "65": [165, 166], "98": 165, "102": 165, "104": 165, "106": 165, "108": 165, "110": 165, "111": 165, "109": 165, "107": 165, "105": 165, "103": 165, "101": 165, "99": 165, "97": 165, "112": 165, "114": 165, "116": 165, "118": 165, "122": 165, "124": 165, "126": [165, 166], "127": [165, 166], "121": 165, "119": 165, "117": 165, "115": 165, "113": 165, "80": 165, "82": 165, "84": 165, "86": 165, "88": 165, "90": 165, "92": 165, "94": 165, "95": 165, "93": 165, "91": 165, "89": 165, "87": 165, "85": 165, "83": 165, "81": 165, "48": [165, 166], "52": [165, 166], "54": [165, 166], "56": [165, 166, 218], "58": [165, 166], "62": [165, 166], "63": [165, 166], "61": [165, 166], "59": [165, 166], "57": [165, 166], "55": [165, 166], "53": [165, 166], "49": [165, 166], "18": [165, 166], "22": [165, 166, 170], "26": [165, 166, 218], "denselm128b16x16": 165, "v3": 165, "512": [165, 166, 204], "130": [165, 166], "132": 165, "134": 165, "136": 165, "138": 165, "142": 165, "144": 165, "146": 165, "148": 165, "150": 165, "152": 165, "154": 165, "156": 165, "158": 165, "159": 165, "157": 165, "155": 165, "153": 165, "151": 165, "149": 165, "147": 165, "145": 165, "143": 165, "141": 165, "139": 165, "137": 165, "135": 165, "133": 165, "131": 165, "129": [165, 166], "192": 165, "194": 165, "196": 165, "198": 165, "200": [165, 166], "202": 165, "204": 165, "206": 165, "208": 165, "210": 165, "212": 165, "214": 165, "216": 165, "218": 165, "220": 165, "222": 165, "223": 165, "221": 165, "219": 165, "217": 165, "215": 165, "213": 165, "211": 165, "209": 165, "207": 165, "205": 165, "203": 165, "201": 165, "199": 165, "197": 165, "195": 165, "193": 165, "258": [165, 166], "260": 165, "262": 165, "264": 165, "266": 165, "268": 165, "270": 165, "272": 165, "274": 165, "276": 165, "278": 165, "280": 165, "282": 165, "284": 165, "286": 165, "287": 165, "285": 165, "283": 165, "281": 165, "279": 165, "277": 165, "275": 165, "273": 165, "271": 165, "269": 165, "267": 165, "265": 165, "263": 165, "261": 165, "259": 165, "257": [165, 166], "320": 165, "322": 165, "324": 165, "326": 165, "328": 165, "330": 165, "332": 165, "334": 165, "336": 165, "338": 165, "340": 165, "342": 165, "344": 165, "346": 165, "348": 165, "350": 165, "351": 165, "349": 165, "347": 165, "345": 165, "343": 165, "341": 165, "339": 165, "337": 165, "335": 165, "333": 165, "331": 165, "329": 165, "327": 165, "325": 165, "323": 165, "321": 165, "384": 165, "386": 165, "388": 165, "390": 165, "392": 165, "394": 165, "396": 165, "398": 165, "400": 165, "402": 165, "404": 165, "406": 165, "408": 165, "410": 165, "412": 165, "414": 165, "415": 165, "413": 165, "411": 165, "409": 165, "407": 165, "405": 165, "403": 165, "401": 165, "399": 165, "397": 165, "395": 165, "393": 165, "391": 165, "389": 165, "387": 165, "385": 165, "448": 165, "450": 165, "452": 165, "454": 165, "456": 165, "458": 165, "460": 165, "462": 165, "464": 165, "466": 165, "468": 165, "470": 165, "472": 165, "474": 165, "476": 165, "478": 165, "479": 165, "477": 165, "475": 165, "473": 165, "471": 165, "469": 165, "467": 165, "465": 165, "463": 165, "461": 165, "459": 165, "457": 165, "455": 165, "453": 165, "451": 165, "449": 165, "480": 165, "482": 165, "484": 165, "486": 165, "488": 165, "490": 165, "492": 165, "494": 165, "496": 165, "498": 165, "500": 165, "502": 165, "504": 165, "506": 165, "508": 165, "510": [165, 166], "511": [165, 166], "509": [165, 166], "507": 165, "505": 165, "503": 165, "501": 165, "499": 165, "497": 165, "495": 165, "493": [165, 170], "491": 165, "489": 165, "487": 165, "485": 165, "483": 165, "481": 165, "416": 165, "418": 165, "420": 165, "422": 165, "424": 165, "426": 165, "428": 165, "430": 165, "432": [165, 170], "434": 165, "436": 165, "438": 165, "440": 165, "442": 165, "444": 165, "446": 165, "445": 165, "443": 165, "441": 165, "439": 165, "437": 165, "435": 165, "433": 165, "431": 165, "427": 165, "425": 165, "423": 165, "421": 165, "419": 165, "417": 165, "352": 165, "354": 165, "356": 165, "358": 165, "360": 165, "362": 165, "364": 165, "366": 165, "368": 165, "370": 165, "372": 165, "374": 165, "376": 165, "378": 165, "380": [165, 185], "382": 165, "383": 165, "381": 165, "379": 165, "377": 165, "375": 165, "373": 165, "371": 165, "369": 165, "367": 165, "365": 165, "363": 165, "361": 165, "359": 165, "357": 165, "355": 165, "353": 165, "288": 165, "290": 165, "292": 165, "294": 165, "296": 165, "298": 165, "302": 165, "304": 165, "306": 165, "308": 165, "310": 165, "312": 165, "314": 165, "316": 165, "318": 165, "319": 165, "317": 165, "315": 165, "313": 165, "311": 165, "309": 165, "307": 165, "305": 165, "303": 165, "301": 165, "299": [165, 185], "297": 165, "295": 165, "293": 165, "291": 165, "289": 165, "224": 165, "226": 165, "228": 165, "230": 165, "232": 165, "234": 165, "236": 165, "238": 165, "240": 165, "242": 165, "244": 165, "246": 165, "248": 165, "250": 165, "252": 165, "254": [165, 166], "255": [165, 166], "253": [165, 166], "251": 165, "249": 165, "247": 165, "245": 165, "243": 165, "241": 165, "239": 165, "237": 165, "235": 165, "233": 165, "229": 165, "227": 165, "225": 165, "160": 165, "162": 165, "164": 165, "166": 165, "168": 165, "170": 165, "172": 165, "174": 165, "176": 165, "178": 165, "180": 165, "182": 165, "184": 165, "186": 165, "188": 165, "190": [165, 166], "191": [165, 166], "189": [165, 166], "187": 165, "185": 165, "183": 165, "181": 165, "179": 165, "177": 165, "175": 165, "173": 165, "171": 165, "169": 165, "167": 165, "165": 165, "163": 165, "161": 165, "denselm175b32x32": 165, "175b": [165, 166], "49152": [165, 166], "12288": [165, 166], "1856": [165, 166], "1920": [165, 166], "1984": [165, 166], "1857": [165, 166], "1921": [165, 166], "1985": [165, 166], "1858": [165, 166], "1922": [165, 166], "1986": [165, 166], "1917": [165, 166], "1981": [165, 166], "2045": [165, 166], "1918": [165, 166], "1982": [165, 166], "2046": [165, 166], "1919": [165, 166], "1983": [165, 166], "2047": [165, 166], "denselm175b32x32dp": 165, "denselm175b1k": 165, "v4": 165, "976": [165, 166], "977": [165, 166], "978": [165, 166], "989": [165, 166], "990": [165, 166], "991": [165, 166], "992": [165, 166], "993": [165, 166], "994": [165, 166], "1005": [165, 166], "1006": [165, 166], "1007": [165, 166], "1008": [165, 166, 198], "1009": [165, 166], "1010": [165, 166], "1021": [165, 166], "1022": [165, 166], "1023": [165, 166], "denselm13b32x32": 165, "5120": [165, 166], "20480": [165, 166], "denselm175b8x8decode2d": 165, "denselm1t16x16": 165, "1t": [165, 166], "03125": 165, "131072": [165, 166], "16384": [165, 166], "denselm128b32x32": 165, "shardedadamoptim": 165, "999": [165, 192], "adamoptim": 165, "shardedadam": 165, "denselm12kwide41badam16x16": 165, "41b": 165, "denselm12kwide41badam8x8": 165, "denselm12kwide162badam16x16": 165, "162b": 165, "denselm12kwide162badambs25616x16": 165, "denselm12kwide162badam32x32": 165, "berttempl": 166, "attention_dropout_r": 166, "loss_denomin": 166, "train_exes_per_ev": 166, "gated_ffn_act": 166, "mlperftraintempl": 166, "mlperftrainbertdense2b": 166, "2b": 166, "30522": 166, "mlperfbertdense1t": 166, "chip": 166, "mlperfbertdense1twid": 166, "mlperfbertdense175b": 166, "mlperfbertdense500b": 166, "481b": 166, "remove_mask": 166, "mlperfbertdense500b2k": 166, "1280": 166, "1536": 166, "1792": 166, "513": 166, "1281": 166, "1537": 166, "1793": 166, "514": 166, "1282": 166, "1538": 166, "1794": 166, "765": 166, "1533": 166, "1789": 166, "766": 166, "1534": 166, "1790": 166, "767": 166, "1535": 166, "1791": 166, "mlperfbertdense13b32x32": 166, "13b": 166, "berttoken": 167, "detoken": 167, "www": [169, 185, 214], "statmt": 169, "print_output": 170, "gshardlmdecod": 170, "init_vocab": 170, "encode_string_to_id": 170, "decode_ids_to_str": 170, "override_flag": 170, "ids_to_strings_pack": 170, "skip_empti": 170, "preload_lm_prompt": 170, "tsv_file": 170, "tsv_data": 170, "append_extra_eo": 170, "preload": 170, "prompt": 170, "tsv": [170, 196], "read_files_1_col": 170, "tack": 170, "delimited_lm": 170, "lineno": 170, "fileno": 170, "read_file_1_col": 170, "gshardlmdecodebatch": 170, "preload_data": 170, "write_ith_sample_to_output": 170, "batch_decod": 170, "unused_argv": [170, 227], "cxc": [171, 179, 187], "dual_encoder_recip": [171, 179], "generic_dataset": [171, 179], "prepare_coco": [171, 186], "_featur": 172, "imagefeatur": 172, "images_per_exampl": 172, "usabl": 172, "textfeatur": 172, "captions_per_exampl": 172, "bert_embeddings_shap": 172, "schema": [172, 174], "audiofeatur": 172, "mfcc_shape": 172, "cpc8k_shape": 172, "mfcc": 172, "cpc": 172, "8k": 172, "magic": 173, "modal": [173, 175, 178, 184], "items_per_exampl": 174, "modality_batch_shap": [174, 178], "datasetspec": [174, 181], "_inferdefaultbatchshap": 174, "datasetv2": 174, "examplepair": [174, 178, 182], "filebaseddatasetspec": 174, "split_path": 174, "file_read": 174, "parser": 174, "label_fn": 174, "input_filepattern": 174, "shuffle_buffer_s": 174, "num_exampl": 174, "num_epoch": 174, "read_parallel": 174, "tfrecorddatasetspec": [174, 182], "fixedlenfeatur": 174, "fixedlensequencefeatur": 174, "_encodebatch": 175, "batch_shap": [175, 190], "encoderconfig": 175, "dualencod": 175, "encodemod": 175, "joint_embedding_dim": 175, "milantask": 175, "cloud": [176, 227], "repo": 176, "_distortbrightnessandcolor": 176, "distort": 176, "bright": 176, "color": 176, "imagepreprocessor": [176, 181], "incept": 176, "jpeg": 176, "rgb": 176, "resiz": 176, "output_image_s": 176, "output_rang": 176, "undergo": 176, "crop": 176, "training_crop_min_area": 176, "bilinearli": 176, "eval_crop_area": 176, "_preprocessfortrain": 176, "_preprocessforev": 176, "encoded_imag": 176, "milaninputgener": 177, "dataset_fn": 177, "dataset_fn_kwarg": 177, "preprocessor": [177, 181], "preprecessor": 177, "foopreprocessor": 177, "_filterfeaturesbynam": 177, "tradit": 178, "supervis": 178, "fly": 178, "relationship": 178, "fit": [178, 196], "priori": 178, "unrel": 178, "incorrect": 178, "unnecessari": 178, "example_id": 178, "easi": 178, "detect": 178, "trinari": 178, "ignore_pair_label": 178, "query_exampl": 178, "query_mod": 178, "result_exampl": 178, "result_mod": 178, "superset": 178, "query_batch_s": 178, "result_batch_s": 178, "rectangular": 178, "constitut": 178, "withinbatch": 178, "betweenlocalandglobalbatch": 178, "local_batch": 178, "examplepairlabel": 178, "drop_pairs_that_match": 178, "_broadcastexamplepairlabelstoallitempair": 178, "example_pair_label": 178, "queries_shap": 178, "results_shap": 178, "_ignorepairswher": 178, "multiitemexamplewrapp": 178, "former": 178, "modality_shap": 178, "intra": 178, "multilabelcontrastiveloss": 178, "positive_class": 178, "p_i": 178, "positive_class_i": 178, "softmax_cross_entropy_with_logit": 178, "crisscross": [180, 187], "parekh": 180, "al": 180, "intramod": 180, "intermod": 180, "judgment": 180, "coco": [180, 187], "eacl": 180, "15020": 180, "_baseimagetextrecip": 180, "dualencoderrecip": [180, 181], "recip": [180, 181], "addefficientnetb4imageencod": 180, "image_featur": [180, 181], "id_featur": [180, 181], "addbertadaptertextencod": 180, "bert_embeddings_featur": 180, "token_featur": 180, "lengths_featur": 180, "768": 180, "efficientnetb4bertadapt": 180, "efficientnet": [180, 185], "b4": [180, 185], "default_dataset": [180, 181], "recipeerror": 181, "advertis": 181, "myexperi": 181, "addmod": 181, "input_featur": 181, "text_featur": 181, "text_id": 181, "mytextencod": 181, "encoder_output_dim": 181, "addpreprocessor": 181, "image_id": 181, "myimageencod": 181, "_choosedatasetspec": 181, "encoder_config": 181, "startfromcheckpoint": 181, "tracker": [181, 187], "_simpleimagecaptiondatasetlabel": 182, "image_id_featur": 182, "imagetexttfrecord": 182, "common_shema": 182, "paramsfromenv": 182, "environment_vari": 182, "milan_dataset_config_json": 182, "die_if_unset": 182, "dotproductscorefunct": 184, "x_batch_siz": 184, "encoded_dim": 184, "y_batch_siz": 184, "_wrapnonlingvovar": 185, "dest_lay": 185, "trainable_vari": 185, "trackabl": 185, "_addupdateopstosignatur": 185, "hub": [185, 187], "imagemodul": 185, "common_signatur": 185, "inception_model": 185, "inception_v3": 185, "module_path": 185, "tfhub": 185, "imagenet": 185, "feature_vector": 185, "update_batch_norm": 185, "imagemodulev2": 185, "efficientnet_b4": 185, "efficientnetb4param": 185, "web": 187, "tensorflow_dataset": 187, "tensorflow_hub": 187, "gb": 187, "storag": 187, "tfds_data_dir": 187, "tfhub_cache_dir": 187, "my": 187, "tfhubbertencod": 187, "input_str": 187, "padded_featur": 187, "bert_feature_dim": 187, "dict_to_example_proto": 187, "example_dict": 187, "readcocofromtfdsfn": 187, "unused_arg": 187, "dofn": 187, "coco_capt": 187, "dofnrunn": 187, "pcollect": 187, "elementparam": 187, "timestampparam": 187, "sideinputparam": 187, "windowparam": 187, "timerparam": 187, "userst": 187, "runtimetim": 187, "stateparam": 187, "runtimest": 187, "keyparam": 187, "restrictionparam": 187, "iobas": 187, "restrictiontrack": 187, "treatment": 187, "splittabl": 187, "watermarkestimatorparam": 187, "watermark": 187, "encodecaptionsfn": 187, "encoder_param": 187, "bundl": 187, "transient": 187, "dispos": 187, "teardown": 187, "concatenateacrossreplica": 188, "stop_cross_gradi": 188, "crossreplicaconcat": 188, "local_tensor": 188, "neon": 188, "gettransformerstackwithembeddinginput": 189, "fixed_dim_encod": 189, "batchmajortotimemajor": 190, "makefnlay": 190, "add_two_th": 190, "getfromnestedmapordi": 190, "di": 190, "nice": 190, "selector": 190, "restructur": 190, "simplest": 190, "tuple_selector": 190, "fancy_selector": 190, "inferbatchs": 190, "resolvebatchdim": 190, "batchflatten": 190, "mess": 190, "bf": 190, "flat_input": 190, "flat_output": 190, "unflatten": 190, "nearli": 190, "fewer": 190, "flat_tensor": 190, "_packa": 190, "_getflatshap": 190, "flattenbatch": 190, "unflattenbatch": 190, "collectregularizationloss": 190, "regularzi": 190, "padortrimdimens": 190, "new_siz": 190, "xendec": [191, 198, 199], "wmt14_en_d": [191, 199, 203], "wmtm16_en_d": [191, 199], "inittraindatasetparam": 192, "nmtinput": [192, 196], "inittestdatasetparam": 192, "inittransformertestbucket": 192, "inittransformertrainbucket": 192, "setuptransformerparam": 192, "label_smoothing_uncertainti": 192, "is_transpar": [192, 194, 195, 197], "add_unnormalized_residu": 192, "atten_hidden_dim": 192, "num_encoder_lay": 192, "num_decoder_lay": 192, "16000": [192, 211], "4000": [192, 204], "40000": 192, "vaswani": 192, "2017": 192, "setuptransformerdecod": 192, "setuptransformerencod": 192, "setuprnmtparam": 192, "lr_warmup_step": 192, "lr_decay_start": 192, "lr_decay_end": 192, "lr_min": 192, "ls_uncertainti": 192, "l2_regularizer_weight": 192, "adam_beta1": 192, "adam_beta2": 192, "adam_epsilon": 192, "8e": 192, "07": 192, "rnmt": [192, 198, 211], "setupxendectransformerparam": 192, "use_dim_scal": 192, "dim_scal": 192, "seq_id": 193, "mtbasedecod": 194, "_computexentloss": 194, "time_axi": 194, "_computesoftmaxmetr": 194, "xent_loss": 194, "_fpropsoftmax": 194, "_truncatetargetsequ": 194, "_addattenprobssummari": 194, "_expandtonumhyp": 194, "source_enc_len": 194, "src_enc_len": 194, "mtdecoderv1": 194, "_float_dtype_max_scal": 194, "05": 194, "_createproject": 194, "proj_tpl": 194, "applydropout": 194, "_zerooutfirsttimestep": 194, "token_emb": 194, "samplesequencedecod": 194, "_initdecod": 194, "_getattentioninitst": 194, "_decoderinit": 194, "_setattentioninitst": 194, "_getattentionsourcest": 194, "rnn_state": 194, "atten_st": 194, "_forcealign": 194, "source_num_sent": 194, "hyp_num_sent": 194, "sentence_boundary_token_id": 194, "misalign": 194, "unequ": 194, "_updatelogitsforsingletokenfastdecod": 194, "is_single_token": 194, "_removeeosprob": 194, "num_trans_lay": 194, "target_length": [194, 198], "last_decoder_out": 194, "_addattenprobsscalarsummari": 194, "primarili": 194, "reveal": 194, "multi_headed_atten_prob": 194, "1_v_2": 194, "1_v_3": 194, "3rd": 194, "source_padding_ratio": 194, "1_v_mean": 194, "quantiti": 194, "insertiondecod": 194, "transformerbatchmajordecod": 194, "_maybetransposeencoderoutput": 194, "target_data_format": 194, "_maybetransposetarget": 194, "input_data_format": 194, "updated_prefix_st": 194, "_fpropfastsoftmax": 194, "xentropi": 194, "bs_result": 194, "transformerxdecod": 194, "mainli": 194, "kl": 194, "interpolation_batch": [194, 195], "source_emb": [194, 198], "ref_prob": 194, "tesnor": 194, "mtencoderv1": 195, "mtencoderunirnn": 195, "mtencoderbirnn": 195, "_computeinput": 195, "mtencoderbirnnprecomputedembed": 195, "transformer_stack": 195, "embedded_input": 195, "transformerbatchmajorencod": 195, "builder_param": 195, "selfatten_add_unnormalized_input": 195, "selfatten_enable_value_proj": 195, "output_data_format": 195, "transformerxencod": 195, "2106": [195, 198, 204], "04060": [195, 198, 204], "mlperfinput": 196, "_getsegmentpo": 196, "_getdescriptorsetfortextinput": 196, "textpackedinput": 196, "textinput": 196, "utf8": 196, "input_file_typ": 196, "tab": 196, "sentencepair": [196, 205], "quality_score_filter_fn": 196, "tokenizer_dict": 196, "packing_factor": 196, "discard": 196, "src_packed_token_ratio": 196, "tgt_packed_token_ratio": 196, "fluctuat": 196, "believ": 196, "remedi": 196, "conserv": 196, "num_samples_in_batch": 196, "exmpl": 196, "num_packed_exampl": 196, "targt": 196, "conrol": 196, "meaning": 196, "file_pattern_task_id": 196, "task_to_": 196, "_lang_map": 196, "eaxmpl": 196, "souce_id": 196, "lang_id": 196, "overload": 196, "logical_and": 196, "multithread": 196, "num_batcher_thread": 196, "_getbucketkei": 196, "_gettaskid": 196, "_getlangid": 196, "_processsingleinput": 196, "_processmassinput": 196, "_readrecordtsv": 196, "_readrecordtsvsinglecolumn": 196, "_readrecordsentencepairproto": 196, "_applypack": 196, "_scaledbatchs": 196, "_addnois": 196, "00043": 196, "hyparam": 196, "denois": 196, "shuffle_tok_rang": 196, "drop_tok_prob": 196, "blank_tok_prob": 196, "noise_sent_prob": 196, "nmtdoubleinput": 196, "monolingu": 196, "mono_source_id": 196, "mono_target_id": 196, "mono_source_pad": 196, "padd": 196, "mono_target_label": 196, "mono_target_pad": 196, "mono_target_weight": 196, "natural_ord": 196, "narur": 196, "nmtinputwithmono": 196, "_selectmaskposit": 196, "sampled_num": 196, "_shuffleword": 196, "permutation_dist": [196, 204], "_maskword": 196, "_generatenoises": 196, "_createsourcelambda": 196, "_processbatch": 196, "transformer_input": 197, "num_transparent_output": 197, "mtbasemodel": 198, "_encoderdevic": 198, "_decoderdevic": 198, "_gettokenizerkeytous": 198, "_beamsearchdecod": 198, "_postprocessbeamsearchdecodeout": 198, "rnmtmodel": [198, 209, 211], "p18": 198, "hybridmodel": 198, "insertionmodel": 198, "_samplecanvasandtarget": 198, "_createcanvasandtarget": 198, "transformerxendecmodel": 198, "_createtargetlambda": 198, "source_lambdas_pair": 198, "source_paddings_pair": 198, "target_paddings_pair": 198, "input_lambda": 198, "label_lambda": 198, "other_batch": 198, "source_lambda": 198, "target_lambda": 198, "conta": 198, "wmt": [201, 202, 204], "german": [201, 202, 204], "wmtendetransformerbas": 201, "datadir": [201, 202, 204], "wmt14": 201, "wmtendetransformersmal": 201, "wmtendetransformersmallcloudtpu": 201, "wmtendernmt": 201, "wmtendernmtcloudtpu": 201, "mmt": 202, "wmtcaptionendetransform": 202, "wmtm16": 202, "2000": 202, "vocab_fil": [202, 218], "voc": 202, "wmtcaptionendetransformercloudtpu": 202, "wmtendexendec": 204, "wmt14end": 204, "datatrain": 204, "datadev": 204, "newstest2013": 204, "00000": 204, "00001": 204, "datatest": 204, "newstest2014": 204, "wpm32k": 204, "source_mask_ratio": 204, "source_mask_ratio_beta": 204, "mask_word_id": 204, "pad_id": 204, "mask_words_ratio": 204, "loss_mix_weight": 204, "loss_clean_weight": 204, "loss_mono_weight": 204, "batch_size_ratio": 204, "4506303": 204, "use_prob_cl": 204, "atten_drop": 204, "use_atten_cl": 204, "use_prob_drop": 204, "_evalparam": 204, "wmtdeenxendec": 204, "wmt14deen": 204, "lang": 205, "src_sentenc": 205, "tgt_sentenc": 205, "codelab": [207, 210], "download_brown_corpu": [207, 213], "textlin": 208, "punctuatorinput": 208, "_process": 208, "_processlin": 208, "_getsequencelength": 208, "browncorpuswpm": 211, "brown": [211, 214], "_datadir": 211, "punctuator_data": 211, "_vocab_fil": 211, "brown_corpus_wpm": 211, "_vocab_s": 211, "nltk": 214, "nltk_data": 214, "decodeflactowav": 216, "input_byt": 216, "flac": 216, "wav": 216, "decodewav": 216, "audiotomfcc": 216, "sample_r": 216, "window_size_m": 216, "window_stride_m": 216, "num_coeffici": 216, "extractlogmelfeatur": 216, "wav_bytes_t": 216, "16khz": 216, "car": 217, "beaminit": 217, "getpipelineroot": 217, "pardo": 217, "exit": 217, "pipeline_opt": 217, "pipelineopt": 217, "getread": 217, "value_cod": 217, "coder": 217, "getwrit": 217, "getemitterfn": 217, "emitt": 217, "words_to_id": 218, "THAT": 218, "THE": 218, "THEIR": 218, "workflow": 218, "train_fil": 218, "code_fil": 218, "train_bpe_fil": 218, "words_to_ids_fil": 218, "_getvocabulari": 218, "_extracttoken": 218, "encoded_filepath": 218, "_hyperparams_text_to_dict": 219, "cfg_text": 219, "hyperparams_text_diff": 219, "cfg1_text": 219, "cfg2_text": 219, "cfg1_not_cfg2": 219, "cfg1": 219, "cfg2": 219, "cfg2_not_cfg1": 219, "cfg1_and_cfg2_diff": 219, "print_hyperparams_text_diff": 219, "path1": 219, "path2": 219, "get_model_params_as_text": 219, "model_path": 219, "statscollector": 220, "_accumulatemo": 220, "float_list": 220, "_computemeanvar": 220, "tf_ex": 220, "_printlengthbucket": 220, "_printmeanvar": 220, "littl": 221, "leverag": 221, "recommend": 221, "tarbal": 222, "_makebytesfeatur": [222, 226], "unicode_arrai": [222, 226], "_makeint64featur": [222, 226], "_makefloatfeatur": [222, 226], "_maketfexampl": [222, 226], "uttid": 222, "_readtranscript": 222, "_dumptranscript": 222, "_loadtranscriptionsfromfil": 222, "_makelogmelfromtensorflowbuiltin": 222, "tf_wav_byt": 222, "_opensubshard": 222, "_closesubshard": 222, "_selectrandomshard": 222, "_createasrfeatur": 222, "launch": 223, "gke": 223, "deploy": 223, "gc": 223, "docker": 223, "gcp": 223, "instal": 223, "gcloud": 223, "base_imag": 223, "date": 223, "trainer_cel": 223, "decoder_cel": 223, "yaml": 223, "python3": 223, "lingvo_lib_gpu": 223, "docker_imag": 223, "tpu_typ": 223, "tpu_cluster_nam": 223, "gpu_cluster_nam": 223, "decoder_gpu": 223, "gpu_typ": 223, "extra_env": 223, "kitti_dir": 223, "gcs_path": 223, "exp_nam": 223, "your_code_dir": 223, "action": 223, "_get_or_add": 223, "add_gpu_to_pod": 223, "num_gpu": 223, "set_pod_cpu_memori": 223, "cpu_memori": 223, "decoder_templ": 223, "_tpu_resourc": 223, "tpu_training_templ": 223, "tensorboard_templ": 223, "port": 223, "build_docker_imag": 223, "code_directori": 223, "push": 223, "gcr": 223, "get_gke_clust": 223, "gke_cluster_spec": 223, "shorthand": 223, "p100": 223, "europ": 223, "west4": 223, "nh16": 223, "qualifi": 223, "create_tpu_clust": 223, "cluster_nam": 223, "validate_arg": 223, "usageerror": 223, "_listdebugstr": 225, "to_str": 225, "_customshortdebugstr": 225, "tf_exampl": 225, "_printhead": 225, "_printfil": 225, "_asserttextformat": 226, "src_i": 226, "src_": 226, "tgt_i": 226, "tgt_": 226, "tfexampl": 226, "_runencod": 226, "bin": 227, "logtostderr": 227, "run_loc": 227, "cuda": 227, "command": 227, "_validatevizierreportingjob": 227, "_getclusterspecdict": 227, "cluster_spec": 227, "runnermanag": 227, "maybelaunchtensorflow": 227, "machineri": 227, "high_level": 227, "getparamsfordataset": 227, "maybeconfigrundistribut": 227, "maybeconfigcloudtpu": 227, "updateclusterparamsfromflag": 227, "_createrunn": 227, "createrunn": 227, "startrunn": 227, "all_runn": 227, "runtrial": 227, "maybeconfigrunloc": 227, "inspectparam": 227, "inspect_param": 227, "inspectmodel": 227, "inspectdataset": 227, "inspectdecod": 227, "setmodelnam": 227, "writeinferencegraph": 227, "runevaleronc": 227}, "objects": {"": [[1, 0, 0, "-", "lingvo"]], "lingvo": [[2, 0, 0, "-", "base_runner"], [3, 0, 0, "-", "base_trial"], [4, 0, 0, "-", "compat"], [5, 0, 0, "-", "core"], [122, 0, 0, "-", "datasets"], [123, 0, 0, "-", "eager_runners"], [124, 0, 0, "-", "executor"], [126, 0, 0, "-", "model_imports"], [127, 0, 0, "-", "model_registry"], [128, 0, 0, "-", "models_test_helper"], [129, 0, 0, "-", "pdb_wrapper"], [130, 0, 0, "-", "runners"], [131, 0, 0, "-", "tasks"], [215, 0, 0, "-", "tools"], [227, 0, 0, "-", "trainer"], [228, 0, 0, "-", "trainer_utils"]], "lingvo.base_runner": [[2, 1, 1, "", "BaseRunner"]], "lingvo.base_runner.BaseRunner": [[2, 2, 1, "", "GetTrainDir"], [2, 2, 1, "", "Start"], [2, 2, 1, "", "_CreateCheckpointer"], [2, 2, 1, "", "_CreateSummaryWriter"], [2, 2, 1, "", "_CreateTF2SummaryOps"], [2, 2, 1, "", "_CreateTF2SummaryWriter"], [2, 2, 1, "", "_DequeueThreadComplete"], [2, 2, 1, "", "_ExportMetrics"], [2, 2, 1, "", "_FindNewCheckpoint"], [2, 2, 1, "", "_FormatStatusMessage"], [2, 2, 1, "", "_GetSession"], [2, 2, 1, "", "_GetTtlDir"], [2, 2, 1, "", "_InVizierStudy"], [2, 2, 1, "", "_InitializeTF2SummaryWriter"], [2, 2, 1, "", "_LoopEnqueue"], [2, 2, 1, "", "_RunLoop"], [2, 2, 1, "", "_RunOnAllCheckpoints"], [2, 2, 1, "", "_RunOnLatestCheckpoints"], [2, 2, 1, "", "_RunTF2SummaryOps"], [2, 2, 1, "", "_SetStatusMessage"], [2, 2, 1, "", "_ShouldEarlyStop"], [2, 2, 1, "", "_ShouldStop"], [2, 2, 1, "", "_TF2SummaryContext"], [2, 2, 1, "", "_TrainerFinished"], [2, 2, 1, "", "_UpdateEarlyStopMetric"], [2, 2, 1, "", "_WaitUntilInit"], [2, 2, 1, "", "_WriteInputDataStatSummaries"], [2, 2, 1, "", "_WriteSummaries"], [2, 2, 1, "", "_WriteToLog"], [2, 3, 1, "", "params"]], "lingvo.base_trial": [[3, 1, 1, "", "NoOpTrial"], [3, 1, 1, "", "Trial"], [3, 4, 1, "", "TunerManagedError"]], "lingvo.base_trial.NoOpTrial": [[3, 2, 1, "", "Name"], [3, 2, 1, "", "OverrideModelParams"], [3, 2, 1, "", "ReportDone"], [3, 2, 1, "", "ReportEvalMeasure"], [3, 2, 1, "", "ShouldStop"], [3, 2, 1, "", "ShouldStopAndMaybeReport"]], "lingvo.base_trial.Trial": [[3, 2, 1, "", "Name"], [3, 2, 1, "", "OverrideModelParams"], [3, 2, 1, "", "Params"], [3, 2, 1, "", "ReportDone"], [3, 2, 1, "", "ReportEvalMeasure"], [3, 2, 1, "", "ShouldStop"], [3, 2, 1, "", "ShouldStopAndMaybeReport"], [3, 2, 1, "", "_DoReportTrainingProgress"], [3, 3, 1, "", "objective_metric_key"], [3, 3, 1, "", "report_interval_seconds"]], "lingvo.compat": [[4, 1, 1, "", "_CacheDataset"], [4, 1, 1, "", "_ShuffleDataset"], [4, 6, 1, "", "_clone_module"], [4, 6, 1, "", "stateless_cache_dataset"], [4, 6, 1, "", "stateless_list_files"], [4, 6, 1, "", "stateless_shuffle_dataset"], [4, 6, 1, "", "summarize_tf2_status"], [4, 1, 1, "", "variable_scope"]], "lingvo.compat._CacheDataset": [[4, 5, 1, "", "_abc_impl"]], "lingvo.compat._ShuffleDataset": [[4, 5, 1, "", "_abc_impl"]], "lingvo.core": [[6, 0, 0, "-", "activations"], [7, 0, 0, "-", "adagraft"], [8, 0, 0, "-", "attention"], [9, 0, 0, "-", "attention_util"], [10, 0, 0, "-", "base_decoder"], [11, 0, 0, "-", "base_input_generator"], [12, 0, 0, "-", "base_layer"], [13, 0, 0, "-", "base_model"], [14, 0, 0, "-", "base_model_params"], [15, 0, 0, "-", "batch_major_attention"], [16, 0, 0, "-", "batch_utils"], [17, 0, 0, "-", "beam_search_helper"], [18, 0, 0, "-", "bfloat16_variables"], [19, 0, 0, "-", "bn_layers"], [20, 0, 0, "-", "build_data"], [21, 0, 0, "-", "builder"], [22, 0, 0, "-", "builder_layers"], [23, 0, 0, "-", "checkpointer"], [24, 0, 0, "-", "cluster"], [25, 0, 0, "-", "cluster_factory"], [26, 0, 0, "-", "computation_cost"], [27, 0, 0, "-", "conformer_layer"], [28, 0, 0, "-", "constants"], [29, 0, 0, "-", "conv_layers_builder"], [30, 0, 0, "-", "conv_layers_with_time_padding"], [31, 0, 0, "-", "datasource"], [32, 0, 0, "-", "decoder_lib"], [33, 0, 0, "-", "differentiable_assignment"], [34, 0, 0, "-", "distillation_task"], [35, 0, 0, "-", "distributed_shampoo"], [36, 0, 0, "-", "early_stop"], [37, 0, 0, "-", "egdd"], [38, 0, 0, "-", "entmax"], [39, 0, 0, "-", "favor_attention"], [40, 0, 0, "-", "flat_beam_search_helper"], [41, 0, 0, "-", "generic_input"], [42, 0, 0, "-", "gpipe"], [43, 0, 0, "-", "graddrop"], [44, 0, 0, "-", "gradient_combiner"], [45, 0, 0, "-", "gshard_builder"], [46, 0, 0, "-", "gshard_decode"], [47, 0, 0, "-", "gshard_layers"], [48, 0, 0, "-", "gshard_utils"], [49, 0, 0, "-", "hyperparams"], [50, 0, 0, "-", "hyperparams_pb2"], [51, 0, 0, "-", "inference_graph_exporter"], [52, 0, 0, "-", "inference_graph_pb2"], [53, 0, 0, "-", "input_generator_helper"], [54, 0, 0, "-", "input_policy"], [55, 0, 0, "-", "insertion"], [56, 0, 0, "-", "inspect_utils"], [57, 0, 0, "-", "layers"], [58, 0, 0, "-", "layers_with_attention"], [59, 0, 0, "-", "layers_with_gpipe"], [60, 0, 0, "-", "learner"], [61, 0, 0, "-", "lstm_frnn_layer"], [62, 0, 0, "-", "matrix_functions"], [63, 0, 0, "-", "metrics"], [64, 0, 0, "-", "ml_perf_bleu_metric"], [65, 0, 0, "-", "ml_perf_log"], [66, 0, 0, "-", "ml_perf_tokenizer"], [67, 0, 0, "-", "model_helper"], [68, 0, 0, "-", "multitask_model"], [69, 0, 0, "-", "nested_map"], [70, 0, 0, "-", "ops"], [75, 0, 0, "-", "optimizer"], [76, 0, 0, "-", "plot"], [77, 0, 0, "-", "predictor"], [78, 0, 0, "-", "predictor_runner_base"], [79, 0, 0, "-", "program"], [80, 0, 0, "-", "program_utils"], [81, 0, 0, "-", "pruning_utils"], [82, 0, 0, "-", "py_utils"], [83, 0, 0, "-", "py_utils_flags"], [84, 0, 0, "-", "quant_test_lib"], [85, 0, 0, "-", "quant_utils"], [86, 0, 0, "-", "recurrent"], [87, 0, 0, "-", "repeat_layer"], [88, 0, 0, "-", "retry"], [89, 0, 0, "-", "reversible_layers"], [90, 0, 0, "-", "rnn_cell"], [91, 0, 0, "-", "rnn_layers"], [92, 0, 0, "-", "routing_config_helper"], [93, 0, 0, "-", "saver"], [94, 0, 0, "-", "scatter_update"], [95, 0, 0, "-", "schedule"], [96, 0, 0, "-", "scorers"], [97, 0, 0, "-", "self_attention_layer"], [98, 0, 0, "-", "sendrecv"], [99, 0, 0, "-", "spectrum_augmenter"], [100, 0, 0, "-", "spectrum_augmenter_on_device"], [101, 0, 0, "-", "step"], [102, 0, 0, "-", "steps"], [106, 0, 0, "-", "stream_step_test_base"], [107, 0, 0, "-", "summary_utils"], [108, 0, 0, "-", "symbolic"], [109, 0, 0, "-", "target_sequence_sampler"], [110, 0, 0, "-", "task_scheduler"], [111, 0, 0, "-", "test_helper"], [112, 0, 0, "-", "test_trainer_utils"], [113, 0, 0, "-", "test_utils"], [114, 0, 0, "-", "thread_local_utils"], [115, 0, 0, "-", "tokenizers"], [116, 0, 0, "-", "tpu_embedding_layers"], [117, 0, 0, "-", "tpu_summary"], [118, 0, 0, "-", "trainer_test_utils"], [119, 0, 0, "-", "tshape"], [120, 0, 0, "-", "var_tmp_wrappers"], [121, 0, 0, "-", "wpm_encoder"]], "lingvo.core.activations": [[6, 1, 1, "", "ActivationLayer"], [6, 6, 1, "", "GetFlops"], [6, 6, 1, "", "GetFn"], [6, 6, 1, "", "IsSupported"]], "lingvo.core.activations.ActivationLayer": [[6, 2, 1, "", "FProp"], [6, 2, 1, "", "FPropMeta"], [6, 2, 1, "", "Params"]], "lingvo.core.adagraft": [[7, 1, 1, "", "AdaGraftOptimizer"]], "lingvo.core.adagraft.AdaGraftOptimizer": [[7, 2, 1, "", "_apply_dense"], [7, 2, 1, "", "_apply_sparse"], [7, 2, 1, "", "_create_slots"], [7, 2, 1, "", "_finish"], [7, 2, 1, "", "_internal_apply_dense"], [7, 2, 1, "", "_prepare"], [7, 2, 1, "", "_resource_apply_dense"], [7, 2, 1, "", "_resource_apply_sparse"]], "lingvo.core.attention": [[8, 1, 1, "", "AdditiveAttention"], [8, 1, 1, "", "BaseAttentionLayer"], [8, 1, 1, "", "DotProductAttention"], [8, 1, 1, "", "GmmMonotonicAttention"], [8, 1, 1, "", "LocationSensitiveAttention"], [8, 6, 1, "", "MergeSourcePaddingWithPerStepSourcePadding"], [8, 1, 1, "", "MergerLayer"], [8, 1, 1, "", "MonotonicAttention"], [8, 6, 1, "", "MonotonicAttentionProb"], [8, 1, 1, "", "MultiHeadedAttention"], [8, 1, 1, "", "MultiSourceAttention"], [8, 6, 1, "", "SafeCumprod"], [8, 6, 1, "", "_ApplyAttentionDropout"], [8, 6, 1, "", "_ConditionalCallDefun"], [8, 6, 1, "", "_RecursiveReshape"]], "lingvo.core.attention.AdditiveAttention": [[8, 2, 1, "", "AddGlobalVN"], [8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ZeroAttentionState"], [8, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.attention.BaseAttentionLayer": [[8, 2, 1, "", "ComputeContextVector"], [8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "GetInitializationSourceState"], [8, 2, 1, "", "InitForSourcePacked"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "SetInitializationSourceState"], [8, 2, 1, "", "_CreateLayerVariables"], [8, 2, 1, "", "_PaddedSoftmax"], [8, 2, 1, "", "_UpdatePaddingWithPackedInputMask"]], "lingvo.core.attention.DotProductAttention": [[8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ZeroAttentionState"], [8, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.attention.GmmMonotonicAttention": [[8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ZeroAttentionState"]], "lingvo.core.attention.LocationSensitiveAttention": [[8, 2, 1, "", "AddGlobalVN"], [8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ZeroAttentionState"], [8, 2, 1, "", "_ApplyConv"], [8, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.attention.MergerLayer": [[8, 2, 1, "", "FProp"], [8, 5, 1, "", "MERGER_OPS"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "_CreateLayerVariables"], [8, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.attention.MonotonicAttention": [[8, 2, 1, "", "AddGlobalVN"], [8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "ComputeProbabilities"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ZeroAttentionState"], [8, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.attention.MultiHeadedAttention": [[8, 2, 1, "", "ComputeContextVectorWithAttenProbs"], [8, 2, 1, "", "ComputeContextVectorWithCachedSource"], [8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "ExtendSourcePacked"], [8, 2, 1, "", "PackCachedSource"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ProcessProjectionVec"], [8, 2, 1, "", "SetOutputContextDim"], [8, 2, 1, "", "ZeroAttentionState"], [8, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.attention.MultiSourceAttention": [[8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ZeroAttentionState"], [8, 2, 1, "", "_CombineContext"]], "lingvo.core.attention_util": [[9, 6, 1, "", "AttenContext"], [9, 6, 1, "", "AttenLogits"], [9, 6, 1, "", "ComputeSparseAttention"], [9, 6, 1, "", "ConvertToBlocks"], [9, 6, 1, "", "ExtractBlockContext"], [9, 6, 1, "", "ExtractBlockContextV2"], [9, 1, 1, "", "KMeansClusteringForAtten"], [9, 6, 1, "", "MakeLocalMask"], [9, 1, 1, "", "PositionalAttenLogits"], [9, 6, 1, "", "RelShift"], [9, 6, 1, "", "_DoPadding"]], "lingvo.core.attention_util.KMeansClusteringForAtten": [[9, 2, 1, "", "FProp"], [9, 2, 1, "", "LayerNorm"], [9, 2, 1, "", "Params"], [9, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.attention_util.PositionalAttenLogits": [[9, 2, 1, "", "AttenLogitsRPE"], [9, 2, 1, "", "AttenLogitsRPEOneStep"], [9, 2, 1, "", "AttenLogitsXL"], [9, 2, 1, "", "AttenLogitsXLOneStep"], [9, 2, 1, "", "RelPositionBias"], [9, 2, 1, "", "_AttenLogits"], [9, 2, 1, "", "_ValidateBiases"]], "lingvo.core.base_decoder": [[10, 1, 1, "", "BaseBeamSearchDecoder"], [10, 1, 1, "", "BaseDecoder"], [10, 1, 1, "", "DecoderOutput"], [10, 6, 1, "", "_BatchLookup"], [10, 6, 1, "", "_BatchSampleGumbel"], [10, 6, 1, "", "_BatchScatter"], [10, 6, 1, "", "_KeepTopP"], [10, 6, 1, "", "_SampleGumbelWithMax"]], "lingvo.core.base_decoder.BaseBeamSearchDecoder": [[10, 2, 1, "", "AddExtraDecodingInfo"], [10, 2, 1, "", "BeamSearchDecode"], [10, 2, 1, "", "BeamSearchDecodeBiased"], [10, 2, 1, "", "BeamSearchDecodeWithTheta"], [10, 2, 1, "", "GreedySearchDecode"], [10, 2, 1, "", "GreedySearchDecodeWithTheta"], [10, 2, 1, "", "InferenceAdditionalEncoder"], [10, 2, 1, "", "Params"], [10, 2, 1, "", "SampleTargetSequences"], [10, 2, 1, "", "StochasticBeamSearchDecodeBiased"], [10, 2, 1, "", "UpdateTargetVocabSize"], [10, 2, 1, "", "_PostprocessSample"], [10, 2, 1, "", "_WrapInitBeamSearchStateCallback"], [10, 2, 1, "", "_WrapPostBeamSearchStepCallback"], [10, 2, 1, "", "_WrapPreBeamSearchStepCallback"]], "lingvo.core.base_decoder.BaseDecoder": [[10, 2, 1, "", "ComputeLoss"], [10, 2, 1, "", "ComputePredictions"], [10, 2, 1, "", "FProp"], [10, 2, 1, "", "Params"], [10, 2, 1, "", "UpdateTargetVocabSize"]], "lingvo.core.base_decoder.DecoderOutput": [[10, 2, 1, "", "_asdict"], [10, 5, 1, "", "_field_defaults"], [10, 5, 1, "", "_fields"], [10, 2, 1, "", "_make"], [10, 2, 1, "", "_replace"], [10, 5, 1, "", "metrics"], [10, 5, 1, "", "per_sequence"], [10, 5, 1, "", "predictions"]], "lingvo.core.base_input_generator": [[11, 1, 1, "", "BaseDataExampleInputGenerator"], [11, 1, 1, "", "BaseInputGenerator"], [11, 1, 1, "", "BaseInputGeneratorFromFiles"], [11, 1, 1, "", "BaseSequenceInputGenerator"], [11, 1, 1, "", "BaseTinyDatasetInput"], [11, 6, 1, "", "DefineTFDataInput"], [11, 6, 1, "", "FilePatternToDataSource"], [11, 6, 1, "", "MaybeOffsetDataSourceId"], [11, 6, 1, "", "PartitionFilePatternsIntoDataSources"], [11, 1, 1, "", "TFDataSequenceInputGenerator"], [11, 6, 1, "", "_PerHostInfeedTPUOrdinalFunction"], [11, 6, 1, "", "_ReorderTensorToLogical"], [11, 6, 1, "", "_RorderPartitionedTensorToLogical"]], "lingvo.core.base_input_generator.BaseDataExampleInputGenerator": [[11, 2, 1, "", "GetFeatureSpec"], [11, 2, 1, "", "GetPreprocessedInputBatch"], [11, 2, 1, "", "Params"], [11, 2, 1, "", "_AdditionalPreprocessInputBatch"], [11, 2, 1, "", "_InitDataset"]], "lingvo.core.base_input_generator.BaseInputGenerator": [[11, 2, 1, "", "CommonInputOpArgs"], [11, 2, 1, "", "CreateCpuPassthroughEnqueueOps"], [11, 2, 1, "", "CreateDatasource"], [11, 2, 1, "", "CreateTpuEmbeddingEnqueueOps"], [11, 2, 1, "", "CreateTpuEnqueueOps"], [11, 2, 1, "", "DefineInfeedParams"], [11, 2, 1, "", "DequeueCpuPassthrough"], [11, 2, 1, "", "DeviceLoopSetupEager"], [11, 2, 1, "", "GetBatchSize"], [11, 2, 1, "", "GetBpropVariableFilters"], [11, 2, 1, "", "GetCpuPassthroughKeys"], [11, 2, 1, "", "GetInputSourceOneHot"], [11, 2, 1, "", "GetPreprocessedInputBatch"], [11, 2, 1, "", "GlobalBatchSize"], [11, 2, 1, "", "InfeedBatchSize"], [11, 2, 1, "", "InfeedSetupGraph"], [11, 2, 1, "", "Initialize"], [11, 2, 1, "", "Params"], [11, 2, 1, "", "PreprocessTpuEmbeddingInputBatch"], [11, 2, 1, "", "Reset"], [11, 2, 1, "", "SplitInputBatch"], [11, 2, 1, "", "TpuDequeueBatch"], [11, 2, 1, "", "_GetTpuEmbeddingEnqueueData"], [11, 2, 1, "", "_InputBatch"], [11, 2, 1, "", "_PreprocessInputBatch"], [11, 3, 1, "", "_map_args"], [11, 3, 1, "", "input_data_summary_layout"], [11, 3, 1, "", "merged_input_data_summary_op"], [11, 3, 1, "", "tpu_infeed_op"], [11, 3, 1, "", "tpu_number_of_shards"]], "lingvo.core.base_input_generator.BaseInputGeneratorFromFiles": [[11, 2, 1, "", "CommonInputOpArgs"], [11, 2, 1, "", "CreateDatasource"], [11, 2, 1, "", "Params"], [11, 2, 1, "", "_BuildDataSource"], [11, 2, 1, "", "_BuildDataSourceWithMetadata"], [11, 2, 1, "", "_DataSourceFromFilePattern"], [11, 2, 1, "", "_InputBatch"], [11, 2, 1, "", "_InputOpBucketingArgs"]], "lingvo.core.base_input_generator.BaseSequenceInputGenerator": [[11, 2, 1, "", "Cast"], [11, 2, 1, "", "IdsToStrings"], [11, 2, 1, "", "IdsToTokens"], [11, 2, 1, "", "InfeedBatchSize"], [11, 2, 1, "", "Initialize"], [11, 2, 1, "", "Params"], [11, 2, 1, "", "StringsToIds"], [11, 2, 1, "", "StringsToIdsWithOffsets"], [11, 2, 1, "", "_InputOpBucketingArgs"], [11, 3, 1, "", "infeed_bucket_batch_limit"]], "lingvo.core.base_input_generator.BaseTinyDatasetInput": [[11, 2, 1, "", "Params"], [11, 2, 1, "", "_InputBatch"], [11, 2, 1, "", "_Preprocess"]], "lingvo.core.base_input_generator.TFDataSequenceInputGenerator": [[11, 2, 1, "", "ConvertFilePatternToDataSource"], [11, 2, 1, "", "CreateDatasource"], [11, 2, 1, "", "GetPreprocessedInputBatch"], [11, 2, 1, "", "GetSequenceLength"], [11, 2, 1, "", "LoadDataset"], [11, 2, 1, "", "Params"], [11, 2, 1, "", "ProcessDataset"], [11, 2, 1, "", "Reset"], [11, 2, 1, "", "TakeEvalSamples"], [11, 2, 1, "", "_InputPaddingValue"], [11, 2, 1, "", "_InputShape"]], "lingvo.core.base_layer": [[12, 1, 1, "", "ABCLayerMeta"], [12, 1, 1, "", "Accumulator"], [12, 1, 1, "", "BaseLayer"], [12, 1, 1, "", "BaseLayerMeta"], [12, 6, 1, "", "IsLayerParams"], [12, 6, 1, "", "RecursiveFindLayerParams"], [12, 6, 1, "", "_BaseLayerInitWrapper"]], "lingvo.core.base_layer.Accumulator": [[12, 2, 1, "", "DefaultValue"], [12, 2, 1, "", "Disable"], [12, 2, 1, "", "Enable"], [12, 2, 1, "", "GetValue"], [12, 2, 1, "", "Reset"], [12, 2, 1, "", "SetValue"], [12, 3, 1, "", "is_disabled"]], "lingvo.core.base_layer.BaseLayer": [[12, 2, 1, "", "AddChild"], [12, 2, 1, "", "AddExtraTheta"], [12, 2, 1, "", "AddFunction"], [12, 2, 1, "", "AddGlobalVN"], [12, 2, 1, "", "AddVN"], [12, 2, 1, "", "CopyBaseParams"], [12, 2, 1, "", "CreateChild"], [12, 2, 1, "", "CreateChildren"], [12, 2, 1, "", "CreateVariable"], [12, 2, 1, "", "FProp"], [12, 2, 1, "", "FPropDefaultTheta"], [12, 2, 1, "", "FPropMeta"], [12, 2, 1, "", "GetAccumulatorValues"], [12, 2, 1, "", "GetDescendant"], [12, 2, 1, "", "GetVariableSymbolicShape"], [12, 2, 1, "", "GetVariablesDict"], [12, 2, 1, "", "Params"], [12, 2, 1, "", "PostTrainingStepUpdate"], [12, 2, 1, "", "RegisterAccumulator"], [12, 2, 1, "", "SetAccumulatorValues"], [12, 2, 1, "", "TransformVarsTempContext"], [12, 2, 1, "", "_AutoAddChild"], [12, 2, 1, "", "_CastToFPropDtype"], [12, 2, 1, "", "_CheckName"], [12, 2, 1, "", "_CreateChildContext"], [12, 2, 1, "", "_CreateLayerVariables"], [12, 2, 1, "", "_EMAVariableScope"], [12, 2, 1, "", "_GetSelfVariablesDict"], [12, 5, 1, "", "_INFERENCE_DRIVER_NAME"], [12, 2, 1, "", "_InternalGetTheta"], [12, 2, 1, "", "_RemoveChild"], [12, 2, 1, "", "_RemoveChildren"], [12, 2, 1, "", "_SelfVariableScope"], [12, 2, 1, "", "_TransformVarsInternal"], [12, 2, 1, "", "_UndoTransformVarsInternal"], [12, 2, 1, "", "_VerifyChildren"], [12, 2, 1, "", "_VerifyVarsAndTheta"], [12, 2, 1, "", "_child_variable_scope_override"], [12, 3, 1, "", "accumulators"], [12, 3, 1, "", "children"], [12, 3, 1, "", "cluster"], [12, 3, 1, "", "do_eval"], [12, 3, 1, "", "ema"], [12, 3, 1, "", "fns"], [12, 3, 1, "", "layer_type"], [12, 3, 1, "", "params"], [12, 3, 1, "", "parent"], [12, 3, 1, "", "path"], [12, 3, 1, "", "theta"], [12, 3, 1, "", "vars"]], "lingvo.core.base_model": [[13, 1, 1, "", "BaseModel"], [13, 1, 1, "", "BaseTask"], [13, 1, 1, "", "DecodeEmailOptions"], [13, 1, 1, "", "DecodeFinalizeArgs"], [13, 1, 1, "", "MultiTaskModel"], [13, 1, 1, "", "MultiTaskSubModel"], [13, 1, 1, "", "SingleTaskBase"], [13, 1, 1, "", "SingleTaskModel"], [13, 6, 1, "", "_VariablesForEMA"]], "lingvo.core.base_model.BaseModel": [[13, 2, 1, "", "ApplyExponentialMovingAverage"], [13, 2, 1, "", "ConstructDecodeGraph"], [13, 2, 1, "", "ConstructFPropBPropGraph"], [13, 2, 1, "", "ConstructFPropGraph"], [13, 2, 1, "", "ConstructPostTrainingLoop"], [13, 2, 1, "", "Export"], [13, 2, 1, "", "GetTask"], [13, 2, 1, "", "Params"], [13, 2, 1, "", "ProcessFPropResults"], [13, 2, 1, "", "_GetSelfVariablesDict"], [13, 2, 1, "", "_MakeEMAVariablesDict"], [13, 3, 1, "", "global_step"], [13, 3, 1, "", "tasks"], [13, 3, 1, "", "variables_for_ema"]], "lingvo.core.base_model.BaseTask": [[13, 2, 1, "", "AddEvalMetric"], [13, 2, 1, "", "AddPerExampleTensor"], [13, 2, 1, "", "AdjustGradients"], [13, 2, 1, "", "ApplyExponentialMovingAverage"], [13, 2, 1, "", "BProp"], [13, 2, 1, "", "ComputeLoss"], [13, 2, 1, "", "ComputePredictions"], [13, 2, 1, "", "CreateDecoderMetrics"], [13, 2, 1, "", "Decode"], [13, 2, 1, "", "DecodeFinalize"], [13, 2, 1, "", "DecodeWithTheta"], [13, 2, 1, "", "EmailDecodeSummary"], [13, 2, 1, "", "Export"], [13, 2, 1, "", "FProp"], [13, 2, 1, "", "FPropDefaultTheta"], [13, 2, 1, "", "FPropTower"], [13, 2, 1, "", "FilterPerExampleTensors"], [13, 2, 1, "", "GetInputBatch"], [13, 2, 1, "", "Inference"], [13, 2, 1, "", "InferenceEager"], [13, 2, 1, "", "Params"], [13, 2, 1, "", "PostProcessDecodeOut"], [13, 2, 1, "", "PostTrainingLoop"], [13, 2, 1, "", "ProcessFPropResults"], [13, 2, 1, "", "UpdateTargetVocabSize"], [13, 2, 1, "", "_BPropForVariables"], [13, 2, 1, "", "_BPropGenTrainOps"], [13, 2, 1, "", "_ComputeGradientMask"], [13, 2, 1, "", "_FPropResult"], [13, 2, 1, "", "_FPropSplitInputBatch"], [13, 2, 1, "", "_FPropTpu"], [13, 2, 1, "", "_GetMaskUpdateOp"], [13, 2, 1, "", "_SetLearnerFromLegacyParams"], [13, 2, 1, "", "_UpdateVnConfig"], [13, 3, 1, "", "eval_metrics"], [13, 3, 1, "", "global_step"], [13, 3, 1, "", "input_generator"], [13, 3, 1, "", "loss"], [13, 3, 1, "", "per_example_tensors"], [13, 3, 1, "", "post_training_loop_op"], [13, 3, 1, "", "train_op"]], "lingvo.core.base_model.DecodeEmailOptions": [[13, 5, 1, "", "global_step"], [13, 5, 1, "", "job_name"], [13, 5, 1, "", "train_executions_per_eval"]], "lingvo.core.base_model.DecodeFinalizeArgs": [[13, 5, 1, "", "decode_out"], [13, 5, 1, "", "decode_out_path"]], "lingvo.core.base_model.MultiTaskModel": [[13, 2, 1, "", "ApplyExponentialMovingAverage"], [13, 2, 1, "", "ConstructDecodeGraph"], [13, 2, 1, "", "ConstructFPropBPropGraph"], [13, 2, 1, "", "ConstructFPropGraph"], [13, 2, 1, "", "GetTask"], [13, 2, 1, "", "Params"], [13, 2, 1, "", "SampleTask"], [13, 2, 1, "", "TaskNames"], [13, 2, 1, "", "_child_variable_scope_override"], [13, 3, 1, "", "task_names"], [13, 3, 1, "", "tasks"]], "lingvo.core.base_model.MultiTaskSubModel": [[13, 2, 1, "", "Params"]], "lingvo.core.base_model.SingleTaskBase": [[13, 2, 1, "", "ApplyExponentialMovingAverage"], [13, 2, 1, "", "ConstructDecodeGraph"], [13, 2, 1, "", "ConstructFPropBPropGraph"], [13, 2, 1, "", "ConstructFPropGraph"], [13, 2, 1, "", "ConstructPostTrainingLoop"], [13, 2, 1, "", "GetTask"], [13, 2, 1, "", "SampleTask"], [13, 3, 1, "", "tasks"]], "lingvo.core.base_model.SingleTaskModel": [[13, 2, 1, "", "Params"], [13, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.base_model_params": [[14, 4, 1, "", "DatasetError"], [14, 1, 1, "", "MultiTaskModelParams"], [14, 1, 1, "", "SingleTaskModelParams"], [14, 1, 1, "", "_BaseModelParams"]], "lingvo.core.base_model_params.MultiTaskModelParams": [[14, 2, 1, "", "Dev"], [14, 2, 1, "", "Model"], [14, 2, 1, "", "ProgramSchedule"], [14, 2, 1, "", "Test"], [14, 2, 1, "", "Train"]], "lingvo.core.base_model_params.SingleTaskModelParams": [[14, 2, 1, "", "Dev"], [14, 2, 1, "", "Model"], [14, 2, 1, "", "ProgramSchedule"], [14, 2, 1, "", "Task"], [14, 2, 1, "", "Test"], [14, 2, 1, "", "Train"]], "lingvo.core.base_model_params._BaseModelParams": [[14, 2, 1, "", "GetAllDatasetParams"], [14, 2, 1, "", "GetDatasetParams"]], "lingvo.core.batch_major_attention": [[15, 1, 1, "", "Builder"], [15, 6, 1, "", "CausalPadding"], [15, 6, 1, "", "CausalSegmentMask"], [15, 1, 1, "", "ChunkwiseSelfAttention"], [15, 1, 1, "", "ChunkwiseSelfAttentionXL"], [15, 6, 1, "", "ClearRelativeAttentionInTransformerLayer"], [15, 6, 1, "", "CrossAttentionPaddingWithTimestamp"], [15, 1, 1, "", "FunnelPoolingLayer"], [15, 1, 1, "", "FunnelTransformerAttentionLayer"], [15, 1, 1, "", "FunnelUpsampleLayer"], [15, 1, 1, "", "GPipeBatchMajorTransformerLayer"], [15, 6, 1, "", "GetDtypeMin"], [15, 1, 1, "", "LmBuilder"], [15, 1, 1, "", "LocalSelfAttention"], [15, 1, 1, "", "LocalSelfAttentionXL"], [15, 1, 1, "", "MemoryAddLayer"], [15, 1, 1, "", "MeshSplitLayer"], [15, 1, 1, "", "MultiHeadedAttention"], [15, 1, 1, "", "MultiHeadedAttentionRPE"], [15, 1, 1, "", "MultiHeadedAttentionXL"], [15, 1, 1, "", "MultiHeadedFavorAttention"], [15, 1, 1, "", "MultiHeadedProjectionLayer"], [15, 1, 1, "", "MultiSourceAttention"], [15, 1, 1, "", "MultiSourceTransformerDecoderLayer"], [15, 1, 1, "", "MultiSourceTransformerLayer"], [15, 1, 1, "", "PaddingLayer"], [15, 1, 1, "", "PerDimScaleLayer"], [15, 1, 1, "", "PerformerBuilder"], [15, 1, 1, "", "PipelinedTransformerLayers"], [15, 1, 1, "", "RepeatedTransformerLayer"], [15, 1, 1, "", "ReshapedMultiHeadedAttention"], [15, 1, 1, "", "ReshapedMultiHeadedProjectionLayer"], [15, 1, 1, "", "ResidualAddLayer"], [15, 1, 1, "", "RoutingAttention"], [15, 6, 1, "", "SegmentMask"], [15, 1, 1, "", "SketchMemTransformerBuilder"], [15, 1, 1, "", "StackedTransformerLayers"], [15, 1, 1, "", "StrideLayer"], [15, 1, 1, "", "TransformerAttentionLayer"], [15, 1, 1, "", "TransformerDecoderLayer"], [15, 1, 1, "", "TransformerFeedForwardLayerWithTaskId"], [15, 6, 1, "", "TransformerFlops"], [15, 1, 1, "", "TransformerLayer"], [15, 1, 1, "", "TransformerMultiSourceAttentionLayer"], [15, 6, 1, "", "UseRelativeAttentionInTransformerLayer"]], "lingvo.core.batch_major_attention.Builder": [[15, 2, 1, "", "Feedforward"], [15, 2, 1, "", "FunnelEncoderLayer"], [15, 2, 1, "", "GatedFeedforward"], [15, 2, 1, "", "GatedGeluFeedforward"], [15, 2, 1, "", "LConv"], [15, 2, 1, "", "LConvStack"], [15, 2, 1, "", "LconvBlock"], [15, 2, 1, "", "MeshSplit"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "Seq"], [15, 2, 1, "", "SetCanonicalShardingParams"], [15, 2, 1, "", "Stack"], [15, 2, 1, "", "TransformerEncoderLayer"], [15, 2, 1, "", "TransformerEncoderStack"], [15, 2, 1, "", "_Add"], [15, 2, 1, "", "_DefaultLN"], [15, 2, 1, "", "_DepthwiseConv2D"], [15, 2, 1, "", "_Dropout"], [15, 2, 1, "", "_ExpandDims"], [15, 2, 1, "", "_FunnelAttention"], [15, 2, 1, "", "_Glu"], [15, 2, 1, "", "_MaybeSplit"], [15, 2, 1, "", "_MultiHeadedAtten"], [15, 2, 1, "", "_NormalizedDepthwiseConv2D"], [15, 2, 1, "", "_Pad"], [15, 2, 1, "", "_Pool"], [15, 2, 1, "", "_Squeeze"], [15, 2, 1, "", "_Stride"], [15, 2, 1, "", "_StridedAttention"]], "lingvo.core.batch_major_attention.ChunkwiseSelfAttention": [[15, 2, 1, "", "AttenProbs"], [15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_AttenContext"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_ParamCheck"], [15, 2, 1, "", "zero_state"]], "lingvo.core.batch_major_attention.ChunkwiseSelfAttentionXL": [[15, 2, 1, "", "Params"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.batch_major_attention.FunnelPoolingLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "StreamStep"]], "lingvo.core.batch_major_attention.FunnelTransformerAttentionLayer": [[15, 2, 1, "", "CommonParams"], [15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "StreamStep"]], "lingvo.core.batch_major_attention.FunnelUpsampleLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.batch_major_attention.GPipeBatchMajorTransformerLayer": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "SetupDeterministicDropout"]], "lingvo.core.batch_major_attention.LmBuilder": [[15, 2, 1, "", "Feedforward"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "TransformerEncoderLayer"], [15, 2, 1, "", "_Attention"], [15, 2, 1, "", "_Bias"], [15, 2, 1, "", "_BiasWeight"], [15, 2, 1, "", "_Linear"], [15, 2, 1, "", "_LinearWeight"], [15, 2, 1, "", "_ShardedVar"], [15, 2, 1, "", "_Var"]], "lingvo.core.batch_major_attention.LocalSelfAttention": [[15, 2, 1, "", "AttenProbs"], [15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "IsInferenceStepStatic"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "StreamStep"], [15, 2, 1, "", "StreamStepAddSkipConnection"], [15, 2, 1, "", "_AttenContext"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_StreamAttenLogits"], [15, 2, 1, "", "_StreamStepDimensions"], [15, 2, 1, "", "_StreamStepDynamicLength"], [15, 2, 1, "", "_StreamStepStaticComputeKeyValue"], [15, 2, 1, "", "_StreamStepStaticComputeKeyValue3d"], [15, 2, 1, "", "_StreamStepStaticComputeKeyValueClassic"], [15, 2, 1, "", "_StreamStepStaticComputeKeyValueMinimal"], [15, 2, 1, "", "_StreamStepStaticLength"], [15, 2, 1, "", "_zero_state_dynamic_length"], [15, 2, 1, "", "_zero_state_static_length_inputs"], [15, 2, 1, "", "_zero_state_static_length_key_value"], [15, 2, 1, "", "zero_state"]], "lingvo.core.batch_major_attention.LocalSelfAttentionXL": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "StreamStep"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_AttenLogitsOneStep"], [15, 2, 1, "", "_CreateLayerVariables"], [15, 2, 1, "", "_StreamAttenLogits"]], "lingvo.core.batch_major_attention.MemoryAddLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.MeshSplitLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.MultiHeadedAttention": [[15, 2, 1, "", "AttenProbs"], [15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_AttenContext"], [15, 2, 1, "", "_AttenContextOneStep"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_AttenLogitsOneStep"], [15, 2, 1, "", "_CapLogits"], [15, 2, 1, "", "_DotAtten"], [15, 2, 1, "", "_DotAttenOneStep"], [15, 2, 1, "", "_HeadsProj"], [15, 2, 1, "", "_MaybeScaleQuery"], [15, 2, 1, "", "_PostProj"], [15, 3, 1, "", "dim_per_head"]], "lingvo.core.batch_major_attention.MultiHeadedAttentionRPE": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_AttenContext"], [15, 2, 1, "", "_AttenContextOneStep"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_AttenLogitsOneStep"], [15, 2, 1, "", "_RelativePositionValueEmb"], [15, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.batch_major_attention.MultiHeadedAttentionXL": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_AttenLogitsOneStep"], [15, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.batch_major_attention.MultiHeadedFavorAttention": [[15, 2, 1, "", "Params"], [15, 2, 1, "", "_DotAtten"]], "lingvo.core.batch_major_attention.MultiHeadedProjectionLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.batch_major_attention.MultiSourceAttention": [[15, 2, 1, "", "AttenProbs"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_CombineContext"]], "lingvo.core.batch_major_attention.MultiSourceTransformerDecoderLayer": [[15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.MultiSourceTransformerLayer": [[15, 2, 1, "", "Params"], [15, 2, 1, "", "_GetSourceBatchSize"], [15, 2, 1, "", "_GetSourceLength"], [15, 3, 1, "", "primary_source_key"]], "lingvo.core.batch_major_attention.PaddingLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"]], "lingvo.core.batch_major_attention.PerDimScaleLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.batch_major_attention.PerformerBuilder": [[15, 2, 1, "", "Params"], [15, 2, 1, "", "_MultiHeadedAtten"]], "lingvo.core.batch_major_attention.PipelinedTransformerLayers": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "Params"], [15, 1, 1, "", "WrappedStageClass"]], "lingvo.core.batch_major_attention.PipelinedTransformerLayers.WrappedStageClass": [[15, 2, 1, "", "ExtendStep"]], "lingvo.core.batch_major_attention.RepeatedTransformerLayer": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.ReshapedMultiHeadedAttention": [[15, 2, 1, "", "ExtendStep"]], "lingvo.core.batch_major_attention.ReshapedMultiHeadedProjectionLayer": [[15, 2, 1, "", "FProp"]], "lingvo.core.batch_major_attention.ResidualAddLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.RoutingAttention": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_DotAtten"], [15, 2, 1, "", "_DotAttenFastPath"], [15, 2, 1, "", "_DotAttenOneStep"], [15, 2, 1, "", "_DotAttenSlowPath"]], "lingvo.core.batch_major_attention.SketchMemTransformerBuilder": [[15, 2, 1, "", "Feedforward"], [15, 2, 1, "", "GatedFeedforward"], [15, 2, 1, "", "GatedGeluFeedforward"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_MemoryAdd"], [15, 2, 1, "", "_MultiHeadedAtten"]], "lingvo.core.batch_major_attention.StackedTransformerLayers": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "GetSplitForLayer"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_GetDeviceOfLayer"]], "lingvo.core.batch_major_attention.StrideLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.TransformerAttentionLayer": [[15, 2, 1, "", "CommonParams"], [15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "SetFPropDtype"], [15, 2, 1, "", "StreamStep"], [15, 2, 1, "", "StreamStepAddSkipConnection"], [15, 2, 1, "", "_InitAttentionParams"], [15, 2, 1, "", "zero_state"]], "lingvo.core.batch_major_attention.TransformerDecoderLayer": [[15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.TransformerFeedForwardLayerWithTaskId": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.TransformerLayer": [[15, 2, 1, "", "CommonParams"], [15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "NumOutputNodes"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "SetCanonicalShardingParams"], [15, 2, 1, "", "SetFPropDtype"], [15, 2, 1, "", "SetNumInputNodes"], [15, 2, 1, "", "SetReshapedLayers"], [15, 2, 1, "", "_GetSourceBatchSize"], [15, 2, 1, "", "_GetSourceLength"]], "lingvo.core.batch_major_attention.TransformerMultiSourceAttentionLayer": [[15, 2, 1, "", "Params"], [15, 2, 1, "", "_InitAttentionParams"]], "lingvo.core.batch_utils": [[16, 6, 1, "", "scale_global_to_infeed"], [16, 6, 1, "", "scale_infeed_to_global"], [16, 6, 1, "", "scale_split_to_infeed"]], "lingvo.core.beam_search_helper": [[17, 1, 1, "", "BeamSearchDecodeOutput"], [17, 1, 1, "", "BeamSearchHelper"], [17, 1, 1, "", "BeamSearchSharedParams"], [17, 1, 1, "", "GreedySearchHelper"], [17, 6, 1, "", "MergeBeamSearchOutputs"], [17, 6, 1, "", "_GetShapes"]], "lingvo.core.beam_search_helper.BeamSearchDecodeOutput": [[17, 2, 1, "", "_asdict"], [17, 5, 1, "", "_field_defaults"], [17, 5, 1, "", "_fields"], [17, 2, 1, "", "_make"], [17, 2, 1, "", "_replace"], [17, 5, 1, "", "other_states"], [17, 5, 1, "", "topk_decoded"], [17, 5, 1, "", "topk_hyps"], [17, 5, 1, "", "topk_ids"], [17, 5, 1, "", "topk_lens"], [17, 5, 1, "", "topk_scores"]], "lingvo.core.beam_search_helper.BeamSearchHelper": [[17, 2, 1, "", "BeamSearchDecode"], [17, 2, 1, "", "Params"], [17, 2, 1, "", "_BeamSearchStep"]], "lingvo.core.beam_search_helper.BeamSearchSharedParams": [[17, 2, 1, "", "Params"]], "lingvo.core.beam_search_helper.GreedySearchHelper": [[17, 2, 1, "", "GreedySearchDecode"], [17, 2, 1, "", "Params"], [17, 2, 1, "", "_GreedySearchStep"]], "lingvo.core.bfloat16_variables": [[18, 1, 1, "", "Bfloat16VariableSaveable"], [18, 6, 1, "", "get_saver_spec_for_variables_with_bf16_overrides"]], "lingvo.core.bfloat16_variables.Bfloat16VariableSaveable": [[18, 2, 1, "", "restore"]], "lingvo.core.bn_layers": [[19, 1, 1, "", "AddingAccumulator"], [19, 1, 1, "", "BatchNormLayer"], [19, 1, 1, "", "BatchNormLayerNoPadding"], [19, 1, 1, "", "CategoricalBN"], [19, 6, 1, "", "ComputeMoments"], [19, 1, 1, "", "GroupNormLayer"]], "lingvo.core.bn_layers.AddingAccumulator": [[19, 2, 1, "", "DefaultValue"], [19, 2, 1, "", "Update"]], "lingvo.core.bn_layers.BatchNormLayer": [[19, 2, 1, "", "ComputeAndUpdateMoments"], [19, 2, 1, "", "FProp"], [19, 2, 1, "", "FPropMeta"], [19, 2, 1, "", "GetCurrentMoments"], [19, 2, 1, "", "Params"], [19, 2, 1, "", "_ComputeBN"], [19, 2, 1, "", "_CreateLayerVariables"], [19, 2, 1, "", "_GetBetaGamma"], [19, 2, 1, "", "_GetDefaultPaddings"], [19, 2, 1, "", "_GetWeightShape"], [19, 2, 1, "", "_MaybeExpandPaddings"], [19, 3, 1, "", "epsilon"]], "lingvo.core.bn_layers.BatchNormLayerNoPadding": [[19, 2, 1, "", "FProp"], [19, 2, 1, "", "FPropMeta"], [19, 2, 1, "", "Params"], [19, 2, 1, "", "PostTrainingStepUpdate"], [19, 2, 1, "", "_CreateLayerVariables"], [19, 2, 1, "", "_Moments"]], "lingvo.core.bn_layers.CategoricalBN": [[19, 2, 1, "", "FProp"], [19, 2, 1, "", "Params"], [19, 2, 1, "", "_GetBetaGamma"], [19, 2, 1, "", "_GetWeightShape"]], "lingvo.core.bn_layers.GroupNormLayer": [[19, 2, 1, "", "FProp"], [19, 2, 1, "", "FPropMeta"], [19, 2, 1, "", "Params"], [19, 2, 1, "", "StreamStep"], [19, 2, 1, "", "_CreateLayerVariables"], [19, 2, 1, "", "_Normalize"], [19, 2, 1, "", "_StreamMoments"], [19, 3, 1, "", "group_size"], [19, 3, 1, "", "num_groups"], [19, 2, 1, "", "zero_state"]], "lingvo.core.build_data": [[20, 6, 1, "", "BuildData"]], "lingvo.core.builder": [[21, 1, 1, "", "Base"]], "lingvo.core.builder.Base": [[21, 2, 1, "", "Params"], [21, 2, 1, "", "_Activation"], [21, 2, 1, "", "_AddFetches"], [21, 2, 1, "", "_Arg"], [21, 2, 1, "", "_BN"], [21, 2, 1, "", "_BatchParallel"], [21, 2, 1, "", "_Bias"], [21, 2, 1, "", "_Concat"], [21, 2, 1, "", "_Conv2D"], [21, 2, 1, "", "_CreateNestedMap"], [21, 2, 1, "", "_Dropout"], [21, 2, 1, "", "_FC"], [21, 2, 1, "", "_Fn"], [21, 2, 1, "", "_Graph"], [21, 2, 1, "", "_Id"], [21, 2, 1, "", "_LN"], [21, 2, 1, "", "_Linear"], [21, 2, 1, "", "_MLP"], [21, 2, 1, "", "_Par"], [21, 2, 1, "", "_PrintShape"], [21, 2, 1, "", "_Rematerialize"], [21, 2, 1, "", "_Rep"], [21, 2, 1, "", "_Reshape"], [21, 2, 1, "", "_Save"], [21, 2, 1, "", "_Seq"], [21, 3, 1, "", "params"]], "lingvo.core.builder_layers": [[22, 1, 1, "", "ArgIndexLayer"], [22, 1, 1, "", "BatchParallelLayer"], [22, 1, 1, "", "BiasLayer"], [22, 1, 1, "", "BranchLayer"], [22, 1, 1, "", "ConcatLayer"], [22, 1, 1, "", "CreateNestedMapLayer"], [22, 1, 1, "", "FirstNLayer"], [22, 1, 1, "", "FnLayer"], [22, 1, 1, "", "GraphLayer"], [22, 1, 1, "", "GraphSignature"], [22, 1, 1, "", "GraphTensors"], [22, 1, 1, "", "LinearLayer"], [22, 1, 1, "", "MapLayer"], [22, 1, 1, "", "ParallelLayer"], [22, 1, 1, "", "ParallelRepeatLayer"], [22, 1, 1, "", "PrintShapeLayer"], [22, 1, 1, "", "RematerializationLayer"], [22, 1, 1, "", "RepeatLayer"], [22, 1, 1, "", "ReshapeLayer"], [22, 1, 1, "", "SequentialLayer"], [22, 1, 1, "", "SliceHelper"], [22, 1, 1, "", "SliceLayer"], [22, 1, 1, "", "SoftCondLayer"], [22, 1, 1, "", "UnarySequentialLayer"], [22, 6, 1, "", "_MaybeStackExtraTheta"], [22, 6, 1, "", "_ToTuple"]], "lingvo.core.builder_layers.ArgIndexLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.BatchParallelLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.BiasLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"], [22, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.builder_layers.BranchLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.ConcatLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.CreateNestedMapLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.FirstNLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.FnLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.GraphLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.GraphSignature": [[22, 2, 1, "", "_ConsumeItem"], [22, 2, 1, "", "_ConsumeKey"], [22, 2, 1, "", "_ConsumeList"], [22, 2, 1, "", "_ConsumeMap"], [22, 2, 1, "", "_ConsumePath"], [22, 2, 1, "", "_ConsumeSymbol"], [22, 2, 1, "", "_MaybeConsumeSymbol"], [22, 2, 1, "", "_ParseInputs"], [22, 2, 1, "", "_ParseOutputs"], [22, 2, 1, "", "_TokenizeInputs"], [22, 3, 1, "", "inputs"], [22, 3, 1, "", "outputs"]], "lingvo.core.builder_layers.GraphTensors": [[22, 2, 1, "", "GetTensor"], [22, 2, 1, "", "StoreTensor"]], "lingvo.core.builder_layers.LinearLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"], [22, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.builder_layers.MapLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.ParallelLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.ParallelRepeatLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "_InferOutShapes"]], "lingvo.core.builder_layers.PrintShapeLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"]], "lingvo.core.builder_layers.RematerializationLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.RepeatLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"], [22, 3, 1, "", "_body"], [22, 2, 1, "", "_child_variable_scope_override"], [22, 2, 1, "", "_unrolled_fprop"]], "lingvo.core.builder_layers.ReshapeLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.SequentialLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.SliceLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.SoftCondLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"], [22, 2, 1, "", "_CreateLayerVariables"], [22, 2, 1, "", "_GetExpertDist"]], "lingvo.core.builder_layers.UnarySequentialLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.checkpointer": [[23, 1, 1, "", "Checkpointer"], [23, 1, 1, "", "EagerCheckpointerV1"], [23, 1, 1, "", "EagerCheckpointerV2"], [23, 6, 1, "", "GetSpecificCheckpoint"], [23, 1, 1, "", "SaverWrapper"], [23, 6, 1, "", "SortCheckpointPaths"], [23, 1, 1, "", "_EagerCheckpointer"], [23, 6, 1, "", "_GetSaveableVariablesDict"]], "lingvo.core.checkpointer.Checkpointer": [[23, 2, 1, "", "MaybeSave"], [23, 2, 1, "", "Restore"], [23, 2, 1, "", "RestoreFromPath"], [23, 2, 1, "", "RestoreGlobalStepIfNeeded"], [23, 2, 1, "", "RestoreIfNeeded"], [23, 2, 1, "", "Save"], [23, 2, 1, "", "ShouldSave"], [23, 2, 1, "", "Sync"], [23, 2, 1, "", "_BuildInitFromCheckpointRules"], [23, 2, 1, "", "_GetSaver"], [23, 2, 1, "", "_GetUninitializedVarNames"], [23, 2, 1, "", "_RestoreFromLatestCheckpoint"], [23, 2, 1, "", "_UpdateNextSaveTime"], [23, 3, 1, "", "async_checkpointing"], [23, 3, 1, "", "checkpoint_dir"]], "lingvo.core.checkpointer.EagerCheckpointerV1": [[23, 2, 1, "", "Restore"], [23, 2, 1, "", "RestoreFromPath"], [23, 2, 1, "", "RestoreGlobalStepIfNeeded"], [23, 2, 1, "", "Save"], [23, 2, 1, "", "Sync"], [23, 2, 1, "", "_GetRestorer"], [23, 2, 1, "", "_GetSaver"], [23, 2, 1, "", "_WrapRestoreErrorWithGraphModeWarning"]], "lingvo.core.checkpointer.EagerCheckpointerV2": [[23, 2, 1, "", "Restore"], [23, 2, 1, "", "RestoreFromPath"], [23, 2, 1, "", "RestoreGlobalStepIfNeeded"], [23, 2, 1, "", "Save"], [23, 2, 1, "", "Sync"], [23, 2, 1, "", "_GetSaver"]], "lingvo.core.checkpointer.SaverWrapper": [[23, 2, 1, "", "Restore"], [23, 2, 1, "", "Save"], [23, 2, 1, "", "Sync"]], "lingvo.core.checkpointer._EagerCheckpointer": [[23, 2, 1, "", "RestoreIfNeeded"], [23, 2, 1, "", "_MaybeBuildInitFromCheckpointRules"], [23, 2, 1, "", "_MaybeOverwriteModelVariablesWithEMA"]], "lingvo.core.cluster": [[24, 6, 1, "", "GetInfeedContext"], [24, 1, 1, "", "InfeedContext"], [24, 6, 1, "", "InfeedContextScope"], [24, 6, 1, "", "MakeDeviceString"], [24, 6, 1, "", "ParseDeviceString"], [24, 1, 1, "", "VarPlacer"], [24, 1, 1, "", "_Cluster"], [24, 1, 1, "", "_LeastLoadedPlacer"]], "lingvo.core.cluster.InfeedContext": [[24, 2, 1, "", "_asdict"], [24, 5, 1, "", "_field_defaults"], [24, 5, 1, "", "_fields"], [24, 2, 1, "", "_make"], [24, 2, 1, "", "_replace"], [24, 5, 1, "", "infeed_host_index"], [24, 5, 1, "", "num_infeed_hosts"]], "lingvo.core.cluster.VarPlacer": [[24, 2, 1, "", "DeviceFunction"], [24, 2, 1, "", "_AssignVar"]], "lingvo.core.cluster._Cluster": [[24, 2, 1, "", "ExportMetrics"], [24, 2, 1, "", "GetPlacer"], [24, 2, 1, "", "InitDevices"], [24, 2, 1, "", "InitDevicesEager"], [24, 2, 1, "", "ListDevices"], [24, 2, 1, "", "Params"], [24, 2, 1, "", "Top"], [24, 2, 1, "", "WorkerDeviceInModelSplit"], [24, 2, 1, "", "_CheckInvariants"], [24, 2, 1, "", "_JobSpec"], [24, 3, 1, "", "add_summary"], [24, 3, 1, "", "all_worker_names"], [24, 3, 1, "", "asynchronous"], [24, 3, 1, "", "available_devices"], [24, 3, 1, "", "do_eval"], [24, 3, 1, "", "in_unit_test"], [24, 3, 1, "", "input_device"], [24, 3, 1, "", "input_targets"], [24, 3, 1, "", "is_executor_tpu"], [24, 3, 1, "", "job"], [24, 3, 1, "", "job_spec"], [24, 3, 1, "", "logdir"], [24, 3, 1, "", "mode"], [24, 3, 1, "", "num_devices_per_replica"], [24, 3, 1, "", "num_devices_per_split"], [24, 3, 1, "", "num_replicas"], [24, 3, 1, "", "num_splits_per_client"], [24, 3, 1, "", "num_splits_per_replica"], [24, 3, 1, "", "num_tpu_hosts"], [24, 3, 1, "", "params"], [24, 3, 1, "", "reporting_job"], [24, 3, 1, "", "require_sequential_input_order"], [24, 3, 1, "", "synchronous"], [24, 3, 1, "", "task"], [24, 3, 1, "", "tf_data_service_address"], [24, 3, 1, "", "total_worker_devices"], [24, 3, 1, "", "tpus_per_replica"], [24, 3, 1, "", "worker_cluster_def"]], "lingvo.core.cluster._LeastLoadedPlacer": [[24, 2, 1, "", "_AssignVar"]], "lingvo.core.cluster_factory": [[25, 6, 1, "", "Current"], [25, 6, 1, "", "ForTestingWorker"], [25, 6, 1, "", "SetCluster"], [25, 6, 1, "", "SetEval"], [25, 6, 1, "", "SetModelSplit"], [25, 6, 1, "", "SetRequireSequentialInputOrder"]], "lingvo.core.computation_cost": [[26, 6, 1, "", "Add"], [26, 6, 1, "", "Get"], [26, 6, 1, "", "Prepare"], [26, 6, 1, "", "_GetAccumulator"], [26, 6, 1, "", "_HasAccumulator"]], "lingvo.core.conformer_layer": [[27, 6, 1, "", "ApplyGshard"], [27, 1, 1, "", "ConformerLayer"], [27, 6, 1, "", "GShardMoELayerParams"], [27, 1, 1, "", "LConvLayer"], [27, 6, 1, "", "_AttenCtxIsSet"]], "lingvo.core.conformer_layer.ConformerLayer": [[27, 2, 1, "", "CommonParams"], [27, 2, 1, "", "ConfigFFLayer"], [27, 2, 1, "", "ConfigMoEParams"], [27, 2, 1, "", "FProp"], [27, 2, 1, "", "NumOutputNodes"], [27, 2, 1, "", "Params"], [27, 2, 1, "", "SetFPropDtype"], [27, 2, 1, "", "StreamStep"], [27, 2, 1, "", "Stride"], [27, 2, 1, "", "_AddAttenProbsHistogramSummary"], [27, 2, 1, "", "_AddAttenProbsImageSummary"], [27, 2, 1, "", "_AddAttentionSummaries"], [27, 2, 1, "", "_ConfigFFLayerOrMoEParams"], [27, 2, 1, "", "_ConfigSelfAttenContext"], [27, 2, 1, "", "_FProp"], [27, 2, 1, "", "_LConv"], [27, 2, 1, "", "_MoeOrFFLayer"], [27, 2, 1, "", "_SelfAtten"], [27, 3, 1, "", "has_fflayer_start"], [27, 3, 1, "", "has_lconv"], [27, 3, 1, "", "has_mhsa"], [27, 2, 1, "", "zero_state"]], "lingvo.core.conformer_layer.LConvLayer": [[27, 2, 1, "", "CommonParams"], [27, 2, 1, "", "FProp"], [27, 2, 1, "", "Params"], [27, 2, 1, "", "SetCanonicalShardingParams"], [27, 2, 1, "", "SetFPropDtype"], [27, 2, 1, "", "StreamStep"], [27, 2, 1, "", "_ApplyActivation"], [27, 2, 1, "", "_GLU"], [27, 2, 1, "", "_Normalize"], [27, 2, 1, "", "_NormalizeStep"], [27, 2, 1, "", "zero_state"]], "lingvo.core.conv_layers_builder": [[29, 1, 1, "", "BiasLayer"], [29, 1, 1, "", "Builder"], [29, 1, 1, "", "CausalPoolingLayer"]], "lingvo.core.conv_layers_builder.BiasLayer": [[29, 2, 1, "", "FProp"]], "lingvo.core.conv_layers_builder.Builder": [[29, 2, 1, "", "Conv2D"], [29, 2, 1, "", "DepthwiseConv2D"], [29, 2, 1, "", "LConv"], [29, 2, 1, "", "NormalizedDepthwiseConv2D"], [29, 2, 1, "", "NormalizedLConv"], [29, 2, 1, "", "Params"], [29, 2, 1, "", "SeparableConv2D"], [29, 2, 1, "", "_Activation"], [29, 2, 1, "", "_Add"], [29, 2, 1, "", "_Bias"], [29, 2, 1, "", "_BiasNoPadding"], [29, 2, 1, "", "_ExpandDims"], [29, 2, 1, "", "_GlobalPooling"], [29, 2, 1, "", "_Glu"], [29, 2, 1, "", "_LConvCommon"], [29, 2, 1, "", "_MaybeNorm"], [29, 2, 1, "", "_Norm"], [29, 2, 1, "", "_NormOrBias"], [29, 2, 1, "", "_Padding"], [29, 2, 1, "", "_RawConv2D"], [29, 2, 1, "", "_RawDepthwiseConv2D"], [29, 2, 1, "", "_Squeeze"]], "lingvo.core.conv_layers_builder.CausalPoolingLayer": [[29, 2, 1, "", "FProp"], [29, 2, 1, "", "Params"]], "lingvo.core.conv_layers_with_time_padding": [[30, 1, 1, "", "BaseConv2DLayerWithPadding"], [30, 1, 1, "", "CausalConv2DLayerWithPadding"], [30, 1, 1, "", "CausalDepthwiseConv2DLayer"], [30, 1, 1, "", "CausalNormalizedDepthwiseConv2DLayer"], [30, 6, 1, "", "ComputeConvOutputPadding"], [30, 6, 1, "", "ComputeConvOutputShape"], [30, 6, 1, "", "ComputeExplicitPaddingForCausalConv"], [30, 1, 1, "", "Conv2DLayerWithPadding"], [30, 1, 1, "", "ConvBatchNormLayer"], [30, 1, 1, "", "ConvCategoricalBN"], [30, 1, 1, "", "DepthwiseConv2DLayer"], [30, 1, 1, "", "GlobalPoolingLayer"], [30, 1, 1, "", "NormalizedDepthwiseConv2DLayer"], [30, 1, 1, "", "PaddingLayer"], [30, 6, 1, "", "_ComputeConvOutputPaddingV2"], [30, 6, 1, "", "_PadForLengthCompatibleStridesV2"]], "lingvo.core.conv_layers_with_time_padding.BaseConv2DLayerWithPadding": [[30, 2, 1, "", "FProp"], [30, 2, 1, "", "OutShape"], [30, 2, 1, "", "OutputChannels"], [30, 2, 1, "", "Params"], [30, 2, 1, "", "_ApplyConv"], [30, 2, 1, "", "_EvaluateConvKernel"], [30, 2, 1, "", "_MaybeCausalPadding"], [30, 2, 1, "", "_RescaleBoundary"], [30, 3, 1, "", "filter_stride"], [30, 3, 1, "", "input_channels"], [30, 3, 1, "", "output_channels"]], "lingvo.core.conv_layers_with_time_padding.CausalConv2DLayerWithPadding": [[30, 2, 1, "", "Params"], [30, 2, 1, "", "StreamStep"], [30, 2, 1, "", "_MaybeCausalPadding"], [30, 2, 1, "", "zero_state"]], "lingvo.core.conv_layers_with_time_padding.CausalDepthwiseConv2DLayer": [[30, 2, 1, "", "StreamStep"], [30, 2, 1, "", "_MaybeCausalPadding"], [30, 2, 1, "", "zero_state"]], "lingvo.core.conv_layers_with_time_padding.CausalNormalizedDepthwiseConv2DLayer": [[30, 2, 1, "", "_MaybeCausalPadding"]], "lingvo.core.conv_layers_with_time_padding.Conv2DLayerWithPadding": [[30, 2, 1, "", "OutputChannels"], [30, 2, 1, "", "OutputShape"], [30, 2, 1, "", "Params"], [30, 2, 1, "", "_ApplyConv"], [30, 2, 1, "", "_CreateLayerVariables"], [30, 2, 1, "", "_EvaluateConvKernel"], [30, 2, 1, "", "_GetWeight"]], "lingvo.core.conv_layers_with_time_padding.ConvBatchNormLayer": [[30, 2, 1, "", "FProp"]], "lingvo.core.conv_layers_with_time_padding.ConvCategoricalBN": [[30, 2, 1, "", "FProp"]], "lingvo.core.conv_layers_with_time_padding.DepthwiseConv2DLayer": [[30, 2, 1, "", "OutputChannels"], [30, 2, 1, "", "Params"], [30, 2, 1, "", "_ApplyConv"], [30, 2, 1, "", "_CreateLayerVariables"], [30, 2, 1, "", "_EvaluateConvKernel"], [30, 2, 1, "", "_GetWeight"], [30, 2, 1, "", "_GetWeightShape"]], "lingvo.core.conv_layers_with_time_padding.GlobalPoolingLayer": [[30, 2, 1, "", "FProp"], [30, 2, 1, "", "Params"]], "lingvo.core.conv_layers_with_time_padding.NormalizedDepthwiseConv2DLayer": [[30, 2, 1, "", "FPropMeta"], [30, 2, 1, "", "OutputChannels"], [30, 2, 1, "", "Params"], [30, 2, 1, "", "_GetWeight"], [30, 2, 1, "", "_GetWeightShape"], [30, 3, 1, "", "input_channels"]], "lingvo.core.conv_layers_with_time_padding.PaddingLayer": [[30, 2, 1, "", "FProp"]], "lingvo.core.datasource": [[31, 1, 1, "", "CrossBatchMixingDataSource"], [31, 1, 1, "", "CurriculumDataSource"], [31, 1, 1, "", "CustomTFDatasetTransform"], [31, 1, 1, "", "DataSource"], [31, 6, 1, "", "GetTFDataServiceDataSet"], [31, 1, 1, "", "PrefixedDataSource"], [31, 1, 1, "", "RepeatableTFDatasetTransform"], [31, 1, 1, "", "SimpleDataSource"], [31, 1, 1, "", "TFDSInput"], [31, 1, 1, "", "TFDataServiceSource"], [31, 1, 1, "", "TFDatasetAdaptor"], [31, 1, 1, "", "TFDatasetBatchBySequenceLength"], [31, 1, 1, "", "TFDatasetFnInput"], [31, 1, 1, "", "TFDatasetMixer"], [31, 1, 1, "", "TFDatasetPrefetch"], [31, 1, 1, "", "TFDatasetSource"], [31, 1, 1, "", "TFDatasetTransform"]], "lingvo.core.datasource.CrossBatchMixingDataSource": [[31, 2, 1, "", "GetMeta"], [31, 2, 1, "", "GetNext"], [31, 2, 1, "", "Params"]], "lingvo.core.datasource.CurriculumDataSource": [[31, 2, 1, "", "GetMeta"], [31, 2, 1, "", "GetNext"], [31, 2, 1, "", "Params"]], "lingvo.core.datasource.CustomTFDatasetTransform": [[31, 2, 1, "", "Params"], [31, 2, 1, "", "Transform"]], "lingvo.core.datasource.DataSource": [[31, 2, 1, "", "GetMeta"], [31, 2, 1, "", "GetNext"], [31, 2, 1, "", "Initialize"], [31, 2, 1, "", "Params"], [31, 2, 1, "", "Reset"], [31, 2, 1, "", "SetInputGenerator"]], "lingvo.core.datasource.PrefixedDataSource": [[31, 2, 1, "", "Params"]], "lingvo.core.datasource.RepeatableTFDatasetTransform": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "GetNext"], [31, 2, 1, "", "Params"], [31, 2, 1, "", "Transform"]], "lingvo.core.datasource.SimpleDataSource": [[31, 2, 1, "", "GetMeta"], [31, 2, 1, "", "GetNext"], [31, 2, 1, "", "Params"]], "lingvo.core.datasource.TFDSInput": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "Params"]], "lingvo.core.datasource.TFDataServiceSource": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "Params"], [31, 2, 1, "", "Reset"], [31, 2, 1, "", "SetInputGenerator"]], "lingvo.core.datasource.TFDatasetAdaptor": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "Params"]], "lingvo.core.datasource.TFDatasetBatchBySequenceLength": [[31, 2, 1, "", "Params"], [31, 2, 1, "", "Transform"]], "lingvo.core.datasource.TFDatasetFnInput": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "Params"]], "lingvo.core.datasource.TFDatasetMixer": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "Params"]], "lingvo.core.datasource.TFDatasetPrefetch": [[31, 2, 1, "", "Params"], [31, 2, 1, "", "Transform"]], "lingvo.core.datasource.TFDatasetSource": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "GetNext"], [31, 2, 1, "", "Initialize"], [31, 2, 1, "", "Reset"], [31, 2, 1, "", "_InitIterator"], [31, 3, 1, "", "_map_args"], [31, 3, 1, "", "host_id"], [31, 3, 1, "", "num_hosts"]], "lingvo.core.datasource.TFDatasetTransform": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "Params"], [31, 2, 1, "", "Transform"]], "lingvo.core.decoder_lib": [[32, 6, 1, "", "SerializeOutputs"], [32, 6, 1, "", "WriteKeyValuePairs"]], "lingvo.core.differentiable_assignment": [[33, 6, 1, "", "max_assignment"]], "lingvo.core.distillation_task": [[34, 1, 1, "", "DistillationTask"]], "lingvo.core.distillation_task.DistillationTask": [[34, 2, 1, "", "BProp"], [34, 2, 1, "", "ComputeDistillationLoss"], [34, 2, 1, "", "ComputeLoss"], [34, 2, 1, "", "ComputePredictions"], [34, 2, 1, "", "CreateDecoderMetrics"], [34, 2, 1, "", "Decode"], [34, 2, 1, "", "Inference"], [34, 2, 1, "", "Params"], [34, 2, 1, "", "PostProcessDecodeOut"]], "lingvo.core.distributed_shampoo": [[35, 1, 1, "", "DistributedShampoo"], [35, 1, 1, "", "PartitionConfig"], [35, 1, 1, "", "PartitionMetadata"], [35, 1, 1, "", "TensorPartitioner"]], "lingvo.core.distributed_shampoo.DistributedShampoo": [[35, 2, 1, "", "_apply_dense"], [35, 2, 1, "", "_apply_sparse"], [35, 2, 1, "", "_compute_preconditioned_raw_grad"], [35, 2, 1, "", "_create_slots"], [35, 2, 1, "", "_fallback_to_diagonal_for_shape"], [35, 2, 1, "", "_generalized_inverse_pth_root"], [35, 2, 1, "", "_inverse_pth_root_graph"], [35, 2, 1, "", "_key_for_var"], [35, 2, 1, "", "_make_named_slot"], [35, 2, 1, "", "_preconditioned_update"], [35, 2, 1, "", "_preconditioner_available_for_dims"], [35, 2, 1, "", "_preconditioner_indices"], [35, 2, 1, "", "_preconditioner_key_for_partition_and_dim"], [35, 2, 1, "", "_prepare"], [35, 2, 1, "", "_resource_apply_dense"], [35, 2, 1, "", "_resource_apply_sparse"], [35, 2, 1, "", "_specialized_inverse_pth_root"], [35, 2, 1, "", "_statistics_key_for_partition_and_dim"], [35, 2, 1, "", "_updated_statistics"], [35, 2, 1, "", "assign_preconditioner_to_host_vars"], [35, 2, 1, "", "invoke_async_preconditioner_computation"], [35, 2, 1, "", "make_named_zeros_slot"]], "lingvo.core.distributed_shampoo.TensorPartitioner": [[35, 2, 1, "", "partition_metadata"], [35, 2, 1, "", "partition_tensor"], [35, 2, 1, "", "reform_tensor"]], "lingvo.core.early_stop": [[36, 1, 1, "", "EarlyStop"], [36, 1, 1, "", "MetricHistory"]], "lingvo.core.early_stop.EarlyStop": [[36, 2, 1, "", "Params"], [36, 2, 1, "", "Stop"], [36, 3, 1, "", "best_step"], [36, 3, 1, "", "last_step"], [36, 3, 1, "", "metric_history"]], "lingvo.core.early_stop.MetricHistory": [[36, 2, 1, "", "Append"], [36, 2, 1, "", "ConditionalAppend"], [36, 2, 1, "", "Params"], [36, 2, 1, "", "SetLogdirInMetricHistories"], [36, 2, 1, "", "_Key"], [36, 5, 1, "", "_metric_histories_map"], [36, 3, 1, "", "hist_file"], [36, 3, 1, "", "metric"], [36, 3, 1, "", "minimize"], [36, 3, 1, "", "tfevent_file"]], "lingvo.core.egdd": [[37, 1, 1, "", "EGDD"]], "lingvo.core.egdd.EGDD": [[37, 2, 1, "", "_apply_dense"], [37, 2, 1, "", "_apply_sparse"], [37, 2, 1, "", "_create_slots"], [37, 2, 1, "", "_prepare"], [37, 2, 1, "", "_resource_apply_dense"], [37, 2, 1, "", "_resource_apply_sparse"]], "lingvo.core.entmax": [[38, 6, 1, "", "_calculate_probability"], [38, 6, 1, "", "entmax_loss"], [38, 6, 1, "", "entmax_support"]], "lingvo.core.favor_attention": [[39, 6, 1, "", "causal_denominator"], [39, 6, 1, "", "causal_numerator"], [39, 6, 1, "", "chunked_causal_denominator"], [39, 6, 1, "", "chunked_causal_denominator_func"], [39, 6, 1, "", "chunked_causal_denominator_grad"], [39, 6, 1, "", "chunked_causal_numerator"], [39, 6, 1, "", "chunked_causal_numerator_func"], [39, 6, 1, "", "chunked_causal_numerator_grad"], [39, 6, 1, "", "cossim_kernel_transformation"], [39, 6, 1, "", "create_projection_matrix"], [39, 6, 1, "", "favor_attention"], [39, 6, 1, "", "next_seed"], [39, 6, 1, "", "noncausal_denominator"], [39, 6, 1, "", "noncausal_numerator"], [39, 6, 1, "", "relu_kernel_transformation"], [39, 6, 1, "", "softmax_kernel_transformation"]], "lingvo.core.flat_beam_search_helper": [[40, 6, 1, "", "einsum_i32"], [40, 6, 1, "", "flat_beam_search"], [40, 6, 1, "", "update_nbest"]], "lingvo.core.generic_input": [[41, 6, 1, "", "GenericInput"], [41, 6, 1, "", "GenericInputV2Create"], [41, 6, 1, "", "GenericInputV2GetNext"], [41, 6, 1, "", "IsGenericInputV2AllwedInEager"], [41, 6, 1, "", "ReplicatedGenericInput"], [41, 6, 1, "", "SetAllowGenericInputV2InEager"], [41, 6, 1, "", "_ParseProcessor"]], "lingvo.core.gpipe": [[42, 6, 1, "", "CellFnFPropOpReplacementWrapper"], [42, 1, 1, "", "FeatureExtractionLayer"], [42, 6, 1, "", "GenerateStepSeedPair"], [42, 6, 1, "", "GetOverWriteGlobalStep"], [42, 6, 1, "", "PartitionSequentialLayers"], [42, 1, 1, "", "PipeliningLayer"], [42, 1, 1, "", "SeqLayer"], [42, 6, 1, "", "SetOverWriteGlobalStep"], [42, 6, 1, "", "_ToTuple"]], "lingvo.core.gpipe.FeatureExtractionLayer": [[42, 2, 1, "", "FProp"], [42, 2, 1, "", "FPropMeta"], [42, 2, 1, "", "Params"]], "lingvo.core.gpipe.PipeliningLayer": [[42, 2, 1, "", "FProp"], [42, 2, 1, "", "Params"], [42, 2, 1, "", "_CalculateOutputShapes"], [42, 2, 1, "", "_get_input_shapes"], [42, 2, 1, "", "_get_state_dtype"]], "lingvo.core.gpipe.SeqLayer": [[42, 2, 1, "", "FProp"], [42, 2, 1, "", "Params"], [42, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.graddrop": [[43, 1, 1, "", "GradDrop"]], "lingvo.core.graddrop.GradDrop": [[43, 2, 1, "", "FProp"], [43, 2, 1, "", "Params"], [43, 2, 1, "", "SetLosses"]], "lingvo.core.gradient_combiner": [[44, 1, 1, "", "GradientCombiner"]], "lingvo.core.gradient_combiner.GradientCombiner": [[44, 2, 1, "", "Combine"]], "lingvo.core.gshard_builder": [[45, 1, 1, "", "BertTransformer"], [45, 1, 1, "", "DenseBuilder"], [45, 1, 1, "", "MoEBuilder"], [45, 1, 1, "", "RecurrentDenseBuilderParallelDecode"], [45, 1, 1, "", "TunableUniTransformer"], [45, 1, 1, "", "UniTransformer"], [45, 6, 1, "", "_ToInt32"]], "lingvo.core.gshard_builder.BertTransformer": [[45, 2, 1, "", "ComputeLoss"], [45, 2, 1, "", "ComputePerTokenLoss"], [45, 2, 1, "", "ComputePredictions"], [45, 2, 1, "", "Params"], [45, 2, 1, "", "_ComputeEncInput"], [45, 2, 1, "", "_ComputeNonPadding"], [45, 2, 1, "", "_ComputeSoftLabels"]], "lingvo.core.gshard_builder.DenseBuilder": [[45, 2, 1, "", "Attention"], [45, 2, 1, "", "DecEncAttention"], [45, 2, 1, "", "DecMultiDconvHeadAttention"], [45, 2, 1, "", "DecMultiDconvHeadAttentionRelativeBias"], [45, 2, 1, "", "DecSelfAttention"], [45, 2, 1, "", "DecSelfAttentionRelativeBias"], [45, 2, 1, "", "DenseReluDense"], [45, 2, 1, "", "DenseReluDenseGated"], [45, 2, 1, "", "DepthwiseConvAutoregressive"], [45, 2, 1, "", "EinsumWithModelDim"], [45, 2, 1, "", "Embedding"], [45, 2, 1, "", "MeshSplit"], [45, 2, 1, "", "MoE"], [45, 2, 1, "", "MoEGated"], [45, 2, 1, "", "ParallelDecSelfAttentionRelativeBiasFFN"], [45, 2, 1, "", "Params"], [45, 2, 1, "", "SelfAttention"], [45, 2, 1, "", "SelfAttentionRelativeBias"], [45, 2, 1, "", "_CapLogits"], [45, 2, 1, "", "_ComputeAttenOutputs"], [45, 2, 1, "", "_ComputeCombinedOutputs"], [45, 2, 1, "", "_ComputeQKV"], [45, 2, 1, "", "_ComputeQKVCombine"], [45, 2, 1, "", "_ComputeQKVH"], [45, 2, 1, "", "_EinsumWithModelDim"], [45, 2, 1, "", "_JaxReplicaLN"], [45, 2, 1, "", "_LN"], [45, 2, 1, "", "_MeshSplit"], [45, 2, 1, "", "_MoEWeightsGatedGELU"], [45, 2, 1, "", "_PN"], [45, 2, 1, "", "_ReshapeM"], [45, 2, 1, "", "_ReshapedModelDims"], [45, 2, 1, "", "_ShardedFeedForwardNetworksWeights"], [45, 2, 1, "", "_ShardedMoEGLU"], [45, 2, 1, "", "_ShardedMoEPositionWiseFeedForwardNetworks"], [45, 2, 1, "", "_TrueLN"], [45, 3, 1, "", "_attention_output_hdm_w_split"], [45, 3, 1, "", "_device_mesh"]], "lingvo.core.gshard_builder.MoEBuilder": [[45, 2, 1, "", "Attention"], [45, 2, 1, "", "CausalDepthwiseConv"], [45, 2, 1, "", "DecEncAttention"], [45, 2, 1, "", "DecMultiDconvHeadAttention"], [45, 2, 1, "", "DecMultiDconvHeadAttentionRelativeBias"], [45, 2, 1, "", "DecSelfAttention"], [45, 2, 1, "", "DecSelfAttentionRelativeBias"], [45, 2, 1, "", "DecoderLayer"], [45, 2, 1, "", "DecoderLayerStack"], [45, 2, 1, "", "DenseReluDense"], [45, 2, 1, "", "DenseReluDenseGated"], [45, 2, 1, "", "DenseReluDenseGatedGELU"], [45, 2, 1, "", "DenseReluDenseGatedSILU"], [45, 2, 1, "", "DepthwiseConvAutoregressive"], [45, 2, 1, "", "Embedding"], [45, 2, 1, "", "EncoderLayer"], [45, 2, 1, "", "EncoderLayerStack"], [45, 2, 1, "", "Mask"], [45, 2, 1, "", "MoE"], [45, 2, 1, "", "Params"], [45, 2, 1, "", "Repeat"], [45, 2, 1, "", "SelfAttention"], [45, 2, 1, "", "SelfAttentionRelativeBias"], [45, 2, 1, "", "SetFPropDtype"], [45, 2, 1, "", "ShardablePipeline"], [45, 2, 1, "", "SharedEmbSoftmax"], [45, 2, 1, "", "SmoothedSoftmax"], [45, 2, 1, "", "SoftmaxWeight"], [45, 2, 1, "", "Split"], [45, 2, 1, "", "_Add"], [45, 2, 1, "", "_AddRelativeBias"], [45, 2, 1, "", "_AdjustMSplit"], [45, 2, 1, "", "_AdjustMSplitByName"], [45, 2, 1, "", "_AttentionState"], [45, 2, 1, "", "_AttentionWeights"], [45, 2, 1, "", "_ComputeAttenOutputs"], [45, 2, 1, "", "_ComputeGating"], [45, 2, 1, "", "_ComputeQKV"], [45, 2, 1, "", "_ComputeQKVCombine"], [45, 2, 1, "", "_DecComputeBiasGraphEdge"], [45, 2, 1, "", "_DecNotVisible"], [45, 3, 1, "", "_DecoderLayerInMapKeys"], [45, 2, 1, "", "_DenseReluDenseWeights"], [45, 2, 1, "", "_DenseReluDenseWeightsGatedGELU"], [45, 2, 1, "", "_Dropout"], [45, 2, 1, "", "_EmbeddingWeight"], [45, 2, 1, "", "_EncNotVisible"], [45, 2, 1, "", "_EncoderAddRelativeBias"], [45, 3, 1, "", "_EncoderLayerInMapKeys"], [45, 2, 1, "", "_FeedForwardNetworksApplyGating"], [45, 2, 1, "", "_GetRopeFn"], [45, 2, 1, "", "_Identity"], [45, 2, 1, "", "_JaxReplicaLN"], [45, 2, 1, "", "_LN"], [45, 2, 1, "", "_LNConv"], [45, 2, 1, "", "_LNInternal"], [45, 2, 1, "", "_LNNoScale"], [45, 2, 1, "", "_LayerStack"], [45, 2, 1, "", "_OneHotEncode"], [45, 2, 1, "", "_Override"], [45, 2, 1, "", "_PN"], [45, 2, 1, "", "_RelativeAttentionBiasWeights"], [45, 2, 1, "", "_RelativePositionBucket"], [45, 2, 1, "", "_ShardedFeedForwardNetworksWeights"], [45, 2, 1, "", "_ShardedMoEPositionWiseFeedForwardNetworks"], [45, 2, 1, "", "_ShardedVar"], [45, 2, 1, "", "_ShardedVarOn1DDeviceArray"], [45, 2, 1, "", "_Softmax"], [45, 2, 1, "", "_Top2GatingWeights"], [45, 2, 1, "", "_TrueLN"], [45, 2, 1, "", "_Var"], [45, 3, 1, "", "_device_mesh"], [45, 3, 1, "", "_model_dim_reshape_segments"], [45, 2, 1, "", "_zero_aux_loss"]], "lingvo.core.gshard_builder.RecurrentDenseBuilderParallelDecode": [[45, 2, 1, "", "DecoderLayer"], [45, 2, 1, "", "DecoderLayerStack"], [45, 2, 1, "", "Params"], [45, 2, 1, "", "_ComputeQKVH"], [45, 3, 1, "", "_DecoderLayerInMapKeys"], [45, 2, 1, "", "_DecoderLayerInputProjWeights"], [45, 2, 1, "", "_DecoderLayerOutputProjWeights"], [45, 3, 1, "", "_atten_kv_var_heads"], [45, 3, 1, "", "_atten_q_var_heads"], [45, 3, 1, "", "_ffw_var_h_dim_size"], [45, 3, 1, "", "_num_input_proj_weights"], [45, 3, 1, "", "_num_output_proj_weights"]], "lingvo.core.gshard_builder.TunableUniTransformer": [[45, 2, 1, "", "Params"], [45, 2, 1, "", "_GetDecoderLayerStackParams"]], "lingvo.core.gshard_builder.UniTransformer": [[45, 2, 1, "", "ComputeLoss"], [45, 2, 1, "", "ComputePerTokenLoss"], [45, 2, 1, "", "ComputePredictions"], [45, 2, 1, "", "DecodeIds"], [45, 2, 1, "", "FilterPerExampleTensors"], [45, 2, 1, "", "Params"], [45, 2, 1, "", "ProcessFPropResults"], [45, 2, 1, "", "_BPropGenTrainOps"], [45, 2, 1, "", "_ComputeDecoderInput"], [45, 2, 1, "", "_ComputeNonPadding"], [45, 2, 1, "", "_ComputeSoftLabels"], [45, 2, 1, "", "_FlatBeamSearchCallback"], [45, 2, 1, "", "_GetDecoderLayerStackParams"], [45, 2, 1, "", "_SplitDecoderOutputAndSoftmax"], [45, 2, 1, "", "_top_k_fn"]], "lingvo.core.gshard_decode": [[46, 1, 1, "", "GShardDecode"], [46, 6, 1, "", "daemon"], [46, 6, 1, "", "get_zero_batch"], [46, 6, 1, "", "infinite_repeat"], [46, 6, 1, "", "preload_zero"]], "lingvo.core.gshard_decode.GShardDecode": [[46, 2, 1, "", "_config_infeed"], [46, 2, 1, "", "_config_outfeed"], [46, 2, 1, "", "_configure_cluster_params"], [46, 2, 1, "", "_init_tpu"], [46, 2, 1, "", "_no_opt_sess_cfg"], [46, 2, 1, "", "_start_heartbeat"], [46, 2, 1, "", "get_session"], [46, 2, 1, "", "init_graph"], [46, 2, 1, "", "load_spm"], [46, 2, 1, "", "reset_session"], [46, 2, 1, "", "reset_tpu_cluster"], [46, 2, 1, "", "run_init_sequence"]], "lingvo.core.gshard_layers": [[47, 1, 1, "", "CausalDepthwiseConv1DLayer"], [47, 6, 1, "", "ComputeGating"], [47, 1, 1, "", "Conv1DStateLayer"], [47, 6, 1, "", "EinsumWithModelDim"], [47, 6, 1, "", "FeedForwardNetworksApplyGating"], [47, 6, 1, "", "GatherK"], [47, 6, 1, "", "GetSentenceEmbeddings"], [47, 6, 1, "", "HashGating"], [47, 6, 1, "", "HashGatingOnLogits"], [47, 1, 1, "", "LayerwiseShardablePipelinedLayer"], [47, 1, 1, "", "MultiHeadAttentionStateLayer"], [47, 6, 1, "", "OptimalTransportGating"], [47, 6, 1, "", "OptimalTransportOnlogits"], [47, 1, 1, "", "OverrideLayer"], [47, 1, 1, "", "ReshapeInputLayer"], [47, 6, 1, "", "SentenceTop2Gating"], [47, 1, 1, "", "ShardedVarLayer"], [47, 6, 1, "", "ShardedWeightParams"], [47, 1, 1, "", "SharedEmbeddingSoftmaxLayer"], [47, 1, 1, "", "StateLayer"], [47, 6, 1, "", "TaskTop2Gating"], [47, 6, 1, "", "TokenShuffleGating"], [47, 6, 1, "", "TokenShuffleGatingV2"], [47, 6, 1, "", "TokenShufflingOnlogits"], [47, 6, 1, "", "TokenShufflingOnlogitsV2"], [47, 6, 1, "", "Top2Gating"], [47, 6, 1, "", "Top2GatingOnLogits"], [47, 1, 1, "", "VarLayer"], [47, 6, 1, "", "_EinsumEqWithModelDim"], [47, 6, 1, "", "_ToTuple"]], "lingvo.core.gshard_layers.CausalDepthwiseConv1DLayer": [[47, 2, 1, "", "FProp"], [47, 2, 1, "", "Params"], [47, 2, 1, "", "_CreateLayerVariables"], [47, 2, 1, "", "_DoConv"], [47, 2, 1, "", "_GetWeight"], [47, 2, 1, "", "_Var"]], "lingvo.core.gshard_layers.Conv1DStateLayer": [[47, 2, 1, "", "FProp"], [47, 2, 1, "", "NewState"], [47, 2, 1, "", "Params"], [47, 2, 1, "", "_ProcessPrefixOrSuffix"], [47, 2, 1, "", "_Step"]], "lingvo.core.gshard_layers.LayerwiseShardablePipelinedLayer": [[47, 2, 1, "", "BodyFProp"], [47, 2, 1, "", "BodyFPropNoMicrobatching"], [47, 2, 1, "", "FProp"], [47, 2, 1, "", "FPropFn"], [47, 2, 1, "", "PadMicrobatches"], [47, 2, 1, "", "Params"], [47, 2, 1, "", "_BodyFPropInternal"], [47, 2, 1, "", "_FindPerStageVarShardingDim"], [47, 2, 1, "", "_MicrobatchAndRepeatIDs"], [47, 2, 1, "", "_PadMicrobatchesInternal"], [47, 3, 1, "", "_body"], [47, 2, 1, "", "_child_variable_scope_override"], [47, 2, 1, "", "_unrolled_fprop"], [47, 2, 1, "", "layer_theta"]], "lingvo.core.gshard_layers.MultiHeadAttentionStateLayer": [[47, 2, 1, "", "NewState"], [47, 2, 1, "", "_Step"], [47, 5, 1, "", "_use_flat_beam_search"]], "lingvo.core.gshard_layers.OverrideLayer": [[47, 2, 1, "", "Clear"], [47, 2, 1, "", "FProp"], [47, 2, 1, "", "Params"], [47, 2, 1, "", "Set"], [47, 5, 1, "", "_OVERRIDE"]], "lingvo.core.gshard_layers.ReshapeInputLayer": [[47, 2, 1, "", "FProp"], [47, 2, 1, "", "Params"]], "lingvo.core.gshard_layers.ShardedVarLayer": [[47, 2, 1, "", "FProp"], [47, 2, 1, "", "Params"]], "lingvo.core.gshard_layers.SharedEmbeddingSoftmaxLayer": [[47, 2, 1, "", "ComputeLoss"], [47, 2, 1, "", "FProp"], [47, 2, 1, "", "Params"], [47, 2, 1, "", "_MaybeSplit"]], "lingvo.core.gshard_layers.StateLayer": [[47, 2, 1, "", "FProp"], [47, 2, 1, "", "InitState"], [47, 2, 1, "", "NewState"], [47, 2, 1, "", "Params"], [47, 2, 1, "", "UpdateState"], [47, 2, 1, "", "UpdateTheta"], [47, 2, 1, "", "_Step"]], "lingvo.core.gshard_layers.VarLayer": [[47, 2, 1, "", "FProp"], [47, 2, 1, "", "Params"], [47, 2, 1, "", "_get_var_from_collection"]], "lingvo.core.gshard_utils": [[48, 6, 1, "", "GetMeshSplitDimPrefixContext"], [48, 6, 1, "", "GetMeshSplitSharding"], [48, 6, 1, "", "GetNonPod2dMesh"], [48, 6, 1, "", "GetVarSharding"], [48, 6, 1, "", "LoadSpm"], [48, 6, 1, "", "ManualMeshDimContext"], [48, 6, 1, "", "MeshSplit"], [48, 6, 1, "", "MeshSplitDimPrefixContext"], [48, 6, 1, "", "Replicate"], [48, 6, 1, "", "ReshapeDim"], [48, 6, 1, "", "Split"], [48, 1, 1, "", "TensorShardingSpec"], [48, 6, 1, "", "ZigzagOrderOnDeviceMesh"]], "lingvo.core.gshard_utils.TensorShardingSpec": [[48, 2, 1, "", "AddLeadingDims"], [48, 2, 1, "", "ApplyToTensor"], [48, 2, 1, "", "ApplyToVariable"], [48, 2, 1, "", "AutoToManualPartitioning"], [48, 2, 1, "", "FromFullShape"], [48, 2, 1, "", "FromXlaOpSharding"], [48, 2, 1, "", "ManualToAutoPartitioning"], [48, 2, 1, "", "RemoveDim"], [48, 2, 1, "", "RemoveLeadingDims"], [48, 2, 1, "", "ReplicatedSpec"], [48, 2, 1, "", "ShardShape"], [48, 2, 1, "", "ToXlaOpSharding"], [48, 3, 1, "", "device_mesh"], [48, 3, 1, "", "is_replicated"], [48, 3, 1, "", "mesh_dim_to_tensor_dim_mapping"], [48, 3, 1, "", "split_dims_mapping"], [48, 3, 1, "", "uneven_padding"]], "lingvo.core.hyperparams": [[49, 6, 1, "", "CopyFieldsTo"], [49, 1, 1, "", "InstantiableParams"], [49, 1, 1, "", "Params"], [49, 6, 1, "", "_EndsWithTerminalQuote"], [49, 6, 1, "", "_IsNamedTuple"], [49, 1, 1, "", "_Param"], [49, 6, 1, "", "_QuoteString"], [49, 1, 1, "", "_SortedDict"], [49, 6, 1, "", "_UnquoteString"]], "lingvo.core.hyperparams.InstantiableParams": [[49, 2, 1, "", "Copy"], [49, 2, 1, "", "Instantiate"]], "lingvo.core.hyperparams.Params": [[49, 2, 1, "", "Copy"], [49, 2, 1, "", "Define"], [49, 2, 1, "", "Delete"], [49, 2, 1, "", "Freeze"], [49, 2, 1, "", "FromProto"], [49, 2, 1, "", "FromText"], [49, 2, 1, "", "FromTextWithTypes"], [49, 2, 1, "", "Get"], [49, 2, 1, "", "GetKeys"], [49, 2, 1, "", "IsImmutable"], [49, 2, 1, "", "IterParams"], [49, 2, 1, "", "MergeCommonKeysFrom"], [49, 2, 1, "", "Set"], [49, 2, 1, "", "TextDiff"], [49, 2, 1, "", "ToProto"], [49, 2, 1, "", "ToText"], [49, 2, 1, "", "ToTextWithTypes"], [49, 2, 1, "", "Visit"], [49, 2, 1, "", "_CopyTo"], [49, 2, 1, "", "_GetNested"], [49, 2, 1, "", "_KeyErrorString"], [49, 2, 1, "", "_SimilarKeys"], [49, 2, 1, "", "_ToString"]], "lingvo.core.hyperparams._Param": [[49, 2, 1, "", "Get"], [49, 2, 1, "", "GetDefault"], [49, 2, 1, "", "Set"], [49, 2, 1, "", "ToString"]], "lingvo.core.hyperparams_pb2": [[50, 1, 1, "", "EnumVal"], [50, 1, 1, "", "Hyperparam"], [50, 1, 1, "", "HyperparamRepeated"], [50, 1, 1, "", "HyperparamValue"], [50, 1, 1, "", "NamedTupleVal"], [50, 1, 1, "", "ProtoVal"], [50, 6, 1, "", "_b"]], "lingvo.core.hyperparams_pb2.EnumVal": [[50, 5, 1, "", "DESCRIPTOR"], [50, 5, 1, "", "name"], [50, 5, 1, "", "type"]], "lingvo.core.hyperparams_pb2.Hyperparam": [[50, 5, 1, "", "DESCRIPTOR"], [50, 1, 1, "", "ItemsEntry"], [50, 5, 1, "", "items"]], "lingvo.core.hyperparams_pb2.Hyperparam.ItemsEntry": [[50, 5, 1, "", "DESCRIPTOR"], [50, 5, 1, "", "key"], [50, 5, 1, "", "value"]], "lingvo.core.hyperparams_pb2.HyperparamRepeated": [[50, 5, 1, "", "DESCRIPTOR"], [50, 5, 1, "", "items"]], "lingvo.core.hyperparams_pb2.HyperparamValue": [[50, 5, 1, "", "DESCRIPTOR"], [50, 5, 1, "", "bool_val"], [50, 5, 1, "", "dict_val"], [50, 5, 1, "", "dtype_val"], [50, 5, 1, "", "enum_val"], [50, 5, 1, "", "float_val"], [50, 5, 1, "", "int_val"], [50, 5, 1, "", "list_val"], [50, 5, 1, "", "named_tuple_val"], [50, 5, 1, "", "param_val"], [50, 5, 1, "", "proto_val"], [50, 5, 1, "", "string_repr_val"], [50, 5, 1, "", "string_val"], [50, 5, 1, "", "symbolic_val"], [50, 5, 1, "", "tuple_val"], [50, 5, 1, "", "type_val"]], "lingvo.core.hyperparams_pb2.NamedTupleVal": [[50, 5, 1, "", "DESCRIPTOR"], [50, 5, 1, "", "items"], [50, 5, 1, "", "type"]], "lingvo.core.hyperparams_pb2.ProtoVal": [[50, 5, 1, "", "DESCRIPTOR"], [50, 5, 1, "", "type"], [50, 5, 1, "", "val"]], "lingvo.core.inference_graph_exporter": [[51, 6, 1, "", "ConstGuaranteeScope"], [51, 6, 1, "", "ConvertSubgraphDictToProto"], [51, 6, 1, "", "GetOutputOpNames"], [51, 6, 1, "", "GuaranteeConstGetter"], [51, 1, 1, "", "InferenceDeviceOptions"], [51, 1, 1, "", "InferenceGraphExporter"], [51, 6, 1, "", "IsTpu"], [51, 6, 1, "", "NoConstGuaranteeScope"], [51, 6, 1, "", "ShouldForceBfloat16ForActivations"], [51, 6, 1, "", "ShouldForceBfloat16ForWeightsAndActivations"], [51, 6, 1, "", "_DummyScope"], [51, 6, 1, "", "_FreezeDefaults"], [51, 6, 1, "", "_FreezeGraphFromCheckpoint"], [51, 6, 1, "", "_GetVarName"], [51, 6, 1, "", "_MakeVariableDictionary"], [51, 6, 1, "", "_ParamExists"]], "lingvo.core.inference_graph_exporter.InferenceDeviceOptions": [[51, 2, 1, "", "_asdict"], [51, 5, 1, "", "_field_defaults"], [51, 5, 1, "", "_fields"], [51, 2, 1, "", "_make"], [51, 2, 1, "", "_replace"], [51, 5, 1, "", "device"], [51, 5, 1, "", "dtype_override"], [51, 5, 1, "", "fprop_dtype_override"], [51, 5, 1, "", "gen_init_op"], [51, 5, 1, "", "retain_device_placement"], [51, 5, 1, "", "var_options"]], "lingvo.core.inference_graph_exporter.InferenceGraphExporter": [[51, 2, 1, "", "Export"], [51, 2, 1, "", "_DeviceSupportsFreezing"], [51, 2, 1, "", "_SetClusterParams"]], "lingvo.core.inference_graph_pb2": [[52, 1, 1, "", "InferenceGraph"], [52, 6, 1, "", "_b"]], "lingvo.core.inference_graph_pb2.InferenceGraph": [[52, 1, 1, "", "CollectionDefEntry"], [52, 5, 1, "", "DESCRIPTOR"], [52, 1, 1, "", "FeedFetchMeta"], [52, 1, 1, "", "Subgraph"], [52, 1, 1, "", "SubgraphMeta"], [52, 1, 1, "", "SubgraphsEntry"], [52, 5, 1, "", "asset_file_def"], [52, 5, 1, "", "collection_def"], [52, 5, 1, "", "graph_def"], [52, 5, 1, "", "hyperparameters"], [52, 5, 1, "", "saver_def"], [52, 5, 1, "", "subgraphs"]], "lingvo.core.inference_graph_pb2.InferenceGraph.CollectionDefEntry": [[52, 5, 1, "", "DESCRIPTOR"], [52, 5, 1, "", "key"], [52, 5, 1, "", "value"]], "lingvo.core.inference_graph_pb2.InferenceGraph.FeedFetchMeta": [[52, 5, 1, "", "DESCRIPTOR"], [52, 5, 1, "", "data_type"], [52, 5, 1, "", "dispatch_stride_axis"], [52, 5, 1, "", "extensions"], [52, 5, 1, "", "layout"], [52, 5, 1, "", "quantized_max_const"], [52, 5, 1, "", "quantized_max_tensor"], [52, 5, 1, "", "quantized_min_const"], [52, 5, 1, "", "quantized_min_tensor"], [52, 5, 1, "", "quantized_num_bits"], [52, 5, 1, "", "shape"]], "lingvo.core.inference_graph_pb2.InferenceGraph.Subgraph": [[52, 5, 1, "", "DESCRIPTOR"], [52, 1, 1, "", "FeedsEntry"], [52, 1, 1, "", "FeedsMetaEntry"], [52, 1, 1, "", "FetchesEntry"], [52, 1, 1, "", "FetchesMetaEntry"], [52, 5, 1, "", "feeds"], [52, 5, 1, "", "feeds_meta"], [52, 5, 1, "", "fetches"], [52, 5, 1, "", "fetches_meta"], [52, 5, 1, "", "meta"]], "lingvo.core.inference_graph_pb2.InferenceGraph.Subgraph.FeedsEntry": [[52, 5, 1, "", "DESCRIPTOR"], [52, 5, 1, "", "key"], [52, 5, 1, "", "value"]], "lingvo.core.inference_graph_pb2.InferenceGraph.Subgraph.FeedsMetaEntry": [[52, 5, 1, "", "DESCRIPTOR"], [52, 5, 1, "", "key"], [52, 5, 1, "", "value"]], "lingvo.core.inference_graph_pb2.InferenceGraph.Subgraph.FetchesEntry": [[52, 5, 1, "", "DESCRIPTOR"], [52, 5, 1, "", "key"], [52, 5, 1, "", "value"]], "lingvo.core.inference_graph_pb2.InferenceGraph.Subgraph.FetchesMetaEntry": [[52, 5, 1, "", "DESCRIPTOR"], [52, 5, 1, "", "key"], [52, 5, 1, "", "value"]], "lingvo.core.inference_graph_pb2.InferenceGraph.SubgraphMeta": [[52, 5, 1, "", "DESCRIPTOR"], [52, 5, 1, "", "extensions"]], "lingvo.core.inference_graph_pb2.InferenceGraph.SubgraphsEntry": [[52, 5, 1, "", "DESCRIPTOR"], [52, 5, 1, "", "key"], [52, 5, 1, "", "value"]], "lingvo.core.input_generator_helper": [[53, 6, 1, "", "ComputeSplits"], [53, 6, 1, "", "SplitDictOfTensors"], [53, 6, 1, "", "SplitTensors"]], "lingvo.core.input_policy": [[54, 6, 1, "", "Apply"]], "lingvo.core.insertion": [[55, 6, 1, "", "SequenceAppendToken"], [55, 6, 1, "", "SequenceConcat"], [55, 6, 1, "", "SequenceTrimLastToken"], [55, 1, 1, "", "SymbolInsertionLayer"]], "lingvo.core.insertion.SymbolInsertionLayer": [[55, 2, 1, "", "FProp"], [55, 2, 1, "", "Params"]], "lingvo.core.inspect_utils": [[56, 6, 1, "", "CallWithParams"], [56, 6, 1, "", "ConstructWithParams"], [56, 6, 1, "", "DefineParams"], [56, 6, 1, "", "_ExtractParameters"], [56, 6, 1, "", "_IsDefinableParameter"], [56, 6, 1, "", "_MakeArgs"]], "lingvo.core.layers": [[57, 1, 1, "", "BaseConv2DLayer"], [57, 1, 1, "", "BlurPoolLayer"], [57, 1, 1, "", "CCTGatingNetwork"], [57, 1, 1, "", "CategoricalLayerNorm"], [57, 1, 1, "", "CondScaleShiftFFNLayer"], [57, 6, 1, "", "Conv2DFlops"], [57, 1, 1, "", "Conv2DLayer"], [57, 1, 1, "", "Conv2DLayerNoPadding"], [57, 5, 1, "", "ConvLayer"], [57, 1, 1, "", "ConvNN2DLayer"], [57, 1, 1, "", "ConvSetLayer"], [57, 1, 1, "", "ConvSoftmax"], [57, 1, 1, "", "DeconvLayer"], [57, 1, 1, "", "DepthwiseConv2DLayer"], [57, 1, 1, "", "DeterministicDropoutLayer"], [57, 1, 1, "", "DropoutLayer"], [57, 1, 1, "", "EinsumEmbeddingLayer"], [57, 1, 1, "", "EinsumSoftmax"], [57, 1, 1, "", "EmbeddingLayer"], [57, 1, 1, "", "FCLayer"], [57, 1, 1, "", "FeedForwardNet"], [57, 1, 1, "", "FetchLayer"], [57, 1, 1, "", "FocalFullSoftmax"], [57, 1, 1, "", "GatedAverageLayer"], [57, 1, 1, "", "GatingLayer"], [57, 1, 1, "", "GluLayer"], [57, 1, 1, "", "GradNormTracker"], [57, 1, 1, "", "HighwaySkipLayer"], [57, 1, 1, "", "IdentityLayer"], [57, 1, 1, "", "LHUCLayer"], [57, 1, 1, "", "LSHMemoryRankKOneHotTaskLayer"], [57, 1, 1, "", "LSHTaskWithMultiplierLayer"], [57, 1, 1, "", "LayerNorm"], [57, 1, 1, "", "LearnablePositionalEmbeddingLayer"], [57, 1, 1, "", "LocalizedLabelSmoother"], [57, 1, 1, "", "MaskedLmDataAugmenter"], [57, 1, 1, "", "MultitaskAdapterBaseLayer"], [57, 1, 1, "", "MultitaskAdapterEinsumLayer"], [57, 1, 1, "", "MultitaskAdapterLayer"], [57, 1, 1, "", "OneHotEmbeddingLayer"], [57, 1, 1, "", "PerFrameStatisticalPoolingLayer"], [57, 1, 1, "", "PoolingLayer"], [57, 1, 1, "", "PositionalEmbeddingLayer"], [57, 1, 1, "", "ProjectionLayer"], [57, 1, 1, "", "RelativePositionalEmbeddingLayer"], [57, 1, 1, "", "ReshapedLayerNorm"], [57, 1, 1, "", "ResidualAdapterLayer"], [57, 1, 1, "", "RotaryPositionalEmbeddingLayer"], [57, 1, 1, "", "Scones"], [57, 1, 1, "", "SeparableConv2DLayer"], [57, 1, 1, "", "SharedSoftmaxLayer"], [57, 1, 1, "", "SimpleEmbeddingLayer"], [57, 1, 1, "", "SimpleFullSigmoidCrossEntropy"], [57, 1, 1, "", "SimpleFullSoftmax"], [57, 1, 1, "", "SingleShardEmbeddingLayer"], [57, 1, 1, "", "SingleShardFullSoftmax"], [57, 1, 1, "", "SingleShardSharedEmbeddingSoftmax"], [57, 1, 1, "", "SinusoidalPositionalEmbeddingLayer"], [57, 1, 1, "", "SoftmaxLayer"], [57, 1, 1, "", "StackingOverTime"], [57, 1, 1, "", "StatisticalPoolingLayer"], [57, 1, 1, "", "UniformLabelSmoother"], [57, 1, 1, "", "WeightedSumLayer"]], "lingvo.core.layers.BaseConv2DLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "OutShape"], [57, 2, 1, "", "OutputShape"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_ApplyConv"], [57, 2, 1, "", "_Compute"], [57, 2, 1, "", "_ComputeConvLast"], [57, 2, 1, "", "_CreateLayerVariables"], [57, 2, 1, "", "_EvaluateConvKernel"], [57, 2, 1, "", "_GetWeights"], [57, 2, 1, "", "_child_variable_scope_override"], [57, 3, 1, "", "_is_bn_folded"], [57, 3, 1, "", "filter_output_shape"], [57, 3, 1, "", "output_channels"]], "lingvo.core.layers.BlurPoolLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.CCTGatingNetwork": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "FPropMeta"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.CategoricalLayerNorm": [[57, 2, 1, "", "Params"], [57, 2, 1, "", "_BiasVarName"], [57, 2, 1, "", "_CreateLayerVariables"], [57, 2, 1, "", "_GetScaleAndBias"], [57, 2, 1, "", "_ScaleVarName"]], "lingvo.core.layers.CondScaleShiftFFNLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.Conv2DLayer": [[57, 2, 1, "", "_EvaluateConvKernel"]], "lingvo.core.layers.Conv2DLayerNoPadding": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "FPropMeta"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.ConvNN2DLayer": [[57, 2, 1, "", "_EvaluateConvKernel"]], "lingvo.core.layers.ConvSetLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.ConvSoftmax": [[57, 2, 1, "", "Logits"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.DeconvLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "OutShape"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_ApplyConv"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.DepthwiseConv2DLayer": [[57, 2, 1, "", "Params"], [57, 2, 1, "", "_EvaluateConvKernel"], [57, 3, 1, "", "filter_output_shape"], [57, 3, 1, "", "output_channels"]], "lingvo.core.layers.DeterministicDropoutLayer": [[57, 2, 1, "", "_Dropout"]], "lingvo.core.layers.DropoutLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "FPropMeta"], [57, 2, 1, "", "NumOutputNodes"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_Dropout"]], "lingvo.core.layers.EinsumEmbeddingLayer": [[57, 2, 1, "", "AddGlobalVN"], [57, 2, 1, "", "EmbLookup"], [57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.EinsumSoftmax": [[57, 2, 1, "", "DenseWeights"], [57, 2, 1, "", "FProp"], [57, 2, 1, "", "Logits"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "XentLossFromLogits"], [57, 2, 1, "", "_CreateLayerVariables"], [57, 3, 1, "", "wm_transposed"]], "lingvo.core.layers.EmbeddingLayer": [[57, 2, 1, "", "AddGlobalVN"], [57, 2, 1, "", "EmbLookup"], [57, 2, 1, "", "EmbLookupDefaultTheta"], [57, 5, 1, "", "MIN_PARAMS_PER_SHARD"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.FCLayer": [[57, 2, 1, "", "Params"]], "lingvo.core.layers.FeedForwardNet": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "FPropAllLayers"], [57, 2, 1, "", "FPropMeta"], [57, 2, 1, "", "NumOutputNodes"], [57, 2, 1, "", "Params"], [57, 3, 1, "", "output_dim"]], "lingvo.core.layers.FetchLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "FPropMeta"], [57, 2, 1, "", "_ReturnSingleValueOrList"], [57, 3, 1, "", "activation"], [57, 3, 1, "", "gradient"]], "lingvo.core.layers.FocalFullSoftmax": [[57, 2, 1, "", "Params"], [57, 2, 1, "", "XentLossFromLogits"]], "lingvo.core.layers.GatedAverageLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.GatingLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.GluLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.GradNormTracker": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.HighwaySkipLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.IdentityLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "FPropMeta"]], "lingvo.core.layers.LHUCLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.LSHMemoryRankKOneHotTaskLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "FPropMeta"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_ComputeGridLSHBucketIds"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.LSHTaskWithMultiplierLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "FPropMeta"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.LayerNorm": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "FPropMeta"], [57, 2, 1, "", "NumOutputNodes"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"], [57, 2, 1, "", "_GetScaleAndBias"]], "lingvo.core.layers.LearnablePositionalEmbeddingLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "FPropWithPosition"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"], [57, 2, 1, "", "_PosEmbeddingsFromPositions"]], "lingvo.core.layers.LocalizedLabelSmoother": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.MaskedLmDataAugmenter": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.MultitaskAdapterBaseLayer": [[57, 2, 1, "", "Params"]], "lingvo.core.layers.MultitaskAdapterEinsumLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.MultitaskAdapterLayer": [[57, 2, 1, "", "FProp"]], "lingvo.core.layers.OneHotEmbeddingLayer": [[57, 2, 1, "", "EmbLookup"], [57, 2, 1, "", "EmbLookupDefaultTheta"], [57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.PerFrameStatisticalPoolingLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "StreamingStep"]], "lingvo.core.layers.PoolingLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "OutShape"], [57, 2, 1, "", "OutputShape"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.PositionalEmbeddingLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "FPropWithPosition"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"], [57, 2, 1, "", "_PosEmbeddingsFromPositions"]], "lingvo.core.layers.ProjectionLayer": [[57, 2, 1, "", "AddGlobalVN"], [57, 2, 1, "", "FProp"], [57, 2, 1, "", "FPropFullSequence"], [57, 2, 1, "", "FPropMeta"], [57, 2, 1, "", "NumOutputNodes"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_ApplyActivationFunction"], [57, 2, 1, "", "_ApplyProjectionKernel"], [57, 2, 1, "", "_CreateLayerVariables"], [57, 2, 1, "", "_GetBlockDiagonalInitScale"], [57, 2, 1, "", "_GetBlockedMatMulInputOutputMultipliers"], [57, 2, 1, "", "_GetBlockedWeightMatrix"], [57, 2, 1, "", "_GetWeights"], [57, 2, 1, "", "_child_variable_scope_override"], [57, 3, 1, "", "_is_bn_folded"], [57, 3, 1, "", "output_qact_name"]], "lingvo.core.layers.RelativePositionalEmbeddingLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.ReshapedLayerNorm": [[57, 2, 1, "", "FProp"]], "lingvo.core.layers.ResidualAdapterLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.RotaryPositionalEmbeddingLayer": [[57, 2, 1, "", "ExtendStep"], [57, 2, 1, "", "FProp"]], "lingvo.core.layers.Scones": [[57, 2, 1, "", "Params"], [57, 2, 1, "", "XentLossFromLogits"]], "lingvo.core.layers.SeparableConv2DLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "OutShape"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.SharedSoftmaxLayer": [[57, 2, 1, "", "EmbLookup"], [57, 2, 1, "", "FProp"], [57, 2, 1, "", "Logits"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "SimpleLogits"], [57, 2, 1, "", "XentLossFromLogits"], [57, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.layers.SimpleEmbeddingLayer": [[57, 2, 1, "", "AddGlobalVN"], [57, 2, 1, "", "EmbLookup"], [57, 2, 1, "", "EmbLookupDefaultTheta"], [57, 2, 1, "", "EmbLookupDefaultThetaOnCpu"], [57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"], [57, 2, 1, "", "_FlatFProp"], [57, 2, 1, "", "_FpropImpl"], [57, 2, 1, "", "_GetWeightShape"]], "lingvo.core.layers.SimpleFullSigmoidCrossEntropy": [[57, 2, 1, "", "Params"], [57, 2, 1, "", "XentLossFromLogits"], [57, 2, 1, "", "_FProp2D"]], "lingvo.core.layers.SimpleFullSoftmax": [[57, 2, 1, "", "AddGlobalVN"], [57, 2, 1, "", "DenseWeights"], [57, 2, 1, "", "Logits"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "SimpleLogits"], [57, 2, 1, "", "XentLossFromLogits"], [57, 2, 1, "", "_CreateLayerVariables"], [57, 2, 1, "", "_FProp2D"], [57, 2, 1, "", "_GetInputs"], [57, 2, 1, "", "_LogitsUsingConcatenatedWeights"], [57, 2, 1, "", "_LogitsUsingConcatenatedWeightsHelper"], [57, 2, 1, "", "_XentLossByChunk"], [57, 3, 1, "", "wm_transposed"]], "lingvo.core.layers.SingleShardEmbeddingLayer": [[57, 2, 1, "", "AddGlobalVN"], [57, 2, 1, "", "EmbLookup"], [57, 2, 1, "", "EmbLookupDefaultTheta"], [57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.SingleShardFullSoftmax": [[57, 2, 1, "", "DenseWeights"], [57, 2, 1, "", "FProp"], [57, 2, 1, "", "Logits"], [57, 2, 1, "", "XentLossByChunk"], [57, 2, 1, "", "XentLossFromLogits"]], "lingvo.core.layers.SingleShardSharedEmbeddingSoftmax": [[57, 2, 1, "", "EmbLookup"], [57, 2, 1, "", "EmbLookupDefaultTheta"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.SinusoidalPositionalEmbeddingLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.SoftmaxLayer": [[57, 2, 1, "", "DenseWeights"], [57, 2, 1, "", "FProp"], [57, 2, 1, "", "Logits"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "XentLoss"], [57, 2, 1, "", "XentLossFromLogits"], [57, 2, 1, "", "_FProp2D"], [57, 3, 1, "", "wm_transposed"]], "lingvo.core.layers.StackingOverTime": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "Unstack"], [57, 2, 1, "", "WindowSize"], [57, 2, 1, "", "_ApplyStack"], [57, 3, 1, "", "window_size"]], "lingvo.core.layers.StatisticalPoolingLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.UniformLabelSmoother": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"]], "lingvo.core.layers.WeightedSumLayer": [[57, 2, 1, "", "FProp"], [57, 2, 1, "", "Params"], [57, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers_with_attention": [[58, 1, 1, "", "CCTAttentionLayer"], [58, 1, 1, "", "CCTFeedForwardLayer"], [58, 1, 1, "", "EvolvedTransformerBaseLayer"], [58, 1, 1, "", "EvolvedTransformerDecoderBranchedConvsLayer"], [58, 1, 1, "", "EvolvedTransformerDecoderLayer"], [58, 1, 1, "", "EvolvedTransformerEncoderBranchedConvsLayer"], [58, 1, 1, "", "EvolvedTransformerEncoderLayer"], [58, 1, 1, "", "HybridFeedforwardLayer"], [58, 1, 1, "", "MoEFeedforwardLayer"], [58, 1, 1, "", "ReshapedTransformerFeedForwardLayer"], [58, 1, 1, "", "SelfAttentiveLayer"], [58, 1, 1, "", "StochasticResidualLayer"], [58, 1, 1, "", "StyleLayer"], [58, 1, 1, "", "TransformerAttentionLayer"], [58, 1, 1, "", "TransformerFeedForwardLayer"], [58, 1, 1, "", "TransformerLayer"], [58, 1, 1, "", "TransformerLayerWithMultitaskAdapters"], [58, 1, 1, "", "TransformerMultiSourceAttentionLayer"], [58, 1, 1, "", "TransformerShardedMoeLayer"], [58, 1, 1, "", "TransformerWithContextLayer"]], "lingvo.core.layers_with_attention.CCTAttentionLayer": [[58, 2, 1, "", "ExtendStep"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_FinishExtendStep"]], "lingvo.core.layers_with_attention.CCTFeedForwardLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.EvolvedTransformerBaseLayer": [[58, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.EvolvedTransformerDecoderBranchedConvsLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.EvolvedTransformerDecoderLayer": [[58, 2, 1, "", "ExtendStep"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.EvolvedTransformerEncoderBranchedConvsLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.EvolvedTransformerEncoderLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.HybridFeedforwardLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 3, 1, "", "sub_key"]], "lingvo.core.layers_with_attention.MoEFeedforwardLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.ReshapedTransformerFeedForwardLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.SelfAttentiveLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.StochasticResidualLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "FPropMeta"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_DropConnect"]], "lingvo.core.layers_with_attention.StyleLayer": [[58, 2, 1, "", "EmbLookup"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "StyleEmbFromProbs"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers_with_attention.TransformerAttentionLayer": [[58, 2, 1, "", "ExtendStep"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_FinishExtendStep"], [58, 2, 1, "", "_GetSourceLength"], [58, 2, 1, "", "_InitAttention"]], "lingvo.core.layers_with_attention.TransformerFeedForwardLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "NumOutputNodes"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "SetFPropDtype"], [58, 3, 1, "", "output_dim"]], "lingvo.core.layers_with_attention.TransformerLayer": [[58, 2, 1, "", "ExtendStep"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "NumOutputNodes"], [58, 2, 1, "", "Params"], [58, 3, 1, "", "output_dim"]], "lingvo.core.layers_with_attention.TransformerLayerWithMultitaskAdapters": [[58, 2, 1, "", "ExtendStep"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.TransformerMultiSourceAttentionLayer": [[58, 2, 1, "", "Params"], [58, 2, 1, "", "_GetSourceLength"], [58, 2, 1, "", "_InitAttention"]], "lingvo.core.layers_with_attention.TransformerShardedMoeLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "SetFPropDtype"], [58, 3, 1, "", "output_dim"]], "lingvo.core.layers_with_attention.TransformerWithContextLayer": [[58, 2, 1, "", "ExtendStep"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers_with_gpipe": [[59, 1, 1, "", "DeterministicWeightsLayer"], [59, 1, 1, "", "GPipeBatchMajorTransformerEmbeddingLayer"], [59, 1, 1, "", "GPipeBatchMajorTransformerSoftmaxLayer"], [59, 1, 1, "", "GPipeBatchMajorTransformerStack"], [59, 1, 1, "", "GPipeEvolvedTransformerDecoderLayer"], [59, 1, 1, "", "GPipeEvolvedTransformerEncoderLayer"], [59, 1, 1, "", "GPipeEvolvedTransformerStack"], [59, 1, 1, "", "GPipeTransformerEmbeddingLayer"], [59, 1, 1, "", "GPipeTransformerLayer"], [59, 1, 1, "", "GPipeTransformerSoftmaxLayer"], [59, 1, 1, "", "GPipeTransformerStack"], [59, 6, 1, "", "_common_gpipe_transformer_decoder_fprop"], [59, 6, 1, "", "_common_gpipe_transformer_encoder_fprop"], [59, 6, 1, "", "_common_gpipe_transformer_fprop_meta"], [59, 6, 1, "", "_common_gpipe_transformer_init"], [59, 6, 1, "", "_common_gpipe_transformer_params"]], "lingvo.core.layers_with_gpipe.DeterministicWeightsLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"], [59, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers_with_gpipe.GPipeBatchMajorTransformerEmbeddingLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "FPropMeta"], [59, 2, 1, "", "GetDecoderEmbeddingsDefaultTheta"], [59, 2, 1, "", "GetEmbeddings"], [59, 2, 1, "", "GetEncoderEmbeddingsDefaultTheta"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_gpipe.GPipeBatchMajorTransformerSoftmaxLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "FPropMeta"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_gpipe.GPipeBatchMajorTransformerStack": [[59, 2, 1, "", "DecoderEmbedFPropDefaultTheta"], [59, 2, 1, "", "EncoderEmbedFPropDefaultTheta"], [59, 2, 1, "", "EncoderFPropDefaultTheta"], [59, 2, 1, "", "FProp"], [59, 2, 1, "", "GetDecoders"], [59, 2, 1, "", "GetEncoders"], [59, 2, 1, "", "Logits"], [59, 2, 1, "", "Params"], [59, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.layers_with_gpipe.GPipeEvolvedTransformerDecoderLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "FPropMeta"], [59, 2, 1, "", "Params"], [59, 2, 1, "", "SetupDeterministicDropout"], [59, 2, 1, "", "_AttentionSetupDeterministicDropout"], [59, 2, 1, "", "_TransformerSetupDeterministicDropout"]], "lingvo.core.layers_with_gpipe.GPipeEvolvedTransformerEncoderLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "FPropMeta"], [59, 2, 1, "", "Params"], [59, 2, 1, "", "SetupDeterministicDropout"], [59, 2, 1, "", "_AttentionSetupDeterministicDropout"], [59, 2, 1, "", "_TransformerSetupDeterministicDropout"]], "lingvo.core.layers_with_gpipe.GPipeEvolvedTransformerStack": [[59, 2, 1, "", "Params"]], "lingvo.core.layers_with_gpipe.GPipeTransformerEmbeddingLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "FPropMeta"], [59, 2, 1, "", "GetDecoderEmbeddingsDefaultTheta"], [59, 2, 1, "", "GetEmbeddings"], [59, 2, 1, "", "GetEncoderEmbeddingsDefaultTheta"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_gpipe.GPipeTransformerLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "FPropMeta"], [59, 2, 1, "", "Params"], [59, 2, 1, "", "SetupDeterministicDropout"]], "lingvo.core.layers_with_gpipe.GPipeTransformerSoftmaxLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "FPropMeta"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_gpipe.GPipeTransformerStack": [[59, 2, 1, "", "DecoderEmbedFPropDefaultTheta"], [59, 2, 1, "", "EncoderEmbedFPropDefaultTheta"], [59, 2, 1, "", "EncoderFPropDefaultTheta"], [59, 2, 1, "", "FProp"], [59, 2, 1, "", "GetDecoders"], [59, 2, 1, "", "GetEncoders"], [59, 2, 1, "", "Logits"], [59, 2, 1, "", "Params"], [59, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.learner": [[60, 6, 1, "", "ExtractLearnerFromLegacyParams"], [60, 1, 1, "", "Learner"]], "lingvo.core.learner.Learner": [[60, 2, 1, "", "AdjustGradients"], [60, 2, 1, "", "Apply"], [60, 2, 1, "", "ApplyPostTrainingLoop"], [60, 2, 1, "", "ComputeLosses"], [60, 2, 1, "", "GetTrainableVariables"], [60, 2, 1, "", "GetVarGrads"], [60, 2, 1, "", "LearningRate"], [60, 2, 1, "", "Params"], [60, 2, 1, "", "ScaleGradients"], [60, 2, 1, "", "_AddEvalMetric"], [60, 2, 1, "", "_ComputeLossesAndGradients"], [60, 2, 1, "", "_CustomComputeGradientsFn"], [60, 2, 1, "", "_GetGlobalGradScale"], [60, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.lstm_frnn_layer": [[61, 1, 1, "", "LSTMCellExt"], [61, 1, 1, "", "LSTMCellSimpleExt"], [61, 1, 1, "", "LayerNormalizedLSTMCellLeanExt"], [61, 1, 1, "", "LayerNormalizedLSTMCellSimpleExt"], [61, 1, 1, "", "LstmFRNN"]], "lingvo.core.lstm_frnn_layer.LSTMCellExt": [[61, 2, 1, "", "FPropWithProjectedInput"], [61, 2, 1, "", "ProjectInputSequence"], [61, 2, 1, "", "_MixWithProjectedInput"]], "lingvo.core.lstm_frnn_layer.LstmFRNN": [[61, 2, 1, "", "FProp"], [61, 2, 1, "", "Params"], [61, 2, 1, "", "zero_state"]], "lingvo.core.matrix_functions": [[62, 6, 1, "", "inlined_matrix_inverse_pth_root"], [62, 6, 1, "", "matrix_square_root"]], "lingvo.core.metrics": [[63, 1, 1, "", "AUCMetric"], [63, 1, 1, "", "AverageKeyedCorrelationMetric"], [63, 1, 1, "", "AverageMetric"], [63, 1, 1, "", "BaseMetric"], [63, 1, 1, "", "ConfigurableMetric"], [63, 1, 1, "", "CorpusBleuMetric"], [63, 1, 1, "", "CorrelationMetric"], [63, 6, 1, "", "CreateScalarSummary"], [63, 1, 1, "", "F1Metric"], [63, 1, 1, "", "MCCMetric"], [63, 1, 1, "", "MultiClassAUCMetric"], [63, 1, 1, "", "PrecisionAtRecall"], [63, 1, 1, "", "RecallAtPrecision"], [63, 1, 1, "", "SamplingMetric"], [63, 1, 1, "", "TpuEvalMetrics"], [63, 1, 1, "", "UniqueAverageMetric"]], "lingvo.core.metrics.AUCMetric": [[63, 2, 1, "", "Summary"], [63, 2, 1, "", "Update"], [63, 2, 1, "", "_PrecisionAtRecall"], [63, 2, 1, "", "_RecallAtPrecision"], [63, 3, 1, "", "value"]], "lingvo.core.metrics.AverageKeyedCorrelationMetric": [[63, 2, 1, "", "Update"], [63, 3, 1, "", "value"]], "lingvo.core.metrics.AverageMetric": [[63, 2, 1, "", "GetTotalValue"], [63, 2, 1, "", "GetTotalWeight"], [63, 2, 1, "", "SetTotalValue"], [63, 2, 1, "", "SetTotalWeight"], [63, 2, 1, "", "Update"], [63, 3, 1, "", "total_value"], [63, 3, 1, "", "total_weight"], [63, 3, 1, "", "value"]], "lingvo.core.metrics.BaseMetric": [[63, 2, 1, "", "Summary"], [63, 2, 1, "", "Update"], [63, 3, 1, "", "value"]], "lingvo.core.metrics.ConfigurableMetric": [[63, 2, 1, "", "Params"]], "lingvo.core.metrics.CorpusBleuMetric": [[63, 2, 1, "", "Update"], [63, 3, 1, "", "unsegmenter"], [63, 3, 1, "", "value"]], "lingvo.core.metrics.CorrelationMetric": [[63, 2, 1, "", "Update"], [63, 3, 1, "", "value"]], "lingvo.core.metrics.F1Metric": [[63, 2, 1, "", "UpdateFalseNegative"], [63, 2, 1, "", "UpdateFalsePositive"], [63, 2, 1, "", "UpdateTruePositive"], [63, 3, 1, "", "value"]], "lingvo.core.metrics.MCCMetric": [[63, 2, 1, "", "UpdateTrueNegative"], [63, 3, 1, "", "value"]], "lingvo.core.metrics.MultiClassAUCMetric": [[63, 2, 1, "", "Update"], [63, 3, 1, "", "value"]], "lingvo.core.metrics.PrecisionAtRecall": [[63, 3, 1, "", "value"]], "lingvo.core.metrics.RecallAtPrecision": [[63, 3, 1, "", "value"]], "lingvo.core.metrics.SamplingMetric": [[63, 2, 1, "", "Params"], [63, 2, 1, "", "Summary"], [63, 2, 1, "", "Update"], [63, 2, 1, "", "_CreateSummary"], [63, 3, 1, "", "samples"]], "lingvo.core.metrics.TpuEvalMetrics": [[63, 2, 1, "", "FinalizeMetrics"], [63, 2, 1, "", "PackMetricsValues"], [63, 2, 1, "", "SetMetrics"], [63, 2, 1, "", "ToAverageMetric"], [63, 2, 1, "", "ToAverageMetrics"], [63, 2, 1, "", "_Zip"], [63, 3, 1, "", "initial_values"], [63, 3, 1, "", "metrics"]], "lingvo.core.metrics.UniqueAverageMetric": [[63, 2, 1, "", "Summary"], [63, 2, 1, "", "Update"], [63, 3, 1, "", "value"]], "lingvo.core.ml_perf_bleu_metric": [[64, 1, 1, "", "MlPerfBleuMetric"], [64, 1, 1, "", "UnicodeRegex"], [64, 6, 1, "", "_get_ngrams"], [64, 6, 1, "", "bleu_score"], [64, 6, 1, "", "bleu_tokenize"], [64, 6, 1, "", "bleu_wrapper"], [64, 6, 1, "", "compute_bleu"], [64, 6, 1, "", "is_unicode"], [64, 6, 1, "", "native_to_unicode"], [64, 6, 1, "", "to_unicode"]], "lingvo.core.ml_perf_bleu_metric.MlPerfBleuMetric": [[64, 2, 1, "", "Update"], [64, 3, 1, "", "value"]], "lingvo.core.ml_perf_bleu_metric.UnicodeRegex": [[64, 2, 1, "", "property_chars"]], "lingvo.core.ml_perf_log": [[65, 6, 1, "", "get_caller"], [65, 6, 1, "", "mlperf_format"], [65, 6, 1, "", "mlperf_print"]], "lingvo.core.ml_perf_tokenizer": [[66, 1, 1, "", "MlPerfTokenizer"]], "lingvo.core.ml_perf_tokenizer.MlPerfTokenizer": [[66, 2, 1, "", "IdsToStrings"], [66, 2, 1, "", "Params"]], "lingvo.core.model_helper": [[67, 6, 1, "", "CreateBidirectionalRNNParams"], [67, 6, 1, "", "CreateUnidirectionalRNNParams"]], "lingvo.core.multitask_model": [[68, 1, 1, "", "RegExSharedVariableModel"], [68, 1, 1, "", "SharedEncoderDecoderModel"], [68, 1, 1, "", "SharedEncoderModel"]], "lingvo.core.multitask_model.RegExSharedVariableModel": [[68, 2, 1, "", "ConstructFPropBPropGraph"], [68, 2, 1, "", "Params"]], "lingvo.core.multitask_model.SharedEncoderDecoderModel": [[68, 2, 1, "", "Params"]], "lingvo.core.multitask_model.SharedEncoderModel": [[68, 2, 1, "", "Params"]], "lingvo.core.nested_map": [[69, 1, 1, "", "NestedMap"], [69, 6, 1, "", "_FromNestedDict"]], "lingvo.core.nested_map.NestedMap": [[69, 2, 1, "", "CheckKey"], [69, 2, 1, "", "DebugString"], [69, 2, 1, "", "DeepCopy"], [69, 2, 1, "", "Filter"], [69, 2, 1, "", "FilterKeyVal"], [69, 2, 1, "", "Flatten"], [69, 2, 1, "", "FlattenItems"], [69, 2, 1, "", "FromNestedDict"], [69, 2, 1, "", "Get"], [69, 2, 1, "", "GetItem"], [69, 2, 1, "", "IsCompatible"], [69, 2, 1, "", "Pack"], [69, 2, 1, "", "Set"], [69, 2, 1, "", "SquareBracketIndex"], [69, 2, 1, "", "ToNestedDict"], [69, 2, 1, "", "Transform"], [69, 2, 1, "", "TransformWithKey"], [69, 2, 1, "", "VLog"], [69, 5, 1, "", "_DELETE"], [69, 5, 1, "", "_HAS_DYNAMIC_ATTRIBUTES"], [69, 5, 1, "", "_RESERVED_KEYS"], [69, 2, 1, "", "_RecursiveMap"], [69, 2, 1, "", "_ToStrings"], [69, 2, 1, "", "copy"]], "lingvo.core.ops": [[70, 6, 1, "", "apply_packing"], [70, 6, 1, "", "ascii_to_token_id"], [70, 6, 1, "", "assert_same_dim0"], [70, 6, 1, "", "assert_shape_match"], [70, 6, 1, "", "beam_search_step"], [70, 6, 1, "", "beam_search_step_deprecated"], [70, 6, 1, "", "best_step"], [70, 6, 1, "", "bpe_ids_to_words"], [70, 6, 1, "", "bpe_words_to_ids"], [70, 6, 1, "", "cached_call"], [70, 6, 1, "", "compute_preconditioners"], [70, 6, 1, "", "get_preconditioners"], [70, 6, 1, "", "hyps_from_beam_search_outs"], [71, 0, 0, "-", "hyps_pb2"], [70, 6, 1, "", "id_to_ascii"], [70, 6, 1, "", "mass"], [70, 6, 1, "", "ml_perf_subword_id_to_string"], [70, 6, 1, "", "ngram_id_to_token"], [70, 6, 1, "", "pack_sequences"], [70, 6, 1, "", "pack_single_sequence"], [70, 6, 1, "", "random_permutation_sequence"], [72, 0, 0, "-", "record_pb2"], [70, 6, 1, "", "static_map_int_int"], [70, 6, 1, "", "static_map_int_string"], [70, 6, 1, "", "static_map_string_int"], [70, 6, 1, "", "str_to_vocab_tokens"], [70, 6, 1, "", "token_in_vocab"], [70, 6, 1, "", "top_k_from_beam_search_outs"], [70, 6, 1, "", "top_k_terminated_hyps"], [70, 6, 1, "", "unpack_hyp"], [73, 0, 0, "-", "versioned_file_set_pb2"], [70, 6, 1, "", "vocab_id_to_token"], [70, 6, 1, "", "vocab_token_to_id"]], "lingvo.core.ops.hyps_pb2": [[71, 1, 1, "", "Hypothesis"], [71, 6, 1, "", "_b"]], "lingvo.core.ops.hyps_pb2.Hypothesis": [[71, 1, 1, "", "AttenVec"], [71, 5, 1, "", "DESCRIPTOR"], [71, 5, 1, "", "atten_vecs"], [71, 5, 1, "", "beam_id"], [71, 5, 1, "", "ids"], [71, 5, 1, "", "normalized_score"], [71, 5, 1, "", "scores"]], "lingvo.core.ops.hyps_pb2.Hypothesis.AttenVec": [[71, 5, 1, "", "DESCRIPTOR"], [71, 5, 1, "", "prob"]], "lingvo.core.ops.record_pb2": [[72, 1, 1, "", "Record"], [72, 6, 1, "", "_b"]], "lingvo.core.ops.record_pb2.Record": [[72, 5, 1, "", "DESCRIPTOR"], [72, 1, 1, "", "FieldsEntry"], [72, 5, 1, "", "fields"]], "lingvo.core.ops.record_pb2.Record.FieldsEntry": [[72, 5, 1, "", "DESCRIPTOR"], [72, 5, 1, "", "key"], [72, 5, 1, "", "value"]], "lingvo.core.ops.versioned_file_set_pb2": [[73, 1, 1, "", "FileSet"], [73, 1, 1, "", "VersionedFileSet"], [73, 6, 1, "", "_b"]], "lingvo.core.ops.versioned_file_set_pb2.FileSet": [[73, 5, 1, "", "DESCRIPTOR"], [73, 5, 1, "", "create_timestamp"], [73, 5, 1, "", "file_pattern"]], "lingvo.core.ops.versioned_file_set_pb2.VersionedFileSet": [[73, 5, 1, "", "DESCRIPTOR"], [73, 5, 1, "", "current"], [73, 5, 1, "", "history"]], "lingvo.core.optimizer": [[75, 1, 1, "", "Accumulator"], [75, 1, 1, "", "AdaDelta"], [75, 1, 1, "", "AdaGraft"], [75, 1, 1, "", "Adagrad"], [75, 1, 1, "", "Adam"], [75, 1, 1, "", "AdamV2"], [75, 1, 1, "", "Base"], [75, 1, 1, "", "CompositeOptimizer"], [75, 1, 1, "", "DistributedShampoo"], [75, 1, 1, "", "DynamicAccumulator"], [75, 6, 1, "", "GetLrValue"], [75, 1, 1, "", "GradientAggregationOptimizer"], [75, 1, 1, "", "Momentum"], [75, 1, 1, "", "RMSProp"], [75, 1, 1, "", "SGD"], [75, 1, 1, "", "XLAShardingAdafactor"], [75, 1, 1, "", "XLAShardingAdafactorAccuGrad"], [75, 1, 1, "", "XLAShardingAdafactorOptimizer"], [75, 6, 1, "", "_AdafactorDecayRateAdam"], [75, 6, 1, "", "_AdafactorDecayRatePow"], [75, 6, 1, "", "_StepNum"]], "lingvo.core.optimizer.Accumulator": [[75, 2, 1, "", "AddSummary"], [75, 2, 1, "", "Apply"], [75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"]], "lingvo.core.optimizer.AdaDelta": [[75, 2, 1, "", "AddSummary"], [75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"]], "lingvo.core.optimizer.AdaGraft": [[75, 2, 1, "", "AddSummary"], [75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"]], "lingvo.core.optimizer.Adagrad": [[75, 2, 1, "", "AddSummary"], [75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"]], "lingvo.core.optimizer.Adam": [[75, 2, 1, "", "AddSummary"], [75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"], [75, 2, 1, "", "ParamsA"], [75, 2, 1, "", "ParamsB"]], "lingvo.core.optimizer.AdamV2": [[75, 2, 1, "", "AddSummary"], [75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"], [75, 2, 1, "", "ParamsA"], [75, 2, 1, "", "ParamsB"]], "lingvo.core.optimizer.Base": [[75, 2, 1, "", "AddSummary"], [75, 2, 1, "", "Apply"], [75, 2, 1, "", "ApplyPostTrainingLoop"], [75, 2, 1, "", "ComputeGradients"], [75, 2, 1, "", "GetLrScheduleValue"], [75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"], [75, 2, 1, "", "VarReuseForSlotVars"], [75, 2, 1, "", "_GetSelfVariablesDict"]], "lingvo.core.optimizer.CompositeOptimizer": [[75, 2, 1, "", "Apply"], [75, 2, 1, "", "ApplyPostTrainingLoop"], [75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"]], "lingvo.core.optimizer.DistributedShampoo": [[75, 2, 1, "", "AddSummary"], [75, 2, 1, "", "Apply"], [75, 2, 1, "", "ApplyPostTrainingLoop"], [75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"]], "lingvo.core.optimizer.DynamicAccumulator": [[75, 2, 1, "", "AddSummary"], [75, 2, 1, "", "Apply"], [75, 2, 1, "", "GetLrScheduleValue"], [75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"]], "lingvo.core.optimizer.GradientAggregationOptimizer": [[75, 2, 1, "", "_create_slots"], [75, 2, 1, "", "apply_gradients"], [75, 2, 1, "", "compute_gradients"], [75, 2, 1, "", "get_slot"], [75, 2, 1, "", "get_slot_names"], [75, 2, 1, "", "variables"]], "lingvo.core.optimizer.Momentum": [[75, 2, 1, "", "AddSummary"], [75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"]], "lingvo.core.optimizer.RMSProp": [[75, 2, 1, "", "AddSummary"], [75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"]], "lingvo.core.optimizer.SGD": [[75, 2, 1, "", "AddSummary"], [75, 2, 1, "", "GetOptimizer"]], "lingvo.core.optimizer.XLAShardingAdafactor": [[75, 2, 1, "", "AddSummary"], [75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"]], "lingvo.core.optimizer.XLAShardingAdafactorAccuGrad": [[75, 2, 1, "", "GetOptimizer"], [75, 2, 1, "", "Params"]], "lingvo.core.optimizer.XLAShardingAdafactorOptimizer": [[75, 2, 1, "", "_apply_dense"], [75, 2, 1, "", "_create_slots"], [75, 2, 1, "", "_factored_dims"], [75, 2, 1, "", "_parameter_scale"], [75, 2, 1, "", "_resource_apply_dense"], [75, 2, 1, "", "_resource_apply_sparse"], [75, 2, 1, "", "try_apply_dense"]], "lingvo.core.plot": [[76, 6, 1, "", "AddImage"], [76, 6, 1, "", "AddMultiCurveSubplot"], [76, 6, 1, "", "AddPlot"], [76, 6, 1, "", "AddScatterPlot"], [76, 6, 1, "", "Curve"], [76, 6, 1, "", "FigureToSummary"], [76, 6, 1, "", "Image"], [76, 1, 1, "", "MatplotlibFigureSummary"], [76, 6, 1, "", "Matrix"], [76, 6, 1, "", "Scatter"], [76, 6, 1, "", "ToUnicode"], [76, 6, 1, "", "_AddMultiCurveRowPlots"], [76, 6, 1, "", "_RenderMatplotlibFigures"], [76, 6, 1, "", "_RenderOneMatplotlibFigure"], [76, 1, 1, "", "_SubplotMetadata"]], "lingvo.core.plot.MatplotlibFigureSummary": [[76, 2, 1, "", "AddSubplot"], [76, 2, 1, "", "Finalize"], [76, 2, 1, "", "FinalizeImage"]], "lingvo.core.plot._SubplotMetadata": [[76, 2, 1, "", "_asdict"], [76, 5, 1, "", "_field_defaults"], [76, 5, 1, "", "_fields"], [76, 2, 1, "", "_make"], [76, 2, 1, "", "_replace"], [76, 5, 1, "", "plot_func"], [76, 5, 1, "", "tensor_list"]], "lingvo.core.predictor": [[77, 6, 1, "", "LoadInferenceGraph"], [77, 1, 1, "", "Predictor"], [77, 6, 1, "", "main"]], "lingvo.core.predictor.Predictor": [[77, 2, 1, "", "Load"], [77, 2, 1, "", "Run"], [77, 2, 1, "", "_LoadCheckpoint"], [77, 2, 1, "", "_create_new_session"], [77, 2, 1, "", "_get_subgraph"], [77, 2, 1, "", "_get_subgraph_feeds"], [77, 2, 1, "", "_get_subgraph_fetches"], [77, 2, 1, "", "_load_graph_from_inference_graph"], [77, 2, 1, "", "_maybe_create_new_session"], [77, 2, 1, "", "_run_with_valid_session"], [77, 3, 1, "", "feed_keys"], [77, 3, 1, "", "feed_shapes"], [77, 3, 1, "", "fetch_keys"], [77, 3, 1, "", "fetch_shapes"], [77, 2, 1, "", "subgraph_feed_keys"], [77, 2, 1, "", "subgraph_feed_shapes"], [77, 2, 1, "", "subgraph_fetch_keys"], [77, 2, 1, "", "subgraph_fetch_shapes"], [77, 3, 1, "", "subgraphs"]], "lingvo.core.predictor_runner_base": [[78, 1, 1, "", "PredictorRunnerBase"]], "lingvo.core.predictor_runner_base.PredictorRunnerBase": [[78, 2, 1, "", "FromFlags"], [78, 2, 1, "", "InputGenerator"], [78, 2, 1, "", "Run"], [78, 2, 1, "", "RunBatch"], [78, 2, 1, "", "_OutputFilename"], [78, 2, 1, "", "_PredictContinuously"], [78, 2, 1, "", "_PredictOneCheckpoint"], [78, 2, 1, "", "_ShouldProcessInputId"]], "lingvo.core.program": [[79, 1, 1, "", "BaseProgram"], [79, 1, 1, "", "DecodeProgram"], [79, 1, 1, "", "EvalProgram"], [79, 1, 1, "", "ExperimentalDecodeProgram"], [79, 1, 1, "", "InputBenchmark"], [79, 1, 1, "", "MLPerfProgramSchedule"], [79, 6, 1, "", "MLPerfProgramScheduleForTask"], [79, 1, 1, "", "MLPerfTrainDecodeProgram"], [79, 1, 1, "", "MultiInputsDecodeProgram"], [79, 1, 1, "", "MultiTaskProgramSchedule"], [79, 1, 1, "", "SimpleProgramSchedule"], [79, 6, 1, "", "SimpleProgramScheduleForTask"], [79, 1, 1, "", "TrainProgram"], [79, 6, 1, "", "UpdateProgramSchedule"], [79, 6, 1, "", "_CheckLengthOrExpand"], [79, 6, 1, "", "_ClearSpecifiedProgram"], [79, 6, 1, "", "_CreateProgramParams"], [79, 6, 1, "", "_FetchDecodeOut"], [79, 6, 1, "", "_InferStepsPerLoop"], [79, 6, 1, "", "_UpdateCpuPassThroughData"]], "lingvo.core.program.BaseProgram": [[79, 2, 1, "", "BuildTpuSubgraph"], [79, 2, 1, "", "Compile"], [79, 2, 1, "", "GetModel"], [79, 2, 1, "", "InitInputs"], [79, 2, 1, "", "LoadProgramState"], [79, 2, 1, "", "Params"], [79, 2, 1, "", "Run"], [79, 2, 1, "", "SaveProgramState"], [79, 2, 1, "", "SetStatusMessage"], [79, 2, 1, "", "SetStatusMessageFn"], [79, 2, 1, "", "Shutdown"], [79, 2, 1, "", "_InfeedLoop"], [79, 2, 1, "", "_InfeedLoopForInput"], [79, 2, 1, "", "_InitializeVizier"], [79, 2, 1, "", "_InstantiateTaskModel"], [79, 2, 1, "", "_OutfeedEnqueue"], [79, 2, 1, "", "_ReportVizierMetrics"], [79, 2, 1, "", "_SetProgramDir"], [79, 2, 1, "", "_SummarizeValue"], [79, 2, 1, "", "_WriteInputDataStats"], [79, 2, 1, "", "_WriteSummaries"], [79, 3, 1, "", "_summary_writer"]], "lingvo.core.program.DecodeProgram": [[79, 2, 1, "", "BuildTpuSubgraph"], [79, 2, 1, "", "DecodeFunc"], [79, 2, 1, "", "FinalizeCallback"], [79, 2, 1, "", "InfeedTFFunc"], [79, 2, 1, "", "Params"], [79, 2, 1, "", "Run"], [79, 2, 1, "", "RunForInput"], [79, 2, 1, "", "Summary"], [79, 2, 1, "", "_DatasetSummaryWriter"], [79, 2, 1, "", "_DecodeStep"], [79, 2, 1, "", "_DecodeUntilOutOfRangeInfeedLoop"], [79, 2, 1, "", "_FinalizeDecode"], [79, 2, 1, "", "_PostProcessStep"], [79, 2, 1, "", "_RunPostProcess"], [79, 2, 1, "", "_WriteInputDataStats"], [79, 2, 1, "", "_WriteSummaries"]], "lingvo.core.program.EvalProgram": [[79, 2, 1, "", "BuildTpuSubgraph"], [79, 2, 1, "", "EvalFunc"], [79, 2, 1, "", "InfeedTFFunc"], [79, 2, 1, "", "Run"], [79, 2, 1, "", "TpuEvalStep"]], "lingvo.core.program.ExperimentalDecodeProgram": [[79, 2, 1, "", "BuildTpuSubgraph"], [79, 2, 1, "", "DecodeFunc"], [79, 2, 1, "", "FinalizeCallback"], [79, 2, 1, "", "Params"], [79, 2, 1, "", "Run"], [79, 2, 1, "", "Summary"], [79, 2, 1, "", "WaitThread"], [79, 2, 1, "", "_DecodeLoop"], [79, 2, 1, "", "_OutfeedDequeue"], [79, 2, 1, "", "_PostProcess"], [79, 2, 1, "", "_ThreadCall"]], "lingvo.core.program.InputBenchmark": [[79, 2, 1, "", "BuildTpuSubgraph"], [79, 2, 1, "", "Params"], [79, 2, 1, "", "Run"]], "lingvo.core.program.MLPerfProgramSchedule": [[79, 2, 1, "", "Params"], [79, 2, 1, "", "Programs"], [79, 2, 1, "", "Run"], [79, 2, 1, "", "Shutdown"]], "lingvo.core.program.MLPerfTrainDecodeProgram": [[79, 2, 1, "", "BuildTpuSubgraph"], [79, 2, 1, "", "Params"], [79, 2, 1, "", "Run"], [79, 2, 1, "", "_InfeedLoop"], [79, 2, 1, "", "_InitializeVizier"], [79, 2, 1, "", "_TrainAndDecode"]], "lingvo.core.program.MultiInputsDecodeProgram": [[79, 2, 1, "", "BuildTpuSubgraph"], [79, 2, 1, "", "FinalizeCallback"], [79, 2, 1, "", "InitInputs"], [79, 2, 1, "", "Params"], [79, 2, 1, "", "Run"], [79, 2, 1, "", "_DatasetSummaryWriter"], [79, 2, 1, "", "_SetProgramDir"]], "lingvo.core.program.MultiTaskProgramSchedule": [[79, 2, 1, "", "Params"]], "lingvo.core.program.SimpleProgramSchedule": [[79, 2, 1, "", "Params"], [79, 2, 1, "", "Programs"], [79, 2, 1, "", "Run"], [79, 2, 1, "", "Shutdown"]], "lingvo.core.program.TrainProgram": [[79, 2, 1, "", "BuildTpuSubgraph"], [79, 2, 1, "", "InfeedTFFunc"], [79, 2, 1, "", "Params"], [79, 2, 1, "", "Run"], [79, 2, 1, "", "TpuTrainStep"], [79, 2, 1, "", "_OutfeedDequeueLoop"], [79, 2, 1, "", "_ShouldStop"], [79, 2, 1, "", "_ShouldWriteSummary"]], "lingvo.core.program_utils": [[80, 6, 1, "", "CsvToSummary"], [80, 1, 1, "", "DecodeStatusCache"], [80, 6, 1, "", "SummaryToCsv"]], "lingvo.core.program_utils.DecodeStatusCache": [[80, 2, 1, "", "TryLoadCache"], [80, 2, 1, "", "UpdateCkpt"], [80, 2, 1, "", "UpdateDataset"]], "lingvo.core.pruning_utils": [[81, 6, 1, "", "AddToPruningCollections"], [81, 6, 1, "", "ApplyCompression"], [81, 6, 1, "", "FlatEmbeddingLookup"], [81, 1, 1, "", "PruningOp"], [81, 6, 1, "", "UsePruningInterface"], [81, 6, 1, "", "_IsInCollection"]], "lingvo.core.pruning_utils.PruningOp": [[81, 2, 1, "", "ApplyPruning"], [81, 2, 1, "", "ApplyPythonUpdate"], [81, 2, 1, "", "ApplyTensorflowAndPythonUpdate"], [81, 2, 1, "", "ApplyTensorflowUpdate"], [81, 2, 1, "", "GetEmbeddingLookupResult"], [81, 2, 1, "", "GetLastCompressionOp"], [81, 2, 1, "", "GetMixResult"], [81, 2, 1, "", "GetPruningUpdate"], [81, 2, 1, "", "RunPythonUpdate"], [81, 2, 1, "", "Setup"], [81, 5, 1, "", "_global_step"], [81, 5, 1, "", "_pruning_hparams"], [81, 5, 1, "", "_pruning_hparams_dict"], [81, 5, 1, "", "_pruning_obj"]], "lingvo.core.py_utils": [[82, 6, 1, "", "AddDebugTensor"], [82, 6, 1, "", "AddSavedModelAssets"], [82, 6, 1, "", "AddTpuSummaryTensor"], [82, 6, 1, "", "AddVN"], [82, 6, 1, "", "AdjustGradientsWithLpLoss"], [82, 6, 1, "", "AppendDims"], [82, 6, 1, "", "ApplyGradMultiplier"], [82, 6, 1, "", "ApplyGradNormClipping"], [82, 6, 1, "", "ApplyPadding"], [82, 6, 1, "", "ArgMax"], [82, 6, 1, "", "Assert"], [82, 6, 1, "", "AssertIdShape"], [82, 6, 1, "", "AssertIsCompatible"], [82, 1, 1, "", "AuxLossContext"], [82, 6, 1, "", "BlockDiagonalMatmul"], [82, 6, 1, "", "BlockDiagonalMatmulWithMix"], [82, 6, 1, "", "BlockDiagonalProjectLastDim"], [82, 6, 1, "", "BlockDiagonalProjectLastDimWithMix"], [82, 6, 1, "", "CallDefun"], [82, 6, 1, "", "CausalSelfAttenPadding"], [82, 6, 1, "", "CheckNumerics"], [82, 6, 1, "", "CheckShapes"], [82, 6, 1, "", "ClearTpuDevice"], [82, 6, 1, "", "ClearTpuSummaryTensors"], [82, 6, 1, "", "CombineMetrics"], [82, 6, 1, "", "ComputationShape"], [82, 6, 1, "", "ComputeGradients"], [82, 6, 1, "", "ComputeGradientsSimple"], [82, 6, 1, "", "ComputeNceAndAuc"], [82, 6, 1, "", "ConcatPerExampleTensors"], [82, 6, 1, "", "ConcatRecursively"], [82, 6, 1, "", "ConcatenatePaddedSequences"], [82, 6, 1, "", "ConvertNoneGradientToZeros"], [82, 6, 1, "", "CreateEMAForModel"], [82, 6, 1, "", "CreateIdsAndLabels"], [82, 6, 1, "", "CreateLocalTheta"], [82, 6, 1, "", "CreateVariable"], [82, 6, 1, "", "CumSum"], [82, 6, 1, "", "Debug"], [82, 6, 1, "", "DecodeProtoField"], [82, 6, 1, "", "DecodeRepeatedProtoField"], [82, 6, 1, "", "DefaultParamInit"], [82, 6, 1, "", "DefaultRNNCellStateInit"], [82, 6, 1, "", "DefaultVN"], [82, 1, 1, "", "DefinedFunction"], [82, 6, 1, "", "DeterministicDropout"], [82, 6, 1, "", "DeterministicVN"], [82, 6, 1, "", "DisableVN"], [82, 6, 1, "", "DisableVariableNameChecking"], [82, 6, 1, "", "DivideNoNan"], [82, 6, 1, "", "Dtypes"], [82, 6, 1, "", "ExpandAndPadOrTrimTo"], [82, 6, 1, "", "ExpandTo"], [82, 6, 1, "", "FPropDtype"], [82, 6, 1, "", "FindDataType"], [82, 6, 1, "", "FindNeeded"], [82, 6, 1, "", "FindRelevantBatchNormUpdates"], [82, 6, 1, "", "Flatten"], [82, 6, 1, "", "ForLoop"], [82, 1, 1, "", "Function"], [82, 6, 1, "", "GatherTensorValuesBySeqIndices"], [82, 6, 1, "", "GenerateSeedFromId"], [82, 6, 1, "", "GenerateSeedFromName"], [82, 6, 1, "", "GenerateStepSeedPair"], [82, 6, 1, "", "GetExtraArgs"], [82, 6, 1, "", "GetExtraInputs"], [82, 6, 1, "", "GetExtraVars"], [82, 6, 1, "", "GetFanInFanOut"], [82, 6, 1, "", "GetGlobalStep"], [82, 6, 1, "", "GetGlobalVariableScope"], [82, 6, 1, "", "GetIncStepSeed"], [82, 6, 1, "", "GetLingvoVariableCreator"], [82, 6, 1, "", "GetOpportunisticVariableReuse"], [82, 6, 1, "", "GetOrCreateGlobalStepVar"], [82, 6, 1, "", "GetProcessedCheckpoints"], [82, 6, 1, "", "GetRank"], [82, 6, 1, "", "GetSavedModelAssets"], [82, 6, 1, "", "GetShape"], [82, 6, 1, "", "GetSize"], [82, 6, 1, "", "GetSoftmaxProbsBySeqIndices"], [82, 6, 1, "", "GetStepSeed"], [82, 6, 1, "", "GetTaskCallScope"], [82, 6, 1, "", "GetTpuDeviceAssignment"], [82, 6, 1, "", "GetTpuEmbeddingGraphCollection"], [82, 6, 1, "", "GetTpuSummaryTensors"], [82, 6, 1, "", "GetTrainableVariables"], [82, 6, 1, "", "GetUnitTestSession"], [82, 6, 1, "", "GetVarLeadingDimsAsCombinedLayers"], [82, 6, 1, "", "GetVariableName"], [82, 6, 1, "", "GetVariableNumLeadingDimsForCombinedLayersContext"], [82, 6, 1, "", "GetVariableShapePrefixes"], [82, 6, 1, "", "GlobalStepContext"], [82, 6, 1, "", "GradientTape"], [82, 6, 1, "", "HasAtLeastRank"], [82, 6, 1, "", "HasNanOrInf"], [82, 6, 1, "", "HasNanOrInfGradient"], [82, 6, 1, "", "HasRank"], [82, 6, 1, "", "HasSameShape"], [82, 6, 1, "", "HasShape"], [82, 6, 1, "", "If"], [82, 6, 1, "", "InitRNNCellState"], [82, 6, 1, "", "IsCompatible"], [82, 6, 1, "", "IsDefaultParamInit"], [82, 6, 1, "", "IsEagerMode"], [82, 6, 1, "", "LengthsFromPaddings"], [82, 6, 1, "", "Log"], [82, 6, 1, "", "LogMultiLines"], [82, 6, 1, "", "MaskGradients"], [82, 6, 1, "", "Matmul"], [82, 6, 1, "", "MaybeGenerateSeedFromScope"], [82, 6, 1, "", "MaybeOpportunisticVariableReuse"], [82, 6, 1, "", "MaybePinVarsToCpu"], [82, 6, 1, "", "MaybeResetStepSeed"], [82, 6, 1, "", "MaybeResetStepSeedFromScope"], [82, 6, 1, "", "MaybeReuseFromVariableStore"], [82, 6, 1, "", "MaybeSoftCapLogits"], [82, 6, 1, "", "MergeDictsWithValueCheck"], [82, 6, 1, "", "MergeDuplicateIds"], [82, 6, 1, "", "MixByWeight"], [82, 6, 1, "", "NameScopeDecorator"], [82, 6, 1, "", "OpportunisticVariableReuseScope"], [82, 6, 1, "", "OverrideVarsFromCheckpoint"], [82, 6, 1, "", "OverrideVarsFromCheckpoints"], [82, 6, 1, "", "Pack"], [82, 6, 1, "", "PadOrTrimTo"], [82, 6, 1, "", "PadSequenceDimension"], [82, 6, 1, "", "PadSequenceTo"], [82, 6, 1, "", "PaddingsFromLengths"], [82, 6, 1, "", "PiecewiseConstant"], [82, 6, 1, "", "PlaceOnTpuCore"], [82, 6, 1, "", "ProjectLastDim"], [82, 1, 1, "", "RNNCellStateInit"], [82, 6, 1, "", "ReadFileLines"], [82, 6, 1, "", "ReadOnlyAttrDictView"], [82, 6, 1, "", "ReadVariable"], [82, 6, 1, "", "RecordFormatFromFilePattern"], [82, 6, 1, "", "ReduceRms"], [82, 6, 1, "", "RematerializeFn"], [82, 6, 1, "", "RemoveAssertContext"], [82, 6, 1, "", "RepeatDim"], [82, 6, 1, "", "ResetStepSeed"], [82, 6, 1, "", "Retry"], [82, 6, 1, "", "RetryOnTransientTfError"], [82, 6, 1, "", "ReversePaddedSequence"], [82, 6, 1, "", "RunOnTpuHost"], [82, 6, 1, "", "SampleStep"], [82, 6, 1, "", "SanitizeScopeKey"], [82, 6, 1, "", "Save"], [82, 6, 1, "", "SequencePaddings"], [82, 6, 1, "", "SequencesToDebugStrings"], [82, 6, 1, "", "SessionConfig"], [82, 6, 1, "", "SetEagerMode"], [82, 6, 1, "", "SetEagerRngAdaptation"], [82, 6, 1, "", "SetShapes"], [82, 6, 1, "", "SetTpuDeviceAssignment"], [82, 6, 1, "", "ShardedFilePatternToGlob"], [82, 6, 1, "", "ShiftLeft"], [82, 6, 1, "", "SigmoidCrossEntropyFocalLoss"], [82, 6, 1, "", "SkipNoneGradients"], [82, 6, 1, "", "Softmax"], [82, 6, 1, "", "SoftmaxCrossEntropyFocalLoss"], [82, 6, 1, "", "SplitRecursively"], [82, 6, 1, "", "StackTensorsRecursively"], [82, 6, 1, "", "StatefulRandomOpsInDefun"], [82, 6, 1, "", "StepSeedIncrementContext"], [82, 6, 1, "", "SumAbs"], [82, 6, 1, "", "SumSquared"], [82, 6, 1, "", "TaskCallScope"], [82, 6, 1, "", "TaskCallScopeName"], [82, 6, 1, "", "TensorSpecs"], [82, 6, 1, "", "TfFunctionScope"], [82, 6, 1, "", "ToPlaceholders"], [82, 6, 1, "", "ToStaticShape"], [82, 6, 1, "", "ToUniqueList"], [82, 6, 1, "", "TopK"], [82, 6, 1, "", "TpuSummaryTensorContext"], [82, 6, 1, "", "Transform"], [82, 6, 1, "", "TrimTrailingPaddings"], [82, 1, 1, "", "UniformSampler"], [82, 6, 1, "", "UnitTestSessionScope"], [82, 6, 1, "", "UpdateBatchNormVars"], [82, 6, 1, "", "UpdateDtype"], [82, 6, 1, "", "UpdateFpropDtype"], [82, 6, 1, "", "UpdateProcessedCheckpoints"], [82, 1, 1, "", "VarGrad"], [82, 6, 1, "", "VariableCreatorScope"], [82, 6, 1, "", "VariableListDtypeRegexScope"], [82, 6, 1, "", "VariableRenameScope"], [82, 6, 1, "", "VariableShapePrefixContext"], [82, 6, 1, "", "VariableStore"], [82, 6, 1, "", "VariationalNoiseParams"], [82, 6, 1, "", "WarnOnGlobalStepAccess"], [82, 1, 1, "", "WeightInit"], [82, 6, 1, "", "WeightParams"], [82, 6, 1, "", "WeightedAvg"], [82, 6, 1, "", "WeightedAvgOfMetrics"], [82, 6, 1, "", "WhileLoop"], [82, 6, 1, "", "Zeros"], [82, 6, 1, "", "_ApplySharedRendezvous"], [82, 6, 1, "", "_AssertInputsMatch"], [82, 6, 1, "", "_CheckNumerics"], [82, 1, 1, "", "_CollectionGetter"], [82, 6, 1, "", "_ComputeGradientsTpu"], [82, 6, 1, "", "_CreateVarInitStateful"], [82, 6, 1, "", "_CreateVarInitStateless"], [82, 6, 1, "", "_CreateVariableStateful"], [82, 6, 1, "", "_CreateVariableStateless"], [82, 6, 1, "", "_DefaultVariableCreator"], [82, 6, 1, "", "_DefineDefun"], [82, 6, 1, "", "_DefineFunction"], [82, 6, 1, "", "_DeterministicRandomNormalInitializer"], [82, 6, 1, "", "_DeterministicRandomTruncatedNormalInitializer"], [82, 6, 1, "", "_DeterministicRandomUniformInitializer"], [82, 6, 1, "", "_DeterministicRandomUniformUnitScalingInitializer"], [82, 6, 1, "", "_DeterministicRandomVarianceScalingInitializer"], [82, 6, 1, "", "_DeterministicRandomXavierUniformInitializer"], [82, 6, 1, "", "_EnsureMatrixShape"], [82, 6, 1, "", "_GenerateStatelessRngSeed"], [82, 6, 1, "", "_GetSampleStep"], [82, 6, 1, "", "_GetSharedRendezvous"], [82, 6, 1, "", "_GetTpuSummaryTensor"], [82, 6, 1, "", "_GetVariableCreator"], [82, 6, 1, "", "_GetVariableStore"], [82, 6, 1, "", "_GetVarsToLoad"], [82, 6, 1, "", "_Itype"], [82, 6, 1, "", "_LogPlacement"], [82, 6, 1, "", "_MaybeWarnAboutPotentiallyIncorrectEvaluations"], [82, 6, 1, "", "_Print"], [82, 6, 1, "", "_PrintOptions"], [82, 6, 1, "", "_RandomXavierUniformInitializer"], [82, 6, 1, "", "_Save"], [82, 6, 1, "", "_SharedRendezvousScope"], [82, 6, 1, "", "_TransformAndSum"], [82, 1, 1, "", "_Unique"], [82, 6, 1, "", "_UseTfFunction"], [82, 1, 1, "", "_VarGrad"], [82, 6, 1, "", "_VarInCollection"], [82, 6, 1, "", "_WrapFunction"], [82, 6, 1, "", "assert_between"], [82, 6, 1, "", "assert_equal"], [82, 6, 1, "", "assert_even_divide"], [82, 6, 1, "", "assert_greater"], [82, 6, 1, "", "assert_greater_equal"], [82, 6, 1, "", "assert_less"], [82, 6, 1, "", "assert_less_equal"], [82, 6, 1, "", "assert_same_dim0"], [82, 6, 1, "", "assert_shape_match"], [82, 6, 1, "", "clip_by_value"], [82, 6, 1, "", "outside_all_rewrites"], [82, 6, 1, "", "tpu_host"], [82, 6, 1, "", "with_dependencies"]], "lingvo.core.py_utils.AuxLossContext": [[82, 2, 1, "", "AddLoss"], [82, 2, 1, "", "Current"], [82, 5, 1, "", "_global_stack"], [82, 3, 1, "", "aux_losses"]], "lingvo.core.py_utils.DefinedFunction": [[82, 2, 1, "", "AddFrameworkInputs"], [82, 3, 1, "", "captured_inputs"], [82, 3, 1, "", "func"], [82, 3, 1, "", "output_dtypes"], [82, 3, 1, "", "stateful_ops"]], "lingvo.core.py_utils.RNNCellStateInit": [[82, 2, 1, "", "RandomNormal"], [82, 2, 1, "", "Zeros"], [82, 2, 1, "", "_Params"]], "lingvo.core.py_utils.UniformSampler": [[82, 2, 1, "", "Add"], [82, 3, 1, "", "samples"]], "lingvo.core.py_utils.WeightInit": [[82, 2, 1, "", "Category"], [82, 2, 1, "", "Constant"], [82, 2, 1, "", "CustomConstantVarInit"], [82, 2, 1, "", "CustomVarInit"], [82, 2, 1, "", "Gaussian"], [82, 2, 1, "", "GaussianSqrtDim"], [82, 2, 1, "", "GaussianSqrtFanAvg"], [82, 2, 1, "", "GaussianSqrtFanIn"], [82, 2, 1, "", "GaussianSqrtFanOut"], [82, 2, 1, "", "GeoMeanXavier"], [82, 2, 1, "", "KaimingUniformFanInLeakyRelu"], [82, 2, 1, "", "KaimingUniformFanInRelu"], [82, 2, 1, "", "ScaledDeltaOrthogonal"], [82, 2, 1, "", "TruncatedGaussian"], [82, 2, 1, "", "TruncatedGaussianSqrtDim"], [82, 2, 1, "", "TruncatedGaussianSqrtFanIn"], [82, 2, 1, "", "TruncatedGaussianSqrtFanOut"], [82, 2, 1, "", "Uniform"], [82, 2, 1, "", "UniformPositive"], [82, 2, 1, "", "UniformSqrtDim"], [82, 2, 1, "", "UniformUnitScaling"], [82, 2, 1, "", "UniformUnitScalingFanAvg"], [82, 2, 1, "", "Xavier"], [82, 2, 1, "", "XavierWithFixupParams"], [82, 2, 1, "", "_Params"]], "lingvo.core.py_utils._VarGrad": [[82, 2, 1, "", "_asdict"], [82, 5, 1, "", "_field_defaults"], [82, 5, 1, "", "_fields"], [82, 2, 1, "", "_make"], [82, 2, 1, "", "_replace"], [82, 5, 1, "", "grad"], [82, 5, 1, "", "scale"], [82, 5, 1, "", "var"]], "lingvo.core.py_utils_flags": [[83, 6, 1, "", "_FromGlobal"], [83, 6, 1, "", "enable_asserts"], [83, 6, 1, "", "enable_check_numerics"], [83, 6, 1, "", "testonly_skip_norm_layers"], [83, 6, 1, "", "tpu_compat"], [83, 6, 1, "", "use_stateless_vars_init"], [83, 6, 1, "", "use_tpu"], [83, 6, 1, "", "use_xla"]], "lingvo.core.quant_test_lib": [[84, 1, 1, "", "QuantUtilsBaseTest"], [84, 1, 1, "", "SampleQuantizedProjectionLayer"]], "lingvo.core.quant_test_lib.QuantUtilsBaseTest": [[84, 5, 1, "", "NO_QDOMAIN_EXPECTED"], [84, 5, 1, "", "NO_QDOMAIN_EXPECTED_EAGER"], [84, 2, 1, "", "_testLayerHelper"]], "lingvo.core.quant_test_lib.SampleQuantizedProjectionLayer": [[84, 2, 1, "", "FProp"], [84, 2, 1, "", "Params"], [84, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.quant_utils": [[85, 1, 1, "", "BaseClippingCapSchedule"], [85, 1, 1, "", "FakeQDomain"], [85, 1, 1, "", "FakeQuantizationSchedule"], [85, 1, 1, "", "IdentityClippingCapSchedule"], [85, 1, 1, "", "LinearClippingCapSchedule"], [85, 1, 1, "", "PassiveAsymQDomain"], [85, 1, 1, "", "QDistribution"], [85, 1, 1, "", "QDomain"], [85, 1, 1, "", "QuantizableLayer"], [85, 1, 1, "", "SymmetricScheduledClipQDomain"], [85, 6, 1, "", "_CopyShape"], [85, 1, 1, "", "_CountedMinMaxAccumulator"]], "lingvo.core.quant_utils.BaseClippingCapSchedule": [[85, 2, 1, "", "ApplyClipping"], [85, 2, 1, "", "ApplyClippingWithState"], [85, 2, 1, "", "ApplyConstantClip"], [85, 2, 1, "", "GetEndRange"], [85, 2, 1, "", "GetQuantizedEndRange"], [85, 2, 1, "", "GetState"], [85, 3, 1, "", "is_quantized"]], "lingvo.core.quant_utils.FakeQDomain": [[85, 2, 1, "", "Params"], [85, 2, 1, "", "QRAct"], [85, 2, 1, "", "_MaybeNarrowToAsymBitDepth"]], "lingvo.core.quant_utils.FakeQuantizationSchedule": [[85, 2, 1, "", "ApplyClippingWithState"], [85, 2, 1, "", "ApplyConstantClip"], [85, 2, 1, "", "GetEndRange"], [85, 2, 1, "", "GetQuantizedEndRange"], [85, 2, 1, "", "GetState"], [85, 2, 1, "", "Params"], [85, 2, 1, "", "_GetCurrentMinMax"], [85, 2, 1, "", "_GetQuantizedRangeForCap"], [85, 3, 1, "", "bits"], [85, 3, 1, "", "is_quantized"]], "lingvo.core.quant_utils.IdentityClippingCapSchedule": [[85, 2, 1, "", "ApplyClippingWithState"], [85, 2, 1, "", "ApplyConstantClip"], [85, 2, 1, "", "GetEndRange"], [85, 2, 1, "", "GetState"]], "lingvo.core.quant_utils.LinearClippingCapSchedule": [[85, 2, 1, "", "ApplyClippingWithState"], [85, 2, 1, "", "ApplyConstantClip"], [85, 2, 1, "", "GetEndRange"], [85, 2, 1, "", "GetState"], [85, 2, 1, "", "Params"], [85, 2, 1, "", "_Value"], [85, 3, 1, "", "is_quantized"]], "lingvo.core.quant_utils.PassiveAsymQDomain": [[85, 2, 1, "", "Params"], [85, 2, 1, "", "PostTrainingStepUpdate"], [85, 2, 1, "", "QuantizeAct"], [85, 2, 1, "", "QuantizeConstantRange"], [85, 2, 1, "", "QuantizeNaturalRange"], [85, 2, 1, "", "QuantizeWeight"], [85, 2, 1, "", "TrackQActs"], [85, 2, 1, "", "_CreateLayerVariables"], [85, 2, 1, "", "_CreateQStateVar"], [85, 2, 1, "", "_GetAccumulatorNameForTensor"], [85, 2, 1, "", "_GetQStateVar"], [85, 2, 1, "", "_GetQStateVarName"], [85, 2, 1, "", "_MaybeFakeQuant"], [85, 2, 1, "", "_RecordTensor"], [85, 2, 1, "", "_SummarizeTensor"], [85, 3, 1, "", "bits"]], "lingvo.core.quant_utils.QDistribution": [[85, 2, 1, "", "IsPositive"], [85, 5, 1, "", "LOG_SOFTMAX"], [85, 5, 1, "", "PADDING"], [85, 5, 1, "", "POSITIVE"], [85, 5, 1, "", "RANDOM_UNIFORM"], [85, 5, 1, "", "RELU"], [85, 5, 1, "", "RELU6"], [85, 5, 1, "", "SIGMOID"], [85, 5, 1, "", "SOFTMAX"], [85, 5, 1, "", "SYMMETRIC"], [85, 5, 1, "", "TANH"], [85, 2, 1, "", "_generate_next_value_"], [85, 5, 1, "", "_member_map_"], [85, 5, 1, "", "_member_names_"], [85, 5, 1, "", "_member_type_"], [85, 5, 1, "", "_value2member_map_"]], "lingvo.core.quant_utils.QDomain": [[85, 2, 1, "", "FromAqtActActMatmul"], [85, 2, 1, "", "FromAqtConv"], [85, 2, 1, "", "FromAqtMatmul"], [85, 2, 1, "", "FromAqtWeight"], [85, 2, 1, "", "QConv1D"], [85, 2, 1, "", "QConv2D"], [85, 2, 1, "", "QEinsum"], [85, 2, 1, "", "QMatmul"], [85, 2, 1, "", "QRAct"], [85, 2, 1, "", "QuantizeAct"], [85, 2, 1, "", "QuantizeConstantRange"], [85, 2, 1, "", "QuantizeNaturalRange"], [85, 2, 1, "", "QuantizeWeight"], [85, 2, 1, "", "ToAqtActActInputs"], [85, 2, 1, "", "ToAqtConv"], [85, 2, 1, "", "ToAqtInputs"], [85, 2, 1, "", "ToAqtWeight"], [85, 2, 1, "", "TrackQActs"], [85, 2, 1, "", "TrackQWeight"], [85, 3, 1, "", "bits"]], "lingvo.core.quant_utils.QuantizableLayer": [[85, 2, 1, "", "FromAqtActActMatmul"], [85, 2, 1, "", "FromAqtConv"], [85, 2, 1, "", "FromAqtMatmul"], [85, 2, 1, "", "FromAqtWeight"], [85, 2, 1, "", "GetQDomainParams"], [85, 2, 1, "", "Params"], [85, 2, 1, "", "QAct"], [85, 2, 1, "", "QConv1D"], [85, 2, 1, "", "QConv2D"], [85, 2, 1, "", "QEinsum"], [85, 2, 1, "", "QMatmul"], [85, 2, 1, "", "QRAct"], [85, 2, 1, "", "QWeight"], [85, 2, 1, "", "ToAqtActActInputs"], [85, 2, 1, "", "ToAqtConv"], [85, 2, 1, "", "ToAqtInputs"], [85, 2, 1, "", "ToAqtWeight"], [85, 2, 1, "", "TrackQActs"], [85, 2, 1, "", "TrackQWeight"], [85, 2, 1, "", "_AddQuantizationFunctions"], [85, 2, 1, "", "_GetQDomain"], [85, 2, 1, "", "_ValidateArgName"], [85, 2, 1, "", "_ValidateWeight"], [85, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.quant_utils.SymmetricScheduledClipQDomain": [[85, 2, 1, "", "Params"], [85, 2, 1, "", "QuantizeAct"], [85, 2, 1, "", "QuantizeConstantRange"], [85, 2, 1, "", "QuantizeNaturalRange"], [85, 2, 1, "", "QuantizeWeight"], [85, 3, 1, "", "bits"]], "lingvo.core.quant_utils._CountedMinMaxAccumulator": [[85, 2, 1, "", "DefaultValue"], [85, 2, 1, "", "Update"]], "lingvo.core.recurrent": [[86, 1, 1, "", "DevicePair"], [86, 6, 1, "", "FlattenPadding"], [86, 6, 1, "", "Recurrent"], [86, 6, 1, "", "StackedRecurrent"], [86, 6, 1, "", "_Add"], [86, 6, 1, "", "_AssertSameTensors"], [86, 6, 1, "", "_AugmentState"], [86, 6, 1, "", "_CreateLinks"], [86, 6, 1, "", "_DecorateCellFn"], [86, 6, 1, "", "_DecorateCellGrad"], [86, 6, 1, "", "_DependsOn"], [86, 6, 1, "", "_EmptyAcc"], [86, 6, 1, "", "_EmptyLike"], [86, 6, 1, "", "_EmptyWithFixShape"], [86, 6, 1, "", "_GetCellGrad"], [86, 6, 1, "", "_Index"], [86, 1, 1, "", "_Input"], [86, 6, 1, "", "_IsSingleTimeStep"], [86, 6, 1, "", "_Join"], [86, 1, 1, "", "_Link"], [86, 1, 1, "", "_Middle"], [86, 1, 1, "", "_Output"], [86, 1, 1, "", "_Recurrent"], [86, 6, 1, "", "_RecurrentSingleTimeStep"], [86, 6, 1, "", "_ReflectOnCellFn"], [86, 6, 1, "", "_SeqLenDim"], [86, 6, 1, "", "_SeqPaddingLength"], [86, 6, 1, "", "_StackedRecurrent"], [86, 6, 1, "", "_TransformDType"], [86, 6, 1, "", "_Update"], [86, 6, 1, "", "_WrapAccumulatorCellFn"], [86, 6, 1, "", "_WrapAccumulatorCellGradFn"], [86, 6, 1, "", "_WrapCellFnWithStepSeed"], [86, 6, 1, "", "_WrapCellFnWithSymbolValues"], [86, 6, 1, "", "_WrapCellGradFnWithStepSeed"], [86, 6, 1, "", "_WrapCellGradFnWithSymbolValues"]], "lingvo.core.recurrent.DevicePair": [[86, 2, 1, "", "_asdict"], [86, 5, 1, "", "_field_defaults"], [86, 5, 1, "", "_fields"], [86, 2, 1, "", "_make"], [86, 2, 1, "", "_replace"], [86, 5, 1, "", "recv"], [86, 5, 1, "", "send"]], "lingvo.core.recurrent._Input": [[86, 2, 1, "", "Compute"]], "lingvo.core.recurrent._Middle": [[86, 2, 1, "", "Compute"]], "lingvo.core.recurrent._Output": [[86, 2, 1, "", "Compute"]], "lingvo.core.recurrent._Recurrent": [[86, 2, 1, "", "Compute"]], "lingvo.core.repeat_layer": [[87, 1, 1, "", "GenericRepeatLayer"], [87, 6, 1, "", "_CopyShapes"]], "lingvo.core.repeat_layer.GenericRepeatLayer": [[87, 2, 1, "", "Params"], [87, 2, 1, "", "_MaybeStackExtraTheta"], [87, 2, 1, "", "_Repeat"], [87, 3, 1, "", "_body"], [87, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.retry": [[88, 6, 1, "", "Retry"]], "lingvo.core.reversible_layers": [[89, 1, 1, "", "RevNetLayer"], [89, 1, 1, "", "StackedRevNetLayer"]], "lingvo.core.reversible_layers.RevNetLayer": [[89, 2, 1, "", "FProp"], [89, 2, 1, "", "Params"], [89, 2, 1, "", "ReverseAndGrad"]], "lingvo.core.reversible_layers.StackedRevNetLayer": [[89, 2, 1, "", "FProp"], [89, 2, 1, "", "Params"]], "lingvo.core.rnn_cell": [[90, 1, 1, "", "ConvLSTMCell"], [90, 1, 1, "", "DoubleProjectionLSTMCell"], [90, 1, 1, "", "EmbeddingAugmentedLayerNormalizedLSTMCellSimple"], [90, 1, 1, "", "GRUCell"], [90, 1, 1, "", "LSTMCellGrouped"], [90, 1, 1, "", "LSTMCellSimple"], [90, 1, 1, "", "LayerNormalizedLSTMCell"], [90, 1, 1, "", "LayerNormalizedLSTMCellLean"], [90, 1, 1, "", "LayerNormalizedLSTMCellSimple"], [90, 1, 1, "", "NormalizedLSTMCellSimple"], [90, 1, 1, "", "QRNNPoolingCell"], [90, 1, 1, "", "QuantizedLSTMCell"], [90, 1, 1, "", "RNNCell"], [90, 1, 1, "", "SRUCell"], [90, 1, 1, "", "WeightNormalizedLSTMCellSimple"], [90, 6, 1, "", "_HistogramSummary"]], "lingvo.core.rnn_cell.ConvLSTMCell": [[90, 2, 1, "", "AddGlobalVN"], [90, 2, 1, "", "GetOutput"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "_CreateLayerVariables"], [90, 2, 1, "", "_Gates"], [90, 2, 1, "", "_Mix"], [90, 2, 1, "", "batch_size"], [90, 3, 1, "", "hidden_size"], [90, 3, 1, "", "output_size"], [90, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.DoubleProjectionLSTMCell": [[90, 2, 1, "", "AddGlobalVN"], [90, 2, 1, "", "GetOutput"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "_CreateLayerVariables"], [90, 2, 1, "", "_Gates"], [90, 2, 1, "", "_LayerNormGate"], [90, 2, 1, "", "_Mix"], [90, 2, 1, "", "_ProcessInputProj"], [90, 2, 1, "", "_ResetState"], [90, 2, 1, "", "batch_size"], [90, 3, 1, "", "gates"], [90, 3, 1, "", "hidden_size"], [90, 3, 1, "", "output_size"], [90, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.EmbeddingAugmentedLayerNormalizedLSTMCellSimple": [[90, 2, 1, "", "FProp"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.GRUCell": [[90, 2, 1, "", "AddGlobalVN"], [90, 2, 1, "", "FProp"], [90, 2, 1, "", "GetOutput"], [90, 2, 1, "", "LayerNorm"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "_CreateLayerVariables"], [90, 2, 1, "", "_ResetState"], [90, 2, 1, "", "batch_size"], [90, 3, 1, "", "hidden_size"], [90, 3, 1, "", "output_size"], [90, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.LSTMCellGrouped": [[90, 2, 1, "", "FProp"], [90, 2, 1, "", "GetOutput"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "_ShuffleShards"], [90, 2, 1, "", "batch_size"], [90, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.LSTMCellSimple": [[90, 2, 1, "", "AddGlobalVN"], [90, 2, 1, "", "GetOutput"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "PostTrainingStepUpdate"], [90, 2, 1, "", "_ApplyZoneOut"], [90, 2, 1, "", "_CreateLayerVariables"], [90, 2, 1, "", "_Gates"], [90, 2, 1, "", "_GatesInternal"], [90, 2, 1, "", "_GetBias"], [90, 2, 1, "", "_Mix"], [90, 2, 1, "", "_ProcessNewC"], [90, 2, 1, "", "_ResetState"], [90, 2, 1, "", "_RetrieveAndSplitGates"], [90, 2, 1, "", "batch_size"], [90, 3, 1, "", "hidden_size"], [90, 3, 1, "", "num_gates"], [90, 3, 1, "", "output_size"], [90, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.LayerNormalizedLSTMCell": [[90, 2, 1, "", "AddGlobalVN"], [90, 2, 1, "", "GetOutput"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "_CreateLayerVariables"], [90, 2, 1, "", "_Gates"], [90, 2, 1, "", "_Mix"], [90, 2, 1, "", "_ResetState"], [90, 2, 1, "", "batch_size"], [90, 3, 1, "", "hidden_size"], [90, 3, 1, "", "output_size"], [90, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.LayerNormalizedLSTMCellLean": [[90, 2, 1, "", "AddGlobalVN"], [90, 2, 1, "", "GetOutput"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "_CreateLayerVariables"], [90, 2, 1, "", "_Gates"], [90, 2, 1, "", "_LayerNormGate"], [90, 2, 1, "", "_Mix"], [90, 2, 1, "", "_ResetState"], [90, 2, 1, "", "batch_size"], [90, 3, 1, "", "hidden_size"], [90, 3, 1, "", "output_size"], [90, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.LayerNormalizedLSTMCellSimple": [[90, 2, 1, "", "AddGlobalVN"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "_CreateLayerVariables"], [90, 2, 1, "", "_Gates"]], "lingvo.core.rnn_cell.NormalizedLSTMCellSimple": [[90, 2, 1, "", "Params"], [90, 2, 1, "", "_Gates"]], "lingvo.core.rnn_cell.QRNNPoolingCell": [[90, 2, 1, "", "GetOutput"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "_ApplyZoneOut"], [90, 2, 1, "", "_Gates"], [90, 2, 1, "", "_Mix"], [90, 2, 1, "", "batch_size"], [90, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.QuantizedLSTMCell": [[90, 2, 1, "", "AddGlobalVN"], [90, 2, 1, "", "GetOutput"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "_CreateLayerVariables"], [90, 2, 1, "", "_Gates"], [90, 2, 1, "", "_Mix"], [90, 2, 1, "", "_ResetState"], [90, 2, 1, "", "batch_size"], [90, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.RNNCell": [[90, 2, 1, "", "FProp"], [90, 2, 1, "", "GetOutput"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "_ZoneOut"], [90, 2, 1, "", "batch_size"], [90, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.SRUCell": [[90, 2, 1, "", "AddGlobalVN"], [90, 2, 1, "", "GetOutput"], [90, 2, 1, "", "LayerNorm"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "_ApplyZoneOut"], [90, 2, 1, "", "_CreateLayerVariables"], [90, 2, 1, "", "_Gates"], [90, 2, 1, "", "_Mix"], [90, 2, 1, "", "batch_size"], [90, 3, 1, "", "hidden_size"], [90, 3, 1, "", "num_gates"], [90, 3, 1, "", "output_size"], [90, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.WeightNormalizedLSTMCellSimple": [[90, 2, 1, "", "AddGlobalVN"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "_CreateLayerVariables"], [90, 2, 1, "", "_Gates"]], "lingvo.core.rnn_layers": [[91, 1, 1, "", "BidirectionalFRNN"], [91, 1, 1, "", "BidirectionalFRNNQuasi"], [91, 1, 1, "", "BidirectionalRNN"], [91, 1, 1, "", "BidirectionalRNNV2"], [91, 1, 1, "", "FRNN"], [91, 1, 1, "", "FRNNWithAttention"], [91, 6, 1, "", "GeneratePackedInputResetMask"], [91, 1, 1, "", "IdentitySeqLayer"], [91, 1, 1, "", "MultiSourceFRNNWithAttention"], [91, 1, 1, "", "RNN"], [91, 1, 1, "", "StackedBiFRNNLayerByLayer"], [91, 1, 1, "", "StackedFRNNLayerByLayer"], [91, 1, 1, "", "StackedRNNBase"], [91, 6, 1, "", "_ConcatLastDim"], [91, 6, 1, "", "_ShiftRight"], [91, 6, 1, "", "_ShiftRightWithMasking"]], "lingvo.core.rnn_layers.BidirectionalFRNN": [[91, 2, 1, "", "FProp"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.rnn_layers.BidirectionalFRNNQuasi": [[91, 2, 1, "", "FProp"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.rnn_layers.BidirectionalRNN": [[91, 2, 1, "", "FProp"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.rnn_layers.BidirectionalRNNV2": [[91, 2, 1, "", "FProp"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_PadSequenceToLength"], [91, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.rnn_layers.FRNN": [[91, 2, 1, "", "FProp"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_child_variable_scope_override"], [91, 3, 1, "", "rnn_cell"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_layers.FRNNWithAttention": [[91, 2, 1, "", "AccumulateStates"], [91, 2, 1, "", "FProp"], [91, 2, 1, "", "InitForSourcePacked"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "PostProcessStates"], [91, 2, 1, "", "_child_variable_scope_override"], [91, 3, 1, "", "attention"], [91, 2, 1, "", "reset_atten_state"], [91, 3, 1, "", "rnn_cell"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_layers.IdentitySeqLayer": [[91, 2, 1, "", "FPropFullSequence"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_layers.MultiSourceFRNNWithAttention": [[91, 2, 1, "", "FProp"], [91, 2, 1, "", "InitAttention"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_child_variable_scope_override"], [91, 3, 1, "", "attention"], [91, 3, 1, "", "rnn_cell"]], "lingvo.core.rnn_layers.RNN": [[91, 2, 1, "", "FProp"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_child_variable_scope_override"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_layers.StackedBiFRNNLayerByLayer": [[91, 2, 1, "", "FProp"], [91, 2, 1, "", "FPropFullSequence"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_CreateLayerVariables"], [91, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.rnn_layers.StackedFRNNLayerByLayer": [[91, 2, 1, "", "FProp"], [91, 2, 1, "", "FPropFullSequence"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_CreateLayerVariables"], [91, 2, 1, "", "_child_variable_scope_override"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_layers.StackedRNNBase": [[91, 2, 1, "", "Params"], [91, 2, 1, "", "_GetCellTpls"]], "lingvo.core.routing_config_helper": [[92, 1, 1, "", "RoutingTransformerEncoderParams"], [92, 6, 1, "", "SetupRoutingTransformerEncoder"]], "lingvo.core.saver": [[93, 1, 1, "", "InRange"], [93, 1, 1, "", "IsFinite"], [93, 6, 1, "", "ReadNpArrays"], [93, 1, 1, "", "SanityCheck"], [93, 1, 1, "", "Saver"], [93, 6, 1, "", "WriteNpArrays"], [93, 6, 1, "", "_VarKey"]], "lingvo.core.saver.InRange": [[93, 2, 1, "", "Check"]], "lingvo.core.saver.IsFinite": [[93, 2, 1, "", "Check"]], "lingvo.core.saver.SanityCheck": [[93, 2, 1, "", "Check"]], "lingvo.core.saver.Saver": [[93, 2, 1, "", "GetCheckpointId"], [93, 5, 1, "", "RE_PATTERN"], [93, 2, 1, "", "Restore"], [93, 2, 1, "", "Save"], [93, 2, 1, "", "Sync"], [93, 2, 1, "", "_AddShardedSaveOps"], [93, 2, 1, "", "_BuildRestore"], [93, 2, 1, "", "_BuildSave"], [93, 2, 1, "", "_DoSanityCheck"], [93, 2, 1, "", "_FinalizeSave"], [93, 2, 1, "", "_GarbageCollect"], [93, 2, 1, "", "_GetState"], [93, 2, 1, "", "_SaveAsync"], [93, 2, 1, "", "_SaveSync"], [93, 2, 1, "", "_SetState"], [93, 2, 1, "", "_UpdateState"]], "lingvo.core.scatter_update": [[94, 6, 1, "", "SetInplaceUpdate"], [94, 6, 1, "", "Update"], [94, 6, 1, "", "UseInplaceUpdate"]], "lingvo.core.schedule": [[95, 1, 1, "", "AnnealingSchedule"], [95, 1, 1, "", "BaseSchedule"], [95, 1, 1, "", "CombinedMinimumSchedule"], [95, 1, 1, "", "Constant"], [95, 1, 1, "", "ConstantOne"], [95, 1, 1, "", "ContinuousSchedule"], [95, 1, 1, "", "CosineSchedule"], [95, 1, 1, "", "CycleSchedule"], [95, 1, 1, "", "DevBasedSchedule"], [95, 1, 1, "", "ExponentialSchedule"], [95, 1, 1, "", "InverseSigmoid"], [95, 1, 1, "", "LinearRampupCosineSchedule"], [95, 1, 1, "", "LinearRampupDecaySchedule"], [95, 1, 1, "", "LinearRampupExponentialDecay"], [95, 1, 1, "", "LinearRampupExponentialDecayScaledByNumSplitSchedule"], [95, 1, 1, "", "LinearRampupPiecewiseConstantSchedule"], [95, 1, 1, "", "LinearRampupSqrtDecay"], [95, 1, 1, "", "LinearRampupSqrtDecayByBatchSizeAndReplicas"], [95, 1, 1, "", "LinearSchedule"], [95, 1, 1, "", "PiecewiseConstantSchedule"], [95, 1, 1, "", "PiecewiseSchedule"], [95, 1, 1, "", "PolynomialSchedule"], [95, 1, 1, "", "SqrtDecay"], [95, 1, 1, "", "SqrtDecayToZero"], [95, 1, 1, "", "StepwiseExponentialSchedule"], [95, 1, 1, "", "TransformerMLPerfSchedule"], [95, 1, 1, "", "TransformerSchedule"], [95, 1, 1, "", "TransformerScheduleNoWarmUp"]], "lingvo.core.schedule.AnnealingSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.BaseSchedule": [[95, 2, 1, "", "GetStep"], [95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.CombinedMinimumSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.Constant": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.ContinuousSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.CosineSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.CycleSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.DevBasedSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"], [95, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.schedule.ExponentialSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.InverseSigmoid": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearRampupCosineSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearRampupDecaySchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearRampupExponentialDecay": [[95, 2, 1, "", "Params"]], "lingvo.core.schedule.LinearRampupExponentialDecayScaledByNumSplitSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearRampupPiecewiseConstantSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearRampupSqrtDecay": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearRampupSqrtDecayByBatchSizeAndReplicas": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearSchedule": [[95, 2, 1, "", "Params"]], "lingvo.core.schedule.PiecewiseConstantSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.PiecewiseSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.PolynomialSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.SqrtDecay": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.SqrtDecayToZero": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.StepwiseExponentialSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.TransformerMLPerfSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.TransformerSchedule": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.schedule.TransformerScheduleNoWarmUp": [[95, 2, 1, "", "Params"], [95, 2, 1, "", "Value"]], "lingvo.core.scorers": [[96, 1, 1, "", "BleuScorer"], [96, 6, 1, "", "NGrams"], [96, 1, 1, "", "Unsegmenter"], [96, 6, 1, "", "_ToUnicode"], [96, 6, 1, "", "_Tokenize"]], "lingvo.core.scorers.BleuScorer": [[96, 2, 1, "", "AddSentence"], [96, 2, 1, "", "ComputeOverallScore"], [96, 3, 1, "", "unsegmenter"]], "lingvo.core.scorers.Unsegmenter": [[96, 5, 1, "", "_BPE_SEPARATOR"], [96, 2, 1, "", "_UnsegmentBpe"], [96, 2, 1, "", "_UnsegmentWpm"], [96, 5, 1, "", "_WPM_SEPARATOR"]], "lingvo.core.self_attention_layer": [[97, 1, 1, "", "Builder"], [97, 1, 1, "", "StackedTransformerEncoderLayers"]], "lingvo.core.self_attention_layer.Builder": [[97, 2, 1, "", "SelfAttention"], [97, 2, 1, "", "TransformerStack"], [97, 2, 1, "", "TransformerStackV2"], [97, 2, 1, "", "_StridedTransformerLayerBlock"], [97, 2, 1, "", "_TransformerLayerBlock"]], "lingvo.core.self_attention_layer.StackedTransformerEncoderLayers": [[97, 2, 1, "", "Cast"], [97, 2, 1, "", "FProp"]], "lingvo.core.sendrecv": [[98, 1, 1, "", "Channel"], [98, 6, 1, "", "_TpuCore"]], "lingvo.core.sendrecv.Channel": [[98, 2, 1, "", "Recv"], [98, 2, 1, "", "Send"]], "lingvo.core.spectrum_augmenter": [[99, 1, 1, "", "SpectrumAugmenter"], [99, 6, 1, "", "_global_seed_from_inputs"], [99, 6, 1, "", "_hat"], [99, 6, 1, "", "_random_normal_op"], [99, 6, 1, "", "_random_uniform_op"]], "lingvo.core.spectrum_augmenter.SpectrumAugmenter": [[99, 2, 1, "", "EinsumBBmBm"], [99, 2, 1, "", "EinsumBmtBmBt"], [99, 2, 1, "", "EinsumBxyBxBxy"], [99, 2, 1, "", "EinsumBxycBxBxyc"], [99, 2, 1, "", "EinsumBxycByBxyc"], [99, 2, 1, "", "EinsumBxycBzxBzyc"], [99, 2, 1, "", "EinsumBxycBzyBxzc"], [99, 2, 1, "", "FProp"], [99, 2, 1, "", "Params"], [99, 2, 1, "", "UnstackFeatures"], [99, 2, 1, "", "_AugmentationNetwork"], [99, 2, 1, "", "_ConstructWarpMatrix"], [99, 2, 1, "", "_FrequencyMask"], [99, 2, 1, "", "_FrequencyNoise"], [99, 2, 1, "", "_FrequencyWarp"], [99, 2, 1, "", "_GetMask"], [99, 2, 1, "", "_GetWarpMatrix"], [99, 2, 1, "", "_TimeMask"], [99, 2, 1, "", "_TimeWarp"], [99, 3, 1, "", "augment_weight"]], "lingvo.core.spectrum_augmenter_on_device": [[100, 1, 1, "", "SpectrumAugmenterOnDevice"]], "lingvo.core.spectrum_augmenter_on_device.SpectrumAugmenterOnDevice": [[100, 2, 1, "", "EinsumBBmBm"], [100, 2, 1, "", "EinsumBmtBmBt"], [100, 2, 1, "", "EinsumBxyBxBxy"], [100, 2, 1, "", "EinsumBxycBxBxyc"], [100, 2, 1, "", "EinsumBxycByBxyc"], [100, 2, 1, "", "EinsumBxycBzxBzyc"], [100, 2, 1, "", "EinsumBxycBzyBxzc"]], "lingvo.core.step": [[101, 1, 1, "", "GraphStep"], [101, 1, 1, "", "IteratorStep"], [101, 1, 1, "", "ParallelStep"], [101, 1, 1, "", "RecurrentStepWrapper"], [101, 1, 1, "", "StackStep"], [101, 1, 1, "", "StatelessLayerStep"], [101, 1, 1, "", "Step"], [101, 1, 1, "", "SubStep"]], "lingvo.core.step.GraphStep": [[101, 2, 1, "", "FProp"], [101, 2, 1, "", "Params"], [101, 2, 1, "", "PrepareExternalInputs"], [101, 2, 1, "", "ZeroState"], [101, 5, 1, "", "_seq"]], "lingvo.core.step.IteratorStep": [[101, 2, 1, "", "FProp"], [101, 2, 1, "", "Params"], [101, 2, 1, "", "PrepareExternalInputs"], [101, 2, 1, "", "ZeroState"]], "lingvo.core.step.ParallelStep": [[101, 2, 1, "", "FProp"], [101, 2, 1, "", "Params"]], "lingvo.core.step.RecurrentStepWrapper": [[101, 2, 1, "", "FProp"], [101, 2, 1, "", "Params"], [101, 2, 1, "", "PrepareExternalInputs"], [101, 2, 1, "", "ZeroState"], [101, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.step.StackStep": [[101, 2, 1, "", "FProp"], [101, 2, 1, "", "Params"], [101, 2, 1, "", "PrepareExternalInputs"], [101, 2, 1, "", "ZeroState"]], "lingvo.core.step.StatelessLayerStep": [[101, 2, 1, "", "FProp"], [101, 2, 1, "", "Params"]], "lingvo.core.step.Step": [[101, 2, 1, "", "FProp"], [101, 2, 1, "", "PrepareExternalInputs"], [101, 2, 1, "", "ZeroState"]], "lingvo.core.step.SubStep": [[101, 2, 1, "", "_asdict"], [101, 5, 1, "", "_field_defaults"], [101, 5, 1, "", "_fields"], [101, 2, 1, "", "_make"], [101, 2, 1, "", "_replace"], [101, 5, 1, "", "external_signature"], [101, 5, 1, "", "params"], [101, 5, 1, "", "signature"]], "lingvo.core.steps": [[103, 0, 0, "-", "attention_steps"], [104, 0, 0, "-", "embedding_steps"], [105, 0, 0, "-", "rnn_steps"]], "lingvo.core.steps.attention_steps": [[103, 1, 1, "", "AttentionBlockStep"], [103, 1, 1, "", "AttentionStep"]], "lingvo.core.steps.attention_steps.AttentionBlockStep": [[103, 2, 1, "", "FProp"], [103, 2, 1, "", "Params"], [103, 2, 1, "", "ZeroState"]], "lingvo.core.steps.attention_steps.AttentionStep": [[103, 2, 1, "", "FProp"], [103, 2, 1, "", "Params"], [103, 2, 1, "", "PrepareExternalInputs"], [103, 2, 1, "", "ZeroState"], [103, 2, 1, "", "_GetMaxSeqLength"]], "lingvo.core.steps.embedding_steps": [[104, 1, 1, "", "EmbeddingStep"], [104, 1, 1, "", "StatefulEmbeddingStep"]], "lingvo.core.steps.embedding_steps.EmbeddingStep": [[104, 2, 1, "", "FProp"], [104, 2, 1, "", "Params"]], "lingvo.core.steps.embedding_steps.StatefulEmbeddingStep": [[104, 2, 1, "", "EmbLookup"], [104, 2, 1, "", "FProp"], [104, 2, 1, "", "Params"], [104, 2, 1, "", "ZeroState"], [104, 2, 1, "", "zero_state"]], "lingvo.core.steps.rnn_steps": [[105, 1, 1, "", "RnnStackStep"], [105, 1, 1, "", "RnnStep"]], "lingvo.core.steps.rnn_steps.RnnStackStep": [[105, 2, 1, "", "FProp"], [105, 2, 1, "", "Params"], [105, 2, 1, "", "PrepareExternalInputs"], [105, 2, 1, "", "ZeroState"], [105, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.steps.rnn_steps.RnnStep": [[105, 2, 1, "", "FProp"], [105, 2, 1, "", "Params"], [105, 2, 1, "", "PrepareExternalInputs"], [105, 2, 1, "", "ZeroState"]], "lingvo.core.stream_step_test_base": [[106, 1, 1, "", "StreamStepTestBase"]], "lingvo.core.stream_step_test_base.StreamStepTestBase": [[106, 2, 1, "", "_BuildStackingBaseGraph"], [106, 2, 1, "", "_BuildStackingStreamGraph"], [106, 2, 1, "", "_FProp"], [106, 2, 1, "", "_GetFPropOutput"], [106, 2, 1, "", "_GetInputs"], [106, 2, 1, "", "_GetParams"], [106, 2, 1, "", "_NormalizeStreamStepOutput"], [106, 2, 1, "", "_PadInput"], [106, 2, 1, "", "_StreamStep"], [106, 2, 1, "", "_TestRightContextStackingLayersHelper"], [106, 2, 1, "", "_TestStreamStepHelper"], [106, 5, 1, "", "_test_params_reprs"], [106, 3, 1, "", "input_rank"]], "lingvo.core.summary_utils": [[107, 6, 1, "", "AddAttentionSummary"], [107, 6, 1, "", "AddAttentionSummaryBatchMajor"], [107, 6, 1, "", "AddNormSummary"], [107, 6, 1, "", "CollectVarHistogram"], [107, 6, 1, "", "GetTensorName"], [107, 6, 1, "", "ModelAnalysis"], [107, 6, 1, "", "PlotSequenceFeatures"], [107, 6, 1, "", "PrepareSequenceForPlot"], [107, 6, 1, "", "SequenceLength"], [107, 1, 1, "", "StatsCounter"], [107, 1, 1, "", "StepRateTracker"], [107, 6, 1, "", "TrimPaddingAndPlotAttention"], [107, 6, 1, "", "TrimPaddingAndPlotSequence"], [107, 6, 1, "", "_ShouldAddSummary"], [107, 6, 1, "", "histogram"], [107, 6, 1, "", "histogram_v2"], [107, 6, 1, "", "image"], [107, 6, 1, "", "image_v2"], [107, 6, 1, "", "scalar"], [107, 6, 1, "", "scalar_input_stats"], [107, 6, 1, "", "scalar_v2"], [107, 6, 1, "", "text"], [107, 6, 1, "", "text_v2"]], "lingvo.core.summary_utils.StatsCounter": [[107, 2, 1, "", "IncBy"], [107, 2, 1, "", "Value"]], "lingvo.core.summary_utils.StepRateTracker": [[107, 2, 1, "", "ComputeStepRate"]], "lingvo.core.symbolic": [[108, 6, 1, "", "EvalExpr"], [108, 6, 1, "", "IsExpr"], [108, 6, 1, "", "IsSymbol"], [108, 1, 1, "", "Symbol"], [108, 1, 1, "", "SymbolToValueMap"], [108, 6, 1, "", "ToStatic"], [108, 6, 1, "", "ToTensor"], [108, 1, 1, "", "_LocalSymbolToValueStack"]], "lingvo.core.symbolic.Symbol": [[108, 5, 1, "", "_explicit_class_assumptions"], [108, 5, 1, "", "_prop_handler"], [108, 5, 1, "", "default_assumptions"], [108, 5, 1, "", "dummy_index"]], "lingvo.core.symbolic.SymbolToValueMap": [[108, 2, 1, "", "Get"], [108, 2, 1, "", "Stack"], [108, 5, 1, "", "_local_stack"]], "lingvo.core.target_sequence_sampler": [[109, 1, 1, "", "TargetSequenceSampler"], [109, 6, 1, "", "_ComputePaddings"], [109, 6, 1, "", "_GetShapes"]], "lingvo.core.target_sequence_sampler.TargetSequenceSampler": [[109, 2, 1, "", "Params"], [109, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler": [[110, 1, 1, "", "AdaptiveScheduler"], [110, 1, 1, "", "ConstantScheduler"], [110, 1, 1, "", "ExponentialScheduler"], [110, 1, 1, "", "InverseRatioAdaptiveScheduler"], [110, 1, 1, "", "PieceWiseScheduler"], [110, 1, 1, "", "RoundRobinScheduler"], [110, 1, 1, "", "SequentialScheduler"], [110, 1, 1, "", "ShiftedExponentialScheduler"], [110, 1, 1, "", "SigmoidScheduler"], [110, 1, 1, "", "SimpleAdaptiveScheduler"], [110, 1, 1, "", "TaskScheduler"]], "lingvo.core.task_scheduler.AdaptiveScheduler": [[110, 2, 1, "", "Params"], [110, 2, 1, "", "getMetricHistories"]], "lingvo.core.task_scheduler.InverseRatioAdaptiveScheduler": [[110, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler.PieceWiseScheduler": [[110, 2, 1, "", "Params"], [110, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler.RoundRobinScheduler": [[110, 2, 1, "", "Params"], [110, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler.SequentialScheduler": [[110, 2, 1, "", "Params"], [110, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler.ShiftedExponentialScheduler": [[110, 2, 1, "", "Params"], [110, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler.SimpleAdaptiveScheduler": [[110, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler.TaskScheduler": [[110, 2, 1, "", "Params"], [110, 2, 1, "", "Sample"]], "lingvo.core.test_helper": [[111, 6, 1, "", "test_src_dir_path"]], "lingvo.core.test_trainer_utils": [[112, 6, 1, "", "MakeModelValidatorTestCase"], [112, 6, 1, "", "_ModelTuples"]], "lingvo.core.test_utils": [[113, 6, 1, "", "CompareToGoldenSingleFloat"], [113, 6, 1, "", "ComputeNumericGradient"], [113, 6, 1, "", "ComputeNumericGradientEager"], [113, 6, 1, "", "DefineAndTrace"], [113, 6, 1, "", "DisableEagerAdapter"], [113, 6, 1, "", "PickEveryN"], [113, 6, 1, "", "ReplaceGoldenSingleFloat"], [113, 6, 1, "", "ReplaceGoldenStackAnalysis"], [113, 6, 1, "", "SkipIfEager"], [113, 6, 1, "", "SkipIfNonEager"], [113, 1, 1, "", "TapeIfEager"], [113, 1, 1, "", "TestCase"], [113, 1, 1, "", "_EagerSessionAdaptor"], [113, 6, 1, "", "_PlaceholderAdapter"], [113, 6, 1, "", "_ReplaceOneLineInFile"], [113, 6, 1, "", "_SkipIf"], [113, 6, 1, "", "main"]], "lingvo.core.test_utils.TapeIfEager": [[113, 2, 1, "", "gradient"], [113, 2, 1, "", "watch"]], "lingvo.core.test_utils.TestCase": [[113, 2, 1, "", "GetScalarSummaryValues"], [113, 2, 1, "", "SetEval"], [113, 2, 1, "", "_create_session"], [113, 2, 1, "", "session"], [113, 2, 1, "", "setUp"]], "lingvo.core.test_utils._EagerSessionAdaptor": [[113, 2, 1, "", "_run_impl"], [113, 2, 1, "", "run"]], "lingvo.core.thread_local_utils": [[114, 1, 1, "", "ThreadLocalDict"], [114, 1, 1, "", "ThreadLocalStack"]], "lingvo.core.tokenizers": [[115, 1, 1, "", "AsciiTokenizer"], [115, 1, 1, "", "BaseTokenizer"], [115, 1, 1, "", "BpeTokenizer"], [115, 1, 1, "", "SentencePieceTokenizer"], [115, 1, 1, "", "VocabFileTokenizer"], [115, 1, 1, "", "WpmTokenizer"]], "lingvo.core.tokenizers.AsciiTokenizer": [[115, 2, 1, "", "IdsToStrings"], [115, 2, 1, "", "_StringsToIdsImpl"]], "lingvo.core.tokenizers.BaseTokenizer": [[115, 2, 1, "", "IdsToStrings"], [115, 2, 1, "", "IdsToTokens"], [115, 2, 1, "", "Initialize"], [115, 2, 1, "", "Params"], [115, 2, 1, "", "StringsToIds"], [115, 2, 1, "", "StringsToIdsWithOffsets"], [115, 2, 1, "", "StringsToIdsWithSegments"], [115, 2, 1, "", "_StringsToIdsImpl"], [115, 2, 1, "", "_StringsToIdsWithOffsetsImpl"], [115, 2, 1, "", "_StringsToIdsWithSegmentsImpl"]], "lingvo.core.tokenizers.BpeTokenizer": [[115, 2, 1, "", "IdsToStrings"], [115, 2, 1, "", "Params"], [115, 2, 1, "", "_StringsToIdsImpl"]], "lingvo.core.tokenizers.SentencePieceTokenizer": [[115, 2, 1, "", "IdsToStrings"], [115, 2, 1, "", "IdsToTokens"], [115, 2, 1, "", "Params"], [115, 2, 1, "", "StringsToIds"], [115, 2, 1, "", "_StringsToIdsImpl"]], "lingvo.core.tokenizers.VocabFileTokenizer": [[115, 2, 1, "", "IdsToStrings"], [115, 2, 1, "", "Params"], [115, 2, 1, "", "_CheckParams"], [115, 2, 1, "", "_StringsToIdsImpl"], [115, 3, 1, "", "_vocab_file_params"]], "lingvo.core.tokenizers.WpmTokenizer": [[115, 2, 1, "", "IdsToStrings"], [115, 2, 1, "", "Params"], [115, 2, 1, "", "_StringsToIdsImpl"]], "lingvo.core.tpu_embedding_layers": [[116, 1, 1, "", "TPUEmbeddingAdagradOptimizer"], [116, 1, 1, "", "TPUEmbeddingAdamOptimizer"], [116, 1, 1, "", "TPUEmbeddingFTRLOptimizer"], [116, 1, 1, "", "TPUEmbeddingLayer"], [116, 1, 1, "", "TPUEmbeddingSGDOptimizer"], [116, 1, 1, "", "TPUEmbeddingTable"], [116, 1, 1, "", "TpuEmbeddingCollection"], [116, 6, 1, "", "_IsTpuTraining"], [116, 6, 1, "", "_RemovePrivateVar"], [116, 1, 1, "", "_TPUEmbeddingOptimizer"]], "lingvo.core.tpu_embedding_layers.TPUEmbeddingAdagradOptimizer": [[116, 2, 1, "", "CreateOptimizerParameters"], [116, 2, 1, "", "CreateSlotVariablesAndOps"], [116, 2, 1, "", "Params"]], "lingvo.core.tpu_embedding_layers.TPUEmbeddingAdamOptimizer": [[116, 2, 1, "", "CreateOptimizerParameters"], [116, 2, 1, "", "CreateSlotVariablesAndOps"], [116, 2, 1, "", "Params"]], "lingvo.core.tpu_embedding_layers.TPUEmbeddingFTRLOptimizer": [[116, 2, 1, "", "CreateOptimizerParameters"], [116, 2, 1, "", "CreateSlotVariablesAndOps"], [116, 2, 1, "", "Params"]], "lingvo.core.tpu_embedding_layers.TPUEmbeddingLayer": [[116, 2, 1, "", "EmbLookup"], [116, 2, 1, "", "EmbLookupSparse"], [116, 2, 1, "", "GetAuxiliaryVariables"], [116, 2, 1, "", "GetIdsMap"], [116, 2, 1, "", "Params"], [116, 2, 1, "", "_CheckIdsMap"], [116, 2, 1, "", "_CheckTPUEmbeddingConfig"], [116, 2, 1, "", "_CreateLayerVariables"], [116, 2, 1, "", "_TpuEmbLookup"], [116, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.tpu_embedding_layers.TPUEmbeddingSGDOptimizer": [[116, 2, 1, "", "CreateOptimizerParameters"], [116, 2, 1, "", "CreateSlotVariablesAndOps"]], "lingvo.core.tpu_embedding_layers.TPUEmbeddingTable": [[116, 2, 1, "", "CpuEmbLookup"], [116, 2, 1, "", "CpuEmbLookupSparse"], [116, 2, 1, "", "CreateOptimizerSlotVariable"], [116, 2, 1, "", "GetDeviceName"], [116, 2, 1, "", "GetVariableName"], [116, 2, 1, "", "Params"], [116, 2, 1, "", "_CombinerEmbLookup"], [116, 2, 1, "", "_CreateLayerVariables"], [116, 2, 1, "", "_GetSelfVariablesDict"], [116, 2, 1, "", "_SequenceEmbLookup"], [116, 3, 1, "", "auxiliary_variables"], [116, 3, 1, "", "input_keys"], [116, 3, 1, "", "max_sequence_length"], [116, 3, 1, "", "table_config"], [116, 3, 1, "", "table_name"]], "lingvo.core.tpu_embedding_layers.TpuEmbeddingCollection": [[116, 2, 1, "", "AddActivations"], [116, 2, 1, "", "AddLoadRetrieveOps"], [116, 2, 1, "", "AddSummaryTensor"], [116, 2, 1, "", "AddTableVariables"], [116, 2, 1, "", "ApplyGradients"], [116, 2, 1, "", "Get"], [116, 2, 1, "", "GetActivations"], [116, 2, 1, "", "SetGradientMultiplierSchedule"], [116, 2, 1, "", "SetTaskMode"], [116, 2, 1, "", "ShouldStopGradient"], [116, 2, 1, "", "_ValidateTaskScope"], [116, 3, 1, "", "feature_names"], [116, 3, 1, "", "inference_with_bfloat16_var_names"], [116, 3, 1, "", "load_ops"], [116, 3, 1, "", "retrieve_ops"], [116, 3, 1, "", "summary_tensors"], [116, 3, 1, "", "table_variables"], [116, 3, 1, "", "tpu_embedding"]], "lingvo.core.tpu_embedding_layers._TPUEmbeddingOptimizer": [[116, 2, 1, "", "CreateOptimizerParameters"], [116, 2, 1, "", "CreateSlotVariablesAndOps"], [116, 2, 1, "", "Params"], [116, 2, 1, "", "_GetSelfVariablesDict"]], "lingvo.core.tpu_summary": [[117, 1, 1, "", "PwTpuSummaryTensor"], [117, 1, 1, "", "RewriteLoopContext"], [117, 1, 1, "", "TpuSummaryContext"], [117, 1, 1, "", "TpuSummaryScalar"], [117, 6, 1, "", "context"], [117, 6, 1, "", "merge_all"], [117, 6, 1, "", "merge_all_pw_tensor"], [117, 6, 1, "", "pw_tensor"], [117, 6, 1, "", "scalar"], [117, 6, 1, "", "tensor"]], "lingvo.core.tpu_summary.PwTpuSummaryTensor": [[117, 5, 1, "", "name"], [117, 5, 1, "", "name_scope"], [117, 5, 1, "", "value"]], "lingvo.core.tpu_summary.RewriteLoopContext": [[117, 2, 1, "", "while_loop"]], "lingvo.core.tpu_summary.TpuSummaryContext": [[117, 5, 1, "", "_global_stack"], [117, 2, 1, "", "current"]], "lingvo.core.tpu_summary.TpuSummaryScalar": [[117, 5, 1, "", "name"], [117, 5, 1, "", "name_scope"], [117, 5, 1, "", "value"], [117, 5, 1, "", "while_loop_reduce"]], "lingvo.core.trainer_test_utils": [[118, 1, 1, "", "CountingInputGenerator"], [118, 1, 1, "", "IdentityRegressionTask"], [118, 1, 1, "", "ModelTrackingFPropResults"], [118, 6, 1, "", "RegisterIdentityRegressionModel"]], "lingvo.core.trainer_test_utils.CountingInputGenerator": [[118, 2, 1, "", "Params"], [118, 2, 1, "", "_InputBatch"]], "lingvo.core.trainer_test_utils.IdentityRegressionTask": [[118, 2, 1, "", "ComputeLoss"], [118, 2, 1, "", "ComputePredictions"], [118, 2, 1, "", "CreateDecoderMetrics"], [118, 2, 1, "", "DecodeWithTheta"], [118, 2, 1, "", "FilterPerExampleTensors"], [118, 2, 1, "", "Params"], [118, 2, 1, "", "PostProcessDecodeOut"], [118, 2, 1, "", "ProcessFPropResults"], [118, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.trainer_test_utils.ModelTrackingFPropResults": [[118, 2, 1, "", "ProcessFPropResults"]], "lingvo.core.tshape": [[119, 1, 1, "", "Shape"]], "lingvo.core.tshape.Shape": [[119, 2, 1, "", "Subs"], [119, 2, 1, "", "ToTensorShape"], [119, 2, 1, "", "num_elements"], [119, 3, 1, "", "rank"], [119, 3, 1, "", "size"]], "lingvo.core.var_tmp_wrappers": [[120, 1, 1, "", "StackedVarWrapperWithManualSharding"], [120, 1, 1, "", "VarWrapperTrackAssign"]], "lingvo.core.var_tmp_wrappers.StackedVarWrapperWithManualSharding": [[120, 2, 1, "", "_to_auto"], [120, 2, 1, "", "_to_manual"], [120, 2, 1, "", "assign"], [120, 2, 1, "", "assign_add"], [120, 2, 1, "", "assign_sub"], [120, 3, 1, "", "raw_var"], [120, 2, 1, "", "read_value"], [120, 2, 1, "", "value"]], "lingvo.core.var_tmp_wrappers.VarWrapperTrackAssign": [[120, 2, 1, "", "assign"], [120, 2, 1, "", "assign_add"], [120, 2, 1, "", "assign_sub"], [120, 2, 1, "", "control_after_assigns"], [120, 2, 1, "", "previous_assigns"], [120, 3, 1, "", "raw_var"]], "lingvo.core.wpm_encoder": [[121, 1, 1, "", "WpmEncoder"]], "lingvo.core.wpm_encoder.WpmEncoder": [[121, 2, 1, "", "Decode"], [121, 2, 1, "", "Encode"], [121, 2, 1, "", "_EncodeToIds"], [121, 2, 1, "", "_MergeTokens"], [121, 2, 1, "", "_StringToToken"], [121, 2, 1, "", "_TokenToString"], [121, 3, 1, "", "sentence_end_id"], [121, 3, 1, "", "sentence_end_string"], [121, 3, 1, "", "sentence_start_id"], [121, 3, 1, "", "sentence_start_string"], [121, 3, 1, "", "unk_id"]], "lingvo.datasets": [[122, 4, 1, "", "DatasetFunctionError"], [122, 4, 1, "", "GetAllDatasetParamsNotImplementedError"], [122, 6, 1, "", "GetDatasets"], [122, 6, 1, "", "GetDatasetsAst"]], "lingvo.eager_runners": [[123, 1, 1, "", "Decoder"], [123, 1, 1, "", "Evaler"], [123, 1, 1, "", "Trainer"], [123, 6, 1, "", "_GetCheckpointIdForDecodeOut"]], "lingvo.eager_runners.Decoder": [[123, 2, 1, "", "GetDecodeOutPath"], [123, 2, 1, "", "Start"], [123, 2, 1, "", "_DecodeOnce"], [123, 2, 1, "", "_GetDecodeFunc"]], "lingvo.eager_runners.Evaler": [[123, 2, 1, "", "Start"], [123, 2, 1, "", "_EvalOnce"], [123, 2, 1, "", "_GetEvalFunc"]], "lingvo.eager_runners.TrainSummaries": [[123, 2, 1, "", "Start"]], "lingvo.eager_runners.Trainer": [[123, 2, 1, "", "Start"]], "lingvo.executor.ExecutorTpu": [[124, 2, 1, "", "Start"], [124, 2, 1, "", "_GetSession"], [124, 2, 1, "", "_Loop"], [124, 2, 1, "", "_MaybeConstructSharedModel"]], "lingvo.executor": [[124, 6, 1, "", "GetExecutorParams"], [124, 6, 1, "", "UnsetUnusedTrainParams"]], "lingvo.model_imports": [[126, 6, 1, "", "ImportAllParams"], [126, 6, 1, "", "ImportParams"], [126, 6, 1, "", "_Import"], [126, 6, 1, "", "_InsertParams"]], "lingvo.model_registry": [[127, 6, 1, "", "GetAllRegisteredClasses"], [127, 6, 1, "", "GetClass"], [127, 6, 1, "", "GetParams"], [127, 6, 1, "", "GetProgramSchedule"], [127, 6, 1, "", "RegisterMultiTaskModel"], [127, 6, 1, "", "RegisterSingleTaskModel"], [127, 1, 1, "", "_ModelRegistryHelper"]], "lingvo.model_registry._ModelRegistryHelper": [[127, 2, 1, "", "GetAllRegisteredClasses"], [127, 2, 1, "", "GetClass"], [127, 2, 1, "", "GetParams"], [127, 2, 1, "", "GetParamsFromModelParamsObject"], [127, 2, 1, "", "GetProgramSchedule"], [127, 2, 1, "", "GetProgramScheduleFromModelParamsObject"], [127, 2, 1, "", "MaybeUpdateParamsFromFlags"], [127, 2, 1, "", "RegisterMultiTaskModel"], [127, 2, 1, "", "RegisterSingleTaskModel"], [127, 2, 1, "", "_ClassPathPrefix"], [127, 2, 1, "", "_CreateWrapperClass"], [127, 2, 1, "", "_GetSourceInfo"], [127, 5, 1, "", "_MODEL_PARAMS"], [127, 5, 1, "", "_MODEL_PARAMS_ALLOW_REDEF"], [127, 2, 1, "", "_ModelParamsClassKey"], [127, 5, 1, "", "_REGISTERED_MODULES"], [127, 2, 1, "", "_RegisterModel"]], "lingvo.models_test_helper": [[128, 1, 1, "", "BaseModelsTest"], [128, 6, 1, "", "TraverseLayer"], [128, 6, 1, "", "_StubOutCreateVariable"]], "lingvo.models_test_helper.BaseModelsTest": [[128, 2, 1, "", "CreateTestMethodsForAllRegisteredModels"], [128, 2, 1, "", "_ValidateEMA"], [128, 2, 1, "", "_testOneModelParams"], [128, 2, 1, "", "setUp"]], "lingvo.pdb_wrapper": [[129, 6, 1, "", "catch_post_mortem"]], "lingvo.runners.Controller": [[130, 2, 1, "", "Start"], [130, 2, 1, "", "StartEnqueueOp"], [130, 2, 1, "", "_Loop"], [130, 2, 1, "", "_SummarizeValue"]], "lingvo.runners": [[130, 1, 1, "", "Decoder"], [130, 1, 1, "", "Evaler"], [130, 6, 1, "", "GetDecoderDir"], [130, 6, 1, "", "StartShell"], [130, 1, 1, "", "Trainer"], [130, 6, 1, "", "_GetCheckpointIdForDecodeOut"]], "lingvo.runners.Decoder": [[130, 2, 1, "", "DecodeCheckpoint"], [130, 2, 1, "", "DecodeLatestCheckpoint"], [130, 2, 1, "", "GetCkptIdFromFile"], [130, 2, 1, "", "GetDecodeOutPath"], [130, 2, 1, "", "Start"], [130, 2, 1, "", "_Loop"], [130, 2, 1, "", "_RemoveScalarSummaries"]], "lingvo.runners.Evaler": [[130, 2, 1, "", "EvalCheckpoint"], [130, 2, 1, "", "EvalLatestCheckpoint"], [130, 2, 1, "", "Start"], [130, 2, 1, "", "_EvalOnce"], [130, 2, 1, "", "_Loop"], [130, 2, 1, "", "_RemoveScalarSummaries"]], "lingvo.runners.Trainer": [[130, 2, 1, "", "Start"], [130, 2, 1, "", "StartEnqueueOp"], [130, 2, 1, "", "_Loop"], [130, 2, 1, "", "_LoopEnqueue"], [130, 2, 1, "", "_SummarizeValue"]], "lingvo.runners.TrainerTpu": [[130, 2, 1, "", "Start"], [130, 2, 1, "", "StartEnqueueOp"], [130, 2, 1, "", "_CleanUp"], [130, 2, 1, "", "_GetSession"], [130, 2, 1, "", "_InfeedLoop"], [130, 2, 1, "", "_Loop"], [130, 2, 1, "", "_LoopEnqueue"], [130, 2, 1, "", "_OutfeedDequeueLoop"], [130, 2, 1, "", "_OutfeedEnqueue"], [130, 2, 1, "", "_SummarizeValue"]], "lingvo.tasks": [[132, 0, 0, "-", "asr"], [152, 0, 0, "-", "image"], [158, 0, 0, "-", "lm"], [171, 0, 0, "-", "milan"], [191, 0, 0, "-", "mt"], [207, 0, 0, "-", "punctuator"]], "lingvo.tasks.asr": [[133, 0, 0, "-", "contextualizer_base"], [134, 0, 0, "-", "decoder"], [135, 0, 0, "-", "decoder_metrics"], [136, 0, 0, "-", "decoder_utils"], [137, 0, 0, "-", "encoder"], [138, 0, 0, "-", "eos_normalization"], [139, 0, 0, "-", "frontend"], [140, 0, 0, "-", "fusion"], [141, 0, 0, "-", "input_generator"], [142, 0, 0, "-", "levenshtein_distance"], [143, 0, 0, "-", "metrics_calculator"], [144, 0, 0, "-", "model"], [145, 0, 0, "-", "model_test_input_generator"], [146, 0, 0, "-", "params"], [149, 0, 0, "-", "tools"]], "lingvo.tasks.asr.contextualizer_base": [[133, 1, 1, "", "ContextualizerBase"], [133, 1, 1, "", "NullContextualizer"]], "lingvo.tasks.asr.contextualizer_base.ContextualizerBase": [[133, 2, 1, "", "GetContextDim"], [133, 2, 1, "", "InitAttention"], [133, 2, 1, "", "QueryAttention"], [133, 2, 1, "", "SetContextMap"], [133, 2, 1, "", "ZeroAttention"]], "lingvo.tasks.asr.contextualizer_base.NullContextualizer": [[133, 2, 1, "", "GetContextDim"], [133, 2, 1, "", "InitAttention"], [133, 2, 1, "", "QueryAttention"], [133, 2, 1, "", "SetContextMap"], [133, 2, 1, "", "ZeroAttention"]], "lingvo.tasks.asr.decoder": [[134, 1, 1, "", "AsrDecoder"], [134, 1, 1, "", "AsrDecoderBase"], [134, 6, 1, "", "_NewTensorArray"], [134, 6, 1, "", "_ToTensorArray"]], "lingvo.tasks.asr.decoder.AsrDecoder": [[134, 2, 1, "", "AddAdditionalDecoderSummaries"], [134, 2, 1, "", "Params"], [134, 2, 1, "", "SingleDecodeStep"], [134, 2, 1, "", "_ComputeAttention"], [134, 2, 1, "", "_GetNumHypsForBeamSearch"], [134, 2, 1, "", "_InitBeamSearchStateCallback"], [134, 2, 1, "", "_PostBeamSearchStepCallback"], [134, 2, 1, "", "_PostProcessAttenProbsForBeamSearch"], [134, 2, 1, "", "_PreBeamSearchStepCallback"]], "lingvo.tasks.asr.decoder.AsrDecoderBase": [[134, 2, 1, "", "AddAdditionalDecoderSummaries"], [134, 2, 1, "", "BaseZeroState"], [134, 2, 1, "", "ComputeLoss"], [134, 2, 1, "", "ComputePredictions"], [134, 2, 1, "", "ComputePredictionsDynamic"], [134, 2, 1, "", "ComputePredictionsFunctional"], [134, 2, 1, "", "CreateTargetInfoMisc"], [134, 2, 1, "", "DecoderStepZeroState"], [134, 2, 1, "", "InitDecoder"], [134, 2, 1, "", "MiscZeroState"], [134, 2, 1, "", "Params"], [134, 2, 1, "", "PostStepDecoderStateUpdate"], [134, 1, 1, "", "SequenceOutTensorArrays"], [134, 2, 1, "", "SingleDecodeStep"], [134, 1, 1, "", "TargetInfo"], [134, 2, 1, "", "TargetsToBeFedAtCurrentDecodeStep"], [134, 2, 1, "", "UpdateTargetVocabSize"], [134, 2, 1, "", "_AddDecoderActivationsSummary"], [134, 2, 1, "", "_ApplyDropout"], [134, 2, 1, "", "_ComputeLogits"], [134, 2, 1, "", "_ComputeMetrics"], [134, 2, 1, "", "_CreateAtten"], [134, 2, 1, "", "_ExtractConfidenceFeatures"], [134, 2, 1, "", "_GetAttenContextDim"], [134, 2, 1, "", "_GetAttenProbsFromSequenceOutTensorArrays"], [134, 2, 1, "", "_GetEncoderPaddings"], [134, 2, 1, "", "_GetInitialSeqStateTensorArrays"], [134, 2, 1, "", "_GetInitialTargetInfo"], [134, 2, 1, "", "_GetNewAttenProbs"], [134, 2, 1, "", "_GetPredictionFromSequenceOutTensorArrays"], [134, 2, 1, "", "_InitAttention"], [134, 2, 1, "", "_InitBeamSearchStateCallback"], [134, 2, 1, "", "_PostBeamSearchStepCallback"], [134, 2, 1, "", "_PreBeamSearchStepCallback"], [134, 2, 1, "", "_UpdateSequenceOutTensorArrays"]], "lingvo.tasks.asr.decoder.AsrDecoderBase.SequenceOutTensorArrays": [[134, 2, 1, "", "_asdict"], [134, 5, 1, "", "_field_defaults"], [134, 5, 1, "", "_fields"], [134, 2, 1, "", "_make"], [134, 2, 1, "", "_replace"], [134, 5, 1, "", "atten_probs"], [134, 5, 1, "", "confidence_logits"], [134, 5, 1, "", "fusion"], [134, 5, 1, "", "logits"], [134, 5, 1, "", "misc"], [134, 5, 1, "", "rnn_outs"], [134, 5, 1, "", "step_outs"]], "lingvo.tasks.asr.decoder.AsrDecoderBase.TargetInfo": [[134, 2, 1, "", "_asdict"], [134, 5, 1, "", "_field_defaults"], [134, 5, 1, "", "_fields"], [134, 2, 1, "", "_make"], [134, 2, 1, "", "_replace"], [134, 5, 1, "", "emb"], [134, 5, 1, "", "id"], [134, 5, 1, "", "label"], [134, 5, 1, "", "misc"], [134, 5, 1, "", "padding"], [134, 5, 1, "", "weight"]], "lingvo.tasks.asr.decoder_metrics": [[135, 6, 1, "", "BeamSearchDecodeOutputToDecoderTopK"], [135, 1, 1, "", "DecoderMetrics"], [135, 5, 1, "", "DecoderTopK"]], "lingvo.tasks.asr.decoder_metrics.DecoderMetrics": [[135, 2, 1, "", "AddAdditionalDecoderMetricsToGraph"], [135, 2, 1, "", "ComputeMetrics"], [135, 2, 1, "", "ComputeNormalizedWER"], [135, 2, 1, "", "CreateMetrics"], [135, 2, 1, "", "DeTokenizeDecoderOuts"], [135, 2, 1, "", "FilterRealExamples"], [135, 2, 1, "", "GetTopK"], [135, 2, 1, "", "Params"], [135, 2, 1, "", "PostProcess"], [135, 2, 1, "", "PreparePostProcess"]], "lingvo.tasks.asr.decoder_utils": [[136, 6, 1, "", "ComputeWer"], [136, 6, 1, "", "EditDistance"], [136, 6, 1, "", "EditDistanceInIds"], [136, 6, 1, "", "FilterEpsilon"], [136, 6, 1, "", "FilterNoise"], [136, 6, 1, "", "SetRnnCellNodes"], [136, 6, 1, "", "Tokenize"], [136, 6, 1, "", "_IsSymbolOrPositive"]], "lingvo.tasks.asr.encoder": [[137, 1, 1, "", "AsrEncoder"], [137, 1, 1, "", "ConvLSTMBlock"]], "lingvo.tasks.asr.encoder.AsrEncoder": [[137, 2, 1, "", "CreateBidirectionalRNNParams"], [137, 2, 1, "", "CreateConvLstmLayerParams"], [137, 2, 1, "", "FProp"], [137, 2, 1, "", "FirstLstmLayerInputDimAndPadding"], [137, 2, 1, "", "Params"], [137, 3, 1, "", "_use_functional"], [137, 3, 1, "", "input_shape"], [137, 3, 1, "", "supports_streaming"], [137, 2, 1, "", "zero_state"]], "lingvo.tasks.asr.encoder.ConvLSTMBlock": [[137, 2, 1, "", "_asdict"], [137, 5, 1, "", "_field_defaults"], [137, 5, 1, "", "_fields"], [137, 2, 1, "", "_make"], [137, 2, 1, "", "_replace"], [137, 5, 1, "", "cnn"], [137, 5, 1, "", "rnn"]], "lingvo.tasks.asr.eos_normalization": [[138, 6, 1, "", "FillPaddingPos"], [138, 6, 1, "", "NormalizeTrailingEos"], [138, 6, 1, "", "NumpyNormalizeTrailingEos"]], "lingvo.tasks.asr.frontend": [[139, 1, 1, "", "AsrFrontendConfig"], [139, 1, 1, "", "BaseAsrFrontend"], [139, 1, 1, "", "MelAsrFrontend"], [139, 1, 1, "", "NullAsrFrontend"], [139, 6, 1, "", "_NextPowerOfTwo"]], "lingvo.tasks.asr.frontend.AsrFrontendConfig": [[139, 2, 1, "", "_asdict"], [139, 5, 1, "", "_field_defaults"], [139, 5, 1, "", "_fields"], [139, 2, 1, "", "_make"], [139, 2, 1, "", "_replace"], [139, 5, 1, "", "input_frame_ratio"], [139, 5, 1, "", "is_null"], [139, 5, 1, "", "output_dim"], [139, 5, 1, "", "src_pcm_sample_rate"], [139, 5, 1, "", "src_pcm_scale"], [139, 5, 1, "", "src_type"]], "lingvo.tasks.asr.frontend.BaseAsrFrontend": [[139, 2, 1, "", "FProp"], [139, 2, 1, "", "GetConfigFromParams"], [139, 3, 1, "", "config"]], "lingvo.tasks.asr.frontend.MelAsrFrontend": [[139, 2, 1, "", "FProp"], [139, 2, 1, "", "GetConfigFromParams"], [139, 2, 1, "", "Params"], [139, 2, 1, "", "_ApplyPreemphasis"], [139, 2, 1, "", "_CreateWindowFunction"], [139, 2, 1, "", "_FPropChunk"], [139, 2, 1, "", "_FPropDefault"], [139, 2, 1, "", "_GetMelPadding"], [139, 2, 1, "", "_MelSpectrogram"], [139, 2, 1, "", "_PadAndReshapeSpec"], [139, 2, 1, "", "_RemoveChannelDim"], [139, 2, 1, "", "_ReshapeToMono2D"], [139, 2, 1, "", "_StackSignal"], [139, 3, 1, "", "window_frame_size"], [139, 3, 1, "", "window_frame_step"]], "lingvo.tasks.asr.frontend.NullAsrFrontend": [[139, 2, 1, "", "FProp"], [139, 2, 1, "", "GetConfigFromParams"]], "lingvo.tasks.asr.fusion": [[140, 1, 1, "", "FusionBase"], [140, 1, 1, "", "NullFusion"]], "lingvo.tasks.asr.fusion.FusionBase": [[140, 2, 1, "", "AddAdditionalDecoderSummaries"], [140, 2, 1, "", "ComputeLogitsWithLM"], [140, 2, 1, "", "FProp"], [140, 2, 1, "", "Params"], [140, 2, 1, "", "_FPropLm"], [140, 2, 1, "", "_FPropLmInternal"], [140, 2, 1, "", "_ModifyLmBeforeFProp"], [140, 2, 1, "", "_child_variable_scope_override"], [140, 2, 1, "", "zero_state"]], "lingvo.tasks.asr.fusion.NullFusion": [[140, 2, 1, "", "ComputeLogitsWithLM"], [140, 2, 1, "", "FProp"]], "lingvo.tasks.asr.input_generator": [[141, 1, 1, "", "AsrInput"]], "lingvo.tasks.asr.input_generator.AsrInput": [[141, 2, 1, "", "BuildInputBatch"], [141, 2, 1, "", "Params"], [141, 2, 1, "", "_DataSourceFromFilePattern"], [141, 2, 1, "", "_MaybePadSourceInputs"]], "lingvo.tasks.asr.levenshtein_distance": [[142, 1, 1, "", "ErrorStats"], [142, 6, 1, "", "LevenshteinDistance"]], "lingvo.tasks.asr.metrics_calculator": [[143, 6, 1, "", "CalculateMetrics"], [143, 6, 1, "", "GetRefIds"], [143, 5, 1, "", "PostProcessInputs"]], "lingvo.tasks.asr.model": [[144, 1, 1, "", "AsrModel"]], "lingvo.tasks.asr.model.AsrModel": [[144, 2, 1, "", "ComputeLoss"], [144, 2, 1, "", "ComputePredictions"], [144, 2, 1, "", "CreateDecoderMetrics"], [144, 2, 1, "", "DecodeWithTheta"], [144, 2, 1, "", "FrontendAndEncoderFProp"], [144, 2, 1, "", "Inference"], [144, 2, 1, "", "Params"], [144, 2, 1, "", "PostProcessDecodeOut"], [144, 2, 1, "", "ProgramSchedule"], [144, 2, 1, "", "_ComputeDecoderMetrics"], [144, 2, 1, "", "_ComputeNormalizedWER"], [144, 2, 1, "", "_DecoderMetricsParams"], [144, 2, 1, "", "_GetDecoderTargets"], [144, 2, 1, "", "_GetTargetForDecoderMetrics"], [144, 2, 1, "", "_GetTopK"], [144, 2, 1, "", "_InferenceSubgraph_Default"], [144, 2, 1, "", "_MakeDecoderTheta"]], "lingvo.tasks.asr.model_test_input_generator": [[145, 1, 1, "", "TestInputGenerator"]], "lingvo.tasks.asr.model_test_input_generator.TestInputGenerator": [[145, 2, 1, "", "GetBpropParams"], [145, 2, 1, "", "GetBpropType"], [145, 2, 1, "", "GlobalBatchSize"], [145, 2, 1, "", "Params"], [145, 2, 1, "", "SampleIds"], [145, 2, 1, "", "SetBpropType"], [145, 2, 1, "", "_GetSourceInputsAndLabels"], [145, 2, 1, "", "_InputBatch"], [145, 2, 1, "", "_Sources"], [145, 2, 1, "", "_Targets"], [145, 2, 1, "", "_check_paddings"]], "lingvo.tasks.asr.params": [[147, 0, 0, "-", "librispeech"], [148, 0, 0, "-", "params"]], "lingvo.tasks.asr.params.librispeech": [[147, 1, 1, "", "Librispeech960Base"], [147, 1, 1, "", "Librispeech960Grapheme"], [147, 1, 1, "", "Librispeech960GraphemeTpuV2"], [147, 1, 1, "", "Librispeech960Wpm"], [147, 1, 1, "", "Librispeech960WpmTpuV2"]], "lingvo.tasks.asr.params.librispeech.Librispeech960Base": [[147, 2, 1, "", "Dev"], [147, 2, 1, "", "Devother"], [147, 2, 1, "", "ProgramSchedule"], [147, 2, 1, "", "SetBucketSizes"], [147, 2, 1, "", "Task"], [147, 2, 1, "", "Test"], [147, 2, 1, "", "Testother"], [147, 2, 1, "", "Train"], [147, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.asr.params.librispeech.Librispeech960Grapheme": [[147, 2, 1, "", "Dev"], [147, 2, 1, "", "Devother"], [147, 5, 1, "", "GRAPHEME_TARGET_SEQUENCE_LENGTH"], [147, 5, 1, "", "GRAPHEME_VOCAB_SIZE"], [147, 2, 1, "", "InitializeTokenizer"], [147, 2, 1, "", "Task"], [147, 2, 1, "", "Test"], [147, 2, 1, "", "Testother"], [147, 2, 1, "", "Train"]], "lingvo.tasks.asr.params.librispeech.Librispeech960GraphemeTpuV2": [[147, 2, 1, "", "Task"], [147, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.asr.params.librispeech.Librispeech960Wpm": [[147, 2, 1, "", "Dev"], [147, 2, 1, "", "Devother"], [147, 5, 1, "", "EMBEDDING_DIMENSION"], [147, 2, 1, "", "InitializeTokenizer"], [147, 5, 1, "", "NUM_TRAINING_WORKERS"], [147, 2, 1, "", "Task"], [147, 2, 1, "", "Test"], [147, 2, 1, "", "Testother"], [147, 2, 1, "", "Train"], [147, 5, 1, "", "WPM_SYMBOL_TABLE_FILEPATH"], [147, 5, 1, "", "WPM_TARGET_SEQUENCE_LENGTH"], [147, 5, 1, "", "WPM_VOCAB_SIZE"]], "lingvo.tasks.asr.params.librispeech.Librispeech960WpmTpuV2": [[147, 2, 1, "", "Task"], [147, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.asr.tools": [[150, 0, 0, "-", "simple_wer"], [151, 0, 0, "-", "simple_wer_v2"]], "lingvo.tasks.asr.tools.simple_wer": [[150, 6, 1, "", "AverageWERs"], [150, 6, 1, "", "ComputeEditDistanceMatrix"], [150, 6, 1, "", "ComputeWER"], [150, 6, 1, "", "GenerateSummaryFromErrs"], [150, 6, 1, "", "PreprocessTxtBeforeWER"], [150, 6, 1, "", "_GenerateAlignedHtml"], [150, 6, 1, "", "main"]], "lingvo.tasks.asr.tools.simple_wer_v2": [[151, 6, 1, "", "ComputeEditDistanceMatrix"], [151, 6, 1, "", "HighlightAlignedHtml"], [151, 6, 1, "", "RemoveCommentTxtPreprocess"], [151, 1, 1, "", "SimpleWER"], [151, 6, 1, "", "TxtPreprocess"], [151, 6, 1, "", "main"]], "lingvo.tasks.asr.tools.simple_wer_v2.SimpleWER": [[151, 2, 1, "", "AddHypRef"], [151, 2, 1, "", "GetBreakdownWER"], [151, 2, 1, "", "GetKeyPhraseStats"], [151, 2, 1, "", "GetSummaries"], [151, 2, 1, "", "GetWER"], [151, 5, 1, "", "aligned_htmls"], [151, 5, 1, "", "hyp_keyphrase_counts"], [151, 5, 1, "", "key_phrases"], [151, 5, 1, "", "matched_keyphrase_counts"], [151, 5, 1, "", "ref_keyphrase_counts"], [151, 5, 1, "", "wer_info"]], "lingvo.tasks.image": [[153, 0, 0, "-", "classifier"], [154, 0, 0, "-", "input_generator"], [155, 0, 0, "-", "params"]], "lingvo.tasks.image.classifier": [[153, 1, 1, "", "BaseClassifier"], [153, 1, 1, "", "ModelV1"], [153, 1, 1, "", "ModelV2"], [153, 6, 1, "", "TopKAccuracy"]], "lingvo.tasks.image.classifier.BaseClassifier": [[153, 2, 1, "", "Params"], [153, 2, 1, "", "_Accuracy"], [153, 2, 1, "", "_AddSummary"]], "lingvo.tasks.image.classifier.ModelV1": [[153, 2, 1, "", "CreateDecoderMetrics"], [153, 2, 1, "", "Decode"], [153, 2, 1, "", "FPropTower"], [153, 2, 1, "", "Params"], [153, 2, 1, "", "PostProcessDecodeOut"]], "lingvo.tasks.image.classifier.ModelV2": [[153, 2, 1, "", "ComputeLoss"], [153, 2, 1, "", "ComputePredictions"], [153, 2, 1, "", "DecodeWithTheta"], [153, 2, 1, "", "Inference"], [153, 2, 1, "", "Params"], [153, 2, 1, "", "_InferenceSubgraph_Default"]], "lingvo.tasks.image.input_generator": [[154, 6, 1, "", "FakeMnistData"], [154, 1, 1, "", "MnistTestInput"], [154, 1, 1, "", "MnistTrainInput"], [154, 6, 1, "", "_GetRandomImages"], [154, 6, 1, "", "_GetRandomLabels"], [154, 1, 1, "", "_MnistInputBase"]], "lingvo.tasks.image.input_generator.MnistTestInput": [[154, 2, 1, "", "Params"]], "lingvo.tasks.image.input_generator.MnistTrainInput": [[154, 2, 1, "", "Params"]], "lingvo.tasks.image.input_generator._MnistInputBase": [[154, 2, 1, "", "Params"], [154, 2, 1, "", "_Preprocess"]], "lingvo.tasks.image.params": [[156, 0, 0, "-", "mnist"], [157, 0, 0, "-", "params"]], "lingvo.tasks.image.params.mnist": [[156, 1, 1, "", "Base"], [156, 1, 1, "", "LeNet5"]], "lingvo.tasks.image.params.mnist.Base": [[156, 2, 1, "", "Dev"], [156, 2, 1, "", "Test"], [156, 2, 1, "", "Train"], [156, 3, 1, "", "path"]], "lingvo.tasks.image.params.mnist.LeNet5": [[156, 5, 1, "", "BN"], [156, 5, 1, "", "DROP"], [156, 2, 1, "", "Task"]], "lingvo.tasks.lm": [[159, 0, 0, "-", "input_generator"], [160, 0, 0, "-", "layers"], [161, 0, 0, "-", "model"], [162, 0, 0, "-", "params"], [167, 0, 0, "-", "tokenizer"], [168, 0, 0, "-", "tools"]], "lingvo.tasks.lm.input_generator": [[159, 1, 1, "", "LmInput"], [159, 1, 1, "", "PackedTextInputGenerator"], [159, 1, 1, "", "TFRecordBertInput"]], "lingvo.tasks.lm.input_generator.LmInput": [[159, 2, 1, "", "BuildInputBatch"], [159, 2, 1, "", "Params"], [159, 2, 1, "", "_DataSourceFromFilePattern"]], "lingvo.tasks.lm.input_generator.PackedTextInputGenerator": [[159, 2, 1, "", "Initialize"], [159, 2, 1, "", "Params"], [159, 2, 1, "", "Reset"], [159, 2, 1, "", "_DatasetOfExamples"], [159, 2, 1, "", "_GetPaddingValues"], [159, 2, 1, "", "_InputBatch"], [159, 2, 1, "", "_Pack"], [159, 2, 1, "", "_ProcessSingleExample"]], "lingvo.tasks.lm.input_generator.TFRecordBertInput": [[159, 2, 1, "", "Initialize"], [159, 2, 1, "", "Params"], [159, 2, 1, "", "Reset"], [159, 2, 1, "", "_InputBatch"], [159, 2, 1, "", "_Pack"], [159, 2, 1, "", "_PadToBatchSize"], [159, 2, 1, "", "_ParseRecord"]], "lingvo.tasks.lm.layers": [[160, 1, 1, "", "BaseLanguageModel"], [160, 6, 1, "", "ComputeXentOutput"], [160, 1, 1, "", "ConditionalRnnLm"], [160, 1, 1, "", "GPipeTransformerLm"], [160, 1, 1, "", "MoeLm"], [160, 1, 1, "", "NullLm"], [160, 1, 1, "", "RnnLm"], [160, 1, 1, "", "RnnLmNoEmbedding"], [160, 1, 1, "", "TransformerLm"], [160, 1, 1, "", "TransformerLmNoEmbedding"], [160, 6, 1, "", "_RnnOutputSize"]], "lingvo.tasks.lm.layers.BaseLanguageModel": [[160, 2, 1, "", "CombineStates"], [160, 2, 1, "", "FProp"], [160, 2, 1, "", "GetFeedDict"], [160, 2, 1, "", "Logits"], [160, 2, 1, "", "Params"], [160, 2, 1, "", "Step"], [160, 2, 1, "", "StepOutputDimension"], [160, 2, 1, "", "UpdateTargetVocabSize"], [160, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.layers.ConditionalRnnLm": [[160, 2, 1, "", "FProp"], [160, 2, 1, "", "Params"]], "lingvo.tasks.lm.layers.GPipeTransformerLm": [[160, 2, 1, "", "CommonParams"], [160, 2, 1, "", "FProp"], [160, 2, 1, "", "Params"], [160, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.layers.MoeLm": [[160, 2, 1, "", "FProp"], [160, 2, 1, "", "Params"], [160, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.layers.NullLm": [[160, 2, 1, "", "CombineStates"], [160, 2, 1, "", "FProp"], [160, 2, 1, "", "Logits"], [160, 2, 1, "", "Step"], [160, 2, 1, "", "StepOutputDimension"], [160, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.layers.RnnLm": [[160, 2, 1, "", "CommonParams"], [160, 2, 1, "", "FProp"], [160, 2, 1, "", "Params"], [160, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.layers.RnnLmNoEmbedding": [[160, 2, 1, "", "CombineStates"], [160, 2, 1, "", "FProp"], [160, 2, 1, "", "Params"], [160, 2, 1, "", "Step"], [160, 2, 1, "", "StepOutputDimension"], [160, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.layers.TransformerLm": [[160, 2, 1, "", "CommonParams"], [160, 2, 1, "", "FProp"], [160, 2, 1, "", "Params"]], "lingvo.tasks.lm.layers.TransformerLmNoEmbedding": [[160, 2, 1, "", "FProp"], [160, 2, 1, "", "Params"], [160, 2, 1, "", "Step"], [160, 2, 1, "", "StepOutputDimension"], [160, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.model": [[161, 1, 1, "", "BatchMajorLanguageModel"], [161, 1, 1, "", "FixedShapeInputLanguageModel"], [161, 1, 1, "", "LanguageModel"], [161, 1, 1, "", "PackedBatchMajorLanguageModel"]], "lingvo.tasks.lm.model.BatchMajorLanguageModel": [[161, 2, 1, "", "FPropTower"], [161, 2, 1, "", "_InferenceSubgraph_Default"], [161, 2, 1, "", "_TrimIfPossible"]], "lingvo.tasks.lm.model.FixedShapeInputLanguageModel": [[161, 2, 1, "", "_TrimIfPossibleThenTranspose"]], "lingvo.tasks.lm.model.LanguageModel": [[161, 2, 1, "", "AdjustGradients"], [161, 2, 1, "", "ComputeLoss"], [161, 2, 1, "", "ComputePredictions"], [161, 2, 1, "", "FPropTower"], [161, 2, 1, "", "Inference"], [161, 2, 1, "", "Params"], [161, 2, 1, "", "UpdateTargetVocabSize"], [161, 2, 1, "", "_InferenceSubgraph_Default"], [161, 2, 1, "", "_TrimIfPossibleThenTranspose"]], "lingvo.tasks.lm.model.PackedBatchMajorLanguageModel": [[161, 2, 1, "", "FPropTower"], [161, 2, 1, "", "Inference"], [161, 2, 1, "", "Params"], [161, 2, 1, "", "_InferenceSubgraph_Default"]], "lingvo.tasks.lm.params": [[163, 0, 0, "-", "one_billion_wds"], [164, 0, 0, "-", "params"], [165, 0, 0, "-", "synthetic_packed_input"], [166, 0, 0, "-", "wiki_bert"]], "lingvo.tasks.lm.params.one_billion_wds": [[163, 1, 1, "", "OneBWdsGPipeTransformerWPM"], [163, 1, 1, "", "WordLevelOneBwdsBase"], [163, 1, 1, "", "WordLevelOneBwdsSimpleSampledSoftmax"], [163, 1, 1, "", "WordLevelOneBwdsSimpleSampledSoftmaxTiny"]], "lingvo.tasks.lm.params.one_billion_wds.OneBWdsGPipeTransformerWPM": [[163, 5, 1, "", "BATCH_SIZE"], [163, 2, 1, "", "Dev"], [163, 5, 1, "", "EMBEDDING_DIM"], [163, 5, 1, "", "GPUS"], [163, 5, 1, "", "LAYERS"], [163, 5, 1, "", "MAX_TOKENS"], [163, 5, 1, "", "NUM_MICRO_BATCHES"], [163, 5, 1, "", "SPLITS"], [163, 2, 1, "", "Task"], [163, 2, 1, "", "Test"], [163, 2, 1, "", "Train"], [163, 5, 1, "", "VOCAB_SIZE"]], "lingvo.tasks.lm.params.one_billion_wds.WordLevelOneBwdsBase": [[163, 5, 1, "", "CORPUS_DIR"], [163, 2, 1, "", "Dev"], [163, 5, 1, "", "EMBEDDING_DIM"], [163, 5, 1, "", "MAX_TOKENS"], [163, 5, 1, "", "NUM_EMBEDDING_SHARDS"], [163, 5, 1, "", "NUM_SAMPLED"], [163, 5, 1, "", "NUM_SOFTMAX_SHARDS"], [163, 5, 1, "", "RNN_STATE_DIM"], [163, 2, 1, "", "Task"], [163, 2, 1, "", "Test"], [163, 2, 1, "", "Train"], [163, 5, 1, "", "VOCAB_SIZE"], [163, 5, 1, "", "WORD_VOCAB"]], "lingvo.tasks.lm.params.one_billion_wds.WordLevelOneBwdsSimpleSampledSoftmax": [[163, 2, 1, "", "Task"]], "lingvo.tasks.lm.params.one_billion_wds.WordLevelOneBwdsSimpleSampledSoftmaxTiny": [[163, 5, 1, "", "EMBEDDING_DIM"], [163, 5, 1, "", "MAX_TOKENS"], [163, 5, 1, "", "NUM_EMBEDDING_SHARDS"], [163, 5, 1, "", "NUM_SAMPLED"], [163, 5, 1, "", "NUM_SOFTMAX_SHARDS"], [163, 5, 1, "", "RNN_STATE_DIM"]], "lingvo.tasks.lm.params.synthetic_packed_input": [[165, 1, 1, "", "DenseLM13B32x32"], [165, 1, 1, "", "DenseLm128B16x16"], [165, 1, 1, "", "DenseLm128B32x32"], [165, 1, 1, "", "DenseLm128B8x8"], [165, 1, 1, "", "DenseLm12kWide162BAdam16x16"], [165, 1, 1, "", "DenseLm12kWide162BAdam32x32"], [165, 1, 1, "", "DenseLm12kWide162BAdamBS25616x16"], [165, 1, 1, "", "DenseLm12kWide41BAdam16x16"], [165, 1, 1, "", "DenseLm12kWide41BAdam8x8"], [165, 1, 1, "", "DenseLm175B1K"], [165, 1, 1, "", "DenseLm175B32x32"], [165, 1, 1, "", "DenseLm175B32x32DP"], [165, 1, 1, "", "DenseLm175B8x8Decode2D"], [165, 1, 1, "", "DenseLm1T16x16"], [165, 1, 1, "", "DenseLm8B2x2"], [165, 1, 1, "", "DenseLm8B2x2Decode"], [165, 1, 1, "", "DenseLmTemplate"], [165, 1, 1, "", "ShardedAdam"], [165, 1, 1, "", "ShardedAdamOptimizer"], [165, 1, 1, "", "SyntheticTrain"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLM13B32x32": [[165, 5, 1, "", "HIDDEN_DIM"], [165, 5, 1, "", "MODEL_DIM"], [165, 5, 1, "", "NUM_HEADS"], [165, 5, 1, "", "NUM_TRANSFORMER_LAYERS"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm128B16x16": [[165, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [165, 5, 1, "", "DEVICE_MESH"], [165, 5, 1, "", "DEVICE_MESH_SHAPE"], [165, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [165, 5, 1, "", "SEQUENCE_LENGTH"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm128B32x32": [[165, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [165, 5, 1, "", "DEVICE_MESH"], [165, 5, 1, "", "DEVICE_MESH_SHAPE"], [165, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [165, 5, 1, "", "SEQUENCE_LENGTH"], [165, 5, 1, "", "TRAIN_STEPS_PER_LOOP"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm128B8x8": [[165, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [165, 5, 1, "", "DEVICE_MESH"], [165, 5, 1, "", "DEVICE_MESH_SHAPE"], [165, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [165, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [165, 5, 1, "", "SEQUENCE_LENGTH"], [165, 2, 1, "", "Task"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm12kWide162BAdam16x16": [[165, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [165, 5, 1, "", "DEVICE_MESH"], [165, 5, 1, "", "DEVICE_MESH_SHAPE"], [165, 5, 1, "", "NUM_TRANSFORMER_LAYERS"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm12kWide162BAdam32x32": [[165, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [165, 5, 1, "", "DEVICE_MESH"], [165, 5, 1, "", "DEVICE_MESH_SHAPE"], [165, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [165, 5, 1, "", "TRAIN_STEPS_PER_LOOP"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm12kWide162BAdamBS25616x16": [[165, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [165, 5, 1, "", "NUM_MICRO_BATCHES"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm12kWide41BAdam16x16": [[165, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [165, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [165, 5, 1, "", "DEVICE_MESH"], [165, 5, 1, "", "DEVICE_MESH_SHAPE"], [165, 5, 1, "", "GATED_GELU"], [165, 5, 1, "", "HIDDEN_DIM"], [165, 5, 1, "", "MODEL_DIM"], [165, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [165, 5, 1, "", "NUM_HEADS"], [165, 5, 1, "", "NUM_MICRO_BATCHES"], [165, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [165, 5, 1, "", "POSITIONAL_EMBEDDING"], [165, 5, 1, "", "SEQUENCE_LENGTH"], [165, 2, 1, "", "Task"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm12kWide41BAdam8x8": [[165, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [165, 5, 1, "", "DEVICE_MESH"], [165, 5, 1, "", "DEVICE_MESH_SHAPE"], [165, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [165, 5, 1, "", "NUM_MICRO_BATCHES"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm175B1K": [[165, 5, 1, "", "DEVICE_MESH"], [165, 5, 1, "", "DEVICE_MESH_SHAPE"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm175B32x32": [[165, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [165, 5, 1, "", "ATTEN_LOGIT_CAP"], [165, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [165, 5, 1, "", "DEVICE_MESH"], [165, 5, 1, "", "DEVICE_MESH_SHAPE"], [165, 5, 1, "", "GATED_GELU"], [165, 5, 1, "", "HIDDEN_DIM"], [165, 5, 1, "", "MODEL_DIM"], [165, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [165, 5, 1, "", "NUM_HEADS"], [165, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [165, 5, 1, "", "POSITIONAL_EMBEDDING"], [165, 5, 1, "", "SEQUENCE_LENGTH"], [165, 5, 1, "", "USE_REPEAT_LAYER"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm175B32x32DP": [[165, 5, 1, "", "DEVICE_MESH"], [165, 5, 1, "", "DEVICE_MESH_SHAPE"], [165, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"], [165, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [165, 5, 1, "", "TRAIN_STEPS_PER_LOOP"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm175B8x8Decode2D": [[165, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [165, 5, 1, "", "DEVICE_MESH"], [165, 5, 1, "", "DEVICE_MESH_SHAPE"], [165, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [165, 2, 1, "", "Task"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm1T16x16": [[165, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [165, 5, 1, "", "HIDDEN_DIM"], [165, 5, 1, "", "MODEL_DIM"], [165, 5, 1, "", "NUM_HEADS"], [165, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [165, 5, 1, "", "SEQUENCE_LENGTH"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm8B2x2": [[165, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [165, 5, 1, "", "DEVICE_MESH"], [165, 5, 1, "", "DEVICE_MESH_SHAPE"], [165, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [165, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [165, 5, 1, "", "SEQUENCE_LENGTH"], [165, 2, 1, "", "Task"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm8B2x2Decode": [[165, 2, 1, "", "Task"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLmTemplate": [[165, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [165, 5, 1, "", "ATTEN_LOGIT_CAP"], [165, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [165, 5, 1, "", "DEBUG"], [165, 5, 1, "", "DEVICE_MESH"], [165, 5, 1, "", "DEVICE_MESH_SHAPE"], [165, 5, 1, "", "GATED_GELU"], [165, 5, 1, "", "HIDDEN_DIM"], [165, 5, 1, "", "LABEL_SMOOTHING"], [165, 5, 1, "", "MODEL_DIM"], [165, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"], [165, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [165, 5, 1, "", "NUM_HEADS"], [165, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [165, 5, 1, "", "POSITIONAL_EMBEDDING"], [165, 2, 1, "", "ProgramSchedule"], [165, 5, 1, "", "SEQUENCE_LENGTH"], [165, 5, 1, "", "TRAIN_STEPS_PER_LOOP"], [165, 2, 1, "", "Task"], [165, 2, 1, "", "Train"], [165, 5, 1, "", "USE_REPEAT_LAYER"], [165, 5, 1, "", "VOCAB_SIZE"]], "lingvo.tasks.lm.params.synthetic_packed_input.ShardedAdam": [[165, 2, 1, "", "GetOptimizer"], [165, 2, 1, "", "Params"]], "lingvo.tasks.lm.params.synthetic_packed_input.ShardedAdamOptimizer": [[165, 2, 1, "", "_create_slots"]], "lingvo.tasks.lm.params.synthetic_packed_input.SyntheticTrain": [[165, 2, 1, "", "Params"], [165, 2, 1, "", "_InputBatch"]], "lingvo.tasks.lm.params.wiki_bert": [[166, 1, 1, "", "BertTemplate"], [166, 1, 1, "", "MLPerfBertDense13B32x32"], [166, 1, 1, "", "MLPerfBertDense175B"], [166, 1, 1, "", "MLPerfBertDense1T"], [166, 1, 1, "", "MLPerfBertDense1TWider"], [166, 1, 1, "", "MLPerfBertDense500B"], [166, 1, 1, "", "MLPerfBertDense500B2K"], [166, 1, 1, "", "MLPerfTrainBertDense2B"], [166, 1, 1, "", "MLPerfTrainTemplate"]], "lingvo.tasks.lm.params.wiki_bert.BertTemplate": [[166, 5, 1, "", "ATTENTION_DROPOUT_RATE"], [166, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [166, 5, 1, "", "ATTEN_LOGIT_CAP"], [166, 5, 1, "", "BATCH_SIZE"], [166, 5, 1, "", "BETA1"], [166, 5, 1, "", "DEBUG"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "DROPOUT_RATE"], [166, 5, 1, "", "GATED_FFN_ACT"], [166, 5, 1, "", "HIDDEN_DIM"], [166, 5, 1, "", "LABEL_SMOOTHING"], [166, 5, 1, "", "LOSS_DENOMINATOR"], [166, 5, 1, "", "MODEL_DIM"], [166, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"], [166, 5, 1, "", "NUM_HEADS"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [166, 5, 1, "", "POSITIONAL_EMBEDDING"], [166, 5, 1, "", "SEQUENCE_LENGTH"], [166, 5, 1, "", "TRAIN_EXES_PER_EVAL"], [166, 5, 1, "", "TRAIN_STEPS_PER_LOOP"], [166, 2, 1, "", "Task"], [166, 5, 1, "", "USE_REPEAT_LAYER"], [166, 5, 1, "", "VOCAB_SIZE"], [166, 5, 1, "", "WARMUP_STEPS"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfBertDense13B32x32": [[166, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [166, 5, 1, "", "BATCH_SIZE"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "GATED_GELU"], [166, 5, 1, "", "HIDDEN_DIM"], [166, 5, 1, "", "HIDDEN_DIM_RESHAPE_SEGMENTS"], [166, 5, 1, "", "LABEL_SMOOTHING"], [166, 5, 1, "", "MODEL_DIM"], [166, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"], [166, 5, 1, "", "NUM_HEADS"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [166, 5, 1, "", "POSITIONAL_EMBEDDING"], [166, 5, 1, "", "REMOVE_MASK"], [166, 5, 1, "", "TRAIN_EXES_PER_EVAL"], [166, 5, 1, "", "TRAIN_STEPS_PER_LOOP"], [166, 5, 1, "", "USE_REPEAT_LAYER"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfBertDense175B": [[166, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [166, 5, 1, "", "BATCH_SIZE"], [166, 5, 1, "", "HIDDEN_DIM"], [166, 5, 1, "", "MODEL_DIM"], [166, 5, 1, "", "NUM_HEADS"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [166, 5, 1, "", "POSITIONAL_EMBEDDING"], [166, 5, 1, "", "TRAIN_STEPS_PER_LOOP"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfBertDense1T": [[166, 5, 1, "", "BATCH_SIZE"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "HIDDEN_DIM"], [166, 5, 1, "", "HIDDEN_DIM_RESHAPE_SEGMENTS"], [166, 5, 1, "", "MODEL_DIM"], [166, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"], [166, 5, 1, "", "NUM_HEADS"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [166, 5, 1, "", "USE_REPEAT_LAYER"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfBertDense1TWider": [[166, 5, 1, "", "BATCH_SIZE"], [166, 5, 1, "", "HIDDEN_DIM"], [166, 5, 1, "", "MODEL_DIM"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfBertDense500B": [[166, 5, 1, "", "BATCH_SIZE"], [166, 5, 1, "", "LABEL_SMOOTHING"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [166, 5, 1, "", "POSITIONAL_EMBEDDING"], [166, 5, 1, "", "REMOVE_MASK"], [166, 5, 1, "", "TRAIN_EXES_PER_EVAL"], [166, 5, 1, "", "TRAIN_STEPS_PER_LOOP"], [166, 5, 1, "", "VOCAB_SIZE"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfBertDense500B2K": [[166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "HIDDEN_DIM_RESHAPE_SEGMENTS"], [166, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfTrainBertDense2B": [[166, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [166, 5, 1, "", "BATCH_SIZE"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "HIDDEN_DIM"], [166, 5, 1, "", "MODEL_DIM"], [166, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"], [166, 5, 1, "", "NUM_HEADS"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [166, 5, 1, "", "USE_REPEAT_LAYER"], [166, 5, 1, "", "VOCAB_SIZE"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfTrainTemplate": [[166, 2, 1, "", "ProgramSchedule"], [166, 2, 1, "", "Task"], [166, 2, 1, "", "Test"], [166, 2, 1, "", "Train"]], "lingvo.tasks.lm.tokenizer": [[167, 1, 1, "", "BertTokenizer"]], "lingvo.tasks.lm.tokenizer.BertTokenizer": [[167, 2, 1, "", "IdsToStrings"], [167, 2, 1, "", "Params"], [167, 2, 1, "", "_StringsToIdsImpl"]], "lingvo.tasks.lm.tools": [[169, 0, 0, "-", "download_lm1b"], [170, 0, 0, "-", "gshard_lm_decode"]], "lingvo.tasks.lm.tools.download_lm1b": [[169, 6, 1, "", "main"]], "lingvo.tasks.lm.tools.gshard_lm_decode": [[170, 1, 1, "", "GShardLMDecode"], [170, 1, 1, "", "GShardLMDecodeBatch"], [170, 6, 1, "", "main"], [170, 6, 1, "", "override_flags"], [170, 6, 1, "", "read_file_1_col"], [170, 6, 1, "", "read_files_1_col"]], "lingvo.tasks.lm.tools.gshard_lm_decode.GShardLMDecode": [[170, 2, 1, "", "decode_ids_to_string"], [170, 2, 1, "", "encode_string_to_ids"], [170, 2, 1, "", "ids_to_strings_packed"], [170, 2, 1, "", "init_vocab"], [170, 2, 1, "", "preload_lm_prompts"]], "lingvo.tasks.lm.tools.gshard_lm_decode.GShardLMDecodeBatch": [[170, 2, 1, "", "batch_decode"], [170, 2, 1, "", "preload_data"], [170, 2, 1, "", "write_ith_sample_to_output"]], "lingvo.tasks.milan": [[172, 0, 0, "-", "common_schema"], [173, 0, 0, "-", "constants"], [174, 0, 0, "-", "dataset_spec"], [175, 0, 0, "-", "dual_encoder"], [176, 0, 0, "-", "image_preprocessor"], [177, 0, 0, "-", "input_generator"], [178, 0, 0, "-", "labels"], [179, 0, 0, "-", "params"], [184, 0, 0, "-", "score_functions"], [185, 0, 0, "-", "tf_hub_layers"], [186, 0, 0, "-", "tools"], [188, 0, 0, "-", "tpu_utils"], [189, 0, 0, "-", "transformers"], [190, 0, 0, "-", "utils"]], "lingvo.tasks.milan.common_schema": [[172, 6, 1, "", "AudioFeatures"], [172, 6, 1, "", "ImageFeatures"], [172, 6, 1, "", "TextFeatures"], [172, 6, 1, "", "_Feature"]], "lingvo.tasks.milan.constants": [[173, 1, 1, "", "Modality"], [173, 1, 1, "", "Split"]], "lingvo.tasks.milan.constants.Modality": [[173, 5, 1, "", "AUDIO"], [173, 5, 1, "", "IMAGE"], [173, 5, 1, "", "TEXT"]], "lingvo.tasks.milan.constants.Split": [[173, 5, 1, "", "DEV"], [173, 5, 1, "", "TEST"], [173, 5, 1, "", "TRAIN"]], "lingvo.tasks.milan.dataset_spec": [[174, 1, 1, "", "DatasetSpec"], [174, 1, 1, "", "FileBasedDatasetSpec"], [174, 1, 1, "", "Metadata"], [174, 1, 1, "", "TFRecordDatasetSpec"]], "lingvo.tasks.milan.dataset_spec.DatasetSpec": [[174, 2, 1, "", "Label"], [174, 2, 1, "", "Read"], [174, 5, 1, "", "_abc_impl"], [174, 3, 1, "", "meta"]], "lingvo.tasks.milan.dataset_spec.FileBasedDatasetSpec": [[174, 2, 1, "", "Label"], [174, 2, 1, "", "Read"], [174, 5, 1, "", "_abc_impl"], [174, 3, 1, "", "meta"]], "lingvo.tasks.milan.dataset_spec.Metadata": [[174, 2, 1, "", "_InferDefaultBatchShapes"], [174, 5, 1, "", "features"]], "lingvo.tasks.milan.dataset_spec.TFRecordDatasetSpec": [[174, 5, 1, "", "_abc_impl"]], "lingvo.tasks.milan.dual_encoder": [[175, 1, 1, "", "DualEncoder"], [175, 6, 1, "", "EncoderConfig"], [175, 1, 1, "", "MilanTask"], [175, 6, 1, "", "_EncodeBatch"]], "lingvo.tasks.milan.dual_encoder.DualEncoder": [[175, 2, 1, "", "ComputeLoss"], [175, 2, 1, "", "ComputePredictions"], [175, 2, 1, "", "EncodeModality"], [175, 2, 1, "", "Params"], [175, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.milan.dual_encoder.MilanTask": [[175, 2, 1, "", "ComputeLoss"], [175, 2, 1, "", "ComputePredictions"], [175, 2, 1, "", "CreateDecoderMetrics"], [175, 2, 1, "", "Decode"], [175, 2, 1, "", "Params"]], "lingvo.tasks.milan.image_preprocessor": [[176, 1, 1, "", "ImagePreprocessor"], [176, 6, 1, "", "_DistortBrightnessAndColor"]], "lingvo.tasks.milan.image_preprocessor.ImagePreprocessor": [[176, 2, 1, "", "FProp"], [176, 2, 1, "", "Params"], [176, 2, 1, "", "_PreprocessForEval"], [176, 2, 1, "", "_PreprocessForTraining"]], "lingvo.tasks.milan.input_generator": [[177, 1, 1, "", "MilanInputGenerator"]], "lingvo.tasks.milan.input_generator.MilanInputGenerator": [[177, 2, 1, "", "GetPreprocessedInputBatch"], [177, 2, 1, "", "Params"], [177, 2, 1, "", "_FilterFeaturesByName"], [177, 2, 1, "", "_PreprocessInputBatch"]], "lingvo.tasks.milan.labels": [[178, 1, 1, "", "ExamplePairLabeler"], [178, 1, 1, "", "ExamplePairs"], [178, 1, 1, "", "MultiItemExampleWrapper"], [178, 6, 1, "", "MultiLabelContrastiveLoss"], [178, 6, 1, "", "_BroadcastExamplePairLabelsToAllItemPairs"], [178, 6, 1, "", "_IgnorePairsWhere"]], "lingvo.tasks.milan.labels.ExamplePairs": [[178, 2, 1, "", "BetweenLocalAndGlobalBatches"], [178, 2, 1, "", "WithinBatch"], [178, 5, 1, "", "correspondences"], [178, 5, 1, "", "query_batch_size"], [178, 5, 1, "", "query_modality"], [178, 5, 1, "", "result_batch_size"], [178, 5, 1, "", "result_modality"]], "lingvo.tasks.milan.params": [[180, 0, 0, "-", "cxc"], [181, 0, 0, "-", "dual_encoder_recipe"], [182, 0, 0, "-", "generic_datasets"], [183, 0, 0, "-", "params"]], "lingvo.tasks.milan.params.cxc": [[180, 1, 1, "", "EfficientNetB4BertAdapter"], [180, 1, 1, "", "_BaseImageTextRecipe"]], "lingvo.tasks.milan.params.cxc.EfficientNetB4BertAdapter": [[180, 3, 1, "", "default_dataset"]], "lingvo.tasks.milan.params.cxc._BaseImageTextRecipe": [[180, 2, 1, "", "AddBertAdapterTextEncoder"], [180, 2, 1, "", "AddEfficientNetB4ImageEncoder"]], "lingvo.tasks.milan.params.dual_encoder_recipe": [[181, 1, 1, "", "DualEncoderRecipe"], [181, 4, 1, "", "RecipeError"]], "lingvo.tasks.milan.params.dual_encoder_recipe.DualEncoderRecipe": [[181, 2, 1, "", "AddModality"], [181, 2, 1, "", "AddPreprocessor"], [181, 2, 1, "", "GetAllDatasetParams"], [181, 2, 1, "", "StartFromCheckpoint"], [181, 2, 1, "", "Task"], [181, 2, 1, "", "_ChooseDatasetSpec"], [181, 3, 1, "", "default_dataset"], [181, 3, 1, "", "encoder_configs"]], "lingvo.tasks.milan.params.generic_datasets": [[182, 1, 1, "", "ImageTextTFRecords"], [182, 6, 1, "", "_SimpleImageCaptionDatasetLabeler"]], "lingvo.tasks.milan.params.generic_datasets.ImageTextTFRecords": [[182, 2, 1, "", "Params"], [182, 2, 1, "", "ParamsFromEnv"], [182, 5, 1, "", "_abc_impl"]], "lingvo.tasks.milan.score_functions": [[184, 1, 1, "", "DotProductScoreFunction"]], "lingvo.tasks.milan.score_functions.DotProductScoreFunction": [[184, 2, 1, "", "FProp"], [184, 2, 1, "", "Params"]], "lingvo.tasks.milan.tf_hub_layers": [[185, 6, 1, "", "EfficientNetB4Params"], [185, 1, 1, "", "ImageModule"], [185, 1, 1, "", "ImageModuleV2"], [185, 6, 1, "", "_AddUpdateOpsToSignature"], [185, 6, 1, "", "_WrapNonLingvoVars"]], "lingvo.tasks.milan.tf_hub_layers.ImageModule": [[185, 2, 1, "", "FProp"], [185, 2, 1, "", "Params"], [185, 2, 1, "", "_CreateLayerVariables"], [185, 3, 1, "", "losses"]], "lingvo.tasks.milan.tf_hub_layers.ImageModuleV2": [[185, 2, 1, "", "FProp"], [185, 2, 1, "", "Params"], [185, 3, 1, "", "losses"]], "lingvo.tasks.milan.tools": [[187, 0, 0, "-", "prepare_coco"]], "lingvo.tasks.milan.tools.prepare_coco": [[187, 1, 1, "", "EncodeCaptionsFn"], [187, 1, 1, "", "ReadCocoFromTfdsFn"], [187, 1, 1, "", "TfHubBertEncoder"], [187, 6, 1, "", "dict_to_example_proto"], [187, 6, 1, "", "log"], [187, 6, 1, "", "main"]], "lingvo.tasks.milan.tools.prepare_coco.EncodeCaptionsFn": [[187, 2, 1, "", "process"], [187, 2, 1, "", "setup"]], "lingvo.tasks.milan.tools.prepare_coco.ReadCocoFromTfdsFn": [[187, 2, 1, "", "process"]], "lingvo.tasks.milan.tools.prepare_coco.TfHubBertEncoder": [[187, 2, 1, "", "FProp"], [187, 2, 1, "", "Params"]], "lingvo.tasks.milan.tpu_utils": [[188, 6, 1, "", "ConcatenateAcrossReplicas"], [188, 6, 1, "", "CrossReplicaConcat"]], "lingvo.tasks.milan.transformers": [[189, 6, 1, "", "GetTransformerStackWithEmbeddingInput"]], "lingvo.tasks.milan.utils": [[190, 1, 1, "", "BatchFlattener"], [190, 6, 1, "", "BatchMajorToTimeMajor"], [190, 6, 1, "", "CollectRegularizationLosses"], [190, 6, 1, "", "FlattenBatch"], [190, 6, 1, "", "GetFromNestedMapOrDie"], [190, 6, 1, "", "InferBatchSize"], [190, 6, 1, "", "MakeFnLayer"], [190, 6, 1, "", "PadOrTrimDimension"], [190, 6, 1, "", "ResolveBatchDim"], [190, 1, 1, "", "Selector"], [190, 6, 1, "", "UnflattenBatch"]], "lingvo.tasks.milan.utils.BatchFlattener": [[190, 2, 1, "", "Flatten"], [190, 2, 1, "", "Unflatten"], [190, 2, 1, "", "_GetFlatShape"], [190, 2, 1, "", "_PackAs"], [190, 3, 1, "", "batch_shape"]], "lingvo.tasks.mt": [[192, 0, 0, "-", "base_config"], [193, 0, 0, "-", "data_augmenter"], [194, 0, 0, "-", "decoder"], [195, 0, 0, "-", "encoder"], [196, 0, 0, "-", "input_generator"], [197, 0, 0, "-", "layers"], [198, 0, 0, "-", "model"], [199, 0, 0, "-", "params"], [205, 0, 0, "-", "text_input_pb2"], [206, 0, 0, "-", "tools"]], "lingvo.tasks.mt.base_config": [[192, 6, 1, "", "InitTestDatasetParams"], [192, 6, 1, "", "InitTrainDatasetParams"], [192, 6, 1, "", "InitTransformerTestBuckets"], [192, 6, 1, "", "InitTransformerTrainBuckets"], [192, 6, 1, "", "SetupRNMTParams"], [192, 6, 1, "", "SetupTransformerDecoder"], [192, 6, 1, "", "SetupTransformerEncoder"], [192, 6, 1, "", "SetupTransformerParams"], [192, 6, 1, "", "SetupXEnDecTransformerParams"]], "lingvo.tasks.mt.data_augmenter": [[193, 1, 1, "", "MASS"]], "lingvo.tasks.mt.data_augmenter.MASS": [[193, 2, 1, "", "Mask"], [193, 2, 1, "", "Params"]], "lingvo.tasks.mt.decoder": [[194, 1, 1, "", "InsertionDecoder"], [194, 1, 1, "", "MTBaseDecoder"], [194, 1, 1, "", "MTDecoderV1"], [194, 1, 1, "", "TransformerBatchMajorDecoder"], [194, 1, 1, "", "TransformerDecoder"], [194, 1, 1, "", "TransformerXDecoder"]], "lingvo.tasks.mt.decoder.InsertionDecoder": [[194, 2, 1, "", "ComputeLoss"], [194, 2, 1, "", "ComputePredictions"], [194, 2, 1, "", "Params"], [194, 2, 1, "", "UpdateTargetVocabSize"]], "lingvo.tasks.mt.decoder.MTBaseDecoder": [[194, 2, 1, "", "ComputeLoss"], [194, 2, 1, "", "Params"], [194, 2, 1, "", "UpdateTargetVocabSize"], [194, 2, 1, "", "_AddAttenProbsHistogramSummary"], [194, 2, 1, "", "_AddAttenProbsImageSummary"], [194, 2, 1, "", "_AddAttenProbsSummary"], [194, 2, 1, "", "_ComputeSoftmaxMetrics"], [194, 2, 1, "", "_ComputeXentLoss"], [194, 2, 1, "", "_ExpandToNumHyps"], [194, 2, 1, "", "_FPropSoftmax"], [194, 2, 1, "", "_TruncateTargetSequence"]], "lingvo.tasks.mt.decoder.MTDecoderV1": [[194, 2, 1, "", "AddExtraDecodingInfo"], [194, 2, 1, "", "ApplyClipping"], [194, 2, 1, "", "ApplyDropout"], [194, 2, 1, "", "ComputePredictions"], [194, 2, 1, "", "Params"], [194, 2, 1, "", "SampleSequenceDecode"], [194, 2, 1, "", "UpdateTargetVocabSize"], [194, 2, 1, "", "_CreateProjection"], [194, 2, 1, "", "_DecodeStep"], [194, 5, 1, "", "_FLOAT_DTYPE_MAX_SCALER"], [194, 2, 1, "", "_ForceAlignment"], [194, 2, 1, "", "_GetAttentionInitState"], [194, 2, 1, "", "_InitBeamSearchStateCallback"], [194, 2, 1, "", "_InitDecoder"], [194, 2, 1, "", "_PostBeamSearchStepCallback"], [194, 2, 1, "", "_PreBeamSearchStepCallback"], [194, 2, 1, "", "_SetAttentionInitState"], [194, 2, 1, "", "_UpdateLogitsForSingleTokenFastDecode"], [194, 2, 1, "", "_ZeroOutFirstTimeStep"], [194, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.mt.decoder.TransformerBatchMajorDecoder": [[194, 2, 1, "", "ComputeLoss"], [194, 2, 1, "", "ComputePredictions"], [194, 2, 1, "", "ExtendStep"], [194, 2, 1, "", "Params"], [194, 2, 1, "", "_FProp"], [194, 2, 1, "", "_FPropFastSoftmax"], [194, 2, 1, "", "_InitBeamSearchStateCallback"], [194, 2, 1, "", "_MaybeTransposeEncoderOutputs"], [194, 2, 1, "", "_MaybeTransposeTargets"], [194, 2, 1, "", "_PostBeamSearchStepCallback"], [194, 2, 1, "", "_PreBeamSearchStepCallback"], [194, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.mt.decoder.TransformerDecoder": [[194, 2, 1, "", "AddExtraDecodingInfo"], [194, 2, 1, "", "ComputePredictions"], [194, 2, 1, "", "ExtendStep"], [194, 2, 1, "", "Params"], [194, 2, 1, "", "SampleSequenceDecode"], [194, 2, 1, "", "_AddAttenProbsScalarSummary"], [194, 2, 1, "", "_AddAttenProbsSummary"], [194, 2, 1, "", "_FProp"], [194, 2, 1, "", "_InitBeamSearchStateCallback"], [194, 2, 1, "", "_PostBeamSearchStepCallback"], [194, 2, 1, "", "_PreBeamSearchStepCallback"], [194, 2, 1, "", "_RemoveEOSProbs"], [194, 2, 1, "", "_ZeroOutFirstTimeStep"], [194, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.mt.decoder.TransformerXDecoder": [[194, 2, 1, "", "ComputeLoss"], [194, 2, 1, "", "ComputePredictions"], [194, 2, 1, "", "Params"], [194, 2, 1, "", "_FProp"], [194, 2, 1, "", "_FPropSoftmax"]], "lingvo.tasks.mt.encoder": [[195, 1, 1, "", "MTEncoderBiRNN"], [195, 1, 1, "", "MTEncoderBiRNNPrecomputedEmbedding"], [195, 1, 1, "", "MTEncoderUniRNN"], [195, 1, 1, "", "MTEncoderV1"], [195, 1, 1, "", "TransformerBatchMajorEncoder"], [195, 1, 1, "", "TransformerEncoder"], [195, 1, 1, "", "TransformerXEncoder"]], "lingvo.tasks.mt.encoder.MTEncoderBiRNN": [[195, 2, 1, "", "ApplyClipping"], [195, 2, 1, "", "FProp"], [195, 2, 1, "", "Params"], [195, 2, 1, "", "_ComputeInputs"], [195, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.mt.encoder.MTEncoderBiRNNPrecomputedEmbedding": [[195, 2, 1, "", "_ComputeInputs"]], "lingvo.tasks.mt.encoder.MTEncoderUniRNN": [[195, 2, 1, "", "ApplyClipping"], [195, 2, 1, "", "FProp"], [195, 2, 1, "", "Params"], [195, 2, 1, "", "zero_state"]], "lingvo.tasks.mt.encoder.MTEncoderV1": [[195, 2, 1, "", "ApplyClipping"], [195, 2, 1, "", "FProp"], [195, 2, 1, "", "Params"]], "lingvo.tasks.mt.encoder.TransformerBatchMajorEncoder": [[195, 2, 1, "", "FProp"], [195, 2, 1, "", "Params"], [195, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.mt.encoder.TransformerEncoder": [[195, 2, 1, "", "FProp"], [195, 2, 1, "", "FPropFullSequence"], [195, 2, 1, "", "Params"], [195, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.mt.encoder.TransformerXEncoder": [[195, 2, 1, "", "FProp"]], "lingvo.tasks.mt.input_generator": [[196, 1, 1, "", "MlPerfInput"], [196, 1, 1, "", "NmtDoubleInput"], [196, 1, 1, "", "NmtInput"], [196, 1, 1, "", "TextPackedInput"], [196, 6, 1, "", "_GetDescriptorSetForTextInput"], [196, 6, 1, "", "_GetSegmentPos"]], "lingvo.tasks.mt.input_generator.MlPerfInput": [[196, 2, 1, "", "BuildInputBatch"], [196, 2, 1, "", "Params"], [196, 2, 1, "", "_DataSourceFromFilePattern"]], "lingvo.tasks.mt.input_generator.NmtDoubleInput": [[196, 2, 1, "", "BuildInputBatch"], [196, 2, 1, "", "Params"], [196, 2, 1, "", "_CreateSourceLambdas"], [196, 2, 1, "", "_DataSourceFromFilePattern"], [196, 2, 1, "", "_GenerateNoiseSents"], [196, 2, 1, "", "_MaskWords"], [196, 2, 1, "", "_Pack"], [196, 2, 1, "", "_ProcessBatch"], [196, 2, 1, "", "_SelectMaskPositions"], [196, 2, 1, "", "_ShuffleWords"]], "lingvo.tasks.mt.input_generator.NmtInput": [[196, 2, 1, "", "BuildInputBatch"], [196, 2, 1, "", "Params"], [196, 2, 1, "", "_DataSourceFromFilePattern"]], "lingvo.tasks.mt.input_generator.TextPackedInput": [[196, 2, 1, "", "Params"], [196, 2, 1, "", "_AddNoise"], [196, 2, 1, "", "_ApplyPacking"], [196, 2, 1, "", "_DataSourceFromFilePattern"], [196, 2, 1, "", "_GetBucketKey"], [196, 2, 1, "", "_GetLangIds"], [196, 2, 1, "", "_GetTaskIds"], [196, 2, 1, "", "_Pack"], [196, 2, 1, "", "_ProcessMASSInput"], [196, 2, 1, "", "_ProcessSingleInput"], [196, 2, 1, "", "_ReadRecordSentencePairProto"], [196, 2, 1, "", "_ReadRecordTsv"], [196, 2, 1, "", "_ReadRecordTsvSingleColumn"], [196, 2, 1, "", "_ScaledBatchSize"]], "lingvo.tasks.mt.layers": [[197, 1, 1, "", "TransformerStack"]], "lingvo.tasks.mt.layers.TransformerStack": [[197, 2, 1, "", "FProp"], [197, 2, 1, "", "Params"]], "lingvo.tasks.mt.model": [[198, 1, 1, "", "HybridModel"], [198, 1, 1, "", "InsertionModel"], [198, 1, 1, "", "MTBaseModel"], [198, 1, 1, "", "RNMTModel"], [198, 1, 1, "", "TransformerModel"], [198, 1, 1, "", "TransformerXEnDecModel"]], "lingvo.tasks.mt.model.HybridModel": [[198, 2, 1, "", "Params"]], "lingvo.tasks.mt.model.InsertionModel": [[198, 2, 1, "", "ComputePredictions"], [198, 2, 1, "", "Params"], [198, 2, 1, "", "_CreateCanvasAndTargets"], [198, 2, 1, "", "_SampleCanvasAndTargets"]], "lingvo.tasks.mt.model.MTBaseModel": [[198, 2, 1, "", "ComputeLoss"], [198, 2, 1, "", "ComputePredictions"], [198, 2, 1, "", "CreateDecoderMetrics"], [198, 2, 1, "", "Decode"], [198, 2, 1, "", "PostProcessDecodeOut"], [198, 2, 1, "", "_BeamSearchDecode"], [198, 2, 1, "", "_DecoderDevice"], [198, 2, 1, "", "_EncoderDevice"], [198, 2, 1, "", "_GetTokenizerKeyToUse"], [198, 2, 1, "", "_PostProcessBeamSearchDecodeOut"]], "lingvo.tasks.mt.model.RNMTModel": [[198, 2, 1, "", "Params"]], "lingvo.tasks.mt.model.TransformerModel": [[198, 2, 1, "", "Params"]], "lingvo.tasks.mt.model.TransformerXEnDecModel": [[198, 2, 1, "", "ComputeLoss"], [198, 2, 1, "", "ComputePredictions"], [198, 2, 1, "", "Params"], [198, 2, 1, "", "_CreateTargetLambdas"]], "lingvo.tasks.mt.params": [[200, 0, 0, "-", "params"], [201, 0, 0, "-", "wmt14_en_de"], [202, 0, 0, "-", "wmtm16_en_de"], [203, 0, 0, "-", "xendec"]], "lingvo.tasks.mt.params.wmt14_en_de": [[201, 1, 1, "", "WmtEnDeRNMT"], [201, 1, 1, "", "WmtEnDeRNMTCloudTpu"], [201, 1, 1, "", "WmtEnDeTransformerBase"], [201, 1, 1, "", "WmtEnDeTransformerSmall"], [201, 1, 1, "", "WmtEnDeTransformerSmallCloudTpu"]], "lingvo.tasks.mt.params.wmt14_en_de.WmtEnDeRNMT": [[201, 2, 1, "", "Task"], [201, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.mt.params.wmt14_en_de.WmtEnDeRNMTCloudTpu": [[201, 2, 1, "", "Task"], [201, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.mt.params.wmt14_en_de.WmtEnDeTransformerBase": [[201, 5, 1, "", "DATADIR"], [201, 2, 1, "", "Dev"], [201, 2, 1, "", "Task"], [201, 2, 1, "", "Test"], [201, 2, 1, "", "Train"], [201, 5, 1, "", "VOCAB_SIZE"], [201, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.mt.params.wmt14_en_de.WmtEnDeTransformerSmall": [[201, 2, 1, "", "Task"]], "lingvo.tasks.mt.params.wmt14_en_de.WmtEnDeTransformerSmallCloudTpu": [[201, 2, 1, "", "Task"], [201, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.mt.params.wmtm16_en_de": [[202, 1, 1, "", "WmtCaptionEnDeTransformer"], [202, 1, 1, "", "WmtCaptionEnDeTransformerCloudTpu"]], "lingvo.tasks.mt.params.wmtm16_en_de.WmtCaptionEnDeTransformer": [[202, 5, 1, "", "DATADIR"], [202, 2, 1, "", "Dev"], [202, 2, 1, "", "Task"], [202, 2, 1, "", "Test"], [202, 2, 1, "", "Train"], [202, 5, 1, "", "VOCAB_FILE"], [202, 5, 1, "", "VOCAB_SIZE"], [202, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.mt.params.wmtm16_en_de.WmtCaptionEnDeTransformerCloudTpu": [[202, 2, 1, "", "Task"], [202, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.mt.params.xendec": [[204, 0, 0, "-", "wmt14_en_de"]], "lingvo.tasks.mt.params.xendec.wmt14_en_de": [[204, 1, 1, "", "WmtDeEnXEnDec"], [204, 1, 1, "", "WmtEnDeXEnDec"]], "lingvo.tasks.mt.params.xendec.wmt14_en_de.WmtDeEnXEnDec": [[204, 5, 1, "", "DATADIR"]], "lingvo.tasks.mt.params.xendec.wmt14_en_de.WmtEnDeXEnDec": [[204, 5, 1, "", "DATADEV"], [204, 5, 1, "", "DATADIR"], [204, 5, 1, "", "DATATEST"], [204, 5, 1, "", "DATATRAIN"], [204, 2, 1, "", "Dev"], [204, 5, 1, "", "PACKED_INPUT"], [204, 2, 1, "", "Task"], [204, 2, 1, "", "Test"], [204, 2, 1, "", "Train"], [204, 5, 1, "", "VOCAB"], [204, 2, 1, "", "_EvalParams"], [204, 5, 1, "", "atten_drop"], [204, 5, 1, "", "atten_dropout_prob"], [204, 5, 1, "", "batch_size_ratio"], [204, 5, 1, "", "hidden_dim"], [204, 5, 1, "", "input_dropout_prob"], [204, 5, 1, "", "learning_rate"], [204, 5, 1, "", "loss_clean_weight"], [204, 5, 1, "", "loss_mix_weight"], [204, 5, 1, "", "loss_mono_weight"], [204, 5, 1, "", "mask_word_id"], [204, 5, 1, "", "mask_words_ratio"], [204, 5, 1, "", "model_dim"], [204, 5, 1, "", "num_heads"], [204, 5, 1, "", "num_samples"], [204, 5, 1, "", "pad_id"], [204, 5, 1, "", "permutation_distance"], [204, 5, 1, "", "relu_dropout_prob"], [204, 5, 1, "", "residual_dropout_prob"], [204, 5, 1, "", "source_mask_ratio"], [204, 5, 1, "", "source_mask_ratio_beta"], [204, 5, 1, "", "use_atten_cl"], [204, 5, 1, "", "use_prob_cl"], [204, 5, 1, "", "use_prob_drop"], [204, 5, 1, "", "vocab_size"], [204, 5, 1, "", "warmup_steps"]], "lingvo.tasks.mt.text_input_pb2": [[205, 1, 1, "", "Sentence"], [205, 1, 1, "", "SentencePair"], [205, 6, 1, "", "_b"]], "lingvo.tasks.mt.text_input_pb2.Sentence": [[205, 5, 1, "", "DESCRIPTOR"], [205, 5, 1, "", "lang"], [205, 5, 1, "", "sentence"]], "lingvo.tasks.mt.text_input_pb2.SentencePair": [[205, 5, 1, "", "DESCRIPTOR"], [205, 5, 1, "", "src_sentence"], [205, 5, 1, "", "tgt_sentence"]], "lingvo.tasks.punctuator": [[208, 0, 0, "-", "input_generator"], [209, 0, 0, "-", "model"], [210, 0, 0, "-", "params"], [213, 0, 0, "-", "tools"]], "lingvo.tasks.punctuator.input_generator": [[208, 1, 1, "", "PunctuatorInput"], [208, 1, 1, "", "TextLines"]], "lingvo.tasks.punctuator.input_generator.PunctuatorInput": [[208, 2, 1, "", "CreateDatasource"], [208, 2, 1, "", "Params"], [208, 2, 1, "", "_GetSequenceLength"], [208, 2, 1, "", "_InputPaddingValue"], [208, 2, 1, "", "_InputShape"], [208, 2, 1, "", "_Process"], [208, 2, 1, "", "_ProcessLine"]], "lingvo.tasks.punctuator.input_generator.TextLines": [[208, 2, 1, "", "GetDataset"], [208, 2, 1, "", "Params"]], "lingvo.tasks.punctuator.model": [[209, 1, 1, "", "RNMTModel"]], "lingvo.tasks.punctuator.model.RNMTModel": [[209, 2, 1, "", "Inference"], [209, 2, 1, "", "_InferenceSubgraph_Default"]], "lingvo.tasks.punctuator.params": [[211, 0, 0, "-", "codelab"], [212, 0, 0, "-", "params"]], "lingvo.tasks.punctuator.params.codelab": [[211, 1, 1, "", "BrownCorpusWPM"], [211, 1, 1, "", "RNMTModel"]], "lingvo.tasks.punctuator.params.codelab.BrownCorpusWPM": [[211, 2, 1, "", "Test"], [211, 2, 1, "", "Train"], [211, 5, 1, "", "_DATADIR"], [211, 5, 1, "", "_VOCAB_FILE"], [211, 5, 1, "", "_VOCAB_SIZE"]], "lingvo.tasks.punctuator.params.codelab.RNMTModel": [[211, 2, 1, "", "Task"]], "lingvo.tasks.punctuator.tools": [[214, 0, 0, "-", "download_brown_corpus"]], "lingvo.tasks.punctuator.tools.download_brown_corpus": [[214, 6, 1, "", "main"]], "lingvo.tools": [[216, 0, 0, "-", "audio_lib"], [217, 0, 0, "-", "beam_utils"], [218, 0, 0, "-", "bpe_word_tokenizer"], [219, 0, 0, "-", "compare_params"], [220, 0, 0, "-", "compute_stats"], [221, 0, 0, "-", "count_records"], [222, 0, 0, "-", "create_asr_features"], [223, 0, 0, "-", "gke_launch"], [224, 0, 0, "-", "keras2ckpt"], [225, 0, 0, "-", "print_tf_records"], [226, 0, 0, "-", "wpm_encode_file"]], "lingvo.tools.audio_lib": [[216, 6, 1, "", "AudioToMfcc"], [216, 6, 1, "", "DecodeFlacToWav"], [216, 6, 1, "", "DecodeWav"], [216, 6, 1, "", "ExtractLogMelFeatures"]], "lingvo.tools.beam_utils": [[217, 6, 1, "", "BeamInit"], [217, 6, 1, "", "GetEmitterFn"], [217, 6, 1, "", "GetPipelineRoot"], [217, 6, 1, "", "GetReader"], [217, 6, 1, "", "GetWriter"]], "lingvo.tools.bpe_word_tokenizer": [[218, 6, 1, "", "_ExtractTokenization"], [218, 6, 1, "", "_GetVocabulary"], [218, 6, 1, "", "main"]], "lingvo.tools.compare_params": [[219, 6, 1, "", "_hyperparams_text_to_dict"], [219, 6, 1, "", "get_model_params_as_text"], [219, 6, 1, "", "hyperparams_text_diff"], [219, 6, 1, "", "print_hyperparams_text_diff"]], "lingvo.tools.compute_stats": [[220, 1, 1, "", "StatsCollector"], [220, 6, 1, "", "main"]], "lingvo.tools.compute_stats.StatsCollector": [[220, 2, 1, "", "Accumulate"], [220, 2, 1, "", "Print"], [220, 2, 1, "", "_AccumulateMoments"], [220, 2, 1, "", "_ComputeMeanVar"], [220, 2, 1, "", "_PrintLengthBuckets"], [220, 2, 1, "", "_PrintMeanVar"]], "lingvo.tools.count_records": [[221, 6, 1, "", "main"]], "lingvo.tools.create_asr_features": [[222, 6, 1, "", "_CloseSubShards"], [222, 6, 1, "", "_CreateAsrFeatures"], [222, 6, 1, "", "_DumpTranscripts"], [222, 6, 1, "", "_LoadTranscriptionsFromFile"], [222, 6, 1, "", "_MakeBytesFeature"], [222, 6, 1, "", "_MakeFloatFeature"], [222, 6, 1, "", "_MakeInt64Feature"], [222, 6, 1, "", "_MakeLogMelFromTensorflowBuiltin"], [222, 6, 1, "", "_MakeTfExample"], [222, 6, 1, "", "_OpenSubShards"], [222, 6, 1, "", "_ReadTranscriptions"], [222, 6, 1, "", "_SelectRandomShard"], [222, 6, 1, "", "main"]], "lingvo.tools.gke_launch": [[223, 6, 1, "", "_get_or_add"], [223, 6, 1, "", "_tpu_resource"], [223, 6, 1, "", "add_gpu_to_pod"], [223, 6, 1, "", "build_docker_image"], [223, 6, 1, "", "create_tpu_cluster"], [223, 6, 1, "", "decoder_template"], [223, 6, 1, "", "get_gke_cluster"], [223, 6, 1, "", "main"], [223, 6, 1, "", "set_pod_cpu_memory"], [223, 6, 1, "", "tensorboard_template"], [223, 6, 1, "", "tpu_training_template"], [223, 6, 1, "", "validate_args"]], "lingvo.tools.keras2ckpt": [[224, 6, 1, "", "main"]], "lingvo.tools.print_tf_records": [[225, 6, 1, "", "_CustomShortDebugString"], [225, 6, 1, "", "_ListDebugString"], [225, 6, 1, "", "_PrintFiles"], [225, 6, 1, "", "_PrintHeader"], [225, 6, 1, "", "main"]], "lingvo.tools.wpm_encode_file": [[226, 6, 1, "", "_AssertTextFormat"], [226, 6, 1, "", "_MakeBytesFeature"], [226, 6, 1, "", "_MakeFloatFeature"], [226, 6, 1, "", "_MakeInt64Feature"], [226, 6, 1, "", "_MakeTfExample"], [226, 6, 1, "", "_Preprocess"], [226, 6, 1, "", "_RunEncoding"], [226, 6, 1, "", "main"]], "lingvo.trainer": [[227, 1, 1, "", "RunnerManager"], [227, 6, 1, "", "_GetClusterSpecDict"], [227, 6, 1, "", "_ValidateVizierReportingJob"], [227, 6, 1, "", "main"]], "lingvo.trainer.RunnerManager": [[227, 1, 1, "", "Controller"], [227, 2, 1, "", "CreateRunners"], [227, 3, 1, "", "Decoder"], [227, 3, 1, "", "Evaler"], [227, 1, 1, "", "ExecutorTpu"], [227, 2, 1, "", "GetExecutorParams"], [227, 2, 1, "", "GetParamsForDataset"], [227, 2, 1, "", "InspectDatasets"], [227, 2, 1, "", "InspectDecoder"], [227, 2, 1, "", "InspectModel"], [227, 2, 1, "", "InspectParams"], [227, 2, 1, "", "MaybeConfigCloudTpu"], [227, 2, 1, "", "MaybeConfigRunDistributed"], [227, 2, 1, "", "MaybeConfigRunLocally"], [227, 2, 1, "", "MaybeLaunchTensorFlow"], [227, 2, 1, "", "RunEvalerOnce"], [227, 2, 1, "", "RunTrial"], [227, 2, 1, "", "SetModelName"], [227, 2, 1, "", "Start"], [227, 2, 1, "", "StartRunners"], [227, 1, 1, "", "TrainSummaries"], [227, 3, 1, "", "Trainer"], [227, 1, 1, "", "TrainerTpu"], [227, 2, 1, "", "UpdateClusterParamsFromFlags"], [227, 2, 1, "", "WriteInferenceGraph"], [227, 2, 1, "", "_CreateRunner"], [227, 5, 1, "", "inference_graph_exporter"], [227, 5, 1, "", "model_registry"]], "lingvo.trainer.RunnerManager.Controller": [[227, 2, 1, "", "Start"], [227, 2, 1, "", "StartEnqueueOp"], [227, 2, 1, "", "_Loop"], [227, 2, 1, "", "_SummarizeValue"]], "lingvo.trainer.RunnerManager.ExecutorTpu": [[227, 2, 1, "", "Start"], [227, 2, 1, "", "_GetSession"], [227, 2, 1, "", "_Loop"], [227, 2, 1, "", "_MaybeConstructSharedModel"]], "lingvo.trainer.RunnerManager.TrainSummaries": [[227, 2, 1, "", "Start"]], "lingvo.trainer.RunnerManager.TrainerTpu": [[227, 2, 1, "", "Start"], [227, 2, 1, "", "StartEnqueueOp"], [227, 2, 1, "", "_CleanUp"], [227, 2, 1, "", "_GetSession"], [227, 2, 1, "", "_InfeedLoop"], [227, 2, 1, "", "_Loop"], [227, 2, 1, "", "_LoopEnqueue"], [227, 2, 1, "", "_OutfeedDequeueLoop"], [227, 2, 1, "", "_OutfeedEnqueue"], [227, 2, 1, "", "_SummarizeValue"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:property", "4": "py:exception", "5": "py:attribute", "6": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "property", "Python property"], "4": ["py", "exception", "Python exception"], "5": ["py", "attribute", "Python attribute"], "6": ["py", "function", "Python function"]}, "titleterms": {"welcom": 0, "lingvo": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "": 0, "document": 0, "indic": 0, "tabl": 0, "packag": [1, 5, 70, 102, 131, 132, 149, 152, 158, 168, 191, 206, 207, 213, 215], "subpackag": [1, 5, 131, 132, 152, 158, 171, 191, 199, 207], "submodul": [1, 5, 70, 102, 132, 146, 149, 152, 155, 158, 162, 168, 171, 179, 186, 191, 199, 203, 207, 210, 213, 215], "base_runn": 2, "modul": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 147, 148, 150, 151, 153, 154, 156, 157, 159, 160, 161, 163, 164, 165, 166, 167, 169, 170, 172, 173, 174, 175, 176, 177, 178, 180, 181, 182, 183, 184, 185, 187, 188, 189, 190, 192, 193, 194, 195, 196, 197, 198, 200, 201, 202, 204, 205, 208, 209, 211, 212, 214, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228], "base_tri": 3, "compat": 4, "core": [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121], "activ": 6, "adagraft": 7, "attent": 8, "attention_util": 9, "base_decod": 10, "base_input_gener": 11, "base_lay": 12, "base_model": 13, "base_model_param": 14, "batch_major_attent": 15, "batch_util": 16, "beam_search_help": 17, "bfloat16_vari": 18, "bn_layer": 19, "build_data": 20, "builder": 21, "builder_lay": 22, "checkpoint": 23, "cluster": 24, "cluster_factori": 25, "computation_cost": 26, "conformer_lay": 27, "constant": [28, 173], "conv_layers_build": 29, "conv_layers_with_time_pad": 30, "datasourc": 31, "decoder_lib": 32, "differentiable_assign": 33, "distillation_task": 34, "distributed_shampoo": 35, "early_stop": 36, "egdd": 37, "entmax": 38, "favor_attent": 39, "flat_beam_search_help": 40, "generic_input": 41, "gpipe": 42, "graddrop": 43, "gradient_combin": 44, "gshard_build": 45, "gshard_decod": 46, "gshard_lay": 47, "gshard_util": 48, "hyperparam": 49, "hyperparams_pb2": 50, "inference_graph_export": 51, "inference_graph_pb2": 52, "input_generator_help": 53, "input_polici": 54, "insert": 55, "inspect_util": 56, "layer": [57, 160, 197], "layers_with_attent": 58, "layers_with_gpip": 59, "learner": 60, "lstm_frnn_layer": 61, "matrix_funct": 62, "metric": 63, "ml_perf_bleu_metr": 64, "ml_perf_log": 65, "ml_perf_token": 66, "model_help": 67, "multitask_model": 68, "nested_map": 69, "op": [70, 71, 72, 73, 74], "hyps_pb2": 71, "record_pb2": 72, "versioned_file_set_pb2": 73, "x_op": 74, "optim": 75, "plot": 76, "predictor": 77, "predictor_runner_bas": 78, "program": 79, "program_util": 80, "pruning_util": 81, "py_util": 82, "py_utils_flag": 83, "quant_test_lib": 84, "quant_util": 85, "recurr": 86, "repeat_lay": 87, "retri": 88, "reversible_lay": 89, "rnn_cell": 90, "rnn_layer": 91, "routing_config_help": 92, "saver": 93, "scatter_upd": 94, "schedul": 95, "scorer": 96, "self_attention_lay": 97, "sendrecv": 98, "spectrum_augment": 99, "spectrum_augmenter_on_devic": 100, "step": [101, 102, 103, 104, 105], "attention_step": 103, "embedding_step": 104, "rnn_step": 105, "stream_step_test_bas": 106, "summary_util": 107, "symbol": 108, "target_sequence_sampl": 109, "task_schedul": 110, "test_help": 111, "test_trainer_util": 112, "test_util": 113, "thread_local_util": 114, "token": [115, 167], "tpu_embedding_lay": 116, "tpu_summari": 117, "trainer_test_util": 118, "tshape": 119, "var_tmp_wrapp": 120, "wpm_encod": 121, "dataset": 122, "eager_runn": 123, "executor": 124, "ipython_kernel": 125, "model_import": 126, "model_registri": 127, "models_test_help": 128, "pdb_wrapper": 129, "runner": 130, "task": [131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214], "asr": [132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151], "contextualizer_bas": 133, "decod": [134, 194], "decoder_metr": 135, "decoder_util": 136, "encod": [137, 195], "eos_norm": 138, "frontend": 139, "fusion": 140, "input_gener": [141, 154, 159, 177, 196, 208], "levenshtein_dist": 142, "metrics_calcul": 143, "model": [144, 161, 198, 209], "model_test_input_gener": 145, "param": [146, 147, 148, 155, 156, 157, 162, 163, 164, 165, 166, 179, 180, 181, 182, 183, 199, 200, 201, 202, 203, 204, 210, 211, 212], "namespac": [146, 155, 162, 171, 179, 186, 199, 203, 210], "librispeech": 147, "tool": [149, 150, 151, 168, 169, 170, 186, 187, 206, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226], "simple_w": 150, "simple_wer_v2": 151, "imag": [152, 153, 154, 155, 156, 157], "classifi": 153, "mnist": 156, "lm": [158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170], "one_billion_wd": 163, "synthetic_packed_input": 165, "wiki_bert": 166, "download_lm1b": 169, "gshard_lm_decod": 170, "milan": [171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190], "common_schema": 172, "dataset_spec": 174, "dual_encod": 175, "image_preprocessor": 176, "label": 178, "function": 178, "cxc": 180, "dual_encoder_recip": 181, "generic_dataset": 182, "score_funct": 184, "tf_hub_lay": 185, "prepare_coco": 187, "tpu_util": 188, "transform": 189, "util": 190, "mt": [191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206], "base_config": 192, "data_augment": 193, "wmt14_en_d": [201, 204], "wmtm16_en_d": 202, "xendec": [203, 204], "text_input_pb2": 205, "punctuat": [207, 208, 209, 210, 211, 212, 213, 214], "codelab": 211, "download_brown_corpu": 214, "audio_lib": 216, "beam_util": 217, "bpe_word_token": 218, "compare_param": 219, "compute_stat": 220, "count_record": 221, "create_asr_featur": 222, "gke_launch": 223, "keras2ckpt": 224, "print_tf_record": 225, "wpm_encode_fil": 226, "trainer": 227, "trainer_util": 228}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})