Search.setIndex({"docnames": ["index", "lingvo", "lingvo.base_runner", "lingvo.base_trial", "lingvo.compat", "lingvo.core", "lingvo.core.activations", "lingvo.core.adagraft", "lingvo.core.attention", "lingvo.core.attention_util", "lingvo.core.base_decoder", "lingvo.core.base_input_generator", "lingvo.core.base_layer", "lingvo.core.base_model", "lingvo.core.base_model_params", "lingvo.core.batch_major_attention", "lingvo.core.batch_utils", "lingvo.core.beam_search_helper", "lingvo.core.bfloat16_variables", "lingvo.core.bn_layers", "lingvo.core.build_data", "lingvo.core.builder", "lingvo.core.builder_layers", "lingvo.core.checkpointer", "lingvo.core.cluster", "lingvo.core.cluster_factory", "lingvo.core.computation_cost", "lingvo.core.conformer_layer", "lingvo.core.constants", "lingvo.core.conv_layers_builder", "lingvo.core.conv_layers_with_time_padding", "lingvo.core.datasource", "lingvo.core.datasource_tfds", "lingvo.core.decoder_lib", "lingvo.core.differentiable_assignment", "lingvo.core.distillation_task", "lingvo.core.distributed_shampoo", "lingvo.core.early_stop", "lingvo.core.egdd", "lingvo.core.entmax", "lingvo.core.favor_attention", "lingvo.core.flat_beam_search_helper", "lingvo.core.generic_input", "lingvo.core.gpipe", "lingvo.core.graddrop", "lingvo.core.gradient_combiner", "lingvo.core.gshard_builder", "lingvo.core.gshard_decode", "lingvo.core.gshard_layers", "lingvo.core.gshard_utils", "lingvo.core.hyperparams", "lingvo.core.hyperparams_pb2", "lingvo.core.inference_graph_exporter", "lingvo.core.inference_graph_pb2", "lingvo.core.input_generator_helper", "lingvo.core.input_policy", "lingvo.core.insertion", "lingvo.core.inspect_utils", "lingvo.core.layers", "lingvo.core.layers_with_attention", "lingvo.core.layers_with_gpipe", "lingvo.core.learner", "lingvo.core.lstm_frnn_layer", "lingvo.core.matrix_functions", "lingvo.core.metrics", "lingvo.core.ml_perf_bleu_metric", "lingvo.core.ml_perf_log", "lingvo.core.ml_perf_tokenizer", "lingvo.core.model_helper", "lingvo.core.multitask_model", "lingvo.core.nested_map", "lingvo.core.ops", "lingvo.core.ops.hyps_pb2", "lingvo.core.ops.record_pb2", "lingvo.core.ops.versioned_file_set_pb2", "lingvo.core.ops.x_ops", "lingvo.core.optimizer", "lingvo.core.plot", "lingvo.core.predictor", "lingvo.core.predictor_runner_base", "lingvo.core.program", "lingvo.core.program_utils", "lingvo.core.pruning_utils", "lingvo.core.py_utils", "lingvo.core.py_utils_flags", "lingvo.core.quant_test_lib", "lingvo.core.quant_utils", "lingvo.core.recurrent", "lingvo.core.repeat_layer", "lingvo.core.retry", "lingvo.core.reversible_layers", "lingvo.core.rnn_cell", "lingvo.core.rnn_layers", "lingvo.core.routing_config_helper", "lingvo.core.saver", "lingvo.core.scatter_update", "lingvo.core.schedule", "lingvo.core.scorers", "lingvo.core.self_attention_layer", "lingvo.core.sendrecv", "lingvo.core.spectrum_augmenter", "lingvo.core.spectrum_augmenter_on_device", "lingvo.core.step", "lingvo.core.steps", "lingvo.core.steps.attention_steps", "lingvo.core.steps.embedding_steps", "lingvo.core.steps.rnn_steps", "lingvo.core.stream_step_test_base", "lingvo.core.summary_utils", "lingvo.core.symbolic", "lingvo.core.target_sequence_sampler", "lingvo.core.task_scheduler", "lingvo.core.test_helper", "lingvo.core.test_trainer_utils", "lingvo.core.test_utils", "lingvo.core.thread_local_utils", "lingvo.core.tokenizers", "lingvo.core.tpu_embedding_layers", "lingvo.core.tpu_summary", "lingvo.core.trainer_test_utils", "lingvo.core.tshape", "lingvo.core.var_tmp_wrappers", "lingvo.core.wpm_encoder", "lingvo.datasets", "lingvo.eager_runners", "lingvo.executor", "lingvo.ipython_kernel", "lingvo.model_imports", "lingvo.model_registry", "lingvo.models_test_helper", "lingvo.pdb_wrapper", "lingvo.runners", "lingvo.tasks", "lingvo.tasks.asr", "lingvo.tasks.asr.contextualizer_base", "lingvo.tasks.asr.decoder", "lingvo.tasks.asr.decoder_metrics", "lingvo.tasks.asr.decoder_utils", "lingvo.tasks.asr.encoder", "lingvo.tasks.asr.eos_normalization", "lingvo.tasks.asr.frontend", "lingvo.tasks.asr.fusion", "lingvo.tasks.asr.input_generator", "lingvo.tasks.asr.levenshtein_distance", "lingvo.tasks.asr.metrics_calculator", "lingvo.tasks.asr.model", "lingvo.tasks.asr.model_test_input_generator", "lingvo.tasks.asr.params", "lingvo.tasks.asr.params.librispeech", "lingvo.tasks.asr.params.params", "lingvo.tasks.asr.tools", "lingvo.tasks.asr.tools.simple_wer", "lingvo.tasks.asr.tools.simple_wer_v2", "lingvo.tasks.image", "lingvo.tasks.image.classifier", "lingvo.tasks.image.input_generator", "lingvo.tasks.image.params", "lingvo.tasks.image.params.mnist", "lingvo.tasks.image.params.params", "lingvo.tasks.lm", "lingvo.tasks.lm.input_generator", "lingvo.tasks.lm.layers", "lingvo.tasks.lm.model", "lingvo.tasks.lm.params", "lingvo.tasks.lm.params.one_billion_wds", "lingvo.tasks.lm.params.params", "lingvo.tasks.lm.params.synthetic_packed_input", "lingvo.tasks.lm.params.wiki_bert", "lingvo.tasks.lm.tokenizer", "lingvo.tasks.lm.tools", "lingvo.tasks.lm.tools.download_lm1b", "lingvo.tasks.lm.tools.gshard_lm_decode", "lingvo.tasks.milan", "lingvo.tasks.milan.common_schema", "lingvo.tasks.milan.constants", "lingvo.tasks.milan.dataset_spec", "lingvo.tasks.milan.dual_encoder", "lingvo.tasks.milan.image_preprocessor", "lingvo.tasks.milan.input_generator", "lingvo.tasks.milan.labels", "lingvo.tasks.milan.params", "lingvo.tasks.milan.params.cxc", "lingvo.tasks.milan.params.dual_encoder_recipe", "lingvo.tasks.milan.params.generic_datasets", "lingvo.tasks.milan.params.params", "lingvo.tasks.milan.score_functions", "lingvo.tasks.milan.tf_hub_layers", "lingvo.tasks.milan.tools", "lingvo.tasks.milan.tools.prepare_coco", "lingvo.tasks.milan.tpu_utils", "lingvo.tasks.milan.transformers", "lingvo.tasks.milan.utils", "lingvo.tasks.mt", "lingvo.tasks.mt.base_config", "lingvo.tasks.mt.data_augmenter", "lingvo.tasks.mt.decoder", "lingvo.tasks.mt.encoder", "lingvo.tasks.mt.input_generator", "lingvo.tasks.mt.layers", "lingvo.tasks.mt.model", "lingvo.tasks.mt.params", "lingvo.tasks.mt.params.params", "lingvo.tasks.mt.params.wmt14_en_de", "lingvo.tasks.mt.params.wmtm16_en_de", "lingvo.tasks.mt.params.xendec", "lingvo.tasks.mt.params.xendec.wmt14_en_de", "lingvo.tasks.mt.text_input_pb2", "lingvo.tasks.mt.tools", "lingvo.tasks.punctuator", "lingvo.tasks.punctuator.input_generator", "lingvo.tasks.punctuator.model", "lingvo.tasks.punctuator.params", "lingvo.tasks.punctuator.params.codelab", "lingvo.tasks.punctuator.params.params", "lingvo.tasks.punctuator.tools", "lingvo.tasks.punctuator.tools.download_brown_corpus", "lingvo.tools", "lingvo.tools.audio_lib", "lingvo.tools.beam_utils", "lingvo.tools.bpe_word_tokenizer", "lingvo.tools.compare_params", "lingvo.tools.compute_stats", "lingvo.tools.count_records", "lingvo.tools.create_asr_features", "lingvo.tools.gke_launch", "lingvo.tools.keras2ckpt", "lingvo.tools.print_tf_records", "lingvo.tools.wpm_encode_file", "lingvo.trainer", "lingvo.trainer_utils", "modules"], "filenames": ["index.rst", "lingvo.rst", "lingvo.base_runner.rst", "lingvo.base_trial.rst", "lingvo.compat.rst", "lingvo.core.rst", "lingvo.core.activations.rst", "lingvo.core.adagraft.rst", "lingvo.core.attention.rst", "lingvo.core.attention_util.rst", "lingvo.core.base_decoder.rst", "lingvo.core.base_input_generator.rst", "lingvo.core.base_layer.rst", "lingvo.core.base_model.rst", "lingvo.core.base_model_params.rst", "lingvo.core.batch_major_attention.rst", "lingvo.core.batch_utils.rst", "lingvo.core.beam_search_helper.rst", "lingvo.core.bfloat16_variables.rst", "lingvo.core.bn_layers.rst", "lingvo.core.build_data.rst", "lingvo.core.builder.rst", "lingvo.core.builder_layers.rst", "lingvo.core.checkpointer.rst", "lingvo.core.cluster.rst", "lingvo.core.cluster_factory.rst", "lingvo.core.computation_cost.rst", "lingvo.core.conformer_layer.rst", "lingvo.core.constants.rst", "lingvo.core.conv_layers_builder.rst", "lingvo.core.conv_layers_with_time_padding.rst", "lingvo.core.datasource.rst", "lingvo.core.datasource_tfds.rst", "lingvo.core.decoder_lib.rst", "lingvo.core.differentiable_assignment.rst", "lingvo.core.distillation_task.rst", "lingvo.core.distributed_shampoo.rst", "lingvo.core.early_stop.rst", "lingvo.core.egdd.rst", "lingvo.core.entmax.rst", "lingvo.core.favor_attention.rst", "lingvo.core.flat_beam_search_helper.rst", "lingvo.core.generic_input.rst", "lingvo.core.gpipe.rst", "lingvo.core.graddrop.rst", "lingvo.core.gradient_combiner.rst", "lingvo.core.gshard_builder.rst", "lingvo.core.gshard_decode.rst", "lingvo.core.gshard_layers.rst", "lingvo.core.gshard_utils.rst", "lingvo.core.hyperparams.rst", "lingvo.core.hyperparams_pb2.rst", "lingvo.core.inference_graph_exporter.rst", "lingvo.core.inference_graph_pb2.rst", "lingvo.core.input_generator_helper.rst", "lingvo.core.input_policy.rst", "lingvo.core.insertion.rst", "lingvo.core.inspect_utils.rst", "lingvo.core.layers.rst", "lingvo.core.layers_with_attention.rst", "lingvo.core.layers_with_gpipe.rst", "lingvo.core.learner.rst", "lingvo.core.lstm_frnn_layer.rst", "lingvo.core.matrix_functions.rst", "lingvo.core.metrics.rst", "lingvo.core.ml_perf_bleu_metric.rst", "lingvo.core.ml_perf_log.rst", "lingvo.core.ml_perf_tokenizer.rst", "lingvo.core.model_helper.rst", "lingvo.core.multitask_model.rst", "lingvo.core.nested_map.rst", "lingvo.core.ops.rst", "lingvo.core.ops.hyps_pb2.rst", "lingvo.core.ops.record_pb2.rst", "lingvo.core.ops.versioned_file_set_pb2.rst", "lingvo.core.ops.x_ops.rst", "lingvo.core.optimizer.rst", "lingvo.core.plot.rst", "lingvo.core.predictor.rst", "lingvo.core.predictor_runner_base.rst", "lingvo.core.program.rst", "lingvo.core.program_utils.rst", "lingvo.core.pruning_utils.rst", "lingvo.core.py_utils.rst", "lingvo.core.py_utils_flags.rst", "lingvo.core.quant_test_lib.rst", "lingvo.core.quant_utils.rst", "lingvo.core.recurrent.rst", "lingvo.core.repeat_layer.rst", "lingvo.core.retry.rst", "lingvo.core.reversible_layers.rst", "lingvo.core.rnn_cell.rst", "lingvo.core.rnn_layers.rst", "lingvo.core.routing_config_helper.rst", "lingvo.core.saver.rst", "lingvo.core.scatter_update.rst", "lingvo.core.schedule.rst", "lingvo.core.scorers.rst", "lingvo.core.self_attention_layer.rst", "lingvo.core.sendrecv.rst", "lingvo.core.spectrum_augmenter.rst", "lingvo.core.spectrum_augmenter_on_device.rst", "lingvo.core.step.rst", "lingvo.core.steps.rst", "lingvo.core.steps.attention_steps.rst", "lingvo.core.steps.embedding_steps.rst", "lingvo.core.steps.rnn_steps.rst", "lingvo.core.stream_step_test_base.rst", "lingvo.core.summary_utils.rst", "lingvo.core.symbolic.rst", "lingvo.core.target_sequence_sampler.rst", "lingvo.core.task_scheduler.rst", "lingvo.core.test_helper.rst", "lingvo.core.test_trainer_utils.rst", "lingvo.core.test_utils.rst", "lingvo.core.thread_local_utils.rst", "lingvo.core.tokenizers.rst", "lingvo.core.tpu_embedding_layers.rst", "lingvo.core.tpu_summary.rst", "lingvo.core.trainer_test_utils.rst", "lingvo.core.tshape.rst", "lingvo.core.var_tmp_wrappers.rst", "lingvo.core.wpm_encoder.rst", "lingvo.datasets.rst", "lingvo.eager_runners.rst", "lingvo.executor.rst", "lingvo.ipython_kernel.rst", "lingvo.model_imports.rst", "lingvo.model_registry.rst", "lingvo.models_test_helper.rst", "lingvo.pdb_wrapper.rst", "lingvo.runners.rst", "lingvo.tasks.rst", "lingvo.tasks.asr.rst", "lingvo.tasks.asr.contextualizer_base.rst", "lingvo.tasks.asr.decoder.rst", "lingvo.tasks.asr.decoder_metrics.rst", "lingvo.tasks.asr.decoder_utils.rst", "lingvo.tasks.asr.encoder.rst", "lingvo.tasks.asr.eos_normalization.rst", "lingvo.tasks.asr.frontend.rst", "lingvo.tasks.asr.fusion.rst", "lingvo.tasks.asr.input_generator.rst", "lingvo.tasks.asr.levenshtein_distance.rst", "lingvo.tasks.asr.metrics_calculator.rst", "lingvo.tasks.asr.model.rst", "lingvo.tasks.asr.model_test_input_generator.rst", "lingvo.tasks.asr.params.rst", "lingvo.tasks.asr.params.librispeech.rst", "lingvo.tasks.asr.params.params.rst", "lingvo.tasks.asr.tools.rst", "lingvo.tasks.asr.tools.simple_wer.rst", "lingvo.tasks.asr.tools.simple_wer_v2.rst", "lingvo.tasks.image.rst", "lingvo.tasks.image.classifier.rst", "lingvo.tasks.image.input_generator.rst", "lingvo.tasks.image.params.rst", "lingvo.tasks.image.params.mnist.rst", "lingvo.tasks.image.params.params.rst", "lingvo.tasks.lm.rst", "lingvo.tasks.lm.input_generator.rst", "lingvo.tasks.lm.layers.rst", "lingvo.tasks.lm.model.rst", "lingvo.tasks.lm.params.rst", "lingvo.tasks.lm.params.one_billion_wds.rst", "lingvo.tasks.lm.params.params.rst", "lingvo.tasks.lm.params.synthetic_packed_input.rst", "lingvo.tasks.lm.params.wiki_bert.rst", "lingvo.tasks.lm.tokenizer.rst", "lingvo.tasks.lm.tools.rst", "lingvo.tasks.lm.tools.download_lm1b.rst", "lingvo.tasks.lm.tools.gshard_lm_decode.rst", "lingvo.tasks.milan.rst", "lingvo.tasks.milan.common_schema.rst", "lingvo.tasks.milan.constants.rst", "lingvo.tasks.milan.dataset_spec.rst", "lingvo.tasks.milan.dual_encoder.rst", "lingvo.tasks.milan.image_preprocessor.rst", "lingvo.tasks.milan.input_generator.rst", "lingvo.tasks.milan.labels.rst", "lingvo.tasks.milan.params.rst", "lingvo.tasks.milan.params.cxc.rst", "lingvo.tasks.milan.params.dual_encoder_recipe.rst", "lingvo.tasks.milan.params.generic_datasets.rst", "lingvo.tasks.milan.params.params.rst", "lingvo.tasks.milan.score_functions.rst", "lingvo.tasks.milan.tf_hub_layers.rst", "lingvo.tasks.milan.tools.rst", "lingvo.tasks.milan.tools.prepare_coco.rst", "lingvo.tasks.milan.tpu_utils.rst", "lingvo.tasks.milan.transformers.rst", "lingvo.tasks.milan.utils.rst", "lingvo.tasks.mt.rst", "lingvo.tasks.mt.base_config.rst", "lingvo.tasks.mt.data_augmenter.rst", "lingvo.tasks.mt.decoder.rst", "lingvo.tasks.mt.encoder.rst", "lingvo.tasks.mt.input_generator.rst", "lingvo.tasks.mt.layers.rst", "lingvo.tasks.mt.model.rst", "lingvo.tasks.mt.params.rst", "lingvo.tasks.mt.params.params.rst", "lingvo.tasks.mt.params.wmt14_en_de.rst", "lingvo.tasks.mt.params.wmtm16_en_de.rst", "lingvo.tasks.mt.params.xendec.rst", "lingvo.tasks.mt.params.xendec.wmt14_en_de.rst", "lingvo.tasks.mt.text_input_pb2.rst", "lingvo.tasks.mt.tools.rst", "lingvo.tasks.punctuator.rst", "lingvo.tasks.punctuator.input_generator.rst", "lingvo.tasks.punctuator.model.rst", "lingvo.tasks.punctuator.params.rst", "lingvo.tasks.punctuator.params.codelab.rst", "lingvo.tasks.punctuator.params.params.rst", "lingvo.tasks.punctuator.tools.rst", "lingvo.tasks.punctuator.tools.download_brown_corpus.rst", "lingvo.tools.rst", "lingvo.tools.audio_lib.rst", "lingvo.tools.beam_utils.rst", "lingvo.tools.bpe_word_tokenizer.rst", "lingvo.tools.compare_params.rst", "lingvo.tools.compute_stats.rst", "lingvo.tools.count_records.rst", "lingvo.tools.create_asr_features.rst", "lingvo.tools.gke_launch.rst", "lingvo.tools.keras2ckpt.rst", "lingvo.tools.print_tf_records.rst", "lingvo.tools.wpm_encode_file.rst", "lingvo.trainer.rst", "lingvo.trainer_utils.rst", "modules.rst"], "titles": ["Welcome to lingvo\u2019s documentation!", "lingvo package", "lingvo.base_runner module", "lingvo.base_trial module", "lingvo.compat module", "lingvo.core package", "lingvo.core.activations module", "lingvo.core.adagraft module", "lingvo.core.attention module", "lingvo.core.attention_util module", "lingvo.core.base_decoder module", "lingvo.core.base_input_generator module", "lingvo.core.base_layer module", "lingvo.core.base_model module", "lingvo.core.base_model_params module", "lingvo.core.batch_major_attention module", "lingvo.core.batch_utils module", "lingvo.core.beam_search_helper module", "lingvo.core.bfloat16_variables module", "lingvo.core.bn_layers module", "lingvo.core.build_data module", "lingvo.core.builder module", "lingvo.core.builder_layers module", "lingvo.core.checkpointer module", "lingvo.core.cluster module", "lingvo.core.cluster_factory module", "lingvo.core.computation_cost module", "lingvo.core.conformer_layer module", "lingvo.core.constants module", "lingvo.core.conv_layers_builder module", "lingvo.core.conv_layers_with_time_padding module", "lingvo.core.datasource module", "lingvo.core.datasource_tfds module", "lingvo.core.decoder_lib module", "lingvo.core.differentiable_assignment module", "lingvo.core.distillation_task module", "lingvo.core.distributed_shampoo module", "lingvo.core.early_stop module", "lingvo.core.egdd module", "lingvo.core.entmax module", "lingvo.core.favor_attention module", "lingvo.core.flat_beam_search_helper module", "lingvo.core.generic_input module", "lingvo.core.gpipe module", "lingvo.core.graddrop module", "lingvo.core.gradient_combiner module", "lingvo.core.gshard_builder module", "lingvo.core.gshard_decode module", "lingvo.core.gshard_layers module", "lingvo.core.gshard_utils module", "lingvo.core.hyperparams module", "lingvo.core.hyperparams_pb2 module", "lingvo.core.inference_graph_exporter module", "lingvo.core.inference_graph_pb2 module", "lingvo.core.input_generator_helper module", "lingvo.core.input_policy module", "lingvo.core.insertion module", "lingvo.core.inspect_utils module", "lingvo.core.layers module", "lingvo.core.layers_with_attention module", "lingvo.core.layers_with_gpipe module", "lingvo.core.learner module", "lingvo.core.lstm_frnn_layer module", "lingvo.core.matrix_functions module", "lingvo.core.metrics module", "lingvo.core.ml_perf_bleu_metric module", "lingvo.core.ml_perf_log module", "lingvo.core.ml_perf_tokenizer module", "lingvo.core.model_helper module", "lingvo.core.multitask_model module", "lingvo.core.nested_map module", "lingvo.core.ops package", "lingvo.core.ops.hyps_pb2 module", "lingvo.core.ops.record_pb2 module", "lingvo.core.ops.versioned_file_set_pb2 module", "lingvo.core.ops.x_ops module", "lingvo.core.optimizer module", "lingvo.core.plot module", "lingvo.core.predictor module", "lingvo.core.predictor_runner_base module", "lingvo.core.program module", "lingvo.core.program_utils module", "lingvo.core.pruning_utils module", "lingvo.core.py_utils module", "lingvo.core.py_utils_flags module", "lingvo.core.quant_test_lib module", "lingvo.core.quant_utils module", "lingvo.core.recurrent module", "lingvo.core.repeat_layer module", "lingvo.core.retry module", "lingvo.core.reversible_layers module", "lingvo.core.rnn_cell module", "lingvo.core.rnn_layers module", "lingvo.core.routing_config_helper module", "lingvo.core.saver module", "lingvo.core.scatter_update module", "lingvo.core.schedule module", "lingvo.core.scorers module", "lingvo.core.self_attention_layer module", "lingvo.core.sendrecv module", "lingvo.core.spectrum_augmenter module", "lingvo.core.spectrum_augmenter_on_device module", "lingvo.core.step module", "lingvo.core.steps package", "lingvo.core.steps.attention_steps module", "lingvo.core.steps.embedding_steps module", "lingvo.core.steps.rnn_steps module", "lingvo.core.stream_step_test_base module", "lingvo.core.summary_utils module", "lingvo.core.symbolic module", "lingvo.core.target_sequence_sampler module", "lingvo.core.task_scheduler module", "lingvo.core.test_helper module", "lingvo.core.test_trainer_utils module", "lingvo.core.test_utils module", "lingvo.core.thread_local_utils module", "lingvo.core.tokenizers module", "lingvo.core.tpu_embedding_layers module", "lingvo.core.tpu_summary module", "lingvo.core.trainer_test_utils module", "lingvo.core.tshape module", "lingvo.core.var_tmp_wrappers module", "lingvo.core.wpm_encoder module", "lingvo.datasets module", "lingvo.eager_runners module", "lingvo.executor module", "lingvo.ipython_kernel module", "lingvo.model_imports module", "lingvo.model_registry module", "lingvo.models_test_helper module", "lingvo.pdb_wrapper module", "lingvo.runners module", "lingvo.tasks package", "lingvo.tasks.asr package", "lingvo.tasks.asr.contextualizer_base module", "lingvo.tasks.asr.decoder module", "lingvo.tasks.asr.decoder_metrics module", "lingvo.tasks.asr.decoder_utils module", "lingvo.tasks.asr.encoder module", "lingvo.tasks.asr.eos_normalization module", "lingvo.tasks.asr.frontend module", "lingvo.tasks.asr.fusion module", "lingvo.tasks.asr.input_generator module", "lingvo.tasks.asr.levenshtein_distance module", "lingvo.tasks.asr.metrics_calculator module", "lingvo.tasks.asr.model module", "lingvo.tasks.asr.model_test_input_generator module", "lingvo.tasks.asr.params namespace", "lingvo.tasks.asr.params.librispeech module", "lingvo.tasks.asr.params.params module", "lingvo.tasks.asr.tools package", "lingvo.tasks.asr.tools.simple_wer module", "lingvo.tasks.asr.tools.simple_wer_v2 module", "lingvo.tasks.image package", "lingvo.tasks.image.classifier module", "lingvo.tasks.image.input_generator module", "lingvo.tasks.image.params namespace", "lingvo.tasks.image.params.mnist module", "lingvo.tasks.image.params.params module", "lingvo.tasks.lm package", "lingvo.tasks.lm.input_generator module", "lingvo.tasks.lm.layers module", "lingvo.tasks.lm.model module", "lingvo.tasks.lm.params namespace", "lingvo.tasks.lm.params.one_billion_wds module", "lingvo.tasks.lm.params.params module", "lingvo.tasks.lm.params.synthetic_packed_input module", "lingvo.tasks.lm.params.wiki_bert module", "lingvo.tasks.lm.tokenizer module", "lingvo.tasks.lm.tools package", "lingvo.tasks.lm.tools.download_lm1b module", "lingvo.tasks.lm.tools.gshard_lm_decode module", "lingvo.tasks.milan namespace", "lingvo.tasks.milan.common_schema module", "lingvo.tasks.milan.constants module", "lingvo.tasks.milan.dataset_spec module", "lingvo.tasks.milan.dual_encoder module", "lingvo.tasks.milan.image_preprocessor module", "lingvo.tasks.milan.input_generator module", "lingvo.tasks.milan.labels module", "lingvo.tasks.milan.params namespace", "lingvo.tasks.milan.params.cxc module", "lingvo.tasks.milan.params.dual_encoder_recipe module", "lingvo.tasks.milan.params.generic_datasets module", "lingvo.tasks.milan.params.params module", "lingvo.tasks.milan.score_functions module", "lingvo.tasks.milan.tf_hub_layers module", "lingvo.tasks.milan.tools namespace", "lingvo.tasks.milan.tools.prepare_coco module", "lingvo.tasks.milan.tpu_utils module", "lingvo.tasks.milan.transformers module", "lingvo.tasks.milan.utils module", "lingvo.tasks.mt package", "lingvo.tasks.mt.base_config module", "lingvo.tasks.mt.data_augmenter module", "lingvo.tasks.mt.decoder module", "lingvo.tasks.mt.encoder module", "lingvo.tasks.mt.input_generator module", "lingvo.tasks.mt.layers module", "lingvo.tasks.mt.model module", "lingvo.tasks.mt.params namespace", "lingvo.tasks.mt.params.params module", "lingvo.tasks.mt.params.wmt14_en_de module", "lingvo.tasks.mt.params.wmtm16_en_de module", "lingvo.tasks.mt.params.xendec namespace", "lingvo.tasks.mt.params.xendec.wmt14_en_de module", "lingvo.tasks.mt.text_input_pb2 module", "lingvo.tasks.mt.tools package", "lingvo.tasks.punctuator package", "lingvo.tasks.punctuator.input_generator module", "lingvo.tasks.punctuator.model module", "lingvo.tasks.punctuator.params namespace", "lingvo.tasks.punctuator.params.codelab module", "lingvo.tasks.punctuator.params.params module", "lingvo.tasks.punctuator.tools package", "lingvo.tasks.punctuator.tools.download_brown_corpus module", "lingvo.tools package", "lingvo.tools.audio_lib module", "lingvo.tools.beam_utils module", "lingvo.tools.bpe_word_tokenizer module", "lingvo.tools.compare_params module", "lingvo.tools.compute_stats module", "lingvo.tools.count_records module", "lingvo.tools.create_asr_features module", "lingvo.tools.gke_launch module", "lingvo.tools.keras2ckpt module", "lingvo.tools.print_tf_records module", "lingvo.tools.wpm_encode_file module", "lingvo.trainer module", "lingvo.trainer_utils module", "lingvo"], "terms": {"packag": [0, 83, 230], "subpackag": [0, 230], "core": [0, 1, 131, 179, 189, 219, 228, 230], "submodul": [0, 12, 132, 230], "task": [0, 1, 2, 11, 13, 14, 22, 24, 35, 42, 43, 44, 45, 46, 47, 52, 58, 60, 64, 69, 76, 80, 83, 111, 117, 119, 123, 125, 127, 128, 224, 228, 230], "tool": [0, 1, 52, 119, 132, 133, 159, 172, 177, 192, 208, 230], "base_runn": [0, 1, 3, 230], "modul": [0, 1, 5, 71, 103, 132, 133, 147, 150, 153, 156, 159, 163, 169, 172, 180, 187, 192, 200, 204, 208, 211, 214, 216, 230], "base_tri": [0, 1, 2, 80, 124, 228, 230], "compat": [0, 1, 8, 9, 11, 12, 13, 15, 22, 43, 48, 58, 60, 61, 70, 71, 83, 86, 88, 91, 92, 94, 102, 106, 108, 114, 117, 121, 140, 141, 176, 195, 196, 218, 219, 230], "dataset": [0, 1, 4, 11, 14, 31, 32, 42, 80, 81, 128, 140, 148, 157, 160, 164, 166, 167, 170, 174, 175, 178, 179, 181, 182, 183, 188, 193, 197, 202, 203, 205, 209, 212, 222, 225, 228, 230], "eager_runn": [0, 1, 230], "executor": [0, 1, 14, 80, 148, 166, 167, 230], "ipython_kernel": [0, 1, 230], "model_import": [0, 1, 230], "model_registri": [0, 1, 52, 78, 123, 125, 182, 228, 230], "models_test_help": [0, 1, 230], "pdb_wrapper": [0, 1, 230], "runner": [0, 1, 2, 83, 124, 125, 228, 230], "trainer": [0, 1, 2, 24, 37, 61, 80, 83, 96, 113, 118, 119, 124, 131, 186, 197, 224, 230], "trainer_util": [0, 1, 230], "index": [0, 12, 13, 15, 17, 21, 22, 23, 24, 30, 35, 42, 46, 48, 59, 60, 70, 71, 83, 87, 95, 100, 105, 108, 119, 139, 145, 151, 152, 154, 161, 162, 176, 195, 197, 199], "search": [0, 10, 15, 17, 41, 65, 71, 80, 83, 122, 123, 135, 141, 195], "page": [0, 63], "op": [1, 2, 5, 7, 11, 12, 13, 15, 24, 36, 37, 38, 43, 47, 48, 49, 52, 58, 61, 64, 76, 78, 80, 82, 83, 86, 87, 91, 92, 94, 99, 100, 101, 114, 117, 121, 131, 134, 135, 141, 142, 160, 186, 194, 197, 219, 228], "step": [1, 2, 3, 5, 7, 8, 9, 10, 11, 12, 13, 15, 17, 19, 23, 27, 30, 31, 35, 37, 41, 44, 46, 47, 48, 58, 59, 61, 62, 64, 71, 76, 80, 82, 83, 86, 87, 90, 92, 94, 96, 100, 108, 110, 111, 114, 116, 119, 124, 125, 131, 134, 135, 141, 145, 148, 154, 161, 182, 193, 195, 199, 228], "activ": [1, 5, 8, 15, 17, 21, 27, 29, 43, 46, 48, 58, 59, 60, 71, 83, 86, 90, 91, 117, 135, 161, 193, 195, 224], "adagraft": [1, 5, 76], "attent": [1, 5, 9, 15, 17, 27, 29, 40, 41, 46, 48, 58, 59, 60, 71, 88, 92, 93, 98, 102, 104, 108, 134, 135, 161, 190, 193, 195, 196, 198, 199], "attention_util": [1, 5], "base_decod": [1, 5], "base_input_gener": [1, 5], "base_lay": [1, 5], "base_model": [1, 5], "base_model_param": [1, 5, 128], "batch_major_attent": [1, 5], "batch_util": [1, 5], "beam_search_help": [1, 5, 110, 136], "bfloat16_vari": [1, 5], "bn_layer": [1, 5], "build_data": [1, 5], "builder": [1, 5, 15, 29, 46, 48, 98, 182, 196], "builder_lay": [1, 5, 43, 46, 88, 102], "checkpoint": [1, 2, 5, 8, 11, 12, 13, 15, 18, 22, 43, 48, 52, 58, 60, 61, 78, 79, 80, 81, 83, 86, 88, 92, 94, 102, 106, 117, 119, 124, 125, 131, 141, 166, 171, 176, 182, 186, 195, 196, 225, 228], "cluster": [1, 5, 9, 11, 12, 15, 16, 25, 47, 52, 76, 83, 84, 93, 125, 131, 224, 228], "cluster_factori": [1, 5, 189], "computation_cost": [1, 5], "conformer_lay": [1, 5], "constant": [1, 5, 34, 40, 48, 52, 83, 86, 87, 96, 102, 111, 119, 132, 172, 191], "conv_layers_build": [1, 5, 15], "conv_layers_with_time_pad": [1, 5], "datasourc": [1, 5, 11, 32, 142, 160, 197, 209], "datasource_tfd": [1, 5], "decoder_lib": [1, 5], "differentiable_assign": [1, 5], "distillation_task": [1, 5], "distributed_shampoo": [1, 5], "early_stop": [1, 5], "egdd": [1, 5], "entmax": [1, 5], "favor_attent": [1, 5], "flat_beam_search_help": [1, 5], "generic_input": [1, 5], "gpipe": [1, 5, 15, 60, 161, 164], "graddrop": [1, 5], "gradient_combin": [1, 5], "gshard_build": [1, 5], "gshard_decod": [1, 5], "gshard_lay": [1, 5, 27, 46], "gshard_util": [1, 5], "hyperparam": [1, 3, 5, 12, 14, 15, 20, 47, 48, 51, 83, 125, 220], "hyperparams_pb2": [1, 5], "inference_graph_export": [1, 5, 78, 228], "inference_graph_pb2": [1, 5, 13, 35], "input_generator_help": [1, 5], "input_polici": [1, 5], "insert": [1, 5, 44, 48, 70, 86, 105, 127, 137, 151, 152, 195, 199], "inspect_util": [1, 5], "layer": [1, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 17, 19, 21, 22, 26, 27, 29, 30, 31, 32, 35, 36, 40, 41, 43, 44, 45, 46, 48, 56, 59, 60, 61, 62, 68, 69, 76, 83, 85, 86, 87, 88, 90, 91, 92, 93, 96, 98, 100, 101, 102, 104, 105, 106, 107, 110, 117, 118, 119, 129, 132, 134, 135, 136, 138, 140, 141, 145, 154, 159, 162, 164, 166, 176, 177, 178, 185, 186, 188, 190, 191, 192, 193, 194, 195, 196, 199, 209], "layers_with_attent": [1, 5], "layers_with_gpip": [1, 5], "learner": [1, 5, 13, 186], "lstm_frnn_layer": [1, 5], "matrix_funct": [1, 5], "metric": [1, 2, 3, 5, 10, 13, 24, 26, 35, 37, 46, 61, 65, 71, 80, 83, 96, 117, 119, 135, 136, 144, 145, 154, 162, 176, 195, 197, 199], "ml_perf_bleu_metr": [1, 5], "ml_perf_log": [1, 5], "ml_perf_token": [1, 5], "model_help": [1, 5], "multitask_model": [1, 5], "nested_map": [1, 5, 191], "optim": [1, 5, 7, 9, 13, 15, 34, 35, 36, 38, 44, 48, 58, 61, 71, 83, 117, 119, 139, 166, 183, 193, 195], "plot": [1, 5, 108], "predictor": [1, 5, 38, 79], "predictor_runner_bas": [1, 5], "program": [1, 5, 8, 47, 61, 81, 125, 152, 218, 228], "program_util": [1, 5], "pruning_util": [1, 5], "py_util": [1, 5, 11, 12, 15, 42, 43, 46, 58, 59, 61, 70, 96, 117, 129, 142, 160, 197], "py_utils_flag": [1, 5], "quant_test_lib": [1, 5], "quant_util": [1, 5, 85], "recurr": [1, 5, 8, 12, 15, 22, 43, 48, 59, 62, 83, 88, 91, 92, 102, 106, 135, 138, 161], "repeat_lay": [1, 5], "retri": [1, 2, 5, 83], "reversible_lay": [1, 5], "rnn_cell": [1, 5, 62, 92, 104], "rnn_layer": [1, 5], "routing_config_help": [1, 5], "saver": [1, 5, 18, 23, 47, 52], "scatter_upd": [1, 5], "schedul": [1, 5, 14, 61, 76, 80, 81, 83, 86, 110, 111, 135, 148, 166, 167], "scorer": [1, 5], "self_attention_lay": [1, 5, 196], "sendrecv": [1, 5], "spectrum_augment": [1, 5], "spectrum_augmenter_on_devic": [1, 5], "stream_step_test_bas": [1, 5], "summary_util": [1, 5], "symbol": [1, 5, 11, 12, 22, 50, 56, 59, 65, 71, 83, 87, 116, 120, 139, 195], "target_sequence_sampl": [1, 5], "task_schedul": [1, 5, 13], "test_help": [1, 5], "test_trainer_util": [1, 5], "test_util": [1, 5], "thread_local_util": [1, 5], "token": [1, 5, 9, 10, 11, 15, 17, 22, 41, 46, 48, 56, 58, 59, 65, 67, 71, 83, 91, 92, 93, 97, 100, 105, 122, 132, 136, 137, 148, 159, 160, 161, 162, 171, 188, 193, 195, 196, 197, 199, 209, 212, 219], "tpu_embedding_lay": [1, 5], "tpu_summari": [1, 5, 41], "trainer_test_util": [1, 5], "tshape": [1, 5, 6, 12, 15, 19, 21, 22, 29, 30, 43, 58, 59, 60, 71, 83], "var_tmp_wrapp": [1, 5], "wpm_encod": [1, 5, 227], "asr": [1, 127, 132], "imag": [1, 27, 29, 30, 43, 58, 77, 108, 127, 128, 132, 173, 174, 176, 177, 179, 181, 182, 183, 186, 195, 203, 224, 228], "lm": [1, 43, 46, 83, 127, 132, 135, 141], "milan": [1, 127, 132], "namespac": [1, 12, 132, 133, 153, 159, 192, 208], "mt": [1, 127, 132, 210], "punctuat": [1, 50, 65, 116, 127, 132, 151], "audio_lib": [1, 216], "beam_util": [1, 216], "bpe_word_token": [1, 216], "compare_param": [1, 216], "compute_stat": [1, 216], "count_record": [1, 216], "create_asr_featur": [1, 216], "gke_launch": [1, 216], "keras2ckpt": [1, 216], "print_tf_record": [1, 216], "wpm_encode_fil": [1, 216], "base": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 27, 29, 30, 31, 32, 35, 36, 37, 38, 39, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 56, 58, 59, 60, 61, 62, 64, 65, 67, 68, 69, 70, 71, 72, 73, 74, 76, 77, 78, 79, 80, 81, 82, 83, 85, 86, 87, 88, 90, 91, 92, 93, 94, 96, 97, 98, 99, 100, 101, 102, 104, 105, 106, 107, 108, 109, 110, 111, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 128, 129, 131, 134, 135, 136, 138, 139, 140, 141, 142, 143, 145, 146, 148, 152, 154, 155, 157, 160, 161, 162, 164, 166, 167, 168, 171, 174, 175, 176, 177, 178, 179, 181, 182, 183, 185, 186, 188, 191, 193, 194, 195, 196, 197, 198, 199, 202, 203, 205, 206, 209, 210, 212, 218, 221, 224, 228], "class": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 27, 29, 30, 31, 32, 35, 36, 37, 38, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 56, 57, 58, 59, 60, 61, 62, 64, 65, 67, 69, 70, 72, 73, 74, 76, 77, 78, 79, 80, 81, 82, 83, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 96, 97, 98, 99, 100, 101, 102, 104, 105, 106, 107, 108, 109, 110, 111, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 128, 129, 131, 134, 135, 136, 138, 140, 141, 142, 143, 145, 146, 148, 152, 154, 155, 157, 160, 161, 162, 164, 166, 167, 168, 171, 174, 175, 176, 177, 178, 179, 181, 182, 183, 185, 186, 188, 191, 194, 195, 196, 197, 198, 199, 202, 203, 205, 206, 209, 210, 212, 221, 226, 228], "all": [2, 3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 21, 22, 23, 24, 36, 37, 38, 40, 41, 42, 43, 44, 46, 48, 50, 52, 58, 59, 60, 61, 64, 65, 70, 71, 76, 80, 83, 86, 87, 88, 91, 92, 94, 97, 98, 100, 102, 104, 105, 106, 108, 111, 114, 116, 117, 118, 123, 125, 127, 131, 135, 136, 141, 142, 152, 160, 166, 175, 176, 179, 182, 186, 189, 191, 193, 195, 196, 197, 198, 199, 219, 222, 223, 224, 228], "job": [2, 11, 13, 24, 25, 31, 33, 47, 58, 80, 83, 104, 197, 224, 228], "baserunn": [2, 124, 125, 131, 228], "param": [2, 3, 6, 8, 9, 10, 11, 12, 13, 14, 15, 17, 19, 21, 22, 24, 27, 29, 30, 31, 32, 35, 37, 43, 44, 46, 47, 48, 50, 52, 55, 56, 57, 58, 59, 60, 61, 62, 64, 67, 69, 76, 78, 80, 82, 83, 85, 86, 88, 90, 91, 92, 93, 96, 98, 100, 102, 104, 105, 106, 107, 108, 110, 111, 116, 117, 119, 124, 125, 127, 128, 132, 133, 135, 136, 138, 140, 141, 142, 144, 145, 146, 153, 154, 155, 159, 160, 161, 162, 168, 172, 176, 177, 178, 185, 186, 188, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 208, 209, 220, 228], "model_task_nam": [2, 52, 124, 131, 228], "logdir": [2, 23, 24, 37, 78, 94, 114, 124, 131, 224, 228], "tf_master": [2, 78, 79, 124, 228], "trial": [2, 3, 80, 124, 228], "nooptrial": [2, 3, 80, 124, 228], "object": [2, 3, 4, 6, 7, 8, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 27, 29, 30, 35, 36, 37, 38, 43, 44, 46, 47, 48, 49, 50, 51, 52, 53, 57, 58, 59, 60, 61, 62, 64, 65, 70, 71, 72, 73, 74, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 87, 90, 91, 92, 94, 97, 98, 99, 100, 102, 104, 105, 106, 108, 109, 110, 114, 117, 118, 119, 120, 121, 122, 124, 125, 128, 134, 135, 136, 138, 140, 141, 143, 144, 145, 152, 154, 161, 162, 166, 174, 175, 176, 178, 179, 183, 186, 188, 191, 193, 195, 196, 197, 198, 199, 206, 218, 221, 228], "sourc": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 52, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 127, 128, 129, 130, 131, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 148, 151, 152, 154, 155, 157, 160, 161, 162, 164, 166, 167, 168, 170, 171, 173, 174, 175, 176, 177, 178, 179, 181, 182, 183, 185, 186, 188, 189, 190, 191, 193, 194, 195, 196, 197, 198, 199, 202, 203, 205, 209, 210, 212, 215, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228], "properti": [2, 3, 11, 12, 13, 15, 19, 21, 22, 23, 24, 27, 30, 31, 37, 46, 48, 49, 50, 58, 59, 64, 65, 78, 80, 83, 86, 88, 91, 92, 97, 100, 107, 116, 117, 120, 121, 122, 138, 139, 140, 157, 175, 181, 182, 186, 191, 195, 228], "start": [2, 9, 11, 17, 22, 30, 34, 38, 47, 50, 58, 79, 80, 83, 86, 96, 100, 116, 124, 125, 131, 171, 179, 182, 193, 197, 209, 224, 228], "_createcheckpoint": 2, "train_dir": [2, 13, 23], "model": [2, 3, 8, 9, 10, 11, 12, 13, 14, 15, 17, 19, 21, 22, 23, 24, 25, 29, 37, 43, 44, 46, 47, 48, 49, 52, 54, 56, 58, 59, 64, 65, 68, 69, 71, 76, 78, 80, 83, 86, 87, 91, 93, 97, 108, 113, 116, 119, 122, 123, 124, 125, 127, 128, 129, 131, 132, 133, 134, 135, 136, 138, 140, 141, 146, 148, 149, 154, 157, 158, 159, 160, 161, 164, 165, 166, 167, 171, 176, 177, 178, 179, 182, 184, 185, 186, 188, 190, 192, 193, 195, 196, 201, 202, 203, 205, 208, 212, 213, 220, 224, 228], "wrapper": [2, 12, 15, 22, 23, 30, 46, 49, 76, 83, 91, 92, 93, 98, 99, 105, 116, 118, 121, 128, 130, 166, 179, 191, 194, 228], "method": [2, 3, 4, 7, 8, 9, 11, 12, 13, 14, 15, 18, 19, 21, 22, 30, 31, 36, 38, 42, 46, 48, 50, 57, 58, 59, 60, 62, 63, 65, 76, 80, 82, 83, 85, 86, 91, 92, 96, 102, 107, 111, 114, 117, 119, 123, 128, 129, 141, 145, 179, 181, 182, 186, 188, 197], "overrid": [2, 4, 7, 8, 10, 11, 12, 13, 15, 17, 18, 22, 30, 31, 32, 36, 38, 43, 46, 48, 50, 57, 58, 60, 61, 76, 77, 79, 80, 83, 84, 86, 87, 88, 92, 102, 106, 111, 117, 135, 141, 145, 160, 171, 175, 176, 178, 181, 182, 195, 196, 209], "purpos": [2, 11, 15, 48, 52, 59, 86, 117, 139, 209], "classmethod": [2, 3, 6, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 27, 29, 30, 31, 32, 35, 36, 37, 43, 44, 46, 48, 49, 50, 52, 56, 58, 59, 60, 61, 62, 64, 67, 69, 76, 77, 79, 80, 82, 83, 85, 86, 87, 88, 90, 91, 92, 96, 98, 100, 102, 104, 105, 106, 110, 111, 116, 117, 118, 119, 124, 128, 129, 131, 135, 136, 138, 140, 141, 142, 145, 146, 154, 155, 160, 161, 162, 166, 168, 176, 177, 178, 179, 183, 185, 186, 188, 194, 195, 196, 197, 198, 199, 209], "_getttldir": 2, "path": [2, 11, 12, 13, 15, 22, 23, 31, 52, 58, 71, 78, 80, 83, 94, 113, 124, 131, 157, 171, 175, 182, 218, 220], "durat": 2, "return": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 52, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 67, 68, 69, 70, 71, 76, 77, 78, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 98, 99, 100, 102, 104, 105, 106, 107, 108, 109, 110, 111, 113, 114, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 128, 129, 131, 134, 135, 136, 137, 138, 139, 140, 141, 142, 145, 146, 148, 151, 152, 154, 157, 160, 161, 162, 164, 166, 167, 168, 171, 173, 175, 176, 177, 178, 179, 181, 182, 183, 185, 186, 188, 189, 190, 191, 193, 194, 195, 196, 197, 198, 199, 202, 203, 205, 209, 210, 212, 217, 218, 219, 220, 223, 224, 228], "time": [2, 4, 8, 9, 12, 13, 15, 17, 19, 21, 23, 29, 30, 41, 46, 48, 58, 59, 60, 62, 64, 65, 71, 76, 77, 78, 80, 83, 86, 87, 91, 92, 96, 100, 102, 104, 105, 108, 111, 117, 125, 129, 131, 135, 138, 140, 141, 161, 162, 173, 195, 196, 197, 198, 199, 228], "limit": [2, 11, 41, 46, 64, 70, 83, 121], "directori": [2, 4, 13, 23, 79, 114, 123, 128, 188, 224, 228], "under": [2, 10, 14, 39, 46, 48, 52, 62, 94], "dir": [2, 37, 80], "requir": [2, 3, 8, 9, 10, 15, 31, 36, 48, 50, 58, 59, 64, 71, 76, 78, 80, 83, 86, 87, 102, 116, 117, 123, 135, 151, 152, 179, 183, 195, 222], "_formatstatusmessag": 2, "messag": [2, 4, 13, 35, 51, 53, 66, 71, 72, 73, 74, 83, 188, 206], "_setstatusmessag": 2, "fals": [2, 3, 7, 8, 9, 11, 12, 13, 15, 17, 19, 21, 22, 23, 25, 27, 29, 30, 36, 40, 46, 47, 48, 49, 50, 52, 56, 57, 58, 59, 60, 65, 70, 71, 76, 77, 78, 80, 83, 84, 86, 87, 92, 94, 96, 100, 107, 110, 114, 118, 121, 123, 124, 127, 128, 135, 136, 139, 141, 151, 157, 160, 161, 166, 167, 171, 183, 189, 193, 195, 196, 197, 198, 205], "updat": [2, 7, 9, 10, 12, 13, 15, 17, 19, 27, 35, 36, 37, 38, 41, 48, 50, 55, 57, 58, 59, 61, 64, 65, 70, 71, 76, 78, 80, 81, 82, 83, 86, 87, 91, 94, 95, 96, 99, 105, 111, 114, 117, 119, 121, 128, 135, 138, 141, 144, 145, 152, 154, 161, 162, 176, 186, 195, 199, 224, 228], "statu": [2, 71, 80, 81, 94], "thi": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 26, 27, 29, 30, 31, 34, 35, 36, 37, 38, 39, 42, 43, 44, 46, 48, 49, 50, 51, 52, 53, 56, 57, 58, 59, 60, 61, 62, 64, 65, 69, 70, 71, 72, 73, 74, 76, 77, 79, 80, 82, 83, 84, 85, 86, 87, 88, 90, 91, 92, 94, 96, 98, 100, 101, 102, 104, 105, 106, 111, 114, 116, 117, 118, 119, 121, 123, 125, 127, 131, 134, 135, 138, 139, 140, 141, 142, 145, 146, 151, 152, 154, 160, 161, 162, 166, 171, 175, 176, 178, 179, 181, 182, 183, 185, 186, 188, 189, 191, 193, 194, 195, 196, 197, 198, 199, 206, 209, 218, 222, 224, 228], "_exportmetr": 2, "kwarg": [2, 4, 6, 8, 9, 10, 11, 12, 13, 15, 17, 19, 22, 24, 27, 29, 30, 31, 32, 35, 42, 43, 44, 45, 46, 48, 50, 52, 56, 57, 58, 59, 60, 61, 62, 64, 65, 67, 69, 70, 76, 77, 78, 79, 80, 83, 85, 86, 88, 90, 91, 92, 96, 98, 100, 101, 102, 104, 105, 106, 107, 108, 110, 111, 114, 116, 117, 118, 119, 124, 125, 131, 134, 135, 136, 138, 140, 141, 142, 145, 146, 154, 155, 160, 161, 162, 166, 168, 175, 176, 177, 178, 179, 182, 185, 186, 188, 194, 195, 196, 197, 198, 199, 209, 210, 218, 228], "export": [2, 12, 13, 24, 52, 71, 78, 80, 99], "extern": [2, 11, 13, 24, 31, 35, 102, 105, 106, 140], "_shouldearlystop": 2, "sess": [2, 11, 13, 18, 23, 24, 31, 46, 78, 80, 83, 94, 114, 116, 119, 124, 131, 160, 228], "option": [2, 4, 8, 9, 10, 11, 12, 13, 15, 17, 22, 25, 27, 31, 41, 46, 47, 48, 49, 50, 52, 58, 59, 60, 61, 70, 71, 76, 77, 78, 80, 82, 83, 86, 87, 91, 92, 102, 104, 106, 108, 110, 118, 135, 136, 139, 151, 152, 161, 173, 175, 176, 191, 198, 199, 218, 228], "session": [2, 8, 11, 13, 23, 37, 46, 47, 78, 80, 82, 83, 94, 108, 114, 116, 119, 131, 160], "none": [2, 3, 4, 6, 8, 9, 10, 11, 12, 13, 15, 17, 18, 19, 21, 22, 23, 24, 25, 27, 29, 30, 31, 35, 36, 37, 40, 41, 43, 46, 47, 48, 49, 50, 52, 56, 57, 58, 59, 60, 61, 62, 64, 66, 70, 71, 76, 77, 78, 79, 80, 81, 82, 83, 85, 86, 87, 88, 89, 91, 92, 94, 95, 96, 97, 98, 99, 100, 101, 102, 106, 108, 109, 110, 114, 116, 117, 118, 119, 121, 124, 129, 131, 135, 136, 138, 141, 142, 145, 151, 152, 160, 161, 162, 166, 167, 171, 173, 175, 176, 188, 189, 191, 193, 195, 196, 197, 198, 199, 218, 224, 228], "bool": [2, 9, 11, 12, 15, 16, 34, 39, 46, 48, 49, 50, 52, 70, 71, 78, 80, 82, 83, 86, 91, 116, 123, 139, 144, 161, 178, 183, 189, 195], "_shouldstop": [2, 80], "check_early_stop": 2, "true": [2, 4, 8, 10, 11, 12, 13, 15, 17, 18, 22, 23, 24, 25, 27, 30, 34, 37, 38, 39, 41, 42, 46, 48, 49, 50, 52, 56, 57, 58, 59, 60, 64, 65, 70, 71, 76, 77, 78, 80, 81, 82, 83, 86, 87, 91, 92, 94, 96, 110, 114, 118, 121, 123, 127, 135, 139, 144, 151, 161, 166, 167, 171, 186, 189, 193, 195, 196, 197, 198, 205, 228], "check": [2, 6, 8, 11, 12, 31, 50, 57, 64, 70, 71, 80, 83, 94, 114, 117, 195], "should": [2, 3, 4, 8, 9, 11, 12, 13, 15, 17, 18, 19, 21, 22, 23, 26, 27, 29, 30, 31, 34, 35, 36, 40, 41, 43, 44, 46, 48, 50, 52, 57, 58, 59, 60, 61, 65, 70, 71, 76, 77, 79, 80, 81, 82, 83, 85, 86, 87, 88, 90, 91, 92, 98, 102, 104, 105, 106, 111, 117, 119, 123, 135, 136, 139, 140, 141, 142, 145, 146, 154, 160, 166, 171, 176, 178, 179, 181, 182, 183, 186, 188, 195, 196, 197, 209, 222], "stop": [2, 3, 34, 37, 41, 80, 83, 189, 224, 228], "paramet": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 29, 30, 31, 33, 34, 35, 36, 37, 38, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 52, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 67, 68, 70, 71, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 90, 91, 92, 93, 94, 95, 96, 98, 100, 102, 104, 105, 106, 108, 109, 110, 111, 113, 114, 116, 117, 118, 119, 120, 121, 123, 124, 125, 127, 128, 129, 131, 134, 135, 136, 137, 138, 139, 140, 141, 142, 144, 145, 148, 149, 151, 152, 154, 158, 160, 161, 162, 165, 166, 167, 171, 173, 175, 176, 177, 179, 182, 183, 185, 186, 188, 189, 190, 191, 193, 195, 196, 197, 198, 199, 201, 209, 213, 217, 218, 219, 220, 224, 228], "tf": [2, 4, 8, 9, 10, 11, 12, 13, 15, 18, 19, 21, 22, 23, 24, 25, 30, 31, 32, 34, 36, 40, 41, 42, 43, 46, 47, 48, 49, 52, 56, 58, 59, 60, 61, 62, 64, 70, 71, 76, 77, 78, 80, 81, 82, 83, 85, 86, 87, 88, 91, 92, 94, 95, 96, 100, 101, 102, 106, 108, 114, 117, 118, 119, 120, 121, 131, 136, 141, 142, 160, 166, 173, 175, 176, 177, 178, 179, 186, 188, 189, 191, 195, 196, 197, 199, 209, 225, 226, 228], "The": [2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 27, 29, 30, 31, 34, 35, 36, 38, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50, 51, 52, 53, 56, 57, 58, 59, 60, 61, 62, 64, 65, 67, 70, 71, 72, 73, 74, 76, 77, 78, 80, 83, 84, 85, 86, 87, 88, 90, 91, 92, 94, 95, 96, 97, 98, 99, 100, 102, 104, 105, 106, 108, 109, 110, 111, 114, 116, 117, 119, 120, 121, 123, 125, 128, 131, 135, 136, 138, 139, 140, 141, 142, 145, 146, 152, 154, 160, 161, 162, 166, 175, 176, 177, 178, 179, 183, 186, 188, 189, 190, 191, 193, 195, 196, 197, 199, 206, 209, 210, 219, 224, 228], "current": [2, 8, 10, 11, 12, 13, 15, 17, 19, 22, 23, 24, 25, 31, 37, 41, 42, 46, 47, 58, 59, 64, 65, 71, 74, 76, 78, 80, 82, 83, 84, 86, 87, 91, 95, 96, 102, 104, 108, 109, 111, 117, 118, 119, 135, 140, 145, 146, 166, 189, 194, 195, 197, 217], "globalstep": 2, "whether": [2, 3, 9, 10, 11, 12, 15, 16, 17, 23, 34, 36, 40, 46, 48, 50, 52, 56, 57, 58, 61, 65, 71, 80, 82, 83, 86, 87, 91, 95, 100, 114, 116, 117, 135, 136, 141, 144, 151, 171, 189, 193, 195, 224], "we": [2, 7, 8, 9, 13, 15, 21, 22, 23, 24, 30, 34, 36, 37, 39, 44, 46, 48, 49, 50, 52, 56, 58, 61, 63, 65, 70, 71, 76, 80, 83, 86, 87, 88, 91, 94, 104, 117, 119, 125, 128, 151, 152, 179, 191, 193, 195, 197, 209, 228], "want": [2, 11, 15, 83, 91, 152, 191], "earlystop": [2, 37], "condit": [2, 10, 19, 22, 30, 31, 47, 71, 83, 161, 179], "In": [2, 3, 8, 11, 13, 15, 22, 34, 35, 36, 41, 44, 46, 48, 58, 59, 61, 70, 76, 83, 86, 87, 88, 100, 104, 114, 125, 128, 140, 177, 179, 182, 189, 191, 197, 218, 228], "tpu": [2, 10, 11, 13, 15, 19, 25, 31, 36, 47, 48, 52, 58, 59, 61, 64, 76, 79, 80, 83, 91, 99, 117, 118, 119, 125, 131, 144, 146, 148, 166, 171, 177, 179, 189, 202, 203, 224, 228], "train": [2, 3, 8, 11, 12, 13, 14, 15, 18, 19, 23, 24, 25, 31, 35, 39, 43, 46, 47, 48, 50, 58, 59, 61, 62, 64, 71, 76, 78, 80, 83, 86, 87, 91, 94, 96, 110, 113, 119, 123, 124, 125, 131, 135, 141, 145, 148, 154, 155, 157, 162, 164, 166, 167, 173, 174, 175, 176, 177, 179, 182, 186, 188, 193, 197, 199, 202, 203, 205, 212, 224, 228], "don": [2, 6, 9, 11, 12, 13, 15, 19, 22, 30, 43, 46, 48, 50, 58, 59, 60, 83, 119, 186], "t": [2, 6, 9, 11, 12, 13, 15, 17, 19, 21, 22, 27, 30, 34, 37, 41, 43, 46, 48, 50, 58, 59, 60, 62, 70, 71, 76, 83, 86, 87, 88, 91, 102, 105, 111, 119, 161, 179, 183, 186, 195, 197], "everi": [2, 9, 15, 17, 22, 38, 42, 43, 46, 50, 58, 62, 64, 70, 71, 76, 80, 83, 86, 87, 88, 92, 96, 102, 106, 114, 135, 162, 175, 197, 217], "granular": 2, "enqueu": [2, 11, 131, 228], "thread": [2, 47, 50, 80, 94, 109, 115, 228], "mai": [2, 3, 7, 8, 11, 12, 13, 15, 17, 22, 24, 30, 31, 34, 36, 38, 44, 46, 48, 49, 50, 58, 71, 76, 80, 83, 84, 86, 87, 94, 119, 123, 127, 128, 179, 188, 189, 191, 197], "starv": 2, "loop": [2, 3, 11, 13, 22, 46, 47, 48, 58, 61, 64, 76, 80, 83, 87, 88, 91, 96, 118, 119, 131, 135, 228], "which": [2, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 18, 19, 21, 22, 24, 27, 30, 35, 36, 38, 39, 43, 44, 46, 47, 48, 50, 52, 56, 57, 58, 59, 60, 61, 64, 65, 70, 71, 76, 77, 78, 80, 83, 85, 86, 87, 88, 90, 91, 92, 94, 96, 97, 100, 102, 104, 105, 108, 110, 117, 118, 119, 121, 129, 134, 135, 136, 138, 139, 140, 141, 142, 145, 152, 154, 160, 161, 176, 178, 179, 186, 188, 194, 195, 197, 219], "default": [2, 3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 19, 22, 24, 27, 30, 35, 36, 38, 41, 43, 46, 48, 49, 50, 52, 57, 58, 59, 60, 61, 62, 65, 67, 70, 71, 76, 78, 80, 83, 86, 87, 88, 91, 92, 94, 96, 102, 104, 106, 110, 116, 117, 119, 128, 135, 136, 141, 142, 146, 151, 155, 160, 161, 162, 166, 168, 175, 176, 177, 179, 181, 182, 186, 188, 191, 193, 195, 196, 197, 209], "oper": [2, 6, 7, 8, 11, 12, 13, 15, 18, 19, 22, 23, 24, 30, 34, 35, 36, 38, 43, 48, 58, 59, 60, 61, 71, 76, 82, 83, 86, 91, 94, 100, 125, 135, 140, 228], "1000": [2, 36, 125, 228], "_findnewcheckpoint": 2, "processed_ckpt": 2, "new": [2, 4, 8, 10, 11, 15, 17, 24, 25, 30, 41, 46, 48, 52, 56, 57, 58, 59, 71, 77, 78, 79, 80, 83, 87, 91, 94, 102, 105, 108, 114, 120, 135, 138, 139, 140, 152, 161, 182, 195, 199], "rais": [2, 8, 11, 12, 13, 14, 15, 18, 23, 24, 31, 42, 48, 50, 52, 56, 57, 58, 67, 68, 70, 76, 78, 79, 82, 83, 87, 92, 94, 116, 117, 118, 123, 125, 128, 135, 141, 152, 171, 182, 191, 218, 224], "runtimeerror": [2, 23, 24, 42, 76, 118], "_trainerfinish": 2, "infer": [2, 8, 10, 13, 15, 18, 35, 39, 52, 58, 59, 78, 80, 86, 91, 102, 106, 117, 119, 145, 154, 162, 176, 189, 195, 199, 210, 228], "finish": [2, 7, 17, 23, 50, 59, 71, 77, 80, 94, 228], "us": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 21, 22, 23, 24, 28, 29, 30, 31, 34, 35, 36, 38, 39, 40, 42, 43, 44, 45, 46, 47, 48, 49, 50, 52, 55, 57, 58, 59, 60, 61, 62, 63, 64, 65, 67, 69, 70, 71, 76, 77, 78, 79, 80, 82, 83, 84, 86, 87, 88, 90, 91, 92, 93, 94, 96, 97, 100, 101, 102, 104, 105, 106, 108, 110, 111, 114, 116, 117, 118, 119, 121, 122, 123, 124, 127, 128, 131, 134, 135, 136, 140, 141, 142, 144, 145, 146, 148, 151, 152, 154, 160, 161, 162, 164, 166, 168, 175, 176, 177, 178, 179, 181, 182, 188, 190, 191, 193, 195, 196, 197, 199, 205, 209, 218, 224, 227, 228], "latest": [2, 23, 36, 80, 94, 131, 228], "_runonlatestcheckpoint": 2, "runner_fn": 2, "runner_dir": [2, 83], "execut": [2, 11, 64, 76, 78, 80, 83, 114, 125, 131, 218, 228], "produc": [2, 22, 31, 39, 48, 50, 64, 70, 71, 83, 91, 102, 104, 106, 119, 175, 179, 189, 191, 196, 224], "comput": [2, 6, 8, 9, 10, 12, 13, 15, 17, 19, 21, 22, 24, 26, 27, 30, 34, 35, 36, 38, 40, 41, 43, 44, 45, 46, 47, 48, 49, 58, 59, 60, 61, 62, 63, 64, 65, 71, 76, 82, 83, 85, 86, 87, 88, 90, 91, 92, 97, 98, 102, 104, 106, 108, 109, 114, 119, 134, 135, 136, 137, 140, 141, 143, 145, 151, 152, 154, 161, 162, 175, 176, 179, 185, 186, 195, 196, 199, 209, 220, 221], "callabl": [2, 11, 15, 42, 50, 57, 70, 76, 77, 80, 83, 87, 114, 175, 178, 179, 183, 186], "take": [2, 3, 8, 9, 12, 15, 21, 22, 34, 42, 48, 56, 58, 61, 64, 76, 77, 80, 83, 86, 87, 96, 104, 108, 109, 114, 116, 135, 168, 190, 191, 197, 218, 219], "appli": [2, 4, 6, 7, 8, 9, 10, 12, 13, 15, 19, 21, 22, 27, 29, 30, 31, 36, 38, 43, 44, 46, 48, 49, 55, 56, 58, 59, 60, 61, 62, 65, 70, 71, 76, 83, 85, 86, 87, 88, 90, 91, 92, 98, 100, 102, 106, 117, 135, 141, 175, 176, 186, 193, 195, 196, 198, 219], "save": [2, 11, 13, 21, 23, 35, 78, 80, 83, 87, 94, 119, 145, 154, 199], "log": [2, 8, 10, 17, 41, 56, 58, 66, 70, 83, 104, 123, 135, 144, 161, 162, 179, 188, 195, 199, 217, 228], "_runonallcheckpoint": 2, "_invizierstudi": 2, "_updateearlystopmetr": 2, "jobnam": [2, 37], "global_step": [2, 3, 13, 31, 36, 37, 46, 71, 76, 80, 82, 83, 85, 91, 94, 119, 124, 131], "metric_nam": 2, "metric_valu": [2, 83], "_writetolog": 2, "text": [2, 50, 65, 71, 77, 83, 108, 122, 151, 152, 160, 162, 164, 173, 174, 181, 182, 183, 188, 190, 197, 209, 220, 223, 226, 227], "filenam": [2, 4, 33, 83, 94, 151, 152], "_waituntilinit": 2, "start_up_delay_step": 2, "wait": [2, 23, 79, 80, 94], "until": [2, 34, 64, 71, 80, 83, 96], "i": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 27, 29, 30, 31, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 48, 49, 50, 52, 54, 56, 57, 58, 59, 60, 61, 62, 63, 64, 67, 68, 70, 71, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 90, 91, 92, 94, 95, 96, 97, 98, 100, 102, 104, 105, 106, 108, 110, 111, 114, 116, 117, 118, 119, 121, 122, 123, 125, 128, 134, 135, 136, 137, 138, 139, 140, 141, 142, 144, 145, 146, 151, 152, 154, 160, 161, 162, 166, 171, 175, 176, 177, 179, 182, 183, 186, 188, 189, 191, 193, 194, 195, 196, 197, 198, 199, 205, 209, 217, 218, 219, 220, 222, 228], "readi": [2, 15, 58], "_runloop": 2, "job_nam": [2, 11, 13, 24, 31, 80, 224, 228], "loop_func": 2, "loop_arg": 2, "cleanup_func": 2, "run": [2, 7, 8, 10, 11, 13, 15, 22, 31, 34, 36, 37, 43, 46, 47, 48, 58, 61, 62, 64, 71, 76, 78, 79, 80, 82, 83, 87, 91, 92, 94, 102, 104, 114, 116, 117, 119, 123, 124, 129, 131, 135, 151, 152, 164, 166, 171, 176, 182, 186, 191, 199, 218, 224, 225, 228], "expect": [2, 8, 13, 15, 17, 21, 22, 29, 30, 35, 46, 48, 50, 57, 58, 59, 62, 69, 71, 80, 83, 85, 86, 87, 91, 92, 106, 111, 116, 119, 123, 135, 138, 140, 145, 154, 162, 176, 179, 191, 195, 196, 199], "error": [2, 3, 4, 12, 14, 63, 71, 80, 83, 90, 94, 137, 143, 148, 151, 152, 175, 191], "string": [2, 4, 7, 11, 12, 13, 14, 15, 22, 24, 29, 31, 35, 42, 46, 48, 50, 52, 58, 64, 65, 67, 70, 71, 76, 77, 78, 80, 83, 84, 91, 97, 102, 108, 111, 116, 117, 118, 119, 122, 123, 128, 135, 136, 137, 142, 145, 151, 152, 154, 160, 162, 168, 171, 176, 177, 179, 188, 195, 197, 199, 209, 217, 218, 219, 224], "name": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 27, 29, 30, 31, 35, 36, 38, 42, 43, 45, 46, 47, 48, 50, 51, 52, 57, 58, 59, 60, 61, 64, 70, 71, 76, 77, 79, 80, 81, 83, 84, 85, 86, 87, 88, 91, 92, 96, 98, 99, 100, 101, 102, 106, 108, 109, 111, 114, 117, 118, 119, 121, 123, 124, 125, 127, 128, 129, 131, 135, 136, 138, 140, 141, 142, 144, 145, 151, 154, 160, 161, 162, 166, 171, 174, 175, 176, 177, 178, 179, 182, 183, 186, 190, 191, 193, 195, 196, 197, 220, 224, 228], "list": [2, 4, 7, 8, 11, 12, 13, 15, 17, 21, 22, 23, 24, 27, 30, 31, 35, 36, 38, 42, 43, 44, 46, 47, 48, 49, 50, 52, 54, 57, 58, 59, 60, 61, 62, 64, 65, 70, 71, 76, 77, 78, 79, 80, 83, 85, 86, 87, 88, 90, 91, 92, 98, 102, 105, 106, 108, 109, 113, 114, 116, 117, 118, 119, 123, 135, 137, 141, 142, 143, 145, 146, 151, 152, 154, 160, 161, 162, 166, 171, 176, 186, 191, 195, 196, 197, 198, 199, 219, 220, 224, 228], "tupl": [2, 6, 8, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 30, 34, 42, 43, 44, 47, 48, 50, 52, 54, 56, 58, 59, 60, 62, 70, 71, 76, 77, 83, 86, 87, 90, 91, 92, 102, 108, 109, 116, 125, 135, 138, 139, 140, 151, 161, 162, 176, 188, 191, 195, 198, 209, 220, 228], "argument": [2, 7, 8, 13, 15, 21, 22, 31, 36, 38, 43, 47, 48, 50, 57, 58, 64, 65, 76, 77, 83, 86, 87, 91, 92, 102, 108, 118, 123, 161, 175, 178, 188, 191, 218, 224], "pass": [2, 7, 8, 10, 11, 12, 13, 15, 17, 21, 22, 30, 31, 36, 38, 40, 44, 46, 48, 50, 57, 58, 59, 62, 64, 71, 76, 77, 83, 86, 87, 90, 91, 92, 94, 102, 104, 105, 106, 108, 110, 114, 119, 140, 145, 161, 175, 189, 218], "befor": [2, 7, 8, 11, 13, 15, 17, 21, 22, 26, 36, 37, 38, 46, 47, 48, 50, 58, 70, 71, 80, 83, 91, 94, 100, 110, 114, 117, 129, 135, 141, 151, 152, 161, 178, 193, 199, 209, 218], "_dequeuethreadcomplet": 2, "_loopenqueu": [2, 131, 228], "session_overrid": 2, "_getsess": [2, 125, 131, 228], "gettraindir": 2, "_createsummarywrit": 2, "creat": [2, 4, 7, 8, 9, 10, 11, 12, 13, 15, 19, 22, 23, 27, 30, 31, 35, 36, 38, 42, 43, 46, 48, 49, 50, 54, 58, 59, 60, 61, 68, 71, 76, 77, 78, 80, 83, 85, 86, 87, 88, 91, 92, 94, 96, 102, 106, 108, 114, 117, 118, 119, 125, 128, 129, 134, 135, 136, 141, 145, 154, 166, 176, 179, 183, 186, 193, 195, 196, 199, 217, 224, 227, 228], "summari": [2, 13, 27, 64, 76, 77, 80, 81, 83, 91, 104, 108, 114, 118, 124, 131, 135, 141, 144, 154, 195, 228], "writer": [2, 114, 131, 218], "_createtf2summarywrit": 2, "tf2": [2, 4, 13, 76, 83, 114, 186], "_tf2summarycontext": 2, "_createtf2summaryop": 2, "_initializetf2summarywrit": 2, "_runtf2summaryop": 2, "_writesummari": [2, 80], "summary_writ": 2, "text_filenam": 2, "construct": [2, 13, 21, 22, 24, 35, 37, 40, 46, 48, 50, 56, 57, 58, 59, 64, 78, 79, 80, 83, 87, 94, 100, 102, 106, 114, 119, 125, 128, 140, 145, 154, 162, 176, 179, 199, 210, 224, 228], "write": [2, 13, 33, 50, 52, 80, 83, 94, 97, 121, 124, 152, 171, 218, 224, 228], "them": [2, 11, 12, 13, 15, 18, 46, 58, 76, 80, 83, 86, 117, 119, 162, 175, 183, 186, 191, 209, 219, 224, 228], "tri": [2, 48, 83, 164], "eval": [2, 3, 13, 19, 23, 35, 58, 64, 80, 83, 86, 91, 96, 117, 119, 124, 125, 131, 136, 141, 154, 160, 176, 228], "gener": [2, 8, 9, 10, 11, 12, 13, 14, 15, 31, 35, 37, 42, 48, 50, 52, 55, 57, 58, 59, 62, 71, 77, 79, 80, 83, 86, 87, 88, 90, 92, 94, 97, 99, 100, 104, 108, 111, 116, 119, 128, 131, 135, 140, 142, 146, 148, 151, 152, 155, 160, 166, 177, 178, 179, 182, 183, 188, 191, 197, 202, 203, 205, 209, 219, 224, 228], "dict": [2, 8, 10, 11, 12, 13, 14, 15, 17, 22, 24, 35, 43, 45, 46, 48, 49, 50, 52, 54, 57, 58, 59, 60, 61, 64, 70, 76, 77, 78, 80, 81, 82, 83, 86, 87, 88, 92, 102, 106, 108, 109, 114, 117, 118, 119, 125, 128, 129, 131, 135, 136, 138, 140, 141, 144, 145, 151, 152, 154, 161, 162, 173, 175, 176, 179, 182, 188, 189, 191, 195, 196, 199, 210, 220, 224, 228], "from": [2, 4, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 21, 22, 23, 24, 30, 31, 32, 35, 36, 40, 41, 42, 43, 45, 46, 47, 48, 49, 50, 52, 56, 57, 58, 59, 60, 61, 63, 64, 65, 70, 71, 76, 77, 78, 79, 80, 83, 84, 86, 87, 88, 91, 92, 94, 96, 97, 99, 100, 102, 104, 105, 106, 109, 110, 111, 114, 117, 118, 119, 121, 123, 124, 128, 129, 131, 134, 135, 136, 137, 138, 140, 141, 142, 145, 151, 154, 160, 162, 166, 171, 175, 176, 179, 181, 182, 183, 185, 186, 188, 189, 191, 195, 196, 197, 199, 209, 217, 218, 219, 220, 221, 223, 224, 227, 228], "kei": [2, 8, 9, 10, 11, 12, 13, 15, 21, 22, 23, 35, 37, 40, 41, 42, 43, 45, 46, 47, 48, 50, 51, 53, 54, 58, 59, 60, 61, 62, 64, 66, 70, 71, 73, 78, 80, 81, 83, 86, 87, 88, 91, 92, 100, 102, 104, 106, 107, 108, 114, 117, 119, 120, 128, 131, 135, 141, 142, 145, 152, 154, 160, 161, 162, 176, 188, 191, 195, 196, 197, 199, 209, 218, 220, 224, 228], "protobuf": [2, 51, 53, 72, 73, 74, 206], "If": [2, 3, 4, 6, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 21, 23, 30, 37, 42, 46, 47, 48, 49, 50, 52, 56, 57, 58, 59, 62, 64, 67, 70, 71, 76, 78, 80, 83, 86, 87, 91, 92, 94, 95, 96, 100, 106, 114, 116, 118, 121, 124, 125, 128, 131, 139, 141, 142, 144, 152, 160, 161, 175, 179, 182, 183, 189, 193, 195, 196, 197, 198, 218, 224, 228], "file": [2, 4, 10, 11, 13, 23, 31, 37, 65, 71, 78, 81, 83, 94, 96, 114, 116, 124, 127, 128, 131, 135, 142, 151, 152, 160, 161, 162, 171, 175, 179, 195, 197, 209, 212, 217, 218, 219, 221, 222, 223, 224, 227], "_writeinputdatastatsummari": 2, "summary_str": 2, "global_enqueue_step": 2, "input": [2, 4, 6, 8, 9, 10, 11, 12, 13, 14, 15, 17, 19, 21, 22, 24, 27, 29, 30, 31, 35, 39, 40, 42, 43, 44, 46, 47, 48, 49, 52, 55, 58, 59, 60, 61, 62, 64, 65, 71, 78, 79, 80, 83, 85, 86, 87, 88, 90, 91, 92, 98, 100, 102, 104, 105, 106, 107, 108, 110, 111, 114, 116, 117, 119, 135, 136, 138, 140, 142, 144, 145, 146, 148, 154, 155, 157, 160, 161, 162, 166, 171, 174, 175, 176, 177, 178, 179, 182, 186, 188, 189, 190, 191, 193, 194, 195, 196, 197, 198, 199, 202, 203, 205, 209, 218, 224], "data": [2, 4, 11, 14, 15, 19, 20, 21, 22, 30, 31, 32, 33, 36, 40, 47, 48, 50, 58, 70, 71, 77, 79, 80, 83, 87, 100, 101, 102, 104, 118, 131, 134, 136, 140, 142, 145, 155, 157, 160, 164, 166, 171, 173, 175, 178, 183, 188, 194, 195, 197, 209, 212, 224, 228], "stat": [2, 11, 19, 58, 80, 146, 152, 182, 221], "merg": [2, 8, 15, 17, 50, 58, 59, 61, 71, 80, 83, 86, 97, 109], "scalar": [2, 4, 8, 9, 10, 13, 15, 17, 34, 41, 42, 48, 58, 59, 60, 61, 64, 71, 76, 83, 86, 87, 90, 92, 95, 96, 102, 104, 105, 106, 108, 110, 114, 118, 154, 179, 183, 191, 195, 209], "relat": [2, 8, 9, 107, 117, 141, 179, 195], "measur": [2, 3, 64, 80, 97, 152, 228], "how": [2, 7, 8, 13, 15, 27, 31, 44, 50, 58, 65, 83, 102, 114, 118, 128, 135, 152, 175, 179, 195, 197], "mani": [2, 11, 13, 21, 46, 65, 71, 80, 83, 102, 152, 161, 179, 183, 197, 222], "global": [2, 3, 11, 12, 13, 16, 23, 30, 31, 37, 46, 48, 61, 71, 76, 80, 82, 83, 84, 94, 96, 119, 124, 127, 128, 131, 179, 182, 197], "ha": [2, 7, 8, 10, 11, 15, 17, 21, 22, 29, 30, 36, 38, 40, 41, 48, 50, 57, 58, 59, 60, 64, 68, 71, 76, 80, 81, 83, 86, 87, 88, 90, 91, 94, 96, 100, 104, 116, 117, 121, 128, 135, 136, 161, 162, 179, 183, 190, 191, 195, 198, 222], "been": [2, 7, 10, 12, 15, 36, 38, 50, 61, 76, 81, 83, 86, 91, 94, 100, 102, 104, 117, 128, 135, 195, 197, 209], "defin": [3, 8, 9, 11, 12, 13, 14, 15, 17, 31, 39, 42, 46, 48, 50, 57, 58, 59, 64, 80, 83, 86, 91, 92, 94, 100, 102, 104, 106, 107, 128, 129, 161, 173, 175, 179, 182, 188, 190, 191, 196, 197], "explor": [3, 61], "report_interval_second": 3, "objective_metric_kei": 3, "overridemodelparam": 3, "model_param": [3, 47, 52, 83, 171], "modifi": [3, 8, 10, 22, 31, 44, 48, 58, 71, 83, 106, 135, 193, 194, 195, 197], "accord": [3, 8, 9, 12, 13, 46, 48, 49, 50, 52, 55, 58, 59, 61, 71, 83, 86, 87, 96, 100, 101, 120, 179, 195], "through": [3, 8, 11, 12, 13, 15, 22, 25, 44, 46, 48, 59, 64, 83, 88, 91, 92, 99, 100, 102, 114, 119, 145, 154, 162, 175, 176, 178, 179, 182, 186, 191], "tweak": 3, "e": [3, 4, 6, 8, 9, 10, 11, 12, 13, 15, 19, 21, 22, 24, 25, 27, 30, 31, 34, 35, 42, 43, 44, 46, 48, 50, 56, 57, 58, 59, 60, 64, 65, 70, 71, 76, 77, 80, 81, 83, 85, 86, 87, 88, 90, 91, 96, 98, 100, 102, 110, 114, 119, 121, 123, 128, 135, 145, 151, 154, 162, 171, 175, 176, 179, 186, 191, 193, 196, 197, 199, 218, 224, 225], "g": [3, 6, 8, 9, 10, 11, 12, 13, 15, 19, 21, 22, 24, 25, 27, 30, 31, 35, 42, 43, 44, 46, 48, 50, 57, 58, 59, 60, 64, 65, 70, 71, 76, 77, 80, 81, 83, 85, 87, 88, 90, 91, 96, 98, 100, 102, 108, 110, 114, 121, 123, 128, 135, 145, 151, 154, 162, 171, 175, 176, 179, 186, 193, 196, 197, 199, 218, 224, 225], "learn": [3, 7, 8, 35, 38, 44, 45, 58, 61, 76, 96, 111, 119, 161, 179, 193, 219], "rate": [3, 7, 35, 38, 48, 61, 71, 76, 96, 108, 111, 119, 148, 151, 152, 161, 193, 217], "shape": [3, 6, 8, 9, 10, 11, 12, 15, 17, 18, 19, 21, 22, 27, 29, 30, 36, 40, 41, 43, 46, 48, 49, 53, 56, 58, 59, 60, 62, 67, 71, 76, 77, 82, 83, 86, 87, 88, 90, 91, 92, 99, 100, 102, 105, 106, 108, 110, 114, 116, 117, 118, 120, 121, 129, 134, 135, 136, 137, 138, 140, 141, 142, 160, 161, 162, 171, 173, 176, 177, 179, 185, 188, 190, 191, 195, 196, 197, 198, 199, 209], "depth": [3, 11, 58, 59, 62, 83, 86, 92, 104, 138, 195, 196, 198], "width": [3, 11, 19, 27, 29, 30, 46, 58, 77, 177], "network": [3, 8, 22, 24, 43, 44, 48, 50, 58, 59, 83, 87, 90, 91, 177, 188, 193], "origin": [3, 9, 10, 11, 34, 44, 46, 48, 49, 54, 58, 59, 71, 77, 83, 96, 97, 100, 116, 140, 177, 179, 197, 209], "shouldstop": 3, "reportdon": 3, "infeas": 3, "infeasible_reason": 3, "report": [3, 64, 80, 195, 228], "complet": [3, 58, 71, 80], "shouldstopandmaybereport": 3, "metrics_dict": [3, 80], "counter": [3, 48, 65, 79, 81, 108], "contain": [3, 6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 18, 19, 22, 23, 24, 27, 29, 30, 31, 32, 35, 43, 44, 45, 46, 48, 50, 52, 54, 57, 58, 59, 60, 61, 62, 63, 65, 68, 70, 71, 76, 77, 80, 82, 83, 85, 86, 87, 90, 91, 92, 93, 96, 98, 100, 102, 104, 105, 106, 108, 110, 114, 116, 117, 119, 123, 127, 134, 135, 136, 137, 138, 140, 141, 142, 145, 154, 160, 161, 162, 175, 176, 177, 179, 183, 186, 191, 193, 195, 196, 197, 198, 199, 209, 224], "do": [3, 7, 9, 10, 11, 12, 15, 21, 22, 44, 46, 48, 50, 64, 65, 69, 71, 76, 80, 83, 86, 87, 91, 92, 95, 104, 117, 118, 136, 183, 191, 209], "noth": [3, 48, 83, 118, 141, 161, 175, 179], "_doreporttrainingprogress": 3, "reportevalmeasur": 3, "checkpoint_path": [3, 18, 23, 83, 131, 182], "A": [3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 25, 27, 29, 30, 31, 32, 33, 34, 35, 36, 38, 42, 43, 44, 45, 46, 48, 49, 50, 52, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 67, 70, 71, 76, 77, 78, 80, 81, 82, 83, 85, 86, 87, 88, 90, 91, 92, 93, 94, 95, 96, 98, 99, 100, 102, 104, 105, 106, 107, 108, 109, 110, 111, 113, 114, 116, 117, 118, 119, 121, 123, 125, 128, 129, 131, 134, 135, 136, 137, 138, 140, 141, 142, 144, 145, 146, 151, 152, 154, 160, 161, 162, 166, 168, 173, 175, 176, 177, 179, 182, 185, 186, 188, 191, 193, 195, 196, 197, 198, 199, 209, 217, 218, 220, 223, 224, 228], "implement": [3, 4, 8, 9, 10, 11, 12, 13, 14, 15, 17, 19, 21, 22, 25, 27, 29, 30, 34, 35, 36, 39, 40, 43, 44, 46, 47, 48, 58, 59, 60, 64, 65, 71, 77, 79, 80, 83, 85, 86, 87, 90, 91, 92, 94, 96, 98, 101, 102, 104, 107, 118, 119, 121, 122, 135, 139, 140, 141, 142, 160, 162, 171, 175, 176, 177, 179, 182, 185, 186, 188, 189, 195, 196, 197, 199], "doe": [3, 8, 9, 10, 11, 12, 15, 24, 36, 48, 49, 50, 52, 57, 58, 65, 70, 71, 76, 77, 78, 83, 86, 87, 88, 91, 96, 105, 106, 116, 118, 125, 129, 139, 140, 141, 161, 171, 179, 186, 224, 228], "except": [3, 9, 11, 14, 15, 17, 42, 71, 76, 79, 87, 89, 92, 94, 96, 116, 123, 138, 179, 182, 186], "tunermanagederror": 3, "baseexcept": 3, "propag": [3, 11, 12, 13, 15, 22, 27, 30, 34, 43, 44, 46, 48, 58, 59, 60, 85, 86, 87, 90, 92, 98, 118, 154, 162, 179, 186, 196], "tuner": 3, "py": [3, 15, 19, 20, 29, 32, 58, 81, 83, 110, 151, 152, 188, 189, 219, 224, 228], "catch": 3, "treat": [3, 8, 11, 14, 15, 50, 52, 71, 88, 123, 142, 160, 182, 197], "unknown": [3, 11, 67, 116, 179], "failur": [3, 49, 94], "howev": [3, 11, 15, 22, 44, 50, 76, 83, 94, 179, 195, 197, 222], "some": [3, 8, 9, 10, 11, 12, 13, 22, 31, 44, 46, 48, 49, 50, 58, 59, 68, 76, 83, 86, 91, 102, 104, 117, 118, 119, 128, 140, 179, 189, 191, 195, 222], "case": [3, 7, 11, 13, 15, 35, 36, 38, 40, 48, 49, 50, 58, 59, 60, 61, 70, 71, 76, 80, 83, 86, 87, 91, 116, 128, 135, 140, 151, 175, 179, 183, 197, 223], "pyglov": 3, "an": [3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 22, 24, 30, 31, 34, 35, 36, 38, 42, 43, 44, 45, 46, 48, 49, 50, 52, 55, 56, 57, 58, 59, 60, 61, 63, 64, 65, 70, 71, 76, 77, 78, 79, 80, 81, 82, 83, 84, 86, 87, 91, 92, 94, 97, 100, 102, 104, 105, 106, 108, 109, 111, 114, 116, 117, 119, 125, 134, 135, 137, 139, 140, 142, 145, 154, 160, 161, 162, 175, 176, 179, 188, 191, 193, 195, 196, 197, 209, 210, 218, 224, 228], "earlystoppingerror": 3, "signal": [3, 58, 122, 140], "earli": [3, 37, 41, 52, 63, 80, 228], "might": [3, 8, 34, 83, 94, 141, 179, 188], "place": [3, 7, 15, 24, 46, 48, 55, 80, 83, 87, 134, 188, 197], "ani": [3, 11, 12, 13, 15, 23, 30, 46, 50, 54, 56, 58, 61, 70, 71, 76, 77, 80, 83, 86, 87, 94, 104, 116, 119, 123, 127, 129, 135, 136, 141, 144, 179, 183, 186, 189, 191, 195, 222, 224], "moment": [3, 19, 58, 76, 182], "migrat": [4, 83], "_clone_modul": 4, "m": [4, 15, 38, 40, 46, 48, 63, 71, 91, 119, 122, 181], "shallow": [4, 70], "clone": 4, "summarize_tf2_statu": 4, "summar": [4, 80, 83, 151, 152, 195], "version": [4, 8, 9, 15, 27, 38, 40, 80, 91, 94, 102, 106, 138, 152, 162, 188, 195, 196, 224], "environ": [4, 86, 188, 224], "_cachedataset": 4, "input_dataset": 4, "unaryunchangedstructuredataset": 4, "cach": [4, 15, 81, 188], "element": [4, 8, 9, 10, 11, 15, 17, 21, 30, 31, 48, 54, 56, 58, 70, 71, 77, 79, 83, 100, 102, 104, 106, 108, 120, 121, 135, 151, 152, 161, 188, 191, 195, 220], "its": [4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 26, 27, 29, 30, 31, 36, 38, 43, 44, 48, 50, 57, 58, 59, 60, 62, 63, 70, 71, 76, 80, 83, 85, 86, 87, 88, 90, 91, 92, 96, 98, 100, 102, 104, 105, 106, 110, 111, 117, 129, 134, 135, 138, 140, 141, 145, 161, 179, 185, 186, 188, 191, 195, 196, 197, 198, 199, 217, 219], "_abc_impl": [4, 175, 183], "_abc": [4, 175, 183], "_abc_data": [4, 175, 183], "_shuffledataset": 4, "buffer_s": 4, "seed": [4, 10, 40, 52, 71, 83, 87, 90, 100, 110], "reshuffle_each_iter": 4, "randomli": [4, 47, 48, 58, 59, 71, 83, 100, 175, 177, 179, 197], "shuffl": [4, 48, 91, 175, 197], "stateless_shuffle_dataset": 4, "stateless": [4, 83, 87, 100, 102], "shuffledataset": 4, "uncondition": 4, "It": [4, 8, 10, 12, 15, 17, 22, 29, 30, 43, 44, 46, 48, 49, 50, 58, 59, 61, 62, 70, 71, 76, 80, 83, 86, 87, 88, 91, 92, 94, 100, 102, 104, 106, 108, 114, 118, 128, 135, 138, 140, 166, 179, 186, 195, 196, 197, 199, 217, 222, 224], "can": [4, 7, 8, 9, 11, 12, 13, 15, 18, 19, 21, 22, 24, 25, 27, 30, 34, 35, 36, 38, 39, 42, 43, 44, 45, 46, 48, 50, 56, 57, 58, 59, 60, 61, 64, 71, 76, 77, 78, 80, 82, 83, 85, 86, 87, 88, 90, 91, 92, 96, 100, 102, 104, 105, 106, 109, 110, 114, 116, 117, 118, 119, 123, 127, 134, 135, 140, 141, 145, 151, 152, 154, 162, 166, 175, 176, 179, 186, 188, 191, 195, 196, 197, 198, 199, 218, 222, 224], "obtain": [4, 11, 15, 16, 31, 71, 83, 86, 100, 197, 209], "support": [4, 6, 11, 12, 13, 15, 21, 24, 30, 31, 46, 48, 50, 52, 57, 58, 59, 62, 70, 71, 80, 83, 86, 87, 91, 92, 94, 102, 106, 116, 117, 138, 140, 151, 179, 189, 194, 195, 196, 197], "tf1": [4, 83, 114, 186], "api": [4, 13, 30, 35, 50, 82, 83, 88, 106, 117, 134], "make_one_shot_iter": 4, "rubric": 4, "exampl": [4, 8, 9, 11, 12, 13, 15, 17, 21, 22, 27, 31, 34, 35, 42, 43, 44, 45, 46, 48, 50, 54, 58, 59, 60, 64, 70, 71, 76, 78, 80, 81, 83, 86, 91, 92, 97, 100, 102, 108, 117, 119, 121, 131, 135, 141, 142, 145, 151, 152, 154, 160, 162, 173, 175, 176, 178, 179, 182, 183, 186, 188, 189, 191, 195, 196, 197, 199, 209, 218, 224, 228], "rang": [4, 8, 9, 11, 12, 15, 22, 34, 41, 42, 48, 58, 62, 70, 71, 80, 83, 86, 88, 100, 102, 135, 177], "3": [4, 8, 9, 10, 15, 17, 34, 41, 46, 48, 52, 54, 56, 58, 59, 63, 71, 77, 83, 87, 90, 91, 92, 98, 100, 108, 116, 119, 135, 140, 141, 148, 151, 166, 167, 171, 177, 186, 189, 191, 193, 195, 197, 205, 220], "int64": [4, 48, 71, 137, 189], "tensor": [4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 18, 19, 21, 22, 27, 29, 30, 31, 34, 35, 36, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 54, 56, 58, 59, 60, 61, 62, 64, 65, 71, 76, 77, 80, 82, 83, 86, 87, 88, 90, 91, 92, 95, 96, 99, 100, 102, 104, 105, 106, 108, 109, 110, 114, 116, 117, 118, 119, 120, 121, 129, 131, 134, 135, 136, 137, 138, 139, 140, 141, 142, 144, 145, 146, 154, 160, 161, 162, 166, 171, 175, 176, 177, 179, 183, 185, 186, 188, 189, 191, 195, 196, 197, 198, 199, 209, 217, 228], "repres": [4, 6, 7, 8, 10, 11, 12, 13, 15, 17, 19, 22, 24, 30, 35, 36, 38, 41, 42, 43, 45, 46, 48, 49, 50, 56, 57, 58, 59, 60, 61, 70, 71, 76, 83, 86, 87, 88, 91, 99, 100, 102, 104, 105, 106, 110, 119, 120, 134, 135, 136, 137, 138, 145, 154, 179, 191, 193, 195, 196, 199, 209, 217], "number": [4, 6, 9, 10, 11, 12, 15, 17, 19, 22, 23, 24, 30, 31, 34, 37, 40, 41, 42, 43, 46, 48, 50, 52, 54, 56, 58, 59, 60, 63, 64, 71, 76, 77, 78, 80, 83, 86, 87, 88, 91, 93, 100, 102, 104, 106, 108, 111, 118, 119, 131, 135, 136, 137, 138, 140, 152, 161, 162, 171, 173, 175, 176, 179, 189, 190, 191, 193, 195, 197, 219, 222, 224, 228], "sampl": [4, 10, 11, 13, 15, 35, 39, 43, 48, 56, 64, 67, 71, 80, 83, 91, 92, 100, 110, 111, 116, 119, 131, 135, 140, 142, 145, 154, 160, 162, 164, 171, 176, 179, 195, 197, 199, 217], "random": [4, 10, 40, 48, 52, 56, 71, 83, 90, 91, 100, 110, 135, 177, 186], "distribut": [4, 8, 10, 13, 15, 35, 36, 40, 42, 58, 60, 71, 83, 86, 110, 111, 145, 154, 162, 176, 179, 195, 199, 228], "see": [4, 7, 8, 10, 15, 17, 27, 34, 36, 38, 41, 42, 46, 48, 50, 58, 59, 60, 70, 71, 76, 78, 83, 86, 87, 90, 91, 92, 93, 102, 104, 106, 109, 110, 114, 116, 117, 121, 139, 140, 183, 186, 188, 190, 197, 198, 217, 224], "set_se": 4, "behavior": [4, 8, 11, 48, 50, 59, 60, 71, 77, 83, 86, 87, 94, 96, 114, 117, 135], "boolean": [4, 10, 58, 65, 70, 71, 80, 83], "indic": [4, 7, 9, 10, 11, 15, 22, 24, 34, 36, 38, 40, 46, 48, 50, 56, 58, 59, 60, 61, 63, 70, 71, 76, 80, 82, 83, 104, 116, 139, 145, 161, 179, 188, 198, 199], "pseudorandomli": 4, "reshuffl": 4, "each": [4, 8, 9, 10, 11, 12, 13, 15, 16, 17, 19, 22, 26, 31, 34, 35, 36, 40, 42, 43, 44, 45, 46, 48, 50, 52, 54, 56, 57, 58, 59, 60, 61, 64, 65, 70, 71, 76, 77, 80, 83, 86, 87, 88, 91, 92, 94, 100, 102, 104, 105, 106, 108, 111, 116, 117, 119, 122, 125, 128, 129, 134, 135, 138, 144, 145, 152, 154, 161, 162, 171, 173, 176, 179, 183, 188, 189, 190, 191, 193, 195, 197, 199, 209, 218, 219, 220, 224, 228], "iter": [4, 10, 11, 17, 24, 34, 48, 50, 52, 63, 64, 77, 80, 83, 86, 87, 88, 102, 135, 138, 140, 179, 188, 195], "over": [4, 8, 19, 22, 30, 48, 50, 58, 60, 64, 71, 76, 86, 91, 92, 102, 109, 145, 179, 191], "type": [4, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 22, 23, 24, 27, 30, 31, 35, 36, 38, 42, 43, 46, 48, 50, 51, 53, 56, 57, 58, 59, 60, 62, 63, 65, 67, 70, 71, 72, 73, 74, 76, 77, 80, 83, 86, 87, 88, 90, 91, 92, 100, 102, 104, 106, 108, 109, 116, 118, 119, 125, 135, 137, 139, 141, 145, 146, 151, 152, 154, 162, 171, 176, 177, 179, 182, 189, 195, 196, 197, 199, 206, 210, 218, 220, 224, 228], "stateless_cache_dataset": 4, "cachedataset": 4, "filesystem": 4, "provid": [4, 8, 10, 11, 12, 13, 15, 17, 18, 21, 22, 31, 43, 48, 50, 52, 58, 59, 60, 61, 64, 71, 76, 80, 83, 86, 87, 88, 91, 92, 102, 106, 109, 114, 116, 117, 135, 141, 176, 178, 179, 188, 191, 195, 196, 199, 218], "memori": [4, 8, 15, 46, 58, 71, 76, 87, 90, 94, 171, 188, 197, 224], "stateless_list_fil": 4, "file_pattern": [4, 11, 31, 42, 74, 83, 142, 160, 197, 218], "match": [4, 8, 10, 13, 24, 48, 58, 71, 76, 83, 86, 87, 97, 108, 117, 152, 164], "one": [4, 6, 8, 9, 11, 12, 13, 15, 17, 19, 21, 22, 24, 27, 30, 31, 35, 43, 44, 46, 48, 50, 58, 59, 60, 63, 65, 70, 71, 76, 77, 80, 83, 86, 87, 91, 92, 96, 100, 102, 104, 105, 106, 109, 110, 114, 117, 119, 135, 137, 138, 145, 151, 152, 154, 161, 162, 171, 175, 176, 177, 179, 181, 182, 183, 189, 191, 195, 196, 197, 199, 218, 228], "more": [4, 8, 15, 17, 21, 22, 42, 43, 44, 45, 48, 58, 59, 60, 65, 71, 76, 80, 83, 86, 87, 92, 94, 102, 104, 105, 111, 135, 139, 179, 183, 189, 191, 195, 197], "glob": 4, "pattern": [4, 9, 11, 13, 21, 29, 31, 48, 58, 71, 83, 100, 142, 160, 197], "note": [4, 8, 9, 10, 11, 12, 13, 15, 17, 22, 24, 31, 35, 46, 48, 50, 52, 56, 58, 64, 69, 71, 80, 83, 86, 91, 116, 117, 118, 135, 140, 151, 152, 179, 186, 188, 195, 197], "Then": [4, 12, 15, 59, 80, 83, 100, 118, 224], "some_file_pattern": 4, "vector": [4, 8, 9, 11, 15, 36, 40, 42, 48, 58, 59, 60, 67, 71, 82, 83, 88, 91, 92, 93, 95, 100, 102, 104, 105, 106, 116, 117, 134, 135, 145, 154, 161, 162, 171, 185, 186, 193, 195, 196, 199], "shell": 4, "wildcard": 4, "": [4, 9, 11, 12, 13, 15, 21, 22, 23, 24, 31, 35, 36, 40, 41, 42, 44, 46, 48, 50, 52, 54, 57, 58, 60, 62, 64, 65, 67, 70, 71, 77, 80, 81, 83, 86, 87, 88, 91, 92, 94, 99, 102, 104, 106, 107, 111, 114, 116, 120, 134, 139, 140, 154, 161, 162, 175, 176, 179, 186, 189, 191, 195, 197, 218], "correspond": [4, 6, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 29, 30, 40, 43, 48, 54, 57, 58, 59, 60, 71, 77, 78, 80, 83, 86, 87, 90, 91, 100, 110, 114, 116, 120, 135, 137, 141, 145, 152, 154, 162, 179, 188, 199, 209, 218, 219], "variable_scop": [4, 8, 9, 12, 13, 15, 19, 22, 30, 43, 48, 58, 59, 60, 61, 83, 85, 86, 88, 91, 92, 96, 102, 106, 117, 119, 141, 176, 186, 195, 196], "arg": [4, 6, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 27, 29, 30, 31, 32, 35, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 56, 57, 58, 59, 60, 61, 62, 64, 67, 69, 70, 76, 77, 78, 80, 83, 85, 86, 88, 90, 91, 92, 94, 96, 98, 100, 101, 102, 104, 105, 106, 108, 110, 111, 114, 116, 117, 119, 124, 125, 131, 134, 135, 136, 138, 140, 141, 142, 145, 146, 154, 155, 160, 161, 162, 166, 168, 176, 177, 178, 185, 186, 188, 194, 195, 196, 197, 198, 199, 209, 210, 228], "v1": [4, 9, 23, 83, 114, 195], "addit": [4, 8, 10, 13, 15, 19, 42, 46, 48, 50, 58, 59, 76, 77, 78, 80, 83, 86, 87, 88, 90, 91, 102, 108, 111, 114, 134, 135, 145, 189], "hyps_pb2": [5, 71], "record_pb2": [5, 33, 71], "versioned_file_set_pb2": [5, 71], "x_op": [5, 42, 71], "attention_step": [5, 103], "embedding_step": [5, 103], "rnn_step": [5, 103], "getfn": 6, "activation_nam": [6, 48], "function": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 21, 22, 24, 26, 27, 29, 30, 31, 36, 38, 41, 42, 43, 44, 45, 46, 47, 48, 50, 52, 54, 56, 57, 58, 59, 60, 61, 62, 63, 64, 66, 70, 71, 76, 77, 78, 79, 80, 81, 83, 85, 86, 87, 88, 90, 91, 92, 94, 98, 100, 102, 107, 108, 109, 111, 114, 118, 123, 129, 132, 135, 136, 139, 142, 152, 160, 171, 172, 178, 183, 185, 186, 188, 189, 191, 193, 195, 196, 197, 209, 218, 228], "getflop": 6, "flop": [6, 12, 15, 19, 21, 22, 30, 43, 58, 59, 60], "issupport": 6, "dimmultipli": 6, "dimens": [6, 8, 9, 11, 13, 15, 19, 21, 22, 27, 29, 30, 31, 35, 40, 42, 46, 48, 49, 54, 56, 58, 59, 62, 71, 76, 77, 80, 83, 87, 91, 92, 93, 100, 102, 105, 108, 116, 119, 121, 134, 135, 145, 154, 161, 162, 173, 176, 179, 190, 191, 193, 195, 199, 209], "multipli": [6, 58, 96, 100], "gluvari": 6, "x": [6, 8, 9, 11, 12, 15, 21, 22, 25, 27, 30, 40, 43, 44, 46, 48, 49, 50, 51, 53, 54, 56, 58, 59, 60, 70, 71, 72, 73, 74, 77, 83, 85, 86, 87, 90, 91, 92, 95, 96, 98, 100, 102, 109, 114, 119, 125, 185, 186, 191, 195, 196, 197, 199, 206, 228], "glu": [6, 27, 46, 48], "variant": [6, 9, 58, 60, 83, 140, 196, 199], "activationlay": 6, "baselay": [6, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 27, 29, 30, 31, 43, 44, 45, 48, 56, 58, 59, 60, 61, 62, 76, 86, 88, 90, 92, 96, 98, 100, 102, 110, 111, 116, 117, 129, 134, 136, 138, 140, 141, 161, 176, 177, 185, 186, 188, 194, 196, 198], "fprop": [6, 8, 9, 10, 12, 13, 15, 19, 21, 22, 25, 26, 27, 29, 30, 41, 43, 44, 46, 48, 56, 58, 59, 60, 62, 83, 85, 87, 90, 91, 92, 98, 100, 102, 104, 105, 106, 107, 117, 119, 138, 140, 141, 145, 161, 177, 185, 186, 188, 196, 198], "theta": [6, 8, 9, 10, 12, 13, 15, 17, 19, 22, 27, 29, 30, 35, 43, 44, 46, 48, 56, 58, 59, 60, 62, 82, 83, 85, 86, 87, 88, 90, 91, 92, 98, 100, 102, 104, 105, 106, 117, 119, 134, 135, 138, 140, 141, 145, 154, 161, 162, 176, 185, 186, 195, 196, 198, 199], "pad": [6, 8, 9, 10, 11, 15, 17, 19, 27, 29, 30, 40, 46, 48, 49, 56, 58, 59, 60, 62, 71, 77, 83, 85, 86, 87, 91, 92, 98, 100, 102, 104, 105, 106, 107, 108, 110, 116, 117, 135, 138, 139, 140, 141, 145, 146, 161, 162, 171, 179, 188, 195, 196, 197, 198, 199, 209], "fn": [6, 12, 21, 22, 23, 70, 78, 80, 83, 86, 87, 88, 129, 191], "nestedmap": [6, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 27, 29, 30, 31, 32, 33, 35, 42, 43, 44, 45, 46, 48, 52, 56, 58, 59, 60, 61, 62, 64, 70, 76, 80, 83, 85, 87, 88, 90, 91, 92, 94, 98, 100, 102, 104, 105, 106, 108, 110, 117, 119, 134, 135, 136, 138, 140, 141, 142, 145, 146, 154, 160, 161, 162, 166, 176, 185, 186, 189, 191, 195, 196, 197, 198, 199, 209], "weight": [6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 27, 29, 30, 31, 34, 35, 38, 43, 44, 45, 46, 48, 49, 50, 52, 56, 58, 59, 60, 61, 62, 64, 71, 76, 82, 83, 85, 86, 87, 90, 91, 92, 98, 100, 102, 104, 105, 106, 110, 111, 117, 119, 134, 135, 138, 140, 141, 142, 145, 154, 160, 161, 162, 176, 186, 193, 194, 195, 196, 197, 198, 199, 209], "valu": [6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 19, 22, 24, 27, 29, 30, 34, 35, 36, 37, 38, 40, 41, 43, 44, 45, 46, 47, 48, 50, 51, 52, 53, 54, 57, 58, 59, 60, 61, 62, 64, 65, 66, 70, 71, 73, 76, 77, 80, 83, 84, 85, 86, 87, 88, 90, 91, 92, 93, 94, 95, 96, 98, 100, 102, 104, 105, 106, 108, 109, 110, 114, 117, 118, 119, 120, 121, 131, 134, 135, 138, 140, 142, 145, 152, 154, 160, 161, 162, 176, 177, 179, 186, 188, 191, 193, 195, 196, 197, 198, 199, 209, 218, 220, 223, 224, 226, 227, 228], "children": [6, 8, 10, 12, 13, 15, 17, 19, 22, 27, 29, 30, 43, 44, 48, 58, 59, 60, 61, 62, 76, 85, 86, 88, 90, 91, 92, 98, 100, 102, 104, 105, 106, 110, 117, 134, 135, 138, 140, 141, 145, 161, 176, 185, 186, 191, 195, 196, 198, 199], "output": [6, 8, 9, 10, 11, 13, 15, 17, 19, 21, 22, 27, 29, 30, 31, 34, 35, 42, 43, 46, 48, 50, 52, 58, 59, 60, 61, 64, 65, 71, 79, 80, 82, 83, 86, 87, 88, 90, 91, 92, 100, 102, 104, 105, 106, 107, 108, 110, 114, 118, 119, 135, 136, 138, 139, 140, 141, 145, 154, 161, 162, 171, 176, 177, 178, 186, 188, 190, 191, 193, 195, 196, 198, 199, 219, 220], "els": [6, 9, 15, 19, 46, 56, 58, 83, 118], "just": [6, 12, 13, 15, 17, 22, 35, 44, 50, 52, 58, 71, 83, 86, 87, 91, 104, 140, 179, 224, 228], "same": [6, 8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 27, 29, 30, 42, 43, 44, 46, 47, 48, 50, 54, 58, 59, 60, 62, 64, 70, 71, 77, 80, 82, 83, 85, 86, 87, 88, 90, 91, 96, 98, 102, 108, 109, 110, 114, 116, 118, 135, 141, 179, 183, 186, 191, 195, 196, 197, 199], "fpropmeta": [6, 12, 15, 19, 22, 30, 43, 58, 59, 60], "p": [6, 8, 10, 11, 12, 13, 15, 17, 19, 22, 24, 25, 27, 30, 31, 34, 43, 46, 48, 58, 59, 60, 61, 63, 71, 83, 85, 86, 88, 91, 92, 96, 102, 105, 106, 117, 119, 122, 135, 141, 160, 161, 162, 176, 178, 179, 193, 195, 196, 197, 209], "metadata": [6, 11, 12, 15, 19, 22, 30, 31, 36, 43, 58, 59, 60, 66, 175, 222], "about": [6, 11, 12, 13, 15, 19, 22, 24, 30, 35, 43, 46, 58, 59, 60, 83, 119, 135, 145, 154, 162, 176, 179, 197, 199], "experiment": [6, 12, 15, 19, 21, 22, 30, 43, 58, 59, 60, 80, 83], "featur": [6, 10, 11, 12, 15, 19, 22, 27, 30, 40, 42, 43, 44, 48, 50, 58, 59, 60, 83, 86, 100, 104, 108, 117, 135, 138, 140, 142, 160, 173, 175, 178, 179, 181, 183, 186, 188, 190, 195, 196, 197, 217], "depend": [6, 8, 11, 12, 15, 19, 21, 22, 29, 30, 31, 43, 48, 58, 59, 60, 80, 83, 87, 91, 96, 102, 104, 114, 140, 186, 195, 196, 197], "without": [6, 9, 11, 12, 15, 19, 22, 30, 31, 42, 43, 48, 50, 52, 57, 58, 59, 60, 71, 80, 83, 87, 90, 94, 118, 123, 140, 179, 196, 219], "consult": [6, 12, 15, 19, 22, 30, 43, 58, 59, 60, 117], "author": [6, 12, 15, 19, 22, 30, 43, 58, 59, 60], "somecomplexlay": [6, 12, 15, 19, 22, 30, 43, 58, 59, 60], "meta": [6, 12, 15, 19, 22, 30, 43, 53, 58, 59, 60, 175], "cl": [6, 12, 14, 15, 19, 22, 25, 30, 43, 50, 57, 58, 59, 60, 61, 80, 123], "128": [6, 9, 12, 15, 19, 22, 30, 43, 46, 47, 58, 59, 60, 76, 166, 167, 197], "20": [6, 12, 15, 19, 22, 30, 43, 58, 59, 60, 70, 91, 166, 167], "50": [6, 12, 15, 19, 22, 30, 34, 39, 43, 58, 59, 60, 166, 167, 188, 219], "channel": [6, 12, 15, 19, 22, 29, 30, 43, 58, 59, 60, 86, 87, 91, 99, 100, 108, 138, 140], "give": [6, 12, 15, 19, 22, 30, 43, 58, 59, 60, 76, 83, 179, 195], "estim": [6, 12, 15, 19, 21, 22, 26, 30, 43, 58, 59, 60, 76], "count": [6, 12, 15, 17, 19, 22, 30, 43, 48, 58, 59, 60, 64, 65, 86, 143, 152, 162, 222], "float": [6, 8, 9, 10, 11, 12, 15, 19, 22, 30, 34, 39, 43, 50, 58, 59, 60, 64, 71, 76, 83, 86, 91, 100, 102, 104, 106, 116, 142, 154, 160, 161, 177, 188, 195, 197], "point": [6, 7, 8, 10, 12, 13, 15, 19, 21, 22, 24, 30, 36, 38, 43, 58, 59, 60, 76, 77, 100, 135, 161, 162, 182, 195, 224], "done": [6, 9, 12, 15, 19, 22, 30, 43, 58, 59, 60, 64, 71, 80, 91, 94, 161], "given": [6, 8, 9, 10, 11, 12, 13, 14, 15, 18, 19, 21, 22, 23, 24, 27, 30, 35, 36, 37, 42, 43, 44, 46, 48, 50, 52, 56, 57, 58, 59, 60, 61, 64, 65, 70, 71, 77, 78, 80, 83, 85, 86, 87, 90, 91, 96, 97, 98, 100, 102, 105, 110, 111, 117, 119, 127, 128, 135, 137, 139, 145, 154, 160, 161, 162, 173, 175, 176, 177, 182, 186, 188, 191, 195, 196, 197, 199, 218, 219, 224, 228], "out_shap": [6, 12, 15, 19, 22, 30, 43, 58, 59, 60], "tell": [6, 12, 15, 19, 22, 30, 43, 58, 59, 60], "you": [6, 9, 12, 13, 15, 19, 22, 30, 43, 44, 46, 57, 58, 59, 60, 69, 76, 83, 87, 91, 98, 118, 119, 151, 152, 162, 196, 198, 199, 222, 224], "what": [6, 7, 8, 12, 15, 19, 22, 30, 43, 58, 59, 60, 69, 83, 87, 91, 104, 118, 179, 195, 197], "replac": [6, 8, 9, 10, 11, 12, 15, 17, 19, 22, 24, 30, 43, 46, 52, 58, 59, 60, 70, 71, 77, 80, 83, 87, 91, 95, 101, 102, 114, 135, 138, 140, 178, 179, 191, 195, 197], "tensorshap": [6, 12, 15, 17, 19, 22, 30, 43, 58, 59, 60, 83, 110, 120, 176, 179, 191], "incur": [6, 12, 15, 19, 22, 30, 43, 58, 59, 60, 88], "th": [6, 9, 10, 11, 12, 15, 17, 19, 21, 22, 24, 30, 43, 54, 58, 59, 60, 63, 67, 71, 83, 87, 88, 108, 116, 142, 160, 162, 175, 179, 188, 197], "http": [7, 8, 9, 10, 15, 19, 22, 27, 29, 30, 34, 39, 40, 43, 44, 45, 56, 58, 59, 60, 63, 76, 83, 86, 90, 91, 93, 96, 98, 100, 101, 107, 111, 116, 122, 135, 152, 164, 170, 181, 186, 195, 196, 197, 198, 199, 205, 215], "arxiv": [7, 8, 9, 10, 15, 19, 22, 27, 29, 30, 34, 39, 40, 43, 44, 45, 56, 58, 59, 60, 76, 83, 86, 90, 91, 93, 96, 98, 100, 101, 107, 111, 116, 135, 181, 195, 196, 197, 198, 199, 205], "org": [7, 8, 9, 10, 15, 19, 22, 27, 29, 30, 34, 39, 40, 43, 44, 45, 56, 58, 59, 60, 63, 76, 83, 86, 90, 91, 93, 96, 98, 100, 101, 107, 111, 116, 135, 152, 170, 181, 186, 195, 196, 197, 198, 199, 205, 215], "ab": [7, 8, 9, 15, 19, 22, 27, 29, 30, 43, 44, 45, 58, 59, 60, 76, 83, 86, 90, 91, 93, 96, 98, 107, 116, 181, 195, 196, 198, 199, 205], "2002": [7, 58, 59, 76], "11803": [7, 76], "adagraftoptim": 7, "learning_r": [7, 36, 38, 76, 117, 119, 161, 166, 193, 205], "magnitude_optim": 7, "direction_optim": 7, "diagnost": 7, "use_global_norm": 7, "combin": [7, 8, 11, 15, 45, 48, 56, 58, 59, 60, 62, 71, 76, 80, 83, 91, 96, 104, 117, 161, 185, 193, 195, 196], "per": [7, 8, 9, 11, 13, 15, 16, 17, 24, 31, 36, 42, 46, 48, 54, 58, 64, 71, 76, 77, 80, 83, 86, 92, 94, 100, 102, 105, 106, 110, 117, 119, 131, 134, 135, 138, 140, 145, 152, 179, 186, 193, 195, 196, 197, 228], "direct": [7, 40, 68, 76, 92, 196], "magnitud": [7, 100], "two": [7, 9, 15, 24, 31, 32, 36, 46, 48, 58, 59, 65, 70, 71, 76, 83, 86, 87, 91, 104, 140, 151, 152, 179, 183, 185, 195, 196, 197, 199, 219, 220, 224], "disentangl": [7, 76], "adapt": [7, 15, 38, 58, 59, 76, 88, 91, 99, 102, 111, 114, 179, 181, 188], "gradient": [7, 8, 12, 13, 21, 34, 35, 36, 38, 40, 44, 45, 58, 61, 76, 82, 83, 86, 87, 90, 108, 114, 117, 145, 148, 154, 162, 176, 182, 189, 199], "naman": [7, 76], "agarw": [7, 76], "rohan": [7, 36, 76], "anil": [7, 36, 76], "elad": [7, 76], "hazan": [7, 76], "tomer": [7, 36, 76], "koren": [7, 36, 76], "cyril": [7, 76], "zhang": [7, 76], "_create_slot": [7, 36, 38, 76, 166], "var_list": [7, 36, 38, 76, 117, 166], "slot": [7, 36, 38, 56, 71, 76, 104, 117, 166], "need": [7, 8, 9, 10, 11, 13, 15, 17, 21, 23, 35, 36, 37, 38, 40, 46, 48, 49, 52, 56, 58, 59, 60, 64, 70, 71, 76, 77, 80, 82, 83, 86, 87, 90, 91, 92, 98, 99, 107, 111, 117, 119, 125, 134, 135, 141, 166, 196, 197, 198, 199, 209, 218, 228], "variabl": [7, 8, 9, 12, 13, 15, 18, 19, 22, 23, 24, 30, 31, 34, 35, 36, 38, 43, 45, 46, 48, 49, 52, 58, 59, 60, 61, 69, 71, 76, 83, 85, 86, 88, 91, 92, 94, 96, 102, 106, 108, 117, 119, 121, 123, 129, 141, 145, 154, 162, 166, 173, 176, 182, 185, 186, 188, 195, 196, 199, 224], "_prepar": [7, 36, 38], "call": [7, 8, 11, 12, 13, 14, 15, 17, 21, 22, 26, 27, 30, 31, 34, 36, 37, 38, 41, 42, 43, 44, 46, 48, 50, 57, 58, 59, 60, 64, 71, 77, 78, 79, 80, 81, 82, 83, 85, 87, 88, 90, 94, 97, 98, 102, 104, 105, 106, 114, 117, 118, 119, 123, 134, 135, 140, 142, 146, 151, 152, 160, 166, 178, 179, 182, 186, 188, 189, 191, 195, 196, 197, 218], "name_scop": [7, 36, 38, 83, 118], "user": [7, 11, 17, 31, 36, 38, 48, 52, 57, 76, 83, 86, 178, 188, 191], "have": [7, 8, 9, 11, 12, 13, 15, 21, 27, 35, 36, 38, 40, 42, 46, 48, 50, 52, 57, 58, 59, 60, 61, 65, 69, 70, 71, 80, 81, 83, 86, 87, 91, 94, 102, 104, 105, 114, 117, 121, 123, 135, 136, 140, 141, 161, 173, 176, 179, 182, 189, 190, 195, 197, 209, 219, 222, 224], "chosen": [7, 36, 38, 40, 114, 177, 179], "applic": [7, 23, 36, 38, 44, 63, 76, 83, 86, 100, 107, 114, 179], "_apply_dens": [7, 36, 38, 76], "grad": [7, 36, 38, 40, 45, 58, 61, 76, 83, 87, 162, 182], "var": [7, 12, 13, 18, 23, 24, 36, 38, 46, 47, 48, 49, 61, 76, 82, 83, 86, 94, 118, 121, 162, 186], "add": [7, 9, 10, 11, 12, 13, 15, 19, 21, 22, 26, 27, 29, 36, 38, 48, 49, 58, 59, 60, 76, 77, 82, 83, 86, 87, 91, 94, 108, 117, 118, 127, 128, 135, 139, 141, 144, 145, 154, 181, 182, 186, 195, 197, 224, 228], "dens": [7, 36, 38, 46, 58, 76, 117], "_resource_apply_dens": [7, 36, 38, 76], "handl": [7, 12, 36, 38, 42, 49, 64, 76, 80, 83, 86, 87, 91, 102, 108, 186, 191, 195], "dtype": [7, 9, 10, 11, 15, 18, 19, 36, 38, 41, 46, 48, 58, 59, 60, 71, 76, 82, 83, 86, 87, 91, 92, 94, 99, 100, 105, 114, 118, 135, 161, 173, 195], "resourc": [7, 31, 36, 38, 42, 76, 140, 188], "_internal_apply_dens": 7, "magnitude_optimizer_apply_fn": 7, "direction_optimizer_apply_fn": 7, "main": [7, 15, 47, 78, 79, 80, 87, 107, 114, 131, 151, 152, 170, 171, 179, 188, 215, 218, 219, 221, 222, 223, 224, 225, 226, 227, 228], "logic": [7, 11, 21, 46, 48, 49, 71, 80, 121, 139, 140, 141, 166, 179, 181, 182], "child": [7, 8, 12, 13, 15, 22, 26, 27, 31, 43, 48, 58, 60, 61, 86, 88, 91, 92, 102, 106, 117, 135, 141, 145, 176, 195, 196], "final": [7, 8, 11, 13, 15, 21, 22, 31, 35, 47, 58, 59, 60, 62, 64, 77, 80, 83, 86, 87, 88, 92, 96, 111, 135, 138, 145, 154, 162, 176, 190, 195, 198, 199, 209], "increment": [7, 22, 48, 71, 81, 83, 108, 119], "graft": 7, "pseudocod": 7, "copi": [7, 12, 13, 22, 36, 46, 48, 49, 50, 57, 70, 83, 94, 117, 125, 145, 154, 162, 179, 186, 188, 197, 224, 228], "scratch": 7, "space": [7, 9, 13, 15, 35, 71, 87, 100, 151, 171], "scratch_copi": 7, "figur": [7, 77, 108, 114, 135], "out": [7, 12, 13, 15, 30, 35, 37, 48, 50, 58, 64, 70, 71, 80, 83, 86, 87, 91, 94, 100, 108, 114, 119, 124, 129, 131, 137, 145, 154, 162, 188, 195, 197, 199, 224, 228], "far": [7, 10, 71, 97], "move": [7, 9, 13, 19, 46, 58, 71, 83, 86], "magnitude_step": 7, "back": [7, 11, 12, 58, 59, 67, 83, 96, 97, 102, 116, 140, 162, 181, 182, 197], "along": [7, 8, 9, 10, 15, 30, 46, 48, 49, 54, 56, 58, 59, 71, 80, 83, 86, 92, 108, 135], "line": [7, 50, 71, 77, 81, 83, 97, 114, 152, 171, 197, 209, 219], "segment": [7, 8, 15, 46, 48, 60, 65, 71, 97, 116, 122, 171, 195, 196, 198], "_finish": 7, "update_op": 7, "_apply_spars": [7, 36, 38, 76], "_resource_apply_spars": [7, 36, 38, 76], "grad_valu": [7, 36, 38], "grad_indic": [7, 36, 38], "spars": [7, 15, 34, 36, 38, 39, 48, 76, 83], "similar": [7, 8, 31, 36, 38, 40, 42, 46, 48, 50, 59, 76, 83, 92, 118, 138, 152, 179, 181, 185, 195], "de": [7, 36, 38, 76, 202, 203, 205], "duplic": [7, 9, 11, 15, 36, 38, 76, 83, 179, 183], "deal": [7, 11, 15, 36, 38, 76, 86], "correctli": [7, 36, 38, 57, 76, 83, 186], "non": [7, 8, 9, 10, 11, 15, 17, 22, 24, 30, 34, 36, 38, 43, 46, 48, 50, 58, 59, 64, 71, 76, 77, 83, 100, 108, 111, 117, 118, 131, 137, 183, 186, 189, 193, 197], "uniqu": [7, 15, 22, 36, 38, 42, 50, 64, 76, 79, 83, 86, 102, 129, 179, 183, 224], "instead": [7, 8, 11, 15, 36, 38, 48, 50, 57, 58, 60, 64, 70, 76, 78, 80, 83, 86, 87, 91, 92, 96, 151, 175, 178, 179, 196, 197, 228], "_resource_apply_sparse_duplicate_indic": [7, 36, 38, 76], "avoid": [7, 8, 11, 12, 15, 36, 38, 48, 58, 76, 80, 83, 91, 117, 128, 189], "overhead": [7, 15, 36, 38, 76, 195], "affect": [7, 15, 36, 38, 48, 76, 224], "integr": [7, 9, 36, 38, 76], "nonzero": [7, 36, 38, 76], "ar": [7, 8, 9, 10, 11, 12, 13, 15, 17, 19, 22, 23, 27, 29, 30, 31, 35, 36, 37, 38, 40, 41, 42, 44, 46, 47, 48, 50, 52, 57, 58, 59, 60, 61, 62, 64, 67, 69, 70, 71, 76, 80, 81, 82, 83, 85, 86, 87, 88, 90, 91, 92, 94, 96, 97, 99, 100, 101, 102, 104, 106, 108, 110, 111, 114, 116, 117, 118, 119, 121, 123, 128, 134, 135, 138, 139, 140, 145, 151, 152, 154, 161, 175, 177, 178, 179, 182, 183, 186, 188, 190, 195, 196, 197, 209, 218, 219, 224], "indexedslic": [7, 36, 38, 83], "pre": [7, 30, 36, 38, 46, 50, 58, 80, 94, 102, 104, 106, 151, 196], "process": [7, 8, 11, 13, 15, 19, 35, 36, 38, 42, 48, 58, 59, 71, 80, 83, 86, 92, 102, 104, 105, 106, 116, 119, 122, 131, 135, 140, 144, 145, 151, 154, 170, 188, 195, 197, 199, 209, 215, 228], "_apply_sparse_duplicate_indic": [7, 36, 38], "remov": [7, 8, 12, 15, 30, 36, 38, 48, 49, 71, 83, 117, 136, 139, 151, 152, 195, 209], "docstr": [7, 36, 38, 42, 59], "detail": [7, 8, 11, 15, 17, 36, 38, 42, 48, 58, 59, 60, 77, 83, 87, 92, 102, 104, 114, 135, 139, 144, 179, 198, 224], "toler": [7, 36, 38, 86], "correct": [7, 8, 9, 36, 38, 58, 76, 83, 86, 197], "special": [7, 12, 36, 38, 48, 49, 58, 71, 83, 86, 175, 179, 183, 197], "repeat": [7, 11, 15, 21, 22, 31, 36, 38, 46, 48, 71, 83, 88, 175, 195], "_conditionalcalldefun": 8, "cond": [8, 83, 114, 118], "f": [8, 12, 15, 19, 22, 29, 71, 77, 90, 171], "_applyattentiondropout": 8, "dropout": [8, 15, 25, 27, 29, 44, 46, 48, 58, 59, 60, 83, 90, 161, 193, 196], "atten_dropout_determinist": 8, "set": [8, 10, 11, 12, 13, 15, 17, 22, 24, 25, 27, 30, 31, 35, 37, 42, 44, 46, 48, 49, 50, 52, 56, 58, 59, 61, 64, 70, 71, 77, 79, 80, 82, 83, 86, 87, 91, 92, 94, 95, 96, 100, 102, 104, 114, 119, 125, 128, 129, 134, 135, 140, 148, 155, 161, 162, 173, 175, 176, 178, 179, 186, 188, 189, 191, 193, 195, 196, 197, 209, 224, 228], "fulli": [8, 21, 58, 60, 83, 100, 198, 224], "determinist": [8, 15, 40, 60, 79, 83, 90, 111, 119, 135, 177], "safecumprod": 8, "cumprod": 8, "logspac": 8, "cumsum": [8, 83], "underflow": 8, "result": [8, 9, 10, 13, 15, 17, 31, 35, 52, 58, 59, 62, 64, 70, 71, 80, 82, 83, 86, 91, 92, 102, 104, 107, 109, 114, 119, 136, 141, 145, 154, 175, 179, 190, 195, 199, 227], "numer": [8, 10, 40, 83, 86, 88, 90, 114], "instabl": 8, "when": [8, 11, 12, 13, 15, 21, 23, 24, 30, 35, 37, 44, 46, 48, 49, 50, 58, 59, 60, 65, 70, 71, 76, 77, 79, 80, 81, 83, 86, 87, 92, 96, 100, 104, 106, 109, 114, 117, 118, 119, 123, 135, 145, 146, 152, 161, 166, 178, 179, 186, 188, 191, 195, 197, 199, 218, 228], "veri": [8, 15, 21, 83, 87, 91, 92, 179], "small": [8, 40, 58, 77, 114, 116, 197, 202], "zero": [8, 15, 30, 34, 36, 47, 48, 58, 62, 71, 76, 83, 86, 88, 91, 92, 96, 100, 102, 104, 106, 134, 179, 188, 195], "As": [8, 12, 15, 58, 71, 83, 86, 107, 108, 118, 136, 139, 179, 195], "long": [8, 15, 52, 80, 87, 197], "posit": [8, 9, 10, 15, 22, 30, 40, 46, 48, 58, 59, 60, 63, 71, 77, 83, 86, 93, 100, 116, 123, 139, 161, 179, 183, 193, 195, 196, 197, 209], "cumul": [8, 10, 71], "product": [8, 15, 36, 76, 185], "exp": [8, 111], "ident": [8, 21, 22, 24, 40, 44, 45, 46, 58, 71, 83, 86, 87, 88, 96, 136, 179, 197], "math": [8, 77, 83, 91, 197], "those": [8, 11, 13, 15, 35, 44, 46, 50, 70, 71, 83, 86, 87, 91, 102, 104, 135, 186], "monotonicattentionprob": 8, "p_choose_i": 8, "previous_attent": 8, "mode": [8, 11, 15, 23, 24, 25, 31, 42, 48, 58, 59, 64, 71, 76, 80, 83, 91, 94, 100, 108, 114, 117, 118, 121, 124, 177, 228], "monoton": 8, "choos": [8, 24, 44, 50, 83, 181, 182], "probabl": [8, 10, 15, 27, 39, 48, 58, 59, 60, 64, 71, 83, 91, 104, 108, 111, 135, 161, 179, 193, 195, 197], "impli": [8, 83, 96], "sequenc": [8, 9, 10, 11, 15, 17, 19, 22, 24, 29, 30, 42, 43, 47, 49, 52, 56, 58, 60, 62, 67, 70, 71, 77, 80, 83, 86, 87, 91, 92, 100, 102, 104, 106, 108, 110, 116, 117, 125, 135, 138, 139, 140, 141, 146, 160, 161, 162, 173, 190, 191, 193, 195, 197, 198, 209, 228], "explicitli": [8, 12, 52, 83, 86, 96, 100, 175, 193], "left": [8, 9, 15, 22, 58, 83, 86, 92, 93, 118, 161, 177, 195], "right": [8, 9, 15, 22, 48, 58, 64, 71, 83, 86, 91, 92, 93, 97, 107, 177, 197], "manner": [8, 15, 43, 125, 228], "onc": [8, 12, 13, 15, 17, 37, 46, 58, 71, 80, 86, 102, 117, 119, 125, 131, 228], "attend": [8, 9, 15, 46, 59, 108, 193], "timestep": [8, 10, 58, 59, 71, 87, 91, 102, 110, 135, 140], "occur": [8, 65, 94, 96, 179], "cannot": [8, 18, 22, 58, 80, 83, 123], "subsequ": [8, 80, 104], "assumpt": [8, 109], "For": [8, 9, 10, 11, 13, 15, 21, 22, 27, 34, 35, 44, 46, 48, 50, 58, 59, 60, 62, 64, 71, 76, 83, 87, 91, 92, 96, 100, 108, 111, 117, 135, 140, 142, 145, 154, 160, 162, 176, 178, 179, 182, 188, 189, 193, 197, 199, 224], "inform": [8, 10, 13, 15, 20, 21, 22, 34, 38, 43, 49, 59, 80, 83, 87, 92, 104, 106, 123, 128, 135, 152, 179, 195], "onlin": [8, 13, 35], "linear": [8, 12, 15, 21, 22, 27, 29, 30, 38, 43, 44, 45, 48, 58, 59, 60, 83, 85, 86, 90, 96, 98, 100, 186, 193, 195, 196], "enforc": [8, 15, 91], "align": [8, 48, 151, 152, 195, 197], "batch_siz": [8, 11, 15, 19, 27, 30, 34, 41, 43, 47, 54, 56, 59, 62, 71, 79, 83, 88, 91, 92, 96, 100, 102, 104, 105, 106, 107, 108, 119, 135, 138, 140, 141, 142, 155, 160, 161, 164, 167, 171, 175, 176, 177, 178, 179, 188, 190, 191, 195, 196, 197, 199], "input_sequence_length": 8, "0": [8, 9, 10, 11, 12, 13, 15, 17, 18, 22, 23, 24, 25, 27, 29, 30, 34, 36, 37, 38, 40, 41, 42, 43, 44, 46, 48, 50, 52, 54, 56, 58, 59, 60, 61, 63, 64, 66, 70, 71, 76, 77, 79, 80, 81, 83, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 96, 97, 98, 100, 102, 104, 106, 108, 110, 114, 117, 119, 121, 122, 135, 137, 138, 139, 140, 148, 151, 152, 157, 161, 166, 167, 175, 177, 179, 182, 186, 189, 191, 193, 195, 196, 197, 198, 199, 205, 209], "1": [8, 9, 10, 11, 12, 13, 15, 17, 19, 21, 22, 24, 25, 27, 29, 30, 31, 34, 36, 38, 39, 40, 41, 42, 43, 44, 46, 48, 49, 50, 52, 54, 56, 58, 59, 60, 61, 62, 63, 64, 70, 71, 76, 77, 79, 80, 82, 83, 85, 86, 87, 89, 90, 91, 92, 94, 96, 97, 98, 99, 100, 102, 104, 105, 106, 107, 108, 110, 111, 114, 116, 117, 119, 121, 122, 135, 137, 138, 139, 140, 141, 152, 161, 164, 166, 167, 171, 173, 175, 177, 179, 186, 189, 191, 193, 195, 196, 197, 198, 205, 209, 220, 224], "previou": [8, 15, 22, 25, 48, 58, 59, 60, 64, 71, 80, 82, 91, 94, 102, 104, 105, 106, 135, 195], "first": [8, 9, 10, 11, 13, 15, 22, 30, 35, 36, 43, 46, 48, 54, 57, 58, 59, 62, 67, 71, 76, 77, 80, 83, 86, 88, 91, 92, 94, 96, 100, 102, 104, 105, 106, 116, 118, 119, 135, 140, 145, 151, 152, 154, 161, 162, 171, 176, 195, 196, 197, 199, 218, 219, 220], "preevious_attent": 8, "n": [8, 9, 15, 19, 22, 46, 47, 48, 58, 59, 65, 71, 76, 83, 87, 91, 96, 97, 100, 102, 105, 108, 121, 137, 154, 175, 179, 191], "must": [8, 9, 10, 11, 12, 13, 15, 17, 22, 31, 34, 35, 42, 46, 48, 50, 56, 58, 60, 63, 64, 70, 71, 76, 77, 79, 83, 86, 87, 92, 100, 102, 105, 117, 118, 135, 140, 142, 160, 162, 177, 178, 179, 191, 195, 196, 197], "recurs": [8, 12, 44, 48, 50, 70, 83, 91], "parallel": [8, 22, 43, 46, 48, 62, 83, 87, 166, 175, 222, 228], "hard": [8, 48], "scan": [8, 83, 222], "slowest": 8, "exact": [8, 17, 70, 83, 179], "suffer": 8, "sum": [8, 10, 11, 15, 21, 34, 40, 58, 60, 71, 76, 80, 83, 104, 106, 118, 119, 161, 193, 195], "close": [8, 15, 34, 117], "form": [8, 13, 22, 30, 35, 49, 50, 58, 70, 71, 83, 86, 97, 104, 140, 145, 154, 162, 176, 179, 199], "solut": [8, 34, 58, 179], "make": [8, 9, 10, 11, 15, 17, 24, 30, 34, 43, 49, 52, 63, 77, 83, 87, 94, 102, 105, 121, 135, 138, 139, 140, 175, 179, 186], "effici": [8, 9, 15, 32, 43, 58, 71, 83, 90, 91, 222], "than": [8, 9, 13, 15, 17, 34, 44, 45, 46, 48, 49, 50, 58, 59, 62, 71, 76, 83, 86, 87, 91, 100, 104, 105, 117, 118, 119, 152, 179, 195, 197, 222], "problem": [8, 34, 83], "particular": [8, 11, 18, 58, 59, 60, 80, 83, 88, 106, 179], "entri": [8, 11, 34, 45, 57, 64, 70, 77, 80, 83, 100, 108, 117, 195], "either": [8, 11, 12, 13, 17, 19, 22, 30, 35, 40, 42, 50, 57, 58, 59, 64, 71, 76, 80, 83, 86, 91, 102, 104, 106, 140, 145, 151, 154, 162, 176, 179, 196, 197, 199, 228], "batch": [8, 9, 10, 11, 13, 15, 16, 19, 21, 22, 27, 29, 30, 31, 35, 40, 41, 42, 46, 47, 48, 56, 58, 59, 60, 62, 67, 71, 76, 77, 79, 80, 83, 91, 92, 96, 100, 102, 104, 105, 106, 108, 110, 116, 117, 118, 119, 131, 134, 135, 136, 138, 139, 140, 141, 142, 145, 146, 148, 154, 160, 161, 162, 166, 171, 175, 176, 178, 179, 183, 185, 186, 191, 195, 196, 197, 198, 199, 209], "valueerror": [8, 11, 13, 15, 18, 23, 24, 31, 48, 50, 52, 56, 57, 58, 67, 68, 70, 83, 87, 92, 116, 117, 125, 135, 152, 171, 191, 218, 224], "baseattentionlay": 8, "quantizablelay": [8, 9, 15, 22, 30, 58, 85, 86, 91, 92, 195], "_createlayervari": [8, 9, 12, 15, 19, 22, 30, 48, 58, 59, 60, 85, 86, 91, 92, 96, 117, 119, 186], "legaci": [8, 9, 12, 13, 15, 19, 22, 30, 48, 58, 59, 60, 61, 85, 86, 91, 92, 96, 117, 119, 186], "directli": [8, 9, 11, 12, 15, 19, 22, 30, 44, 48, 49, 58, 59, 60, 77, 83, 85, 86, 91, 92, 96, 102, 117, 119, 140, 146, 166, 171, 178, 186, 196], "__init__": [8, 9, 12, 13, 15, 19, 22, 27, 30, 48, 57, 58, 59, 60, 70, 85, 86, 91, 92, 96, 117, 119, 182, 186], "insid": [8, 9, 11, 12, 15, 19, 21, 22, 30, 48, 58, 59, 60, 85, 86, 91, 92, 96, 109, 117, 118, 119, 179, 186], "self": [8, 9, 10, 11, 12, 13, 15, 17, 19, 22, 25, 27, 30, 40, 41, 43, 44, 46, 48, 49, 50, 57, 58, 59, 60, 62, 64, 70, 78, 79, 83, 85, 86, 90, 91, 92, 96, 98, 114, 117, 119, 135, 145, 162, 179, 182, 186, 195, 196, 197, 198], "_selfvariablescop": [8, 9, 12, 15, 19, 22, 30, 48, 58, 59, 60, 85, 86, 91, 92, 96, 117, 119, 186], "usual": [8, 9, 11, 12, 13, 15, 19, 22, 30, 31, 42, 44, 48, 57, 58, 59, 60, 61, 76, 80, 83, 85, 86, 91, 92, 96, 100, 117, 119, 135, 152, 174, 179, 186, 228], "initforsourcepack": [8, 92, 135], "source_vec": [8, 15, 59, 60], "source_context": [8, 59], "source_pad": [8, 15, 59, 60, 135, 141, 195, 197], "source_segment_id": [8, 15, 59, 60], "initi": [8, 10, 11, 12, 15, 17, 23, 30, 31, 47, 48, 50, 52, 58, 60, 62, 64, 76, 83, 86, 87, 91, 92, 96, 102, 105, 111, 116, 134, 135, 141, 145, 148, 160, 161, 186, 188, 193, 195, 218], "_source_init_don": 8, "present": [8, 48, 52, 70, 71, 97, 191, 197, 224, 228], "alwai": [8, 10, 11, 22, 30, 48, 50, 58, 59, 60, 71, 76, 77, 83, 86, 96, 116, 179, 195], "singl": [8, 9, 11, 13, 14, 15, 19, 21, 22, 24, 30, 31, 35, 41, 46, 48, 50, 52, 58, 60, 62, 70, 71, 76, 79, 80, 83, 86, 87, 91, 92, 102, 105, 108, 117, 124, 125, 141, 145, 154, 160, 162, 176, 177, 179, 189, 191, 195, 197, 199, 209, 222, 228], "source_dim": [8, 59, 92, 141, 195], "some_dim": [8, 92], "pack": [8, 15, 41, 42, 46, 52, 58, 62, 64, 70, 71, 83, 91, 92, 135, 160, 162, 171, 196, 197], "where": [8, 9, 10, 11, 12, 13, 15, 19, 22, 30, 31, 35, 40, 41, 42, 43, 44, 45, 46, 48, 49, 50, 52, 56, 58, 59, 61, 63, 70, 71, 76, 79, 80, 83, 86, 87, 88, 90, 91, 92, 96, 100, 102, 104, 105, 106, 108, 110, 114, 119, 122, 135, 136, 137, 140, 145, 151, 152, 154, 161, 162, 175, 176, 179, 188, 190, 191, 195, 196, 197, 199, 209], "multipl": [8, 11, 12, 13, 15, 17, 21, 22, 31, 43, 44, 45, 46, 48, 50, 58, 61, 76, 80, 83, 91, 92, 96, 100, 102, 109, 117, 171, 179, 191, 197], "computecontextvectorwithsourc": [8, 195], "intern": [8, 9, 10, 11, 12, 46, 48, 50, 58, 77, 86, 99, 102, 106, 121, 122, 140], "structur": [8, 12, 14, 15, 17, 21, 22, 45, 47, 48, 59, 62, 64, 70, 71, 83, 88, 90, 91, 102, 106, 110, 176, 179, 191, 218], "consid": [8, 9, 11, 15, 30, 46, 70, 71, 86, 151, 152, 179, 197], "mechan": [8, 12, 15, 40, 59, 61, 179], "inspect": [8, 57], "caller": [8, 9, 11, 12, 15, 22, 27, 30, 43, 44, 48, 50, 58, 59, 60, 71, 77, 83, 85, 86, 87, 90, 98, 117, 118, 119, 146, 166, 175, 178, 179, 186, 196], "packsourc": 8, "chang": [8, 11, 15, 27, 34, 46, 48, 49, 64, 83, 84, 87, 106, 135, 145, 151, 160, 197], "state": [8, 10, 12, 15, 17, 18, 19, 25, 30, 40, 41, 48, 50, 59, 62, 64, 76, 79, 80, 82, 83, 86, 87, 88, 91, 92, 94, 102, 104, 105, 106, 107, 108, 134, 135, 138, 141, 145, 161, 186, 195], "packed_src": [8, 92, 102, 134, 135], "query_vec": [8, 15, 59], "attention_st": [8, 135], "per_step_source_pad": [8, 135], "query_segment_id": [8, 59, 135], "context": [8, 9, 11, 12, 15, 23, 30, 48, 49, 58, 59, 60, 77, 83, 87, 92, 93, 95, 102, 104, 106, 107, 109, 114, 118, 134, 135, 189, 193, 195, 198, 218], "queri": [8, 9, 15, 40, 58, 59, 60, 104, 134, 135, 175, 179], "query_dim": [8, 15, 135], "target_batch_s": [8, 15], "source_length": [8, 195, 199], "context_dim": [8, 59, 92, 134, 135], "possibli": [8, 50, 55, 57, 76, 83, 120, 135], "nest": [8, 12, 17, 19, 31, 46, 48, 50, 70, 83, 88, 109, 110, 117, 171, 189, 191, 195], "target_batch": [8, 15, 59, 60, 135, 195], "computecontextvector": 8, "unlik": [8, 58, 70, 83, 86, 179], "ask": 8, "getinitializationsourcest": 8, "get": [8, 9, 10, 11, 12, 13, 15, 17, 19, 22, 23, 26, 31, 40, 42, 44, 46, 48, 50, 52, 58, 63, 64, 70, 71, 76, 82, 83, 84, 86, 91, 94, 100, 109, 110, 114, 117, 123, 124, 125, 128, 131, 135, 146, 179, 183, 195, 209, 219, 224, 228], "onli": [8, 10, 11, 12, 13, 15, 17, 22, 23, 27, 30, 31, 35, 36, 43, 44, 46, 48, 49, 50, 52, 58, 59, 60, 61, 64, 67, 70, 71, 76, 80, 81, 83, 86, 87, 88, 91, 92, 94, 96, 102, 104, 106, 107, 114, 116, 117, 118, 121, 125, 127, 139, 140, 141, 161, 167, 176, 179, 195, 196, 197, 199, 209, 228], "preserv": [8, 50, 52], "concated_source_vec": 8, "concated_source_context": 8, "subclass": [8, 11, 12, 13, 15, 22, 27, 30, 31, 43, 44, 48, 58, 59, 60, 64, 76, 79, 85, 86, 88, 90, 91, 98, 102, 105, 111, 119, 128, 129, 135, 142, 145, 146, 160, 166, 171, 178, 181, 182, 186, 195, 196, 197], "interact": 8, "code": [8, 50, 58, 70, 83, 87, 88, 114, 118, 119, 121, 123, 140, 179], "fetch": [8, 13, 21, 35, 43, 52, 53, 58, 78, 80, 83, 119, 145, 154, 162, 199, 210, 222], "reload": [8, 94, 224], "setinitializationsourcest": 8, "overridden": [8, 11, 12, 13, 15, 22, 43, 46, 48, 58, 60, 61, 78, 83, 86, 88, 92, 102, 106, 117, 119, 135, 141, 146, 166, 176, 195, 196], "reset": [8, 11, 12, 31, 47, 83, 91, 92, 160, 182], "via": [8, 11, 12, 13, 15, 35, 48, 71, 80, 83, 86, 87, 123, 127, 186, 188, 195, 197], "later": [8, 12, 71, 86, 96, 105], "allow": [8, 9, 11, 12, 13, 15, 17, 18, 42, 48, 50, 57, 58, 59, 64, 71, 76, 84, 86, 87, 88, 91, 92, 94, 96, 100, 102, 117, 118, 186, 188, 197], "span": [8, 15, 50, 83], "new_init_st": [8, 195], "wa": [8, 15, 22, 23, 46, 48, 71, 76, 80, 87, 104, 114, 145, 179], "_paddedsoftmax": 8, "logit": [8, 9, 10, 13, 15, 35, 41, 46, 48, 58, 60, 71, 83, 110, 135, 141, 145, 154, 161, 162, 176, 179, 195, 199], "perform": [8, 9, 10, 13, 15, 17, 34, 35, 37, 50, 58, 59, 62, 64, 71, 82, 83, 86, 87, 88, 91, 95, 100, 101, 102, 106, 114, 116, 140, 141, 177, 185, 197, 222], "softmax": [8, 12, 13, 15, 22, 27, 30, 35, 40, 43, 44, 46, 48, 56, 58, 59, 60, 83, 85, 86, 90, 98, 145, 154, 161, 162, 176, 179, 186, 195, 196, 199], "were": [8, 12, 18, 32, 58, 86, 94, 102], "after": [8, 9, 11, 12, 13, 15, 17, 18, 19, 21, 30, 34, 44, 46, 48, 49, 50, 58, 61, 64, 71, 76, 80, 83, 86, 87, 91, 94, 96, 119, 134, 135, 141, 148, 152, 162, 179, 195], "exponenti": [8, 13, 38, 86, 96, 111, 193], "techniqu": 8, "approxim": [8, 36, 65, 76, 111, 168], "standard": [8, 10, 15, 58, 59, 83, 86, 90, 106, 134, 186, 191, 196], "nn": [8, 22, 46, 58, 83, 117, 179], "larg": [8, 15, 46, 58, 76, 83, 87, 167, 197], "neg": [8, 15, 34, 42, 80, 83, 111, 179, 183], "defer": [8, 76, 83], "defun": [8, 12, 71, 83], "low": [8, 10, 83, 86, 94, 111], "_updatepaddingwithpackedinputmask": 8, "mask": [8, 9, 13, 15, 40, 41, 46, 48, 58, 59, 71, 82, 83, 90, 91, 92, 100, 162, 194, 197], "id": [8, 10, 11, 17, 22, 25, 31, 41, 48, 56, 58, 59, 60, 65, 67, 71, 72, 78, 83, 91, 92, 94, 100, 105, 110, 116, 117, 122, 124, 131, 135, 136, 139, 141, 145, 160, 161, 162, 168, 171, 176, 179, 181, 189, 195, 196, 197, 198, 199, 209, 219, 223], "invalid": [8, 50, 56, 68, 77, 78, 83, 125, 224], "assign": [8, 11, 22, 34, 36, 47, 48, 54, 77, 80, 86, 121, 131, 183, 228], "neighbor": 8, "assum": [8, 10, 21, 27, 31, 58, 59, 60, 62, 83, 86, 87, 91, 92, 102, 106, 177, 179, 183, 186, 191, 217, 224], "source_batch": [8, 15, 17, 59, 60, 195], "additiveattent": 8, "also": [8, 10, 11, 12, 13, 15, 22, 30, 35, 41, 42, 43, 44, 46, 49, 50, 58, 59, 65, 70, 71, 76, 77, 83, 86, 87, 88, 91, 92, 94, 102, 104, 106, 111, 116, 118, 119, 135, 136, 139, 140, 145, 152, 154, 161, 183, 186, 190, 195, 197, 198, 199, 224], "known": [8, 15, 37, 64, 83, 86, 191], "bahdanau": 8, "describ": [8, 9, 13, 15, 22, 29, 31, 35, 46, 48, 58, 59, 83, 86, 87, 88, 91, 102, 104, 111, 119, 122, 145, 154, 162, 175, 176, 179, 195, 199, 209, 218], "dzmitri": 8, "kyunghyun": 8, "cho": 8, "yoshua": 8, "bengio": 8, "neural": [8, 17, 43, 58, 59, 71, 83, 87, 91, 135, 193], "machin": [8, 15, 43, 195, 196, 197, 201, 202, 203, 205, 222], "translat": [8, 15, 43, 65, 97, 111, 195, 196, 197, 201, 202, 203, 205], "jointli": 8, "iclr": 8, "2015": [8, 58], "1409": 8, "0473": 8, "addglobalvn": [8, 12, 58, 91], "zeroattentionst": 8, "decoder_batch_s": 8, "score": [8, 34, 64, 65, 71, 72, 80, 92, 97, 111, 152, 179, 195, 197], "between": [8, 13, 15, 23, 30, 35, 48, 50, 58, 59, 60, 65, 69, 71, 76, 83, 87, 91, 94, 96, 100, 121, 137, 143, 145, 151, 152, 154, 162, 176, 179, 185, 199, 209, 220], "compos": [8, 21, 22, 43, 76, 91, 96, 100], "averag": [8, 9, 13, 15, 22, 48, 64, 71, 83, 86, 97, 151, 195], "simpli": [8, 44, 179, 222], "dotproductattent": 8, "dot": [8, 12, 15, 50, 185, 191], "luong": 8, "minh": 8, "thang": 8, "hieu": 8, "pham": 8, "christoph": 8, "d": [8, 9, 11, 15, 22, 27, 40, 46, 58, 59, 62, 70, 83, 94, 100, 105, 108, 141, 177], "man": 8, "effect": [8, 15, 58, 64, 71, 76, 80, 83, 86, 87, 96, 121, 136, 183, 186, 197], "approach": [8, 50, 86], "emnlp": 8, "1508": 8, "04025": 8, "hidden_dim": [8, 27, 58, 62, 92, 93, 161, 166, 167, 190, 193, 205], "num_hyps_per_beam": [8, 10, 17, 71, 135, 136, 193, 195], "beamsearch": 8, "group": [8, 9, 15, 19, 48, 83, 91, 209], "consecut": [8, 10, 59, 71, 83, 100], "row": [8, 10, 15, 34, 40, 46, 48, 56, 71, 77, 87, 105, 197], "_recursivereshap": 8, "multiheadedattent": [8, 15, 195], "head": [8, 9, 15, 29, 40, 46, 48, 59, 60, 93, 161, 190, 193, 195, 198], "conceptu": [8, 22, 87], "algorithm": [8, 15, 30, 34, 38, 44, 45, 87, 90, 96, 104, 122], "work": [8, 11, 13, 34, 48, 52, 57, 58, 60, 71, 77, 78, 80, 83, 86, 87, 114, 135, 141, 183, 197, 222], "follow": [8, 9, 10, 15, 17, 34, 40, 44, 45, 46, 48, 50, 58, 59, 60, 62, 65, 70, 71, 80, 81, 83, 86, 87, 94, 95, 96, 99, 104, 107, 110, 111, 122, 135, 140, 145, 148, 151, 152, 154, 161, 171, 179, 186, 188, 195, 197], "project": [8, 9, 15, 22, 27, 40, 46, 48, 58, 59, 60, 62, 83, 85, 91, 176, 195], "dim": [8, 9, 11, 15, 19, 21, 22, 29, 30, 40, 42, 46, 48, 49, 58, 59, 60, 62, 71, 83, 87, 92, 93, 102, 106, 108, 118, 120, 121, 135, 137, 140, 141, 161, 191, 193, 195, 196, 198], "well": [8, 34, 38, 46, 56, 57, 83, 87, 93, 111, 135, 139, 193, 218], "unless": [8, 52, 69, 71, 83, 86, 116, 135], "enable_ctx_pre_proj": 8, "split": [8, 11, 13, 15, 16, 21, 22, 24, 25, 27, 35, 46, 48, 49, 54, 58, 59, 71, 83, 91, 92, 96, 119, 154, 161, 164, 166, 174, 175, 176, 188, 195, 209], "num_attention_head": [8, 190], "chunk": [8, 15, 17, 40, 71, 161], "inner": [8, 29, 83, 109, 161, 193], "atten": [8, 135, 195], "separ": [8, 12, 15, 44, 48, 49, 50, 58, 59, 62, 71, 77, 80, 83, 88, 91, 108, 116, 128, 171, 179, 197, 209, 224], "concaten": [8, 21, 22, 36, 42, 56, 58, 80, 83, 91, 92, 102, 106, 108, 161, 189, 219], "prob": [8, 9, 15, 17, 27, 29, 56, 58, 59, 64, 71, 72, 83, 135, 161, 162, 193, 195, 199], "setoutputcontextdim": 8, "out_dim": [8, 29], "extendsourcepack": 8, "processprojectionvec": 8, "projection_vec": 8, "projection_typ": 8, "computecontextvectorwithattenprob": 8, "packcachedsourc": 8, "cached_src": 8, "computecontextvectorwithcachedsourc": 8, "locationsensitiveattent": 8, "account": [8, 15, 86], "previous": [8, 41, 64, 71, 83, 86, 105], "locat": [8, 10, 15, 48, 83, 175, 224], "section": [8, 9, 15, 58, 90, 98], "2": [8, 9, 10, 11, 12, 15, 17, 21, 27, 29, 31, 34, 41, 46, 47, 48, 50, 52, 54, 56, 58, 59, 63, 66, 70, 71, 76, 83, 90, 91, 94, 96, 98, 100, 102, 111, 119, 125, 135, 137, 139, 140, 141, 148, 152, 157, 161, 166, 167, 171, 186, 189, 191, 193, 195, 197, 205, 220, 228], "paper": [8, 9, 10, 30, 58, 59, 90, 91, 93, 100, 101, 181, 196, 199], "descript": [8, 50, 58, 110, 193], "nip": 8, "cc": [8, 86, 99], "5847": 8, "speech": [8, 15, 58, 122, 134, 135, 136, 138, 141, 142, 145], "recognit": [8, 142], "pdf": [8, 9, 10, 15, 19, 34, 39, 40, 56, 58, 59, 63, 91, 96, 98, 100, 101, 111, 122, 135, 195, 197, 199], "_applyconv": [8, 30, 58], "location_filter_var": 8, "convolut": [8, 15, 29, 30, 46, 48, 58, 59, 86, 91, 92, 98, 100], "location_featur": 8, "prev_prob": 8, "cumulative_prob": 8, "src_len": [8, 17, 108, 195], "mergesourcepaddingwithperstepsourcepad": 8, "tb": 8, "sl": 8, "sb": [8, 21], "target": [8, 9, 10, 11, 15, 17, 34, 47, 56, 58, 59, 60, 64, 71, 83, 91, 104, 108, 109, 110, 116, 119, 135, 136, 141, 145, 161, 171, 179, 195, 197, 199, 209, 224], "size": [8, 9, 10, 11, 12, 13, 15, 16, 24, 29, 30, 34, 41, 42, 46, 47, 48, 49, 54, 58, 63, 71, 76, 77, 80, 82, 83, 87, 88, 91, 92, 93, 96, 100, 102, 105, 106, 108, 119, 120, 121, 134, 135, 137, 142, 146, 148, 160, 161, 162, 164, 171, 175, 179, 190, 191, 193, 195, 197], "monotonicattent": 8, "mononoton": 8, "1704": 8, "00784": 8, "exactli": [8, 10, 15, 42, 48, 58, 60, 69, 102], "wai": [8, 11, 48, 58, 71, 83, 86, 91, 102, 104, 121, 135, 140, 152, 166, 222], "both": [8, 9, 13, 15, 31, 42, 50, 58, 59, 60, 69, 71, 76, 82, 83, 86, 87, 90, 102, 145, 154, 179, 195, 197, 199], "energi": [8, 217], "differ": [8, 9, 10, 11, 12, 15, 22, 31, 43, 44, 46, 48, 50, 58, 59, 60, 69, 71, 76, 77, 80, 83, 87, 91, 92, 94, 100, 111, 114, 135, 137, 151, 152, 177, 179, 182, 183, 189, 191, 193, 209, 220], "rather": [8, 83, 117], "feed": [8, 10, 11, 15, 21, 27, 48, 52, 53, 58, 59, 78, 102, 106, 136, 145, 154, 161, 162, 190, 193, 210], "soft": [8, 22, 161, 164, 179], "sigmoid": [8, 58, 83, 86, 96, 111], "bernoulli": 8, "interpret": [8, 123, 179], "dynam": [8, 11, 15, 30, 58, 71, 76, 83, 86, 98, 146], "intend": [8, 15, 19, 58, 121, 179, 182, 186], "hard_sigmoid": 8, "test": [8, 14, 48, 52, 59, 78, 80, 81, 83, 85, 86, 107, 113, 114, 119, 128, 129, 146, 148, 155, 157, 164, 167, 174, 182, 188, 193, 202, 203, 205, 212, 224], "decod": [8, 10, 11, 13, 15, 17, 33, 35, 41, 46, 47, 48, 58, 59, 60, 64, 65, 67, 69, 71, 80, 81, 83, 104, 110, 119, 122, 124, 125, 131, 132, 133, 134, 136, 137, 141, 143, 144, 145, 154, 166, 171, 176, 177, 192, 193, 199, 217, 224, 228], "To": [8, 11, 15, 44, 46, 48, 57, 58, 64, 71, 79, 83, 104, 118, 171, 181, 191, 228], "encourg": 8, "nois": [8, 10, 25, 83, 100, 137, 197], "ad": [8, 10, 11, 12, 15, 21, 29, 46, 48, 58, 59, 63, 65, 71, 83, 91, 106, 116, 118, 152, 161, 193, 195, 197], "dure": [8, 12, 13, 15, 17, 31, 35, 48, 58, 59, 64, 71, 80, 83, 86, 87, 96, 114, 125, 135, 141, 145, 154, 162, 176, 179, 195, 199, 228], "pre_sigmoid_nois": 8, "v": [8, 9, 11, 12, 15, 22, 40, 46, 48, 52, 58, 83, 91, 95, 108, 121, 135, 195], "tanh": [8, 15, 29, 46, 86], "w": [8, 9, 11, 15, 19, 21, 31, 46, 48, 58, 83, 86, 87, 94, 152, 179], "encoder_st": 8, "b": [8, 9, 10, 11, 15, 17, 19, 21, 22, 27, 30, 40, 46, 48, 50, 58, 62, 71, 76, 83, 91, 100, 101, 105, 108, 111, 116, 119, 121, 135, 139, 191, 195], "r": [8, 9, 15, 34, 83, 87, 151, 179], "l2": [8, 83, 193], "norm": [8, 15, 21, 27, 46, 58, 59, 61, 76, 83, 108, 182, 186], "These": [8, 10, 11, 32, 46, 48, 50, 64, 86, 87, 91, 102, 121, 178, 179], "modif": [8, 141], "address": [8, 24], "fact": [8, 83], "sensit": [8, 83], "offset": [8, 11, 48, 76, 81, 91, 116, 142, 160, 197], "bit": [8, 86], "harder": 8, "compar": [8, 13, 35, 48, 58, 80, 88, 104, 114, 124, 131, 145, 154, 162, 176, 195, 199, 220], "help": [8, 21, 22, 64, 83, 186], "bia": [8, 9, 10, 15, 21, 22, 29, 46, 48, 58, 71, 91, 195, 197], "hidden_bias_init": 8, "computeprob": 8, "merged_source_pad": 8, "emiss": 8, "again": [8, 96, 195], "gmmmonotonicattent": 8, "gmm": 8, "With": [8, 15, 60, 77, 83, 121, 148, 198], "alex": 8, "grave": 8, "eq": [8, 41, 58, 63, 83, 196], "46": [8, 166, 167], "51": [8, 166, 167], "1308": 8, "0850": 8, "num_mixtur": 8, "4": [8, 9, 15, 17, 19, 24, 30, 46, 48, 52, 58, 59, 62, 63, 65, 71, 83, 91, 93, 97, 100, 119, 125, 135, 140, 148, 164, 166, 167, 171, 186, 189, 191, 196, 219, 228], "varianc": [8, 19, 83], "prior": [8, 11, 13, 175, 182], "mergerlay": [8, 58, 60], "variou": [8, 13, 18, 86, 87, 117, 121, 135], "merger": [8, 92, 193], "merger_op": 8, "mean": [8, 9, 10, 15, 19, 24, 30, 48, 50, 58, 64, 71, 83, 87, 94, 102, 104, 106, 118, 175, 176, 179, 183, 195, 197], "concat": [8, 11, 15, 21, 48, 56, 82, 91], "last": [8, 9, 15, 21, 22, 29, 30, 34, 40, 48, 56, 58, 59, 64, 71, 83, 86, 87, 88, 91, 92, 96, 122, 139, 161, 179, 195, 197, 219], "up": [8, 10, 11, 15, 24, 27, 31, 48, 58, 59, 65, 71, 82, 83, 84, 87, 92, 96, 105, 114, 116, 117, 118, 129, 135, 161, 186, 193, 196, 197, 224], "weighted_sum": [8, 83], "learnt": [8, 58], "gated_avg": 8, "gate": [8, 15, 29, 48, 58, 59, 91, 161], "multi": [8, 13, 15, 45, 46, 48, 52, 58, 59, 60, 76, 77, 80, 100, 111, 125, 140, 176, 179, 195, 198, 228], "column": [8, 15, 34, 46, 71, 193, 197], "_child_variable_scope_overrid": [8, 12, 13, 15, 22, 43, 48, 58, 60, 61, 86, 88, 92, 102, 106, 117, 141, 176, 195, 196], "scope": [8, 12, 13, 15, 22, 43, 48, 52, 58, 60, 61, 64, 82, 83, 84, 86, 88, 92, 102, 106, 117, 121, 141, 176, 195, 196], "individu": [8, 12, 13, 15, 16, 17, 22, 41, 43, 48, 58, 60, 61, 71, 83, 86, 88, 92, 102, 106, 117, 121, 141, 176, 195, 196, 197, 209, 224], "backward": [8, 12, 13, 15, 22, 34, 40, 43, 46, 48, 58, 60, 61, 68, 71, 83, 86, 87, 88, 92, 102, 106, 117, 141, 176, 195, 196], "old": [8, 12, 13, 15, 22, 43, 48, 58, 60, 61, 83, 86, 88, 92, 94, 102, 106, 114, 117, 120, 141, 176, 195, 196], "By": [8, 12, 13, 15, 22, 24, 35, 43, 46, 48, 50, 58, 60, 61, 65, 71, 83, 86, 87, 88, 92, 102, 104, 105, 106, 117, 119, 135, 141, 175, 176, 179, 195, 196], "map": [8, 10, 11, 12, 13, 15, 17, 18, 19, 22, 23, 24, 31, 35, 40, 43, 48, 50, 52, 58, 60, 61, 64, 70, 71, 77, 83, 86, 87, 88, 92, 100, 102, 106, 109, 116, 117, 119, 128, 134, 135, 138, 140, 141, 145, 154, 162, 176, 178, 179, 191, 195, 196, 197, 199, 219, 223], "pre_proj_input_dim": 8, "specifi": [8, 9, 10, 11, 15, 17, 22, 23, 24, 27, 42, 46, 47, 48, 50, 52, 58, 59, 64, 76, 77, 78, 80, 83, 86, 87, 88, 92, 93, 94, 102, 104, 117, 120, 124, 131, 135, 138, 140, 142, 160, 175, 177, 179, 181, 182, 193, 197, 209, 224], "multisourceattent": [8, 15], "sub": [8, 12, 13, 15, 21, 22, 27, 30, 40, 43, 44, 48, 58, 59, 60, 70, 80, 83, 85, 88, 90, 96, 98, 102, 106, 107, 120, 125, 135, 137, 143, 151, 152, 161, 186, 193, 196, 217, 228], "associ": [8, 13, 15, 36, 40, 48, 80, 84, 86, 117, 125, 188, 218, 228], "source_seq_length": [8, 92], "_combinecontext": [8, 15], "context_map": [8, 134], "util": [9, 11, 16, 17, 23, 26, 48, 49, 52, 57, 68, 77, 81, 82, 83, 84, 86, 95, 108, 109, 110, 115, 123, 132, 137, 139, 141, 143, 172, 179, 189], "rel": [9, 15, 34, 46, 58, 71, 76, 83, 137], "embed": [9, 11, 15, 46, 48, 50, 58, 59, 60, 82, 83, 86, 91, 93, 105, 117, 134, 161, 173, 188, 190, 193, 195, 196, 199], "converttoblock": 9, "block_siz": [9, 36, 93], "padding_v": [9, 91], "turn": [9, 10, 11, 25, 83], "overlap": [9, 76, 91], "block": [9, 15, 29, 40, 58, 59, 80, 83, 90, 91, 93, 94, 193], "int": [9, 10, 11, 13, 15, 16, 17, 21, 24, 30, 31, 34, 39, 41, 42, 48, 49, 50, 60, 65, 70, 71, 80, 82, 83, 86, 92, 94, 102, 105, 106, 111, 116, 117, 124, 131, 135, 139, 146, 154, 161, 175, 179, 188, 189, 190, 191, 195, 198, 219], "frame": [9, 15, 58, 71, 83, 100, 135, 140, 217, 223], "num_block": [9, 58, 59, 83], "necessari": [9, 57, 58, 80, 83, 86, 179], "extractblockcontext": 9, "left_context": [9, 15, 58, 93], "right_context": [9, 15, 58, 93, 107], "extract": [9, 57, 61, 65, 70, 83, 91, 140, 175, 191, 197, 219], "tempor": [9, 59], "context_s": 9, "end": [9, 10, 11, 13, 15, 17, 30, 35, 48, 50, 56, 58, 61, 64, 71, 76, 80, 83, 86, 87, 96, 110, 116, 171, 175, 193, 199, 203, 209], "_dopad": 9, "l": [9, 15, 40, 46, 48, 83], "helper": [9, 11, 17, 22, 33, 41, 46, 54, 58, 64, 70, 77, 80, 83, 87, 97, 107, 110, 112, 113, 114, 128, 129, 182, 183, 186, 228], "front": [9, 209], "rear": 9, "axi": [9, 10, 15, 21, 22, 29, 30, 36, 39, 46, 48, 58, 82, 83, 86, 100, 102, 108, 179, 189, 191], "length": [9, 10, 11, 15, 17, 30, 31, 40, 41, 42, 43, 46, 47, 48, 54, 56, 58, 65, 67, 70, 71, 76, 77, 80, 83, 87, 91, 92, 100, 104, 108, 116, 136, 137, 139, 171, 173, 181, 188, 190, 195, 197, 209], "3d": [9, 15, 34, 58, 59, 77, 83, 108, 140], "extractblockcontextv2": 9, "restrict": [9, 70, 188], "free": [9, 91], "constraint": [9, 34, 86], "other": [9, 11, 13, 14, 15, 17, 31, 35, 43, 44, 46, 48, 50, 58, 59, 64, 70, 83, 87, 91, 104, 106, 118, 119, 121, 135, 136, 145, 154, 162, 176, 179, 182, 188, 191, 199, 222], "actual": [9, 11, 24, 58, 64, 71, 83, 86, 88, 100, 137, 178, 188, 195, 197], "info": [9, 10, 36, 83, 87, 128, 135, 141], "x_patch": 9, "x_pad": [9, 56, 199], "let": [9, 13, 15, 46, 48, 71, 119], "here": [9, 11, 13, 15, 30, 31, 34, 57, 59, 80, 81, 86, 91, 96, 135, 141, 142, 145, 160, 161, 179, 188, 195, 197], "u": [9, 15, 86, 94], "ceil": [9, 15, 30, 58, 100], "c": [9, 15, 22, 25, 30, 48, 58, 83, 91, 154, 171, 179, 191, 228], "full": [9, 15, 22, 36, 49, 58, 71, 76, 90, 128, 175, 179, 188, 219, 224, 228], "ret": [9, 24, 83, 87, 197], "2d": [9, 15, 24, 29, 30, 34, 48, 49, 58, 77, 83, 108, 140, 166], "procedur": 9, "begin": [9, 11, 15, 17, 71, 83, 87, 106, 122, 191], "extra": [9, 10, 11, 12, 15, 50, 52, 62, 77, 80, 87, 90, 91, 92, 94, 102, 114, 142, 151, 160, 161, 179, 182, 195, 197], "gather": [9, 46, 48, 58, 82, 83], "todo": [9, 11, 15, 21, 31, 43, 46, 48, 58, 59, 61, 80, 83, 140], "yqw": 9, "verfii": 9, "benchmark": [9, 67, 80, 164, 170], "makelocalmask": 9, "seq_len": [9, 27, 58, 71, 83, 93, 108, 135, 141], "query_strid": [9, 15, 27], "float32": [9, 15, 18, 41, 47, 58, 64, 71, 83, 86, 100, 105, 117, 118, 140, 173, 176, 177, 185, 209], "reflect": [9, 12, 64, 83, 87, 128, 177], "1st": [9, 54, 81, 87], "2nd": [9, 48, 83, 87, 195], "2st": 9, "stride": [9, 15, 27, 29, 30, 58, 86, 98, 107, 140], "pool": [9, 15, 29, 30, 58, 59, 91], "funnel": [9, 15], "j": [9, 10, 11, 15, 22, 24, 34, 38, 63, 71, 83, 95, 100, 108, 116, 162], "access": [9, 12, 21, 25, 31, 44, 48, 70, 76, 83, 87, 117, 127, 186, 218], "relshift": 9, "shift": [9, 46, 48, 58, 71, 83, 92, 100, 111, 197], "4d": [9, 58, 77, 140], "content": [9, 13, 31, 33, 35, 50, 71, 83, 94, 119, 145, 154, 199, 217, 223, 224, 226], "abov": [9, 22, 41, 58, 71, 83, 91, 100, 114, 164, 195], "attenlogit": 9, "h": [9, 11, 15, 17, 19, 31, 40, 48, 58, 71, 151], "attencontext": 9, "encod": [9, 10, 13, 15, 17, 35, 46, 50, 59, 60, 69, 76, 92, 93, 97, 98, 104, 110, 122, 132, 133, 135, 136, 140, 145, 167, 176, 177, 179, 181, 182, 185, 188, 190, 191, 192, 193, 195, 197, 199, 217, 219, 223, 227], "positionalattenlogit": 9, "transform": [9, 12, 15, 31, 40, 41, 43, 44, 46, 48, 49, 56, 58, 59, 60, 67, 70, 83, 86, 91, 92, 93, 96, 102, 129, 132, 161, 164, 167, 172, 175, 177, 178, 193, 195, 196, 198, 199, 202], "xl": [9, 15], "languag": [9, 11, 43, 58, 67, 116, 141, 160, 161, 162, 164, 165, 168], "beyond": [9, 59], "fix": [9, 12, 15, 52, 58, 71, 83, 87, 91, 96, 100, 106, 111, 114, 116, 179], "1901": [9, 15, 29, 30, 59, 60, 98], "02860": [9, 15], "represent": [9, 11, 22, 33, 44, 50, 83, 86, 120, 171, 185], "1803": [9, 15, 19, 58], "02155": [9, 15, 58], "relpositionbia": 9, "abs_pos_emb": 9, "skip_term_b": 9, "subroutin": 9, "num": [9, 15, 17, 29, 46, 47, 54, 71, 80, 83, 96, 120, 151, 152, 195], "2t": 9, "absolut": [9, 58, 83], "emb": [9, 15, 58, 59, 60, 91, 135, 196, 199], "distanc": [9, 15, 100, 137, 143, 151, 152], "skip": [9, 11, 50, 58, 61, 71, 80, 83, 114, 171], "term_b": 9, "equat": [9, 46, 48, 63, 86, 91], "_validatebias": 9, "content_bia": 9, "positional_bia": 9, "_attenlogit": [9, 15], "transformerxl": 9, "rpe": [9, 15], "sinusoid": [9, 58, 196], "1706": [9, 15, 59, 60, 98, 195, 196, 198, 199], "03762": [9, 15, 59, 60, 98, 195, 196, 198, 199], "attenlogitsxl": 9, "attenlogitsrp": 9, "trainabl": [9, 15, 48, 58, 83, 91, 186], "embd": 9, "attenlogitsxlonestep": 9, "attenlogitsrpeonestep": 9, "kmeansclusteringforatten": 9, "k": [9, 10, 15, 34, 38, 40, 43, 46, 48, 58, 59, 70, 71, 83, 108, 122, 154], "mini": [9, 195], "2003": [9, 15, 93], "05997": [9, 15, 93], "capit": [9, 15], "letter": [9, 15, 50, 116], "denot": [9, 12, 15, 34, 58, 83, 100], "refer": [9, 11, 17, 22, 29, 31, 34, 38, 43, 47, 50, 56, 58, 65, 80, 86, 87, 91, 92, 100, 136, 137, 139, 140, 143, 144, 151, 152, 191, 195, 196, 199], "elsewher": [9, 181, 182], "layernorm": [9, 58, 91], "epsilon": [9, 19, 34, 36, 63, 71, 111, 137, 166, 193], "1e": [9, 36, 40, 63, 76, 83, 166, 195], "06": [9, 36, 40, 48, 63], "normal": [9, 10, 15, 19, 27, 30, 40, 41, 46, 48, 58, 59, 60, 71, 83, 91, 111, 139, 179, 186, 193, 195, 198, 199], "scale": [9, 15, 34, 36, 40, 46, 58, 61, 76, 83, 86, 91, 96, 100, 140], "tini": [9, 11, 164], "guard": 9, "against": [9, 65, 86, 114, 197], "rsqrt": [9, 96], "centroid": [9, 15], "dist": [9, 86], "k_means_loss": 9, "squar": [9, 63, 70, 83], "euclidean": [9, 15], "closest": [9, 15], "computesparseattent": 9, "q": [9, 15, 22, 40, 179], "sparsity_indic": 9, "sparsiti": [9, 195], "window": [9, 15, 30, 37, 58, 93, 96, 140, 188], "batch_idx": 9, "head_idx": 9, "7": [9, 48, 58, 119, 164, 166, 167, 219], "8": [9, 41, 46, 58, 63, 71, 77, 83, 86, 119, 144, 148, 161, 164, 166, 167, 171, 205], "valid": [9, 11, 12, 17, 19, 23, 30, 50, 56, 58, 67, 70, 71, 77, 78, 83, 113, 116, 117, 123, 195, 224], "reserv": [9, 71, 87], "distinct": [9, 13, 35, 86, 179, 183], "degener": 9, "sort": [9, 10, 23, 50, 83], "flexibl": 9, "complex": [9, 15, 86], "pleas": [9, 15, 17, 21, 58, 59, 71, 91, 110, 151], "subset": [9, 13, 15, 46, 56, 61, 86, 114, 119, 186], "atten_prob": [9, 15, 17, 27, 59, 71, 92, 104, 135, 195, 199], "common": [10, 11, 15, 17, 30, 48, 50, 58, 80, 83, 84, 88, 102, 107, 108, 137, 140, 143, 161, 173, 174, 178, 179, 181, 193, 209, 220, 229], "interfac": [10, 12, 15, 22, 23, 27, 30, 43, 44, 48, 58, 59, 60, 79, 85, 87, 90, 92, 98, 104, 114, 117, 121, 140, 186, 196], "decoderoutput": 10, "predict": [10, 13, 35, 46, 58, 59, 60, 64, 65, 71, 78, 119, 135, 145, 154, 162, 176, 195, 199], "per_sequ": [10, 135], "_asdict": [10, 17, 24, 52, 77, 83, 87, 102, 135, 138, 140], "field": [10, 11, 15, 17, 24, 46, 50, 51, 52, 53, 58, 60, 62, 64, 71, 72, 73, 74, 77, 78, 83, 84, 87, 91, 102, 106, 135, 138, 140, 161, 191, 195, 196, 197, 206, 224], "_field_default": [10, 17, 24, 52, 77, 83, 87, 102, 135, 138, 140], "_field": [10, 17, 24, 52, 77, 83, 87, 102, 135, 138, 140], "_make": [10, 17, 24, 52, 77, 83, 87, 102, 135, 138, 140], "_replac": [10, 17, 24, 52, 77, 83, 87, 102, 135, 138, 140], "kwd": [10, 17, 24, 52, 77, 83, 87, 102, 135, 138, 140], "alia": [10, 17, 24, 52, 58, 77, 83, 86, 87, 102, 135, 136, 138, 140, 144], "basedecod": 10, "updatetargetvocabs": [10, 13, 135, 161, 162, 195], "vocab_s": [10, 13, 17, 41, 46, 71, 82, 110, 135, 141, 161, 162, 164, 166, 167, 193, 195, 202, 203, 205], "wpm_model": [10, 13, 135, 161, 162, 195], "vocab": [10, 11, 13, 17, 56, 58, 71, 116, 135, 148, 161, 162, 164, 195, 205, 212, 219], "wpm": [10, 13, 97, 116, 122, 135, 148, 161, 162, 195, 202, 203], "vocabulari": [10, 13, 71, 82, 116, 135, 161, 162, 193, 195], "prefix": [10, 12, 13, 23, 31, 40, 41, 47, 48, 49, 58, 59, 65, 70, 83, 94, 122, 135, 161, 162, 195, 197], "wordpiec": [10, 13, 122, 135, 161, 162, 168, 195], "encoder_output": [10, 17, 110, 135, 195, 199], "being": [10, 11, 15, 21, 48, 58, 64, 71, 83, 86, 108, 118, 178, 179, 197], "namedtupl": [10, 13, 35, 50, 70, 83, 118, 135, 136, 140, 144, 145, 154, 162, 176, 199], "computepredict": [10, 13, 35, 46, 119, 135, 145, 154, 162, 176, 195, 199], "computeloss": [10, 13, 35, 44, 46, 48, 61, 83, 119, 135, 145, 154, 162, 176, 195, 199], "_keeptopp": 10, "sorted_log_prob": 10, "keep": [10, 17, 58, 71, 80, 81, 83, 105, 114, 143, 191, 193, 195], "top": [10, 17, 24, 48, 59, 60, 71, 83, 86, 102, 106, 108, 154, 181], "mass": [10, 71, 194, 197], "includ": [10, 11, 13, 15, 30, 35, 43, 44, 48, 52, 58, 71, 76, 80, 83, 86, 88, 91, 106, 110, 121, 122, 134, 139, 145, 152, 154, 161, 162, 171, 173, 176, 182, 191, 199, 209], "large_negative_numb": 10, "kept": [10, 15], "descend": [10, 12, 70, 71], "order": [10, 11, 12, 15, 27, 30, 36, 48, 49, 65, 71, 76, 78, 79, 83, 87, 92, 97, 99, 162, 171, 189, 197], "threshold": [10, 13, 41, 48, 82], "item": [10, 11, 22, 51, 70, 83, 92, 102, 106, 120, 141, 176, 179], "like": [10, 11, 12, 15, 17, 22, 50, 76, 83, 86, 91, 105, 114, 119, 173, 179, 182, 188, 191, 195, 197, 218, 219, 224], "outsid": [10, 48, 64, 91, 92, 118, 186], "_batchscatt": 10, "default_tensor": 10, "tensor_scatter_nd_upd": 10, "_batchlookup": 10, "table_kei": 10, "table_valu": 10, "look": [10, 58, 59, 71, 84, 105, 116, 117, 119, 161, 196, 197, 218, 224], "tabl": [10, 58, 82, 105, 117, 226], "hold": [10, 50, 83, 118, 179, 188], "whose": [10, 11, 15, 21, 48, 61, 63, 71, 83, 87, 100, 220, 224], "_batchsamplegumbel": 10, "batch_se": 10, "time_step": [10, 15, 58, 195], "src_id": [10, 71, 119], "src_pad": [10, 92, 100, 108, 142], "gumbel": 10, "determin": [10, 11, 15, 23, 35, 64, 71, 76, 80, 83, 87, 102, 104, 116, 118, 135, 179, 197], "secondari": 10, "src_seq": 10, "_samplegumbelwithmax": 10, "phi": 10, "target_max": 10, "maximum": [10, 12, 15, 17, 34, 46, 63, 65, 71, 77, 83, 86, 100, 104, 108, 116, 119], "equal": [10, 15, 17, 48, 56, 58, 62, 71, 83, 92, 179], "stabl": [10, 50, 63], "appendix": [10, 91], "1903": 10, "06059": 10, "tgt_batch": [10, 17, 48, 195], "thtat": 10, "max": [10, 12, 17, 34, 41, 47, 58, 71, 83, 86, 87, 96, 100, 139, 161, 164, 171, 197], "src_batch": [10, 17, 195], "within": [10, 11, 15, 23, 24, 31, 34, 48, 50, 58, 64, 71, 83, 86, 87, 94, 100, 109, 179, 209], "second": [10, 15, 36, 46, 48, 50, 59, 60, 62, 71, 76, 78, 83, 92, 110, 116, 151, 152, 197, 220], "almost": [10, 83, 97], "basebeamsearchdecod": [10, 135, 195], "beam": [10, 15, 17, 41, 48, 65, 71, 80, 135, 141, 195, 218, 222], "addextradecodinginfo": [10, 195], "encoded_output": [10, 195], "encoder_ouput": [10, 195], "beamsearchdecod": [10, 17, 195], "num_hyps_per_beam_overrid": [10, 17], "ignor": [10, 11, 15, 17, 50, 56, 57, 58, 71, 80, 83, 116, 138, 151, 179, 203], "beamsearchdecodeoutput": [10, 17, 136, 195], "beamsearchdecodewiththeta": 10, "greedysearchdecod": [10, 17], "greedi": [10, 17], "greedysearchdecodewiththeta": 10, "_postprocesssampl": 10, "is_tpu": 10, "topk_hyp": [10, 17, 71, 78, 136], "topk_id": [10, 17, 41], "topk_len": [10, 17, 41], "topk_scor": [10, 17, 41, 171], "empti": [10, 11, 17, 22, 52, 71, 83, 87, 91, 102, 106, 134, 135, 137, 142, 151, 160, 171, 195, 197, 224], "sampletargetsequ": 10, "random_se": [10, 52, 83, 110], "int32": [10, 41, 42, 47, 48, 58, 59, 60, 71, 83, 105, 110, 134, 135, 161, 168, 171, 176, 195, 209], "max_target_length": [10, 110, 135], "target_sos_id": [10, 17, 110], "mayb": [10, 11, 12, 83, 110, 178], "target_eos_id": [10, 110], "beamsearchdecodebias": 10, "while": [10, 15, 19, 30, 34, 48, 58, 78, 83, 86, 92, 102, 118, 135, 179, 197, 219], "bias": [10, 58], "toward": [10, 83, 86], "stochasticbeamsearchdecodebias": 10, "stochast": [10, 59], "advanc": [10, 15], "auxiliari": [10, 15, 48, 59, 60, 117], "label": [10, 11, 39, 46, 48, 58, 60, 64, 65, 71, 77, 83, 104, 114, 116, 132, 135, 145, 154, 161, 162, 172, 175, 183, 193, 195, 199, 209], "seq": [10, 15, 141, 197], "forc": [10, 11, 21, 56, 58], "filter": [10, 11, 30, 58, 70, 71, 83, 86, 137, 197, 224], "ensur": [10, 11, 12, 31, 46, 64, 76, 78, 83, 86, 90, 179, 186, 195], "qualiti": [10, 97, 195, 197], "slight": [10, 197], "coverag": [10, 71], "penalti": [10, 65, 71], "perturb": [10, 114], "stochastic_beam_search": 10, "top_p_threshold": 10, "satisfi": [10, 71, 179], "high": [10, 48, 59, 71, 76, 83, 94, 125, 183], "divers": 10, "drawn": [10, 83], "_wrapinitbeamsearchstatecallback": 10, "callback": [10, 17, 41, 80, 87, 110], "wrap": [10, 13, 15, 46, 48, 55, 58, 64, 80, 83, 87, 102, 104, 114, 178, 179, 186, 191], "_initbeamsearchstatecallback": [10, 110, 135, 195], "attach": [10, 49, 92, 179, 186], "consist": [10, 13, 22, 27, 31, 48, 58, 61, 71, 76, 83, 86, 88, 135, 140, 145, 154, 196, 197], "track": [10, 12, 17, 58, 64, 71, 83, 86, 94, 108, 121, 143, 188, 195], "hypothesi": [10, 65, 71, 72, 135, 151, 152], "so": [10, 11, 13, 15, 30, 43, 46, 48, 49, 50, 58, 64, 71, 80, 82, 83, 86, 87, 91, 94, 97, 100, 104, 110, 116, 119, 160, 171, 177, 179, 182, 183, 186, 191, 195, 209], "cumulative_log_prob": 10, "unperturb": 10, "perturbed_cumulative_log_prob": 10, "counterpart": 10, "footnot": 10, "desir": [10, 43], "sinc": [10, 13, 46, 58, 65, 80, 83, 94, 117, 119, 140, 182], "divid": [10, 48, 59, 83], "tmp_state": 10, "prebeamsearchstepcallback": [10, 17], "postbeamsearchstepcallback": [10, 17], "_wrapprebeamsearchstepcallback": 10, "_prebeamsearchstepcallback": [10, 110, 135, 195], "log_prob": [10, 17, 161, 195], "maintain": [10, 17, 57, 70, 71, 81, 83], "_wrappostbeamsearchstepcallback": 10, "_postbeamsearchstatecallback": 10, "_postbeamsearchstepcallback": [10, 110, 135, 195], "inferenceadditionalencod": 10, "graph": [10, 11, 12, 13, 21, 22, 23, 27, 35, 36, 43, 46, 47, 48, 49, 52, 71, 76, 78, 80, 83, 87, 88, 91, 94, 102, 104, 106, 114, 117, 119, 125, 131, 145, 154, 176, 186, 197, 199, 210, 228], "There": [11, 15, 31, 48, 70, 91, 102, 179], "three": [11, 17, 58, 59, 88, 102, 106, 151, 152, 217], "devic": [11, 13, 15, 21, 22, 24, 25, 27, 42, 43, 46, 47, 48, 49, 52, 58, 64, 78, 80, 83, 86, 87, 91, 94, 99, 101, 154, 162, 199], "baseinputgener": [11, 119, 160, 166, 178, 209], "basesequenceinputgener": [11, 14, 142, 146, 160, 197], "bucket_batch_limit": [11, 42, 148], "globalbatchs": [11, 146], "infeedbatchs": 11, "global_batch_s": [11, 16, 80, 117], "num_infeed_host": [11, 24], "num_tpu_host": [11, 24, 25], "host": [11, 16, 31, 42, 46, 83, 87, 118, 179, 197], "infe": [11, 16, 42, 47, 80, 119, 142, 146, 160, 166, 179, 189, 197], "otherwis": [11, 12, 13, 15, 22, 23, 46, 48, 52, 58, 59, 60, 70, 76, 81, 83, 86, 87, 91, 92, 94, 96, 100, 139, 161, 175, 191, 196, 197, 198], "rpang": [11, 61], "packed_input": [11, 15, 166, 198, 205], "_perhostinfeedtpuordinalfunct": 11, "use_per_core_infe": 11, "task_id": [11, 15, 24, 59, 60, 196, 197], "shard_index_in_host": 11, "ordin": 11, "shard": [11, 15, 27, 36, 46, 48, 49, 58, 59, 76, 80, 83, 86, 91, 117, 119, 121, 146, 166, 193], "_reordertensortolog": 11, "tensor_list": [11, 77, 83], "reorder": [11, 71], "_rorderpartitionedtensortolog": 11, "tpu_number_of_shard": 11, "partit": [11, 36, 43, 49, 86, 161], "input_batch": [11, 13, 35, 42, 46, 58, 102, 114, 117, 119, 135, 136, 140, 145, 154, 162, 176, 178, 196, 199], "abstract": [11, 12, 13, 22, 30, 45, 48, 79, 102, 161, 175], "defineinfeedparam": 11, "createdatasourc": [11, 209], "commoninputoparg": 11, "getbpropvariablefilt": 11, "getinputsourceonehot": 11, "bprop": [11, 13, 35, 83, 117, 146], "getbatchs": 11, "calcul": [11, 15, 16, 39, 46, 58, 83, 86, 136, 144, 145, 179, 183, 195], "implicit": [11, 57, 83, 87], "side": [11, 22, 86, 87, 92, 105, 136, 179, 186, 188], "captur": [11, 56, 83, 87, 179, 195, 199], "229158150": 11, "Or": [11, 13, 19, 35, 77, 108, 119, 151, 154, 176], "spilt": [11, 13, 35, 119, 154, 176], "preprocess": [11, 119, 146, 151, 152, 166, 177, 178, 179, 182, 188, 190], "total": [11, 15, 17, 24, 46, 56, 61, 64, 83, 90, 100, 108, 135, 137, 146, 151, 152, 162, 189, 197], "_inputbatch": [11, 119, 146, 160, 166, 178], "meant": [11, 58, 91, 94, 119, 146, 166], "getpreprocessedinputbatch": [11, 119, 146, 166, 178], "_preprocessinputbatch": [11, 178], "format": [11, 15, 24, 42, 46, 48, 50, 66, 71, 77, 81, 83, 102, 108, 116, 135, 140, 151, 152, 166, 173, 175, 179, 183, 186, 188, 189, 191, 195, 197, 218, 222, 226], "fed": [11, 58, 91, 92, 102, 106, 145, 154, 178, 191], "createtpuenqueueop": 11, "benchmark_onli": 11, "outer": [11, 109], "wire": 11, "tpudequeuebatch": 11, "dequeu": [11, 13, 80], "createtpuembeddingenqueueop": 11, "tpuembed": [11, 117], "instanti": [11, 12, 25, 48, 50, 55, 57, 80, 118, 125, 160, 178, 183, 186, 191, 196, 228], "monolith": [11, 117], "tpuembeddinglay": [11, 117], "_gettpuembeddingenqueuedata": 11, "tpu_embed": [11, 117], "num_split": [11, 54, 83], "feature_nam": [11, 117], "tpu_embedding_lib": 11, "enqueuedata": 11, "infeedsetupgraph": 11, "cpu_passthrough": 11, "pipelin": [11, 15, 31, 42, 43, 46, 48, 83, 136, 142, 160, 175, 197, 218], "deviceloopsetupeag": 11, "level": [11, 12, 48, 58, 64, 70, 83, 86, 116, 125, 164, 175, 183, 188, 228], "preprocesstpuembeddinginputbatch": 11, "hook": [11, 114, 129], "manipul": [11, 12, 13, 83, 197], "getcpupassthroughkei": 11, "send": [11, 13, 46, 48, 80, 87, 99, 119], "still": [11, 21, 64], "passthrough": [11, 80], "inputbatch": 11, "sent": [11, 50, 102], "postprocessdecodeout": [11, 13, 35, 119, 145, 154, 176, 199], "createcpupassthroughenqueueop": 11, "cpu": [11, 25, 36, 42, 58, 79, 80, 83, 117, 224, 228], "dequeuecpupassthrough": 11, "tpu_infeed_op": 11, "merged_input_data_summary_op": 11, "input_data_summary_layout": 11, "splitinputbatch": 11, "input_gener": [11, 13, 31, 132, 133, 153, 159, 172, 192, 208], "reproduc": [11, 83, 160], "fresh": [11, 160], "tensorflow": [11, 12, 13, 19, 24, 30, 32, 43, 51, 53, 72, 73, 74, 80, 82, 83, 86, 87, 114, 140, 151, 152, 160, 177, 186, 197, 206, 224], "_map_arg": [11, 31], "maybeoffsetdatasourceid": 11, "source_id": [11, 42, 60, 142, 160, 197], "configur": [11, 12, 24, 27, 31, 48, 50, 58, 64, 68, 76, 83, 84, 86, 119, 135, 175, 176, 178, 179, 182, 190, 224, 228], "partitionfilepatternsintodatasourc": 11, "batch_mixing_partition_boundari": 11, "document": [11, 78, 86, 102, 104, 106], "simpledatasourc": [11, 31], "filepatterntodatasourc": 11, "deprec": [11, 15, 60, 80, 83, 91], "file_datasourc": 11, "baseinputgeneratorfromfil": 11, "read": [11, 12, 27, 31, 46, 50, 83, 94, 96, 104, 121, 145, 154, 160, 171, 175, 179, 183, 188, 197, 209, 218, 219, 222, 223], "_datasourcefromfilepattern": [11, 142, 160, 197], "_inputopbucketingarg": 11, "input_source_weight": [11, 142, 160, 197], "input_source_id_offset": [11, 142, 160, 197], "extra_input_kwarg": [11, 142, 160, 197], "control": [11, 44, 48, 50, 58, 76, 77, 80, 83, 86, 87, 117, 131, 135, 142, 160, 179, 188, 197, 228], "mix": [11, 15, 31, 82, 83, 142, 160, 197], "record": [11, 12, 20, 33, 37, 42, 71, 73, 83, 86, 96, 142, 160, 175, 197, 218, 222, 226], "proportion": [11, 31, 142, 160, 197], "custom": [11, 13, 15, 23, 31, 58, 83, 86, 87, 90, 91, 135, 142, 160, 197], "genericinputv2": [11, 42, 142, 160, 197], "generic_input_v2_kei": [11, 42, 142, 160, 197], "_builddatasourcewithmetadata": 11, "bprop_variable_filt": [11, 13, 31, 83], "togeth": [11, 21, 31, 71, 83, 91, 175], "source_select": [11, 145], "selected_bprop": 11, "_builddatasourc": 11, "basic": [11, 12, 58, 91, 195], "infeed_bucket_batch_limit": 11, "bucket": [11, 15, 31, 42, 46, 142, 148, 160, 197, 209], "use_per_host_infe": [11, 16, 31], "stringstoid": [11, 116], "str": [11, 12, 13, 23, 31, 35, 45, 46, 50, 61, 70, 80, 81, 83, 86, 97, 111, 116, 117, 119, 123, 136, 143, 144, 145, 151, 154, 161, 162, 168, 171, 175, 176, 179, 182, 188, 190, 191, 199, 226], "is_sourc": 11, "external_max_length": 11, "external_append_eo": [11, 116], "source_max_length": [11, 17, 197, 209], "max_length": [11, 83, 100, 116, 168, 190, 191], "append_eo": [11, 71, 116, 168], "eo": [11, 17, 56, 71, 83, 116, 136, 139, 171, 195, 199, 209], "maxlen": [11, 71, 83, 116], "iff": [11, 30, 37, 71, 83, 94, 116], "That": [11, 71, 83], "ground": [11, 58], "truth": [11, 58], "teacher": [11, 13, 35, 145, 154, 162, 176, 199], "respect": [11, 48, 58, 71, 82, 83, 87, 90, 94, 111, 176, 179, 195, 197, 220], "stringstoidswithoffset": [11, 116], "byte": [11, 13, 24, 33, 35, 97, 116, 119, 144, 145, 154, 199, 217], "start_offset": [11, 116], "end_offset": [11, 116], "idstostr": [11, 67, 116, 168], "len": [11, 15, 54, 67, 71, 83, 114, 116, 136, 168, 197], "convert": [11, 15, 31, 42, 49, 52, 58, 64, 67, 70, 71, 77, 81, 83, 97, 105, 116, 120, 121, 122, 136, 188, 220, 225], "matrix": [11, 15, 36, 40, 58, 59, 63, 67, 71, 76, 77, 83, 91, 92, 100, 108, 116, 151, 152, 162, 179, 195], "seqlen": [11, 15, 27, 62, 67, 83, 108, 116], "idstotoken": [11, 116], "cast": [11, 58, 60, 64, 83, 86, 98, 117], "fprop_dtyp": [11, 15, 27, 41, 46, 48, 59, 83], "basetinydatasetinput": [11, 155], "store": [11, 14, 15, 22, 50, 57, 58, 71, 76, 83, 87, 90, 105, 111, 114, 135, 173, 175, 179, 183, 188], "height": [11, 19, 27, 29, 30, 58, 77, 100, 177], "raw": [11, 12, 48, 92, 155, 182, 217], "real": [11, 48, 83, 114, 136, 141, 199], "_preprocess": [11, 155, 227], "tfdatasequenceinputgener": 11, "inherit": [11, 83, 86, 179], "drop": [11, 12, 31, 42, 58, 59, 71, 83, 91, 95, 157, 179, 183, 197], "exist": [11, 12, 13, 15, 22, 23, 36, 48, 50, 70, 71, 80, 83, 86, 117, 140, 162, 191], "unus": [11, 12, 22, 23, 58, 71, 102, 104, 105, 106, 111, 145, 161], "convertfilepatterntodatasourc": 11, "loaddataset": 11, "load": [11, 18, 23, 24, 31, 32, 46, 48, 49, 52, 78, 80, 81, 83, 117, 166, 175, 182, 186], "lead": [11, 12, 15, 31, 48, 49, 83, 121, 173, 191, 209], "takeevalsampl": 11, "processdataset": 11, "getsequencelength": 11, "integ": [11, 25, 46, 48, 50, 54, 56, 63, 71, 76, 80, 83, 86, 87, 100, 105, 108, 116, 122, 151, 161, 171, 179, 193, 209], "_inputshap": [11, 209], "_inputpaddingvalu": [11, 209], "tensorspec": [11, 83, 114, 175, 209], "basedataexampleinputgener": 11, "proto": [11, 49, 50, 52, 64, 71, 77, 78, 83, 118, 175, 188, 197, 228], "getfeaturespec": 11, "spec": [11, 22, 24, 49, 102, 114, 188, 191], "io": [11, 42, 83, 173, 197, 224], "parse_exampl": [11, 173], "_additionalpreprocessinputbatch": 11, "addition": [11, 48, 78, 94], "get_next": 11, "_initdataset": 11, "definetfdatainput": 11, "func": [11, 12, 57, 80, 83], "ignore_arg": 11, "map_arg": 11, "base_class": 11, "inputgener": [11, 13, 31, 79, 135, 146], "bind": [11, 57, 120], "boilerpl": [11, 77], "behav": 11, "shot": 11, "design": [11, 114], "similarli": [11, 83, 86], "automat": [11, 48, 50, 80, 83, 86, 102, 114, 209, 218, 224], "analys": [11, 57], "signatur": [11, 13, 22, 29, 41, 57, 77, 83, 87, 102, 179, 186, 188, 190, 191], "confus": 11, "identifi": [11, 24, 42, 46, 70, 83, 117, 179, 183, 193, 224], "def": [11, 12, 17, 25, 42, 83, 87, 88, 102, 145, 182, 188, 191], "my_dataset": 11, "10": [11, 12, 38, 48, 63, 70, 77, 87, 119, 151, 166, 167], "from_tensor_slic": 11, "lambda": [11, 21, 22, 42, 46, 58, 83, 102, 114, 191, 195, 196, 197], "myinput": 11, "assert": [11, 12, 70, 71, 83, 87, 161], "ig": 11, "isinst": [11, 70], "tfv1": 11, "tfv2": 11, "yield": [11, 31, 79, 83, 97, 100], "explicit": [11, 30, 42, 57, 83, 87], "would": [11, 17, 27, 46, 49, 50, 58, 69, 83, 86, 87, 91, 94, 100, 104, 119, 140, 179, 195], "collect": [11, 12, 22, 46, 48, 50, 52, 57, 58, 80, 82, 83, 92, 94, 117, 186, 191, 221], "specif": [11, 12, 14, 15, 18, 19, 22, 23, 24, 25, 31, 44, 46, 58, 80, 83, 86, 94, 108, 114, 135, 139, 141, 179, 182, 189], "typic": [11, 12, 14, 15, 21, 46, 48, 56, 57, 58, 71, 77, 86, 96, 128, 134, 140, 175, 179, 182, 186, 193, 197, 218, 219], "super": [11, 12, 140, 145, 182], "func_param": 11, "layer_param": [11, 68, 191], "pair": [11, 12, 13, 19, 22, 29, 30, 35, 42, 45, 46, 50, 57, 58, 61, 64, 70, 71, 76, 79, 83, 87, 97, 100, 119, 120, 135, 140, 145, 151, 152, 154, 162, 175, 176, 179, 183, 185, 195, 196, 197, 199, 217, 220], "won": [11, 197], "definit": [11, 14, 22, 63, 83, 173, 174, 175, 182, 184, 196, 224], "invok": [11, 12, 36, 71, 83, 86, 87, 88, 129, 188], "accumul": [12, 19, 22, 26, 48, 64, 65, 76, 83, 86, 87, 90, 92, 97, 102, 135, 182, 221], "regist": [12, 26, 31, 119, 125, 128, 129, 220], "persist": [12, 94, 135], "suppli": [12, 58, 102], "defaultvalu": [12, 19, 86], "import": [12, 44, 48, 58, 100, 104, 117, 123, 127, 152], "leak": [12, 15, 44], "enabl": [12, 15, 43, 46, 48, 52, 58, 71, 76, 83, 91, 178, 193, 195, 197], "disabl": [12, 15, 41, 46, 52, 58, 83, 86, 87, 175], "silent": 12, "setvalu": 12, "touch": 12, "bracket": [12, 70], "care": [12, 48, 135], "taken": [12, 40, 71, 86, 114, 135, 175, 177], "across": [12, 15, 24, 36, 42, 46, 48, 62, 64, 69, 71, 76, 80, 83, 88, 91, 97, 114, 135, 189, 195], "boundari": [12, 15, 31, 58, 83, 92, 96, 100, 195], "retriev": [12, 22, 83, 86, 104, 117, 124, 128, 131, 179, 191, 228], "getaccumulatorvalu": 12, "marshal": 12, "setaccumulatorvalu": 12, "revers": [12, 83, 87, 90, 92], "is_dis": 12, "balanc": [12, 48], "getvalu": 12, "_baselayerinitwrapp": 12, "decor": [12, 71, 83, 86, 87, 89, 114, 128, 191], "instanc": [12, 13, 22, 25, 31, 34, 44, 48, 50, 52, 58, 70, 79, 80, 87, 123, 128, 136, 140, 175, 179, 188, 193], "hierarchi": [12, 86], "recursivefindlayerparam": 12, "baselayermeta": 12, "dct": 12, "metaclass": 12, "abclayermeta": 12, "abcmeta": 12, "proper": 12, "constitu": 12, "reachabl": 12, "member": [12, 17, 22, 37, 70, 86, 135, 152], "carri": [12, 47, 48, 58, 64, 87, 94], "_inference_driver_nam": 12, "instantiableparam": [12, 14, 50], "baselayert": 12, "static": [12, 13, 24, 37, 48, 64, 70, 71, 83, 86, 92, 94, 96, 109, 122, 128, 140, 191, 197], "copybaseparam": 12, "from_param": 12, "to_param": 12, "getvariablesdict": [12, 13], "visit": [12, 13, 50], "_getselfvariablesdict": [12, 13, 76, 117], "exclud": [12, 13, 76], "fpropdefaulttheta": [12, 13, 59], "forward": [12, 13, 15, 21, 22, 27, 30, 40, 43, 44, 46, 48, 58, 59, 60, 62, 68, 71, 83, 85, 86, 87, 90, 91, 92, 98, 102, 145, 154, 161, 162, 179, 186, 190, 193, 196], "central": [12, 15, 22, 27, 30, 43, 44, 48, 58, 59, 60, 85, 90, 98, 117, 177, 186, 196], "dictionari": [12, 13, 15, 18, 22, 27, 30, 35, 43, 44, 48, 52, 54, 58, 59, 60, 64, 70, 76, 78, 83, 85, 90, 98, 119, 135, 144, 145, 152, 154, 162, 186, 195, 196, 199, 219, 220, 224], "foo": [12, 15, 21, 22, 25, 27, 30, 43, 44, 48, 50, 58, 59, 60, 70, 83, 85, 90, 98, 178, 186, 191, 196, 224], "instanceofasubclassoffoo": [12, 15, 22, 27, 30, 43, 44, 48, 58, 59, 60, 85, 90, 98, 186, 196], "y": [12, 15, 21, 22, 25, 27, 30, 43, 44, 46, 48, 56, 58, 59, 60, 70, 71, 77, 83, 85, 87, 90, 96, 98, 114, 185, 186, 191, 196], "a0": [12, 15, 22, 27, 30, 43, 44, 48, 58, 59, 60, 85, 90, 98, 186, 196], "a1": [12, 15, 22, 27, 30, 43, 44, 48, 58, 59, 60, 85, 90, 98, 186, 196], "twice": [12, 15, 22, 27, 30, 43, 44, 48, 58, 59, 60, 85, 90, 98, 186, 196], "a2": [12, 15, 22, 27, 30, 43, 44, 48, 58, 59, 60, 85, 90, 98, 186, 196], "keyward": [12, 15, 22, 27, 30, 43, 44, 48, 58, 59, 60, 83, 85, 90, 98, 186, 196], "upon": [12, 21, 80, 83, 100], "built": [12, 21, 64, 79, 83, 218, 224], "do_ev": [12, 24, 25, 178, 195, 198], "parent": [12, 117, 179], "root": [12, 26, 31, 37, 48, 63, 83, 191, 218], "layer_typ": [12, 138], "getdescend": 12, "keyerror": [12, 70, 78], "found": [12, 22, 34, 48, 50, 71, 83, 91, 124, 131, 224], "indexerror": [12, 70], "request": [12, 80, 86, 146, 224], "typeerror": [12, 70, 83, 123], "attempt": [12, 22, 31, 58, 83, 127], "though": [12, 21, 71, 87, 218], "ema": [12, 13, 23, 80, 83], "_transformvarsintern": 12, "_private_var": 12, "_undotransformvarsintern": 12, "undo": 12, "transformvarstempcontext": 12, "enter": [12, 50, 71], "temporarili": 12, "_internalgettheta": 12, "view": [12, 24, 80, 83, 86, 104, 162, 179], "local": [12, 15, 38, 48, 71, 79, 83, 93, 109, 115, 164, 179, 189, 197, 224, 228], "attribut": [12, 31, 46, 49, 50, 83, 191], "notat": [12, 22], "librari": [12, 21, 82, 86, 87, 110, 151, 152, 217, 220], "addfunct": 12, "Such": [12, 46, 83, 86], "python": [12, 13, 14, 15, 21, 24, 31, 42, 47, 48, 50, 52, 54, 82, 83, 86, 87, 99, 114, 116, 123, 127, 151, 152, 161, 191, 195], "facil": 12, "organ": [12, 48, 128], "collis": 12, "bodi": [12, 21, 22, 46, 47, 48, 64, 83, 88, 118], "attributeerror": [12, 50], "alreadi": [12, 13, 15, 22, 31, 48, 50, 61, 62, 70, 195, 222], "_checknam": 12, "registeraccumul": 12, "acc": 12, "futur": [12, 15, 59, 80, 87, 128, 197], "act": [12, 21, 27, 58, 62, 86, 91, 102, 106], "part": [12, 13, 22, 24, 35, 52, 70, 71, 86, 91, 92, 102, 104, 108, 135, 140, 209, 228], "posttrainingstepupd": [12, 19, 86, 91], "arbitrarili": [12, 191], "cross": [12, 15, 48, 58, 60, 76, 83, 88, 179, 189, 195, 198], "uniformli": [12, 40, 58, 71, 140], "myaccumul": 12, "min": [12, 86, 96, 100, 111, 139], "convert_to_tensor": 12, "state1": [12, 15, 27, 30, 48, 58, 62, 87, 91, 92, 102, 104, 106, 141, 161], "state0": [12, 15, 19, 27, 30, 48, 58, 62, 87, 91, 92, 102, 104, 105, 106, 138, 141, 161, 196], "stack": [12, 15, 21, 46, 48, 58, 59, 60, 80, 83, 84, 87, 88, 90, 92, 93, 98, 100, 102, 104, 106, 108, 109, 114, 121, 135, 161, 190, 196, 198, 217], "minimum": [12, 71, 76, 86, 193], "mytrack": 12, "batch_min": 12, "batch_max": 12, "acc_valu": 12, "someth": [12, 13, 35, 46, 119, 145, 154, 162, 176, 199, 224], "share": [12, 17, 21, 22, 23, 44, 46, 48, 50, 52, 58, 59, 64, 69, 76, 83, 88, 92, 125, 228], "new_values_nmap": 12, "getvariablesymbolicshap": 12, "var_nam": [12, 83, 117], "createvari": [12, 83, 129], "var_param": [12, 83, 117], "constructor": [12, 22, 50, 77, 175, 179, 182, 218], "weightparam": [12, 46, 83], "100": [12, 38, 63, 71, 83, 152, 166, 167], "keyword": [12, 42, 43, 50, 77, 83, 86, 92, 108, 161, 188], "enter_name_scop": 12, "_emavariablescop": 12, "reus": [12, 22, 83, 188], "addextratheta": 12, "theta_nam": 12, "theta_valu": 12, "doesn": [12, 30, 34, 58, 76, 87, 91], "addvn": [12, 83], "per_step": [12, 15, 46, 83], "_createchildcontext": 12, "createchild": 12, "foo_param": 12, "createchildren": 12, "union": [12, 13, 15, 58, 83, 175, 179], "addchild": 12, "sublay": [12, 22, 43, 46], "_autoaddchild": 12, "_removechild": 12, "earlier": [12, 44, 76], "larger": [12, 15, 34, 71, 111, 152, 197], "your": [12, 13, 44, 46, 50, 119, 152, 182, 193], "own": [12, 31, 80, 83, 117, 129, 152, 179], "risk": 12, "_removechildren": 12, "_verifychildren": 12, "verifi": [12, 22, 69, 86], "ren": 12, "_verifyvarsandtheta": 12, "_casttofpropdtyp": 12, "islayerparam": 12, "decodefinalizearg": 13, "decode_out_path": 13, "decode_out": 13, "basetask": [13, 14, 35, 46, 61, 83, 119, 145, 154, 162, 176, 199], "decodefin": 13, "written": [13, 15, 50, 100, 107, 114, 218], "aggreg": [13, 26, 45, 58, 64, 80, 83, 96], "decodeemailopt": 13, "train_executions_per_ev": [13, 80], "emaildecodesummari": 13, "_variablesforema": 13, "model_var_list": 13, "One": [13, 87, 135, 164, 191, 197, 224], "train_op": [13, 46, 80, 119], "eval_metr": [13, 61], "etc": [13, 14, 25, 36, 46, 48, 50, 58, 60, 70, 77, 80, 83, 86, 91, 161, 179, 189, 197], "_setlearnerfromlegacyparam": 13, "tp": [13, 61], "probablist": [13, 35, 145, 154, 162, 176, 199], "discret": [13, 24, 35, 58, 100, 145, 154, 162, 176, 199], "mixtur": [13, 15, 35, 46, 48, 145, 154, 161, 162, 176, 199], "logist": [13, 35, 83, 145, 154, 162, 176, 199], "continu": [13, 35, 58, 76, 79, 96, 145, 154, 162, 176, 199], "regress": [13, 35, 83, 119, 145, 154, 162, 176, 199], "evalu": [13, 15, 30, 35, 58, 64, 80, 83, 109, 114, 117, 119, 131, 145, 151, 152, 154, 162, 176, 177, 197, 199], "loss": [13, 15, 35, 39, 44, 45, 46, 48, 58, 61, 76, 83, 87, 119, 135, 145, 154, 161, 162, 176, 179, 183, 186, 191, 195, 199, 209], "student": [13, 35, 145, 154, 162, 176, 199], "distil": [13, 35, 58, 145, 154, 162, 176, 199], "perhap": [13, 35, 145, 154, 162, 176, 199], "tower": [13, 35, 46, 119, 145, 154, 162, 176, 199], "arbitrari": [13, 35, 46, 48, 88, 90, 119, 125, 135, 145, 154, 162, 176, 191, 195, 199, 228], "filterperexampletensor": [13, 46, 119], "per_exampl": [13, 46, 83, 119], "processfpropresult": [13, 46, 119], "becaus": [13, 15, 46, 48, 58, 64, 83, 92, 119, 179, 193, 209, 224], "expens": [13, 15, 46, 119], "basemodel": [13, 14, 46, 119, 128], "put": [13, 46, 119, 128], "wherev": [13, 46, 71, 119], "most": [13, 15, 44, 46, 58, 59, 60, 76, 86, 96, 102, 104, 106, 117, 119, 135, 161, 179, 183, 222], "conveni": [13, 14, 46, 66, 71, 76, 77, 80, 86, 88, 119, 128], "Be": [13, 46, 119], "sure": [13, 15, 46, 119, 139], "plan": [13, 46, 49, 119], "tpu_steps_per_loop": [13, 46, 119], "higher": [13, 15, 46, 58, 71, 119, 125, 161, 197, 228], "fproptow": [13, 46, 119, 154, 162], "synchron": [13, 24, 71, 83, 94, 96], "asynchron": [13, 24, 94, 148], "_fproptpu": 13, "_fpropsplitinputbatch": 13, "_fpropresult": 13, "getinputbatch": 13, "adjustgradi": [13, 61, 162], "vars_gradi": 13, "clip": [13, 58, 61, 83, 86, 91, 162], "posttrainingloop": 13, "outfe": [13, 47, 80, 131, 228], "post": [13, 15, 35, 58, 80, 92, 119, 135, 144, 145, 154, 199], "queue": [13, 47], "_bpropgentrainop": [13, 46], "vmap": [13, 45, 46, 61, 76, 83, 162], "add_summari": [13, 24, 25, 144], "popul": [13, 71, 77, 80, 195, 197], "_bpropforvari": 13, "_computegradientmask": 13, "per_input_gradient_mask": 13, "regex": [13, 76, 83, 108], "applyexponentialmovingaverag": 13, "decodewiththeta": [13, 119, 145, 154], "subgraph": [13, 35, 52, 53, 78, 145, 154, 162, 195, 210], "public": [13, 35, 39, 86, 122, 123], "independ": [13, 15, 22, 35, 48, 77, 179], "convent": [13, 27, 35, 50, 105], "drive": [13, 35], "fashion": [13, 35, 135], "often": [13, 21, 35, 58, 87, 96, 111, 152, 186, 193], "broken": [13, 35], "piec": [13, 35, 65, 97, 116, 148, 209, 212], "inferencegraph": [13, 35, 52, 53, 78, 228], "inferenceeag": 13, "concretefunct": [13, 83], "genericfunct": 13, "concret": [13, 21, 42, 114], "createdecodermetr": [13, 35, 119, 145, 154, 176, 199], "basemetr": [13, 35, 64, 65, 119, 145, 154, 176, 199], "decode_out_dict": [13, 35, 80, 119, 145, 154, 199], "decode_metrics_dict": [13, 35, 119, 145, 154, 199], "could": [13, 22, 31, 35, 48, 49, 57, 64, 71, 76, 80, 83, 87, 119, 145, 154, 197, 199], "output_key_value_pair": [13, 35, 119, 145, 154, 199], "unicod": [13, 35, 119, 145, 154, 199], "decode_finalize_arg": 13, "email": [13, 80], "config": [13, 16, 36, 47, 52, 60, 76, 80, 83, 84, 117, 138, 140, 166, 196, 198, 220, 224, 228], "trigger": [13, 58, 71, 80, 81, 96, 186], "post_training_loop_op": 13, "per_example_tensor": [13, 80, 119, 131, 176, 195, 228], "addevalmetr": 13, "raise_if_already_ad": 13, "addperexampletensor": 13, "_updatevnconfig": 13, "vn": [13, 83], "flag": [13, 15, 48, 52, 59, 64, 71, 79, 80, 83, 84, 87, 114, 128, 218, 224, 228, 229], "_getmaskupdateop": 13, "prune": [13, 52, 71, 82, 91, 186, 228], "disk": [13, 50, 80, 94, 183], "variables_for_ema": 13, "_makeemavariablesdict": 13, "constructfpropbpropgraph": [13, 69, 118], "constructfpropgraph": 13, "apply_ema": 13, "constructdecodegraph": 13, "task_nam": [13, 228], "constructposttrainingloop": 13, "gettask": 13, "cn": [13, 228], "singletaskbas": 13, "_task": 13, "sampletask": 13, "singletaskmodel": [13, 14, 80, 119, 125, 228], "task_param": [13, 80, 125], "multitasksubmodel": [13, 80, 125, 228], "entir": [13, 48, 56, 58, 59, 62, 71, 83, 100, 141], "appear": [13, 58, 83, 118, 152, 181], "multitaskmodel": [13, 14, 69, 80, 125, 228], "tasknam": 13, "cur_prob": [13, 111], "basemodelparam": 14, "dataseterror": 14, "_basemodelparam": [14, 128], "experi": [14, 21, 148, 182, 205], "getalldatasetparam": [14, 182], "enumer": [14, 182], "dev": [14, 37, 81, 96, 123, 148, 157, 164, 174, 182, 186, 188, 193, 202, 203, 205, 224], "dataset_param": [14, 182], "dataset_nam": [14, 80, 81, 128, 182, 228], "getalldatasetparamsnotimplementederror": [14, 123, 182], "getdatasetparam": 14, "singletaskmodelparam": [14, 125, 128, 148, 157, 164, 166, 167, 182, 202, 203, 205, 212, 228], "develop": [14, 148, 157, 164, 202, 203, 205], "emul": [14, 86], "multitaskmodelparam": [14, 125, 128, 228], "programschedul": [14, 80, 128, 145, 148, 166, 167], "rethink": 15, "favor": [15, 40, 50, 58], "2009": [15, 40], "14794": [15, 40], "causalsegmentmask": 15, "segment_id": [15, 46, 48, 60, 62, 71, 92, 116, 171, 195, 196, 197, 198], "causal": [15, 29, 30, 40, 46, 48, 59], "slen": [15, 87], "belong": [15, 64, 71, 91, 185, 188], "causalpad": 15, "crossattentionpaddingwithtimestamp": 15, "timestamp": [15, 188], "per_step_pad": 15, "stamp": 15, "around": [15, 30, 48, 58, 77, 79, 83, 87, 91, 105, 116, 197], "itself": [15, 22, 31, 46, 49, 50, 88, 145, 154, 179], "simpl": [15, 21, 22, 31, 45, 46, 50, 58, 70, 80, 85, 86, 87, 91, 102, 105, 111, 116, 119, 146, 179, 183, 197], "a3": 15, "a4": 15, "5": [15, 17, 27, 39, 48, 50, 52, 54, 58, 63, 71, 83, 87, 89, 91, 100, 119, 135, 140, 148, 166, 167, 171, 176, 191, 197, 205], "b0": 15, "b1": 15, "b2": 15, "b3": 15, "shall": 15, "target_seq_len": [15, 17, 110], "source_seq_len": 15, "out_pad": [15, 27, 29, 30, 58, 198], "getdtypemin": 15, "segmentmask": 15, "apply_dtype_min": 15, "nan": [15, 58, 61, 83], "issu": [15, 31, 64, 83, 94], "segment_mask": [15, 60, 98], "perdimscalelay": 15, "outpu": 15, "multiheadedprojectionlay": 15, "below": [15, 48, 59, 60, 70, 71, 80, 197, 217, 224], "num_head": [15, 27, 29, 93, 161, 166, 167, 193, 195, 196, 205], "dim_per_head": [15, 27, 195], "hidden_s": [15, 91], "reshapedmultiheadedprojectionlay": 15, "reshap": [15, 21, 22, 46, 48, 49, 58, 59, 83, 86, 91, 108, 140, 175, 191], "md": [15, 58, 59], "dim_reshape_seg": [15, 49, 58, 59], "heavili": 15, "einsum": [15, 46, 48, 58, 83, 101], "certain": [15, 21, 43, 83, 91, 209], "sketch": [15, 58], "intermedi": [15, 21, 41, 43, 62, 70, 86, 87, 91, 92, 177, 188], "annot": [15, 46, 48, 49, 86, 121, 179], "wq": [15, 46], "wk": [15, 46], "wv": [15, 46], "wout": 15, "input_dim": [15, 22, 27, 29, 48, 58, 60, 62, 83, 107, 190, 195, 199], "key_dim": 15, "value_dim": 15, "q_proj": 15, "btd": 15, "dnh": 15, "btnh": 15, "k_proj": 15, "bsd": 15, "bsnh": 15, "v_proj": 15, "bnt": 15, "sqrt": [15, 40, 83, 96], "_multiheadedattent": 15, "_caplogit": [15, 46], "cap": [15, 46, 83, 86, 91, 96], "atten_logit_cap": [15, 27, 46, 166, 167], "_attenlogitsonestep": 15, "attenprob": 15, "uniform": [15, 83, 91, 186], "ideal": [15, 86, 183], "simultan": 15, "accordingli": [15, 48], "downstream": [15, 44, 52, 58, 86], "prevent": [15, 30, 59], "flow": [15, 21, 22, 48, 59, 83, 102], "probs_sum": 15, "_attencontext": 15, "_attencontextonestep": 15, "_dotatten": 15, "_maybescalequeri": 15, "_dotattenonestep": 15, "use_short_seq_opt": [15, 195], "short": [15, 71, 87, 195, 222], "_headsproj": 15, "key_vec": 15, "value_vec": 15, "_postproj": 15, "initst": [15, 48], "target_max_length": [15, 197, 209], "extendstep": [15, 58, 59, 88, 195], "cached_st": [15, 88], "autoregress": [15, 46, 59], "fast": [15, 59, 195], "updated_key_vec": 15, "updated_value_vec": 15, "reshapedmultiheadedattent": 15, "multiheadedfavorattent": 15, "multihead": [15, 40], "multiheadedattentionxl": 15, "notic": 15, "multiheadedattentionrp": 15, "_relativepositionvalueemb": 15, "tgt_time": [15, 108], "src_time": [15, 108], "attention_dim": 15, "localselfattent": 15, "slide": 15, "canon": [15, 27, 174], "reduc": [15, 46, 48, 58, 59, 76, 83, 87, 88, 90], "o": [15, 46, 48, 58], "practic": [15, 34, 36, 44, 76, 104, 179], "observ": [15, 56, 197], "hbm": [15, 88], "usag": [15, 18, 22, 42, 48, 56, 77, 83, 88, 97, 109, 113, 114, 128, 134, 151, 152, 171, 182, 186, 188, 197, 218, 224], "speed": 15, "gain": [15, 21, 38], "semant": [15, 179, 181], "cover": [15, 50, 71, 76, 135], "weihan": 15, "_streamattenlogit": 15, "query_proj": 15, "now": [15, 18, 48, 59, 66, 71, 83, 91], "Not": [15, 40, 114, 138, 161], "oppos": [15, 71, 86, 108], "streamstep": [15, 19, 27, 30, 107], "much": [15, 34, 44, 58, 83, 118, 195], "smaller": [15, 34, 46, 49, 58, 59, 71, 195, 197], "effic": 15, "bigger": [15, 71], "notimplementederror": [15, 82, 123, 141], "zero_st": [15, 19, 27, 30, 62, 91, 92, 105, 106, 138, 141, 161, 196], "_zero_state_static_length_input": 15, "inference_step_max_length": 15, "circular_tail": 15, "use_3d_recurrent_st": 15, "tail": 15, "pointer": [15, 71], "circular": [15, 48], "buffer": [15, 41, 48, 71, 175], "_zero_state_static_length_key_valu": 15, "_zero_state_dynamic_length": 15, "context_len": 15, "out_mask": 15, "isinferencestepstat": 15, "query_pad": 15, "key_pad": 15, "streamstepaddskipconnect": 15, "input_to_add": 15, "_streamstepdimens": 15, "commonli": [15, 21, 29, 76, 179], "head_dimens": 15, "state_length": 15, "num_queries_in_query_vec": 15, "_streamstepstaticcomputekeyvalueminim": 15, "minimize_state_s": 15, "_streamstepstaticcomputekeyvalue3d": 15, "scatter_nd_upd": 15, "cheaper": 15, "even": [15, 21, 71, 83, 87, 91], "re": [15, 34, 48, 50, 83, 86, 94, 104, 186], "_streamstepstaticcomputekeyvalueclass": 15, "classic": 15, "transfer": [15, 44, 99], "cheap": 15, "although": [15, 48], "interest": [15, 71, 86], "_streamstepstaticcomputekeyvalu": 15, "_streamstepstaticlength": 15, "staticli": 15, "_streamstepdynamiclength": 15, "localselfattentionxl": 15, "po": [15, 46, 48, 139], "reli": [15, 83, 197], "chunkwiseselfattent": 15, "bounari": 15, "chunkwis": 15, "therefor": [15, 30, 46, 48, 186], "essenti": [15, 80, 222], "regardless": [15, 59, 60, 64, 71], "sec": [15, 48, 80], "2010": [15, 44], "10759": 15, "stage": [15, 31, 46, 48, 140], "2005": [15, 27, 107], "08042": 15, "recomput": [15, 87], "receipt": 15, "_paramcheck": 15, "input_vec": 15, "input_pad": 15, "querti": 15, "_streamstepstateless": 15, "chunkwiseselfattentionxl": 15, "attention_logit": 15, "routingattent": 15, "rout": [15, 48, 59, 93], "clustert": 15, "zhouwk": [15, 59], "miss": 15, "select": [15, 22, 31, 37, 44, 48, 71, 83, 96, 145, 191, 197], "attention_window": [15, 93], "find": [15, 23, 44, 48, 83, 102], "know": [15, 50, 58, 69, 86, 179], "causal_mask": 15, "key_dist": 15, "henc": [15, 58, 71, 91], "cache_st": 15, "fast_path": 15, "thei": [15, 22, 46, 50, 52, 71, 83, 86, 87, 91, 102, 124, 131, 140, 177, 179, 186, 191, 209, 219], "major": [15, 60, 86, 105, 162, 173, 195, 196], "obei": [15, 128], "updated_st": [15, 88], "_dotattenslowpath": 15, "q_dist": 15, "k_dist": 15, "query_relative_position_shift": 15, "slow": 15, "basi": [15, 71, 83], "impact": [15, 59, 94], "yet": [15, 83, 91], "_dotattenfastpath": 15, "guarante": [15, 37, 50, 52, 71, 83, 139, 162], "enc_map": 15, "transformerattentionlay": [15, 59, 60, 193], "And": [15, 22, 39, 59, 87], "residu": [15, 29, 46, 58, 59, 90, 106, 135, 161, 193], "connect": [15, 21, 22, 43, 46, 58, 59, 60, 102, 106, 135, 161, 188, 198], "atten_tpl": [15, 59], "scenario": [15, 44, 59], "come": [15, 59, 60, 71, 76, 104], "rightward": [15, 59], "is_mask": [15, 59], "commonparam": [15, 27, 161], "use_relative_atten": [15, 27], "relative_pos_emb_dim": [15, 27], "local_context": 15, "dropout_prob": [15, 27], "extend": [15, 17, 56, 58, 59, 62, 86, 87, 102, 181, 195, 222], "omnipot": 15, "further": [15, 46, 59, 60], "lean": [15, 91], "cautious": 15, "setfpropdtyp": [15, 27, 46, 59], "_initattentionparam": 15, "per_step_padding_overrid": 15, "cross_attent": 15, "thu": [15, 41, 48, 117], "cur_output": [15, 59], "stream": [15, 27, 58, 83], "funneltransformerattentionlay": 15, "funnel_pool": 15, "caus": [15, 49, 178, 179], "reduct": [15, 58], "202530591": 15, "complic": [15, 21, 179], "transformermultisourceattentionlay": [15, 59], "comment": [15, 17, 42, 58, 83, 140, 152], "transformerlay": [15, 59, 60], "setcanonicalshardingparam": [15, 27], "reshape_dim": 15, "shard_atten_w": 15, "spmd": [15, 27, 46, 48, 80], "topologi": [15, 83, 86], "1d": [15, 30, 48, 83, 166, 209], "num_partit": [15, 36, 43, 47], "split_dims_map": [15, 49], "fflayer": [15, 27, 59], "df": [15, 224], "blf": 15, "fd": 15, "bld": 15, "rank": [15, 17, 19, 30, 48, 54, 58, 59, 71, 83, 120, 140, 191], "anoth": [15, 21, 50, 57, 58, 64, 70, 76, 91, 94, 106, 109, 146, 152, 195, 197], "better": [15, 34, 48, 71, 87, 111, 118, 139, 195, 197], "blnh": 15, "auto": [15, 48, 49, 77, 83, 121], "reshapedim": [15, 49], "trick": [15, 34, 59, 91], "setreshapedlay": 15, "atten_num_head": [15, 27], "atten_is_rel": 15, "atten_local_context": [15, 27], "atten_left_context": [15, 27], "atten_right_context": [15, 27], "has_aux_atten": [15, 59, 60], "mask_self_atten": 15, "fflayer_hidden_dim": [15, 27], "fflayer_output_dim": 15, "setnuminputnod": 15, "num_input_nod": [15, 83, 106], "numoutputnod": [15, 27, 58, 59], "_getsourcebatchs": 15, "aux_vec": [15, 59, 60, 88, 198], "_getsourcelength": [15, 59], "aux_pad": [15, 59, 60, 198], "aux_per_step_padding_overrid": 15, "aux_segment_mask": 15, "target_tim": [15, 59, 60, 195], "source_tim": [15, 59, 60, 195], "arrang": [15, 58, 189, 191], "self_atten": 15, "aux_atten": [15, 59], "compute_atten_prob": 15, "aux_": [15, 59, 60], "batch_multipli": 15, "warn": [15, 30, 83, 123, 124, 131], "transformerflop": 15, "ff_dim": [15, 46], "atten_dim": 15, "model_dim": [15, 27, 46, 48, 93, 96, 161, 166, 167, 193, 195, 196, 199, 205], "incl": 15, "6": [15, 21, 29, 58, 63, 71, 83, 119, 135, 161, 166, 167, 171, 191, 196, 205], "bdnh": 15, "bntd": 15, "proj": 15, "ff": [15, 59, 171], "ff_hidden": 15, "feedforward": [15, 46, 48, 58, 59, 93, 193], "hidden": [15, 58, 59, 62, 88, 93, 161, 190, 193], "multisourcetransformerlay": 15, "primary_source_kei": 15, "userelativeattentionintransformerlay": 15, "transformer_param": 15, "rel_pos_emb_dim": 15, "atten_typ": 15, "transformer_xl": 15, "mt_attention_lay": 15, "clearrelativeattentionintransformerlay": 15, "transformerdecoderlay": 15, "multisourcetransformerdecoderlay": 15, "repeatedtransformerlay": 15, "genericrepeatlay": [15, 88], "repeatlay": [15, 22, 46, 83, 88], "stackedtransformerlay": 15, "getsplitforlay": 15, "layer_index": [15, 138], "_getdeviceoflay": 15, "layer_idx": 15, "our": 15, "collect_per_layer_output": 15, "xformer": [15, 47, 83], "all_layer_output": 15, "context_vector": 15, "x_layer": 15, "pipelinedtransformerlay": 15, "wrappedstageclass": 15, "transformerfeedforwardlayerwithtaskid": 15, "transformerfeedforwardlay": [15, 59, 190], "gpipebatchmajortransformerlay": 15, "majortransform": 15, "gpipebatchmajortransformerstack": [15, 60], "target_vec": [15, 60], "target_pad": [15, 58, 60, 195, 197], "encoder_self_atten_segment_mask": [15, 60], "decoder_self_atten_segment_mask": [15, 60], "decoder_cross_atten_segment_mask": [15, 60], "setupdeterministicdropout": [15, 60], "ones": [15, 60, 109, 117], "residualaddlay": 15, "paddinglay": [15, 30], "stridelay": 15, "funnelpoolinglay": 15, "2006": [15, 63], "03236": 15, "begin_intact": 15, "trunc_seq": 15, "few": [15, 17, 21, 22, 43, 50, 71, 76, 96, 135], "first_n": [15, 98], "funnelupsamplelay": 15, "upsampl": 15, "all_hidden": 15, "vec": [15, 46, 98], "meshsplitlay": 15, "meshsplit": [15, 46, 49], "_dropout": [15, 21, 46, 58], "drop_prob": 15, "dropoutlay": [15, 21, 46, 58], "_add": [15, 29, 46, 87], "residual_weight": [15, 27, 29, 46], "apply_residu": 15, "_defaultln": 15, "_expanddim": [15, 29], "_squeez": [15, 29], "_glu": [15, 27, 29], "_pad": [15, 29], "tensor_split_dims_map": [15, 46, 48, 49, 83, 86], "_multiheadedatten": 15, "gatedgelufeedforward": 15, "is_caus": [15, 27, 29], "ff_hidden_dim": [15, 27, 196], "gatedfeedforward": 15, "activation_fn": [15, 46], "relu": [15, 21, 22, 29, 40, 46, 48, 58, 86, 161, 193], "use_pad": 15, "qdomain": [15, 21, 29, 86, 91], "_maybesplit": [15, 48], "_depthwiseconv2d": 15, "filter_s": 15, "depthwis": [15, 27, 30, 46, 48, 58], "lightweight": [15, 27, 29, 93, 98], "conv": [15, 27, 29, 30, 46, 58, 91, 138], "_normalizeddepthwiseconv2d": 15, "kernel_s": [15, 27, 29, 46, 48], "lconv": [15, 27, 29], "convolution_fn": 15, "linear_qdomain": 15, "conv_qdomain": 15, "10430": [15, 29, 30, 98], "pytorch": [15, 29, 39], "l587": [15, 29], "github": [15, 19, 29, 39, 164], "com": [15, 19, 29, 39, 58, 122, 164], "fairseq": [15, 29], "blob": [15, 19, 29], "v0": [15, 29], "lightconv": [15, 29], "altern": [15, 64, 118], "kernel": [15, 29, 30, 40, 46, 58], "lightweightconvlayerblock": 15, "lconvblock": 15, "sequenti": [15, 21, 22, 43, 88, 111], "lconvstack": 15, "_stride": 15, "_stridedattent": 15, "omit": 15, "divis": 15, "_pool": 15, "_funnelattent": 15, "funnelencoderlay": 15, "ff_gated_fn": 15, "num_ffn": 15, "silu": [15, 167], "gelu": 15, "ffn": [15, 27, 46], "transformerencoderlay": 15, "output_all_layer_hidden": 15, "transformerencoderstack": 15, "num_lay": [15, 90, 93, 98, 107, 161, 190, 193, 195], "performerbuild": 15, "gshard": [15, 27, 46, 47, 48, 49, 121, 171], "mesh": [15, 27, 46, 48, 49, 86, 166], "memoryaddlay": 15, "sketchmemtransformerbuild": 15, "sketchmem": 15, "_memoryadd": 15, "add_memori": 15, "output_dim": [15, 48, 58, 59, 83, 140, 181, 190, 195], "lmbuilder": 15, "langang": 15, "_var": [15, 46, 48], "_shardedvar": [15, 46], "mesh_split": [15, 46, 49, 86], "_linearweight": 15, "_linear": [15, 21], "matmul": [15, 21, 58, 82, 83, 86], "idim": [15, 21], "odim": [15, 21], "_biasweight": 15, "_bia": [15, 21, 29], "_attent": 15, "scale_infeed_to_glob": 16, "infeed_batch_s": 16, "scale_global_to_infe": 16, "scale_split_to_infe": 16, "split_batch_s": 16, "topk_decod": [17, 136, 171], "other_st": 17, "beamsearchsharedparam": 17, "beamsearchhelp": 17, "initbeamsearchst": 17, "hyp": [17, 41, 71, 83, 97, 135, 136, 137, 145, 151, 152, 193, 195], "sentenc": [17, 48, 71, 97, 116, 137, 151, 152, 195, 196, 197, 206], "initial_result": [17, 195], "step_id": [17, 135, 195], "hyp_per_beam": 17, "fill": [17, 56, 71, 94, 136, 139], "client": [17, 24, 195], "beam_search_step": [17, 71], "in_stat": 17, "cur_step": [17, 71, 135, 195], "out_stat": [17, 195], "minim": [17, 37, 46, 71, 76, 77, 140], "is_last_chunk": [17, 71], "transduc": [17, 71, 135], "new_step_id": [17, 135, 195], "next": [17, 22, 31, 71, 79, 83, 86, 87, 88, 91, 102, 104, 105, 106, 118, 119, 135, 161, 195], "final_st": [17, 92], "_beamsearchstep": 17, "core_bs_st": 17, "pre_beam_search_step_callback": 17, "post_beam_search_step_callback": 17, "num_beam": [17, 71], "num_hyp": [17, 195], "src_seq_len": 17, "tgt_seq_len": 17, "manag": [17, 44, 48, 64, 77, 79, 83, 86, 87, 114, 117, 118, 128, 228], "header": 17, "all_don": [17, 71], "init_beam_search_st": 17, "max_step": [17, 41, 48], "mostli": [17, 48, 178, 189], "opaqu": [17, 86], "seq_length": [17, 58, 71, 83, 100], "source_batch_s": 17, "_getshap": [17, 110], "none_shap": [17, 110], "mergebeamsearchoutput": 17, "max_hyps_per_beam": 17, "beam_search_output": 17, "less": [17, 46, 58, 71, 98, 100], "hypothes": [17, 71, 137, 143, 144, 151, 152, 195], "greedysearchhelp": 17, "_greedysearchstep": 17, "hyp_id": [17, 137], "hyp_len": 17, "done_hyp": [17, 71], "src_batch_siz": 17, "encount": 17, "bfloat16": [18, 48, 71, 83, 117], "bfloat16variablesav": 18, "saveabl": 18, "restor": [18, 23, 52, 78, 80, 83, 94, 191], "sai": [18, 87], "variable_nam": [18, 83], "original_dtyp": 18, "bfloat16_var": 18, "use_resourc": 18, "slice_spec": 18, "restore_sequenti": 18, "orig_dtyp": 18, "saveableobject": 18, "restored_tensor": 18, "restored_shap": 18, "conform": [18, 27, 83, 107], "get_saver_spec_for_variables_with_bf16_overrid": 18, "variables_to_restor": 18, "bf16": 18, "addingaccumul": 19, "suffici": [19, 83], "statist": [19, 36, 58, 64, 65, 71, 76, 86, 97, 186, 195], "computemo": 19, "reduce_over_dim": 19, "cumulative_axi": 19, "enable_cross_replica_sum_on_tpu": 19, "keepdim": [19, 83], "batchnormlay": [19, 30], "_getweightshap": [19, 30, 58], "_getdefaultpad": 19, "_getbetagamma": 19, "getcurrentmo": 19, "beta": [19, 38, 193], "gamma": [19, 83], "computeandupdatemo": 19, "_computebn": 19, "norm_mean": 19, "norm_vari": 19, "_maybeexpandpad": 19, "categoricalbn": [19, 30], "categor": [19, 58], "bn": [19, 58, 157], "akin": 19, "1809": 19, "11096": 19, "categori": [19, 83, 86, 88], "agnost": 19, "awar": [19, 30, 56], "class_emb": [19, 30], "emb_dim": [19, 30, 161, 195, 199], "batchnormlayernopad": 19, "batchnorm": [19, 58], "moving_mean": 19, "moving_vari": 19, "_moment": 19, "group_siz": [19, 48], "master": 19, "offici": [19, 65], "amoeba_net": 19, "network_util": 19, "l550": 19, "groupnormlay": 19, "08494": 19, "num_group": [19, 27, 48, 91], "_normal": [19, 27], "grouped_input": 19, "group_mean": 19, "group_vari": 19, "output_pad": [19, 48, 58], "_streammoment": 19, "cached_sum": 19, "cached_count": 19, "cached_var": 19, "build": [20, 21, 23, 27, 32, 42, 47, 48, 80, 83, 87, 94, 104, 114, 123, 142, 160, 188, 197, 224, 228], "builddata": 20, "binari": [20, 34, 64, 79, 83, 108, 171, 197], "composit": [21, 59, 76], "discuss": [21, 58, 90], "teammat": 21, "conv2dlay": [21, 58], "facilit": [21, 48, 58, 62, 91], "_seq": [21, 102], "zhifengc": 21, "_rep": 21, "sa": 21, "sc": 21, "sa1": 21, "sb1": 21, "sc1": 21, "sa2": 21, "sb2": 21, "sc2": 21, "_graph": 21, "input_endpoint": [21, 46], "output_endpoint": [21, 46], "signature_sub_param_list": 21, "_id": 21, "t_1": 21, "t_n": 21, "t1": 21, "_arg": 21, "pick": [21, 44, 48, 76], "t_": 21, "_par": 21, "f1": [21, 64, 152], "f2": 21, "_fn": 21, "fn_out": [21, 88], "fn_flop": 21, "prototyp": 21, "advic": 21, "establish": 21, "fnlayer": [21, 22, 191], "serial": [21, 33, 50, 71, 83, 118, 160, 175], "_save": [21, 83], "_addfetch": 21, "_layer": 21, "layer1": 21, "layer1_out": 21, "layer2": 21, "layer2_out": 21, "_output": [21, 87], "input1": [21, 83], "input2": 21, "inputn": 21, "fetch1": 21, "fetchm": 21, "_remateri": 21, "remateri": [21, 22, 83, 88], "_batchparallel": 21, "batchparallel": 21, "_printshap": 21, "print": [21, 22, 50, 83, 97, 108, 124, 131, 220, 221, 224, 226, 228], "_createnestedmap": 21, "_bn": 21, "_ln": [21, 46], "use_fused_layernorm": 21, "keep_prob": [21, 46, 71, 83], "noise_shape_broadcast_dim": [21, 46], "device_mesh": [21, 27, 46, 48, 49, 58, 59, 83, 86, 166, 167], "weight_split_dims_map": 21, "_activ": [21, 29], "_fc": 21, "_mlp": 21, "_conv2d": 21, "filter_shap": [21, 29, 30, 58], "filter_strid": [21, 30], "conv2d": [21, 29, 30, 58], "_reshap": 21, "_concat": 21, "firstnlay": 22, "argindexlay": 22, "_totupl": [22, 43, 48], "_maybestackextratheta": [22, 88], "all_var": [22, 83], "createnestedmaplay": 22, "_bodi": [22, 48, 88], "_unrolled_fprop": [22, 48], "softcondlay": 22, "sum_i": [22, 179], "w_i": 22, "theta_i": 22, "num_expert": [22, 27], "coeffici": [22, 34, 64, 71, 83], "expert": [22, 46, 48, 161], "yang": 22, "bender": 22, "le": 22, "ngiam": 22, "1904": [22, 58, 100, 101], "04971": 22, "_getexpertdist": 22, "parallelrepeatlay": 22, "_inferoutshap": 22, "slice": [22, 49, 83, 87, 125, 179, 188, 189, 228], "becom": [22, 71, 83, 179], "output_tensor": [22, 83], "sequentiallay": [22, 43], "unarysequentiallay": 22, "besid": 22, "graphtensor": 22, "storetensor": 22, "named_tensor": 22, "equival": [22, 52, 62, 64, 83, 84, 179, 186, 197], "overwritten": [22, 83], "gettensor": 22, "seri": [22, 71], "graphsignatur": [22, 102], "graphlay": [22, 29, 46, 102], "out1": 22, "myvar": 22, "out2": 22, "thing": [22, 31, 83, 86, 100, 218], "in1": 22, "in2": 22, "syntax": [22, 111], "bnf": 22, "za": [22, 70], "z_": [22, 70], "z0": [22, 70], "9_": [22, 70], "path_seq": 22, "item_seq": 22, "map_pair_seq": 22, "map_pair": 22, "_parseoutput": 22, "comma": [22, 224], "delimit": [22, 71, 116, 171], "pars": [22, 24, 42, 49, 78, 83, 152, 160, 171, 175, 228], "_tokenizeinput": 22, "spefici": 22, "_consumepath": 22, "_consumekei": 22, "_consumesymbol": 22, "_maybeconsumesymbol": 22, "consum": [22, 71, 188, 196], "_consumeitem": 22, "whatev": 22, "_consumemap": 22, "_consumelist": 22, "_parseinput": 22, "grammar": 22, "parallellay": 22, "maplay": 22, "linearlay": 22, "biaslay": [22, 29], "plu": [22, 29, 179], "branchlay": 22, "batchparallellay": 22, "rematerializationlay": 22, "printshapelay": 22, "debug": [22, 41, 70, 83, 139, 164, 166, 167, 209, 226], "reshapelay": 22, "inp": [22, 48, 58, 59, 83], "concatlay": 22, "slicelay": 22, "numpi": [22, 27, 46, 48, 64, 77, 86, 94, 139], "slicehelp": 22, "sortcheckpointpath": 23, "ckpt": [23, 48, 78, 81, 94], "saverwrapp": 23, "train_param": 23, "variables_to_restore_dict": 23, "async_sav": [23, 94], "gstep": 23, "sync": [23, 71, 80, 94, 202, 228], "outstand": [23, 94], "async": [23, 80, 94], "save_onli": 23, "check_loading_statu": 23, "checkpoint_dir": 23, "_getsav": 23, "async_checkpoint": 23, "_buildinitfromcheckpointrul": 23, "init_from_checkpoint_rul": 23, "restorefrompath": 23, "shouldsav": 23, "maybesav": 23, "_updatenextsavetim": 23, "_restorefromlatestcheckpoint": 23, "_getuninitializedvarnam": 23, "force_reiniti": 23, "avail": [23, 24, 36, 80, 83, 86, 222], "restoreifneed": 23, "restoreglobalstepifneed": 23, "_getsaveablevariablesdict": 23, "stripepd": 23, "trail": [23, 83, 139], "_eagercheckpoint": 23, "eager": [23, 42, 76, 80, 83, 108, 114, 118, 124], "_maybebuildinitfromcheckpointrul": 23, "_maybeoverwritemodelvariableswithema": 23, "overwrit": [23, 50, 102], "shadow": 23, "eagercheckpointerv1": 23, "_getrestor": 23, "_wraprestoreerrorwithgraphmodewarn": 23, "err": [23, 151], "eagercheckpointerv2": 23, "experimental_enable_async_checkpoint": 23, "v2": [23, 114, 148], "getspecificcheckpoint": 23, "load_checkpoint_from": 23, "infeedcontext": 24, "infeed_host_index": 24, "infeedcontextscop": 24, "getinfeedcontext": 24, "makedevicestr": 24, "replica_id": 24, "device_nam": 24, "device_id": 24, "_cluster": 24, "whole": [24, 83, 87, 125, 161, 179, 228], "_jobspec": 24, "replica": [24, 42, 46, 64, 76, 83, 96, 189], "initdevic": 24, "initdeviceseag": 24, "listdevic": 24, "job_spec": 24, "np": [24, 77, 83, 139], "arrai": [24, 31, 48, 52, 64, 77, 83, 94, 100, 116, 135, 139, 166, 167, 217], "exportmetr": 24, "_checkinvari": 24, "invari": 24, "setup": [24, 47, 58, 64, 80, 82, 86, 93, 114, 129, 161, 188, 193], "worker": [24, 25, 43, 47, 148], "coloc": [24, 52, 83], "is_executor_tpu": 24, "num_replica": [24, 42, 96], "tpus_per_replica": 24, "num_devices_per_replica": 24, "total_worker_devic": 24, "num_devices_per_split": [24, 166], "acceler": [24, 52, 62, 83, 224], "num_splits_per_replica": 24, "num_splits_per_cli": 24, "visibl": [24, 186], "available_devic": 24, "input_devic": 24, "all_worker_nam": 24, "input_target": 24, "workerdeviceinmodelsplit": [24, 25], "device_index": 24, "model_split": 24, "onto": [24, 86], "split_id": [24, 25], "incorrectli": [24, 83, 183], "getplac": 24, "strategi": [24, 86, 111], "placement": [24, 71, 83], "least": [24, 46, 48, 50, 71, 83, 177, 179], "polici": [24, 46, 55, 94], "tf_data_service_address": [24, 31], "in_unit_test": 24, "require_sequential_input_ord": [24, 25], "worker_cluster_def": 24, "clusterdef": [24, 83], "reporting_job": 24, "varplac": 24, "placer": [24, 46], "_assignvar": 24, "_": [24, 48, 58, 62, 78, 83, 87, 138, 170, 177, 186, 188, 197, 215, 218, 219, 221, 223, 226, 227], "devicefunct": 24, "_leastloadedplac": 24, "var_op": [24, 83], "parsedevicestr": 24, "device_str": 24, "parsed_devic": 24, "factori": 25, "setclust": 25, "cluster_param": [25, 47, 52, 125], "fortestingwork": 25, "gpu": [25, 78, 83, 148, 164, 224, 228], "split_siz": [25, 83], "unittest": [25, 112, 114], "setev": [25, 114], "off": [25, 56, 58, 76, 83, 100, 199], "z": [25, 46, 83], "bar": [25, 70, 83, 191, 224], "setrequiresequentialinputord": 25, "setmodelsplit": 25, "cost": [26, 36, 43, 48, 87, 90], "prepar": [26, 30, 102, 104, 106, 108, 136, 188, 194], "_hasaccumul": 26, "cost_metric_nam": 26, "_getaccumul": 26, "08100": [27, 107], "lconvlay": 27, "architectur": [27, 83, 91], "ln": [27, 46, 59], "depthwise_conv_1d": 27, "conv_activ": 27, "swish": 27, "gated_input": 27, "act_input": 27, "_applyactiv": 27, "act_nam": [27, 86], "dim0": [27, 83], "_normalizestep": 27, "struct": [27, 30, 58], "_attenctxisset": 27, "atten_context": [27, 92, 104, 195], "gshardmoelayerparam": 27, "num_devic": [27, 48, 49, 80, 131, 228], "per_expert_capacity_dim": 27, "use_densebuild": 27, "conformerlay": 27, "mhsa": 27, "atten_chunk_s": 27, "fflayer_activ": 27, "fflayer_residual_weight": 27, "layer_ord": 27, "mhsa_before_conv": 27, "conv_norm_layer_tpl": 27, "use_moe_in_fflayer_start": 27, "use_moe_in_fflayer_end": 27, "moe_num_partit": 27, "moe_num_expert": 27, "moe_num_group": 27, "moe_per_capacity_dim": 27, "fflayer_start_tpl": 27, "fflayer_end_tpl": 27, "trans_atten_tpl": 27, "lconv_tpl": 27, "list_regex_dtyp": [27, 83], "_configselfattencontext": 27, "configfflay": 27, "tpl": 27, "configmoeparam": 27, "moe": [27, 46, 47, 48, 59], "has_lconv": 27, "has_mhsa": 27, "has_fflayer_start": 27, "_configfflayerormoeparam": 27, "fflayer_tpl": 27, "name_prefix": 27, "_selfatten": 27, "_lconv": 27, "_moeorfflay": 27, "fflayer_nam": 27, "aux_loss": [27, 46, 48, 83], "fflayer_end": 27, "moe_lay": 27, "_moe": 27, "_fprop": [27, 107, 195], "in_nmap": 27, "_addattentionsummari": 27, "_addattenprobshistogramsummari": [27, 195], "histogram": [27, 91, 108, 195], "_addattenprobsimagesummari": [27, 195], "applygshard": 27, "conformer_tpl": 27, "proj_w_split_list": 27, "proj_activation_split_list": 27, "atten_dnh_w_split": 27, "atten_blnh_activation_split": 27, "atten_bld_activation_split": 27, "lconv_df_w_split": 27, "lconv_hwim_w_split": 27, "lconv_fd_w_split": 27, "lconv_blf_activation_split": 27, "lconv_bld_activation_split": 27, "moe_device_mesh_shap": 27, "moe_emh_split": 27, "moe_ehm_split": 27, "moe_eah_split": 27, "moe_eam_split": 27, "moe_egcm_split": 27, "moe_gecm_split": 27, "moe_gsec_split": 27, "moe_blm_split": 27, "ndarrai": [27, 49, 86, 108, 139, 188], "in_channel": [27, 30], "channel_multipli": [27, 30, 48], "emh": 27, "ehm": 27, "eah": [27, 48], "egcm": [27, 48], "gecm": [27, 48], "gsec": [27, 48], "blm": [27, 48], "causalpoolinglay": 29, "frequenc": [29, 30, 58, 77, 100], "_biasnopad": 29, "_norm": 29, "_normorbia": 29, "_maybenorm": 29, "_rawconv2d": 29, "in_dim": 29, "dilat": [29, 30], "_rawdepthwiseconv2d": 29, "depth_multipli": [29, 58], "_globalpool": 29, "pooling_typ": 29, "conv_last": [29, 58], "depthwiseconv2d": 29, "separableconv2d": 29, "normalizeddepthwiseconv2d": 29, "dropconnect_prob": 29, "deterministic_dropout": 29, "glu_with_tanh": 29, "_lconvcommon": 29, "residual_dropout_prob": [29, 93, 161, 193, 205], "unit": [29, 58, 83, 86, 91, 155], "normalizedlconv": 29, "2004": [29, 39, 181], "11886": 29, "buggi": 30, "v2_pad": 30, "computeconvoutputshap": 30, "in_shap": [30, 58], "t_stride": 30, "f_stride": 30, "outc": 30, "computeconvoutputpad": 30, "padding_algorithm": [30, 58], "prefer": [30, 58, 83, 86, 87], "computeconvoutputpaddingv2": 30, "in_pad": 30, "adjac": 30, "computeexplicitpaddingforcausalconv": 30, "dilation_r": [30, 58], "out_channel": [30, 58], "axis": 30, "pad_top": 30, "pad_bottom": 30, "pad_left": 30, "pad_right": 30, "explicit_pad": 30, "_computeconvoutputpaddingv2": 30, "shrink": 30, "unnecessarili": 30, "_padforlengthcompatiblestridesv2": 30, "constant_valu": 30, "incompat": [30, 49, 116], "padded_length": 30, "potenti": [30, 31, 46, 58, 80, 90, 94, 195, 222], "baseconv2dlayerwithpad": 30, "outputchannel": 30, "output_channel": [30, 58], "input_channel": 30, "outshap": [30, 58], "_rescaleboundari": 30, "conv_input": 30, "_maybecausalpad": 30, "_evaluateconvkernel": [30, 58], "conv2dlayerwithpad": 30, "outputshap": [30, 58], "_getweight": [30, 48, 58], "causalconv2dlayerwithpad": 30, "input_tensor": [30, 44], "depthwiseconv2dlay": [30, 58], "1610": [30, 34, 58], "02357": [30, 58], "causaldepthwiseconv2dlay": 30, "normalizeddepthwiseconv2dlay": 30, "causalnormalizeddepthwiseconv2dlay": 30, "convbatchnormlay": 30, "regular": [30, 34, 48, 58, 83, 91, 105, 138, 186, 191, 193], "convcategoricalbn": 30, "globalpoolinglay": 30, "spatial": [30, 58], "broad": 31, "metasourc": 31, "met": [31, 37, 80], "setinputgener": 31, "getnext": 31, "getmeta": 31, "input_common": 31, "record_yield": 31, "record_batch": 31, "crossbatchmixingdatasourc": 31, "curriculumdatasourc": 31, "not_support": 31, "rosenberg": 31, "prefixeddatasourc": 31, "prepend": [31, 71, 83], "tfdatasetsourc": [31, 32, 209], "num_host": 31, "host_id": [31, 117], "getdataset": [31, 32, 123, 209], "_inititer": 31, "tfdatasetadaptor": 31, "tfdatasettransform": 31, "customtfdatasettransform": 31, "repeatabletfdatasettransform": 31, "sentinel": 31, "tfdatasetfninput": 31, "tfdataset": 31, "tfdatasetbatchbysequencelength": [31, 209], "bucket_kei": [31, 42, 142, 160, 197, 209], "seqlen_fn": 31, "On": [31, 34, 48, 58], "partial": [31, 71, 83, 120, 121], "finit": [31, 40], "tfdatasetprefetch": 31, "tfdatasetmix": 31, "gettfdataservicedataset": 31, "bucket_upper_bound": [31, 148, 197], "processing_mod": 31, "dataset_id": 31, "element_spec": 31, "servic": [31, 80], "uuid": 31, "upper": [31, 34, 86, 100, 223], "bound": [31, 34, 57, 76, 86, 100], "dataet": 31, "tfdataservicesourc": 31, "remot": 31, "tfd": 32, "isol": [32, 59], "tfdsinput": 32, "phase": [33, 58, 96], "writekeyvaluepair": 33, "key_value_pair": 33, "serializeoutput": 33, "nmap": [33, 83, 87, 94], "differenti": [34, 48, 83], "csisz": 34, "2008": 34, "algoirthm": 34, "geometri": 34, "background": [34, 47], "cuturi": 34, "2013": 34, "lightspe": 34, "transport": [34, 48], "schmitzer": 34, "2019": [34, 36, 76, 83], "stabil": [34, 40, 83], "entropi": [34, 58, 60, 83, 179, 195], "max_assign": 34, "elementwise_upper_bound": 34, "row_sum": 34, "col_sum": 34, "num_iter": 34, "use_epsilon_sc": 34, "margin": [34, 40, 195], "n_row": 34, "n_column": 34, "upper_bound": 34, "01": [34, 38], "enough": [34, 48, 71, 86], "converg": [34, 86], "solv": 34, "dual": [34, 176, 179, 181, 182, 185, 188], "06519": 34, "decreas": 34, "factor": [34, 37, 58, 61, 71, 76, 83, 91, 96, 195, 197], "reach": [34, 58, 71, 110], "used_it": 34, "ep": [34, 58], "delta": [34, 38, 71, 83, 108, 114, 121], "knowledg": [35, 179], "distillationtask": 35, "computedistillationloss": 35, "dec_out_dict": [35, 119, 136, 145, 154, 199], "dec_metrics_dict": [35, 119, 136, 144, 145, 154, 199], "shampoo": [36, 71], "partitionconfig": 36, "max_dim_s": 36, "partition_s": 36, "partitionmetadata": 36, "split_sizes_per_dim": 36, "num_splits_per_dim": 36, "tensorpartition": 36, "involv": [36, 50, 80, 86], "movement": 36, "partition_metadata": 36, "partition_info": 36, "reform": 36, "partition_tensor": 36, "reform_tensor": 36, "partitioned_tensor": 36, "distributedshampoo": [36, 76], "momentum": [36, 38, 76], "initial_accumulator_valu": 36, "start_preconditioning_step": 36, "statistics_computation_frequ": 36, "matrix_epsilon": 36, "synchronous_precondit": 36, "second_moment_averag": 36, "fallback_to_diagonal_dim": 36, "4096": [36, 46, 167, 175], "max_any_dim": 36, "6656": 36, "block_partition_threshold_s": 36, "1000000": 36, "exponent_multipli": 36, "adagrad": [36, 76, 117], "kroneck": [36, 76], "matric": [36, 71, 76, 77, 83, 91, 100, 116, 193, 199], "made": [36, 48, 50, 76], "vineet": [36, 76], "gupta": [36, 76], "kevin": [36, 76], "regan": [36, 76], "yoram": [36, 76], "singer": [36, 76], "_fallback_to_diagonal_for_shap": 36, "fallback": [36, 140], "diagon": [36, 58, 83], "_preconditioner_available_for_dim": 36, "precondition": [36, 71], "_preconditioner_indic": 36, "_make_named_slot": 36, "val": [36, 50, 51, 64, 71, 83, 121], "slot_nam": 36, "make_named_zeros_slot": 36, "_generalized_inverse_pth_root": 36, "input_t": 36, "expon": [36, 63, 71, 76], "12": [36, 166, 167], "_specialized_inverse_pth_root": 36, "_inverse_pth_root_graph": 36, "invoke_async_preconditioner_comput": 36, "global_step_int32": 36, "svd": 36, "assign_preconditioner_to_host_var": 36, "grab": [36, 58], "_statistics_key_for_partition_and_dim": 36, "dim_index": 36, "partition_index": 36, "_preconditioner_key_for_partition_and_dim": 36, "_key_for_var": 36, "_updated_statist": 36, "partitioned_grad": 36, "l_t": 36, "r_t": 36, "_compute_preconditioned_raw_grad": 36, "precondit": [36, 71], "_preconditioned_upd": 36, "diagonal_grad_upd": 36, "metrichistori": 37, "versu": [37, 38, 96, 140], "histori": [37, 71, 74, 96, 105], "setlogdirinmetrichistori": 37, "_metric_histories_map": 37, "_kei": 37, "hist_fil": [37, 71], "tfevent_fil": 37, "conditionalappend": 37, "append": [37, 47, 56, 71, 83, 108, 116], "hasn": 37, "improv": [37, 59, 96], "metric_histori": 37, "best_step": [37, 71, 96], "last_step": [37, 96], "criterion": 37, "9": [38, 48, 50, 58, 63, 119, 166, 167, 193, 197, 219], "gain_learning_r": 38, "scale_learning_r": 38, "001": [38, 40, 76, 166], "initial_gain": 38, "min_gain": 38, "max_gain": 38, "initial_scal": 38, "min_scal": 38, "max_scal": 38, "use_direct": 38, "use_sign": 38, "gd": 38, "lr_scale": 38, "rule": [38, 83, 86], "mu": 38, "unnorm": [38, 58, 60, 111], "kw97": 38, "tba": 38, "kivinen": 38, "warmuth": 38, "descent": [38, 148], "1997": 38, "demonstr": [39, 85], "02644": 39, "deep": [39, 44, 50, 59, 70], "spin": 39, "hope": [39, 104], "meena2": 39, "unifi": 39, "framework": [39, 56, 83, 114], "_calculate_prob": 39, "alpha": [39, 63, 71, 83, 111], "entmax_support": 39, "n_iter": 39, "ensure_sum_on": 39, "entmax_loss": 39, "valerii": 40, "likhosherstov": 40, "next_se": 40, "current_se": 40, "create_projection_matrix": 40, "nb_random_project": 40, "orthogon": 40, "chi": 40, "latter": [40, 58, 59, 179], "dimension": [40, 46, 135], "gaussian": [40, 83, 100], "covari": 40, "renorm": [40, 195], "relu_kernel_transform": 40, "is_queri": 40, "projection_matrix": 40, "numerical_stabil": 40, "oor": 40, "stand": [40, 151, 152], "pairwis": [40, 179, 185], "softmax_kernel_transform": 40, "cossim_kernel_transform": 40, "cossim": 40, "co": [40, 58, 179, 183], "noncausal_numer": 40, "noncaus": 40, "av": 40, "query_prim": 40, "key_prim": 40, "noncausal_denomin": 40, "causal_numer": 40, "a_": 40, "causal_denomin": 40, "chunked_causal_numerator_func": 40, "chunked_causal_numerator_grad": 40, "res_grad": 40, "chunked_causal_numer": 40, "chunked_causal_denominator_func": 40, "chunked_causal_denominator_grad": 40, "chunked_causal_denomin": 40, "kernel_transform": 40, "use_chunked_caus": 40, "faster": [40, 58, 62, 83, 91, 104, 195, 222], "flat": [41, 70, 83, 171], "beam_siz": [41, 71, 195], "query_s": 41, "key_siz": [41, 47], "buf_siz": 41, "dec_callback": 41, "tgt_id": [41, 46, 47, 60, 71, 171], "tgt_segment_id": [41, 46, 47, 71, 171], "tgt_po": [41, 46], "tgt_mask": [41, 46, 47], "dec_stat": [41, 46], "tgt_semgent_id": 41, "max_len": [41, 46, 47, 48, 139, 171], "einsum_i32": 41, "update_nbest": 41, "nbest_hyp": 41, "cur_hyp": 41, "nbest": 41, "flat_beam_search": [41, 48], "bos_id": 41, "eos_id": [41, 56, 71, 83, 110, 136, 139], "length_norm_alpha": 41, "beam_gap": 41, "top_k_fn": 41, "top_k": [41, 83], "prefix_len": [41, 48], "ext_siz": 41, "nbest_siz": 41, "prefix_max": 41, "extens": [41, 53, 70, 71], "vlaue": 41, "loop_var": [41, 118], "setallowgenericinputv2ineag": 42, "isgenericinputv2allwedineag": 42, "_parseprocessor": 42, "processor": [42, 209], "genericinput": [42, 116], "parserecord": 42, "feature_map": 42, "parse_single_exampl": 42, "field1": 42, "field2": 42, "bucketing_kei": 42, "pure": [42, 83, 140], "genericinputv2cr": 42, "passs": 42, "genericinputv2getnext": 42, "out_typ": 42, "output_tmpl": 42, "generic_input_v2_cr": 42, "seen": [42, 64, 102], "replicatedgenericinput": 42, "replica_device_fn": 42, "replic": [42, 48, 49, 58], "giant": 43, "1811": 43, "06965": 43, "gpipetransformerlm": [43, 161], "billion": [43, 164], "word": [43, 58, 60, 65, 71, 97, 116, 122, 137, 148, 151, 152, 161, 164, 197, 209, 212, 219], "one_billion_wd": [43, 159, 163], "onebwdsgpipetransform": 43, "classif": [43, 58, 64, 154, 157], "getoverwriteglobalstep": 43, "setoverwriteglobalstep": 43, "generatestepseedpair": [43, 83], "unused_global_step": 43, "op_se": [43, 83], "cellfnfpropopreplacementwrapp": 43, "hack": [43, 65, 83], "unwant": [43, 83], "featureextractionlay": 43, "extrac": 43, "capabl": [43, 91], "endpoint": [43, 83], "huangyp": [43, 80], "partitionsequentiallay": 43, "routin": [43, 83], "strive": 43, "roughli": [43, 87, 128, 195], "seqlay": 43, "round": [43, 54, 86], "robin": [43, 54], "cell": [43, 62, 68, 82, 83, 86, 87, 91, 92, 106, 193], "cell_tpl": 43, "among": [43, 71, 83, 152, 179], "feature_height": 43, "feature_width": 43, "pipelininglay": [43, 60], "_calculateoutputshap": 43, "input_shap": [43, 49, 91, 138], "calcuat": 43, "recov": [43, 58, 83], "stackedrecurr": [43, 87], "_get_state_dtyp": 43, "_get_input_shap": 43, "sign": [44, 86], "emit": [44, 56, 58, 71, 105, 135, 195], "At": [44, 48, 58, 104], "backpropag": [44, 90], "setloss": 44, "ratio": [44, 48, 71, 100, 111, 193, 195, 197, 199], "multitask": [44, 58, 59, 69, 80], "neurip": 44, "2020": 44, "06808": 44, "leak_ratio": 44, "clearli": 44, "unchang": [44, 48, 71, 83, 135, 189, 195], "sometim": [45, 58, 87], "benefit": 45, "sophist": 45, "surgeri": 45, "2001": [45, 59], "06782": 45, "gradnorm": 45, "1711": [45, 96, 197], "02257": 45, "gradientcombin": 45, "losses_and_gradi": 45, "loss_and_grad": 45, "loss_metr": 45, "xla_shard": [46, 48, 49], "_toint32": 46, "moebuild": 46, "densespars": 46, "introduc": [46, 83], "enc": [46, 227], "encoderlayerstack": 46, "selfattent": [46, 98], "self_attent": 46, "densereludens": 46, "dense_relu_dens": 46, "dec": [46, 48], "decoderlayerstack": [46, 48], "decselfattent": 46, "dec_self_attent": 46, "decencattent": 46, "dec_enc_attent": 46, "ultim": 46, "encoderlay": 46, "decoderlay": 46, "natur": [46, 86], "24": [46, 164, 166, 167], "segment_po": [46, 48, 197], "subseg": 46, "encoder_segment_id": 46, "appropri": [46, 50, 80, 83, 86, 116, 186, 224], "univers": 46, "layerstack": 46, "xlashardingbuild": 46, "lepikhin": [46, 48], "_device_mesh": 46, "_model_dim_reshape_seg": 46, "_adjustmsplit": 46, "m_dim": 46, "adjust": [46, 48, 61, 76, 83, 86, 91, 96, 100, 162, 195], "model_dim_reshape_seg": [46, 48, 166, 167], "_adjustmsplitbynam": 46, "p_split_nam": 46, "_onehotencod": 46, "shared_var_collection_suffix": 46, "shardedweightparam": [46, 48], "get_quantized_weight_scal": 46, "_shardedvaron1ddevicearrai": 46, "_embeddingweight": 46, "vocab_dim": 46, "w_mesh_split": 46, "_getropefn": 46, "enable_rop": 46, "rope_emb_max_timescal": 46, "rotari": [46, 58], "rope": 46, "timescal": [46, 58], "sharedembsoftmax": 46, "logits_abs_max": 46, "z_loss_coef": 46, "0001": [46, 63, 114], "use_tgt_labels_size_as_loss_denomin": 46, "softmaxweight": 46, "_encoderlayerinmapkei": 46, "sub_lay": 46, "use_repeat_lay": [46, 166, 167], "spmd_pipeline_stag": 46, "spmd_pipeline_microbatch": 46, "clean": [46, 87], "layer_000": 46, "wo": 46, "layer_001": 46, "shardabl": 46, "microbatch": [46, 48], "conv_kernel_s": 46, "norm_typ": 46, "norm_polici": 46, "normalz": 46, "_decoderlayerinmapkei": 46, "start_layer_id": 46, "has_final_lay": 46, "per_layer_var": 46, "shardablepipelin": 46, "layerwiseshardablepipelinedlay": [46, 48], "_layerstack": 46, "imap_kei": 46, "layer_fn": 46, "final_norm_typ": 46, "_densereludenseweight": 46, "wi_mesh_split": 46, "wo_mesh_split": 46, "use_bia": 46, "is_quant": [46, 86], "_densereludenseweightsgatedgelu": 46, "densereludenseg": 46, "densereludensegatedgelu": 46, "densereludensegatedsilu": 46, "scalar_aux_loss": 46, "attention_key_value_dim": [46, 166, 167], "_computeattenoutput": 46, "_encnotvis": 46, "decoder_segment_id": 46, "w_qkv_mhd_mesh_split": 46, "wo_hdm_mesh_split": 46, "transformerencod": [46, 196], "_decnotvis": 46, "_deccomputebiasgraphedg": 46, "edg": [46, 87], "attenion": 46, "transformerdecod": [46, 195], "qkv": 46, "weigtht": 46, "decselfattentionquant": 46, "quantiz": [46, 58, 83, 85, 86, 91], "decmultidconvheadattent": 46, "_relativepositionbucket": 46, "relative_posit": 46, "bidirect": [46, 92], "_addrelativebia": 46, "query_segment_po": 46, "key_segment_po": 46, "relative_bias_weight": 46, "_encoderaddrelativebia": 46, "selfattentionrelativebia": 46, "decselfattentionrelativebia": 46, "_relativeattentionbiasweight": 46, "32": [46, 93, 164, 166, 167], "meena": 46, "64b": 46, "relative_bucket": 46, "decmultidconvheadattentionrelativebia": 46, "primer": 46, "dconv": 46, "rb": 46, "_zero_aux_loss": 46, "causaldepthwiseconv": 46, "depthwiseconvautoregress": 46, "mesh_tensorflow": 46, "sublayer_depthwise_conv_autoregress": 46, "sum_k": 46, "roll": 46, "_lnnoscal": 46, "_lnconv": 46, "_lnintern": 46, "ln_weight_reshap": 46, "_trueln": 46, "_jaxreplicaln": 46, "jax": 46, "_pn": 46, "_ident": 46, "_attentionweight": 46, "_computeqkv": 46, "_computeqkvcombin": 46, "_top2gatingweight": 46, "_computeg": 46, "_shardedfeedforwardnetworksweight": 46, "net": [46, 59, 87], "_feedforwardnetworksapplyg": 46, "_shardedmoepositionwisefeedforwardnetwork": 46, "_attentionst": 46, "_overrid": [46, 48], "_softmax": 46, "dec_out": [46, 199], "tgt": [46, 58, 71, 135, 171, 197, 199, 209], "label_smooth": [46, 166, 167], "smoothedsoftmax": 46, "smooth": [46, 58, 193, 195, 199], "densebuild": [46, 166, 167], "desns": 46, "layr": 46, "_reshapedmodeldim": 46, "_reshapem": 46, "_einsumwithmodeldim": 46, "nm": [46, 48], "gsm": [46, 48], "me": [46, 48], "gse": [46, 48], "16": [46, 48, 71, 86, 118, 138, 148, 161, 164, 166, 167, 175, 193, 203, 219], "rewritten": [46, 48, 58], "gsnol": 46, "nole": 46, "contract": [46, 48], "maybe_modified_equ": [46, 48], "einsumwithmodeldim": [46, 48], "_meshsplit": 46, "_attention_output_hdm_w_split": 46, "paralleldecselfattentionrelativebiasffn": 46, "hidden_dim_reshape_seg": [46, 167], "ffnwithconv": 46, "_computeqkvh": 46, "_computecombinedoutput": 46, "o1": 46, "o2": 46, "wo1": 46, "wo2": 46, "densereludensequant": 46, "_moeweightsgatedgelu": 46, "_shardedmoeglu": 46, "moegat": 46, "recurrentdensebuilderparalleldecod": 46, "recurrentdensebuild": 46, "micro": [46, 76, 161], "proj_weight_hdim": 46, "d_kv": 46, "wi_o": 46, "1024": [46, 161, 164, 166, 167], "120": [46, 166], "16k": 46, "64k": 46, "4byte": 46, "491gb": 46, "exceed": [46, 71, 197], "memoeri": 46, "64": [46, 79, 166, 167], "8x": 46, "_num_input_proj_weight": 46, "_num_output_proj_weight": 46, "_ffw_var_h_dim_s": 46, "_atten_q_var_head": 46, "_atten_kv_var_head": 46, "_decoderlayerinputprojweight": 46, "_decoderlayeroutputprojweight": 46, "unitransform": 46, "transformermodel": [46, 199], "_getdecoderlayerstackparam": 46, "layer_type_dict": 46, "_computedecoderinput": 46, "read_vars_from_theta": 46, "_computenonpad": 46, "_computesoftlabel": 46, "computepertokenloss": 46, "_top_k_fn": 46, "decodeid": 46, "_splitdecoderoutputandsoftmax": 46, "all_dec_output": 46, "_flatbeamsearchcallback": 46, "tunableunitransform": 46, "tunabl": [46, 83], "berttransform": [46, 167], "gspmd": 46, "_computeencinput": 46, "mlm_logit": 46, "masked_po": [46, 160], "preload_zero": 47, "preload_unpack": 47, "get_zero_batch": 47, "return_tgt_mask": 47, "tgt_segment_po": [47, 71, 171], "tgt_label": [47, 71, 171], "tgt_sample_temperatur": 47, "infinite_repeat": 47, "body_fn": 47, "infeed_queu": 47, "infinit": 47, "daemon": 47, "closur": [47, 52], "gsharddecod": [47, 171], "worker_job_nam": 47, "prefix_max_len": 47, "is_cloud_tpu_nod": [47, 171], "attr": [47, 70, 71, 83], "addresss": 47, "node": [47, 52, 70, 78, 82, 83, 129, 136, 161, 171], "compile_op": 47, "compil": [47, 48, 49, 58, 80, 94, 118], "init_vars_op": 47, "init": [47, 48, 83, 92, 110, 119, 134], "infeed_op": 47, "infeed_arg": 47, "placehold": [47, 83, 114, 162], "outfeed_op": 47, "poll": 47, "decode_loop": 47, "num_batch": [47, 171], "spm": [47, 49, 97], "sentencepiecemodel": 47, "load_spm": 47, "reset_tpu_clust": 47, "get_sess": 47, "_no_opt_sess_cfg": 47, "reset_sess": 47, "run_init_sequ": 47, "_configure_cluster_param": 47, "tpu_cor": [47, 189], "cpu_host": 47, "_start_heartbeat": 47, "heartbeat": 47, "_config_infe": 47, "device_assign": 47, "use_partitioned_infeed_queu": 47, "_init_tpu": 47, "device_order_mod": 47, "init_graph": 47, "_config_outfe": 47, "infeed_batch": 47, "varlay": 48, "_get_var_from_collect": 48, "vp": 48, "xla": [48, 49, 58, 76, 80], "shardedvarlay": 48, "num_stag": 48, "num_microbatch": 48, "achiev": [48, 69, 121, 148], "manual": [48, 49, 121, 218], "stage_parallel_bodi": 48, "vectorized_map": 48, "convers": [48, 58, 61, 71, 121, 197], "variableshapeprefixcontext": [48, 83], "single_stage_bodi": 48, "shard_stages_1d": 48, "fail": [48, 50, 71, 83, 152], "per_stage_var": 48, "pipeline_stage_mesh_dim": 48, "reliabl": 48, "reshard": 48, "idea": 48, "commun": [48, 99], "shown": 48, "padded_input": 48, "expand_dim": 48, "shifted_st": 48, "in_mask": 48, "stages_in": 48, "fpropfn": 48, "padded_per_stage_st": 48, "bubbl": 48, "padmicrobatch": 48, "thie": 48, "circular_repeat": 48, "expand": [48, 80, 83, 86, 179, 191], "circular_repeat_000_stage_0": 48, "circular_repeat_000_stage_1": 48, "circular_repeat_000_stage_2": 48, "circular_repeat_000_stage_3": 48, "circular_repeat_001_stage_0": 48, "circular_repeat_001_stage_1": 48, "circular_repeat_001_stage_2": 48, "circular_repeat_001_stage_3": 48, "goe": [48, 123], "rotat": [48, 189], "interleav": [48, 80], "pad_as_abov": 48, "rotated_st": 48, "circularrepeatit": 48, "_findperstagevarshardingdim": 48, "bodyfprop": 48, "fn_name": 48, "kwargs_no_batch": 48, "bodyfpropnomicrobatch": 48, "_microbatchandrepeatid": 48, "_bodyfpropintern": 48, "layer_theta": [48, 129], "repeat_idx": 48, "stage_idx": 48, "per_layer_st": 48, "_padmicrobatchesintern": 48, "pad_stag": 48, "statelay": 48, "newstat": 48, "_step": 48, "travers": [48, 50, 70, 129], "theta0": 48, "updatetheta": 48, "updatest": 48, "beam_search_tpu_help": 48, "multiheadattentionstatelay": 48, "x_full": 48, "_use_flat_beam_search": 48, "use_xla_dynamic_update_slic": 48, "conv1dstatelay": 48, "conv1d": 48, "2021": [48, 107, 181], "max_siz": 48, "kernel_width": 48, "underli": [48, 58, 83, 175], "layout": [48, 53, 77], "_processprefixorsuffix": 48, "suffix": [48, 86], "properli": [48, 52, 83, 87], "overridelay": 48, "my_lay": 48, "out_with_overrid": 48, "clear": [48, 61, 70, 78], "reshapeinputlay": 48, "unused_theta": 48, "sharedembeddingsoftmaxlay": 48, "embemd": 48, "lookup": [48, 58, 59, 82, 105, 117, 195], "causaldepthwiseconv1dlay": 48, "_doconv": 48, "channel_s": 48, "rank4": 48, "top2gatingonlogit": 48, "experts_dim": 48, "expert_capacity_dim": 48, "use_xla_shard": 48, "second_expert_polici": 48, "second_expert_threshold": 48, "legacy_mtf_behavior": 48, "capacity_factor": 48, "mask_dtyp": 48, "dispatch": 48, "cheat": 48, "sheet": 48, "group_dim": 48, "group_size_dim": 48, "capac": 48, "batch_dim": [48, 60, 83], "sequence_length_dim": 48, "local_dispatch": 48, "sm": 48, "se": 48, "minibatch": 48, "datatyp": [48, 86], "greedili": 48, "ii": 48, "iii": 48, "iz": 48, "best": [48, 71, 199], "proport": [48, 71, 83, 88], "mtf": 48, "increas": [48, 58, 86, 96, 179], "big": [48, 193], "problemat": 48, "rid": 48, "combine_tensor": 48, "dispatch_tensor": 48, "scatter": [48, 77, 91, 95], "hashgatingonlogit": 48, "expert_id": 48, "hash": [48, 83], "tokenshufflingonlogit": 48, "advantag": [48, 87], "ec": 48, "tokenshufflingonlogitsv2": 48, "nonpad": 48, "optimaltransportonlogit": 48, "computeg": 48, "gating_func": 48, "top_2": 48, "gating_logits_dtyp": 48, "token_shuffl": 48, "go": 48, "decid": [48, 83, 104, 118], "hashgat": 48, "karg": 48, "top2gat": 48, "tokenshuffleg": 48, "tokenshufflegatingv2": 48, "optimaltransportg": 48, "feedforwardnetworksapplyg": 48, "reshaped_input": 48, "wi_split": 48, "wo_split": 48, "bi_split": 48, "bo_split": 48, "dropout_r": [48, 167], "gsm_split": 48, "egcm_split": 48, "gecm_split": 48, "gsec_split": 48, "gecs_split": 48, "gec_split": 48, "eah_split": 48, "eam_split": 48, "use_glu": 48, "nd": 48, "gec": 48, "eam": 48, "gatherk": 48, "selected_po": 48, "topk": [48, 83, 135, 136], "largest": [48, 76, 195], "value_2d": 48, "11": [48, 166, 167], "13": [48, 119, 148, 166, 167], "15": [48, 148, 151, 166, 167], "17": [48, 71, 166, 167], "19": [48, 166, 167], "21": [48, 166, 167], "23": [48, 166, 167, 171], "25": [48, 166, 167], "27": [48, 166, 167], "29": [48, 71, 166, 167], "31": [48, 83, 166, 167], "33": [48, 166, 167], "35": [48, 166, 167, 219], "37": [48, 166, 167], "39": [48, 166, 167], "getsentenceembed": 48, "float64": [48, 83], "41258181": 48, "61071571": 48, "63777673": 48, "65571443": 48, "54297766": 48, "10288261": 48, "8577837": 48, "81915847": 48, "61996602": 48, "46897136": 48, "92662692": 48, "32942232": 48, "60162383": 48, "3385829": 48, "3408632": 48, "40774807": 48, "86139635": 48, "00927162": 48, "56126334": 48, "51748817": 48, "07791397": 48, "06595223": 48, "95529216": 48, "34458149": 48, "1238971": 48, "49897169": 48, "25216722": 48, "11221774": 48, "50284604": 48, "84106974": 48, "sentence_embed": 48, "sentencetop2g": 48, "embedding_typ": 48, "wise": [48, 58, 100, 185], "tasktop2g": 48, "task_embed": 48, "_einsumeqwithmodeldim": 48, "gsnom": 48, "nome": 48, "split_dimens": 49, "use_sharding_op": 49, "gen_xla_op": 49, "hyoukle": 49, "outcom": 49, "lost": 49, "past": [49, 59, 96], "due": [49, 58, 83, 117], "todai": 49, "condition": 49, "getmeshsplitshard": 49, "mesh_split_shard": 49, "unspecified_dim": 49, "meshsplitdimprefixcontext": 49, "prefix_mesh_dim": 49, "getmeshsplitdimprefixcontext": 49, "manualmeshdimcontext": 49, "mesh_dim": 49, "zigzagorderondevicemesh": 49, "zigzag_mesh_dim": 49, "permut": [49, 197], "zigzag": 49, "getnonpod2dmesh": 49, "device_mesh_shap": [49, 166, 167], "physical_mesh_shap": 49, "pod": 49, "tensorshardingspec": 49, "uneven_pad": 49, "fromfullshap": 49, "full_shap": 49, "tile": [49, 58], "uneven": 49, "applytotensor": 49, "applytovari": 49, "variablev1": [49, 186], "shardshap": 49, "manualtoautopartit": 49, "autotomanualpartit": 49, "toxlaopshard": 49, "opshard": 49, "fromxlaopshard": 49, "op_sharding_proto": 49, "addleadingdim": 49, "num_dim": 49, "removeleadingdim": 49, "removedim": 49, "replicatedspec": 49, "is_repl": 49, "mesh_dim_to_tensor_dim_map": 49, "getvarshard": 49, "loadspm": 49, "model_fil": 49, "sentencepieceprocessor": 49, "_quotestr": 50, "quot": 50, "escap": [50, 76], "lite": 50, "enclos": 50, "quotat": 50, "mark": [50, 83, 151, 152, 179, 183], "doubl": [50, 86], "backslash": 50, "newlin": 50, "verbatim": 50, "multilin": 50, "_unquotestr": 50, "_endswithterminalquot": 50, "quote_char": 50, "termin": [50, 63, 71, 87], "_isnamedtupl": 50, "42": [50, 70, 166, 167, 171, 178, 182], "hi": 50, "_sorteddict": 50, "__repr__": [50, 70], "_param": [50, 83], "default_valu": 50, "tostr": 50, "nested_depth": 50, "getdefault": 50, "copyfieldsto": 50, "from_p": 50, "to_p": 50, "ignore_unknown_kei": 50, "destin": [50, 100], "_tostr": [50, 70], "_similarkei": 50, "_keyerrorstr": 50, "paramst": 50, "_copyto": 50, "mergecommonkeysfrom": 50, "lowercas": [50, 209], "underscor": [50, 70], "freez": [50, 52], "immut": 50, "isimmut": 50, "_getnest": 50, "navig": 50, "ban": 50, "altogeth": [50, 188], "delet": [50, 94, 137, 151, 152], "iterparam": 50, "getkei": 50, "toproto": 50, "themselv": 50, "fingerprint": 50, "totext": [50, 220], "fromproto": 50, "param_pb": 50, "visit_fn": 50, "enter_fn": 50, "exit_fn": 50, "dataclass": 50, "shouldn": 50, "never": [50, 64, 71, 80, 87, 94], "subkei": 50, "abl": [50, 71, 86], "include_typ": 50, "liter": [50, 70], "trivial": [50, 141, 161], "whichev": 50, "charact": [50, 71, 116, 209, 219], "fromtext": 50, "type_overrid": 50, "wrong": [50, 83, 123, 183], "totextwithtyp": 50, "fromtextwithtyp": 50, "textdiff": 50, "instantiableparamsclst": 50, "myobject": 50, "obj": [50, 146], "anyth": [50, 102, 123, 191], "parameter": [50, 96, 161], "aren": [50, 179, 183], "realli": [50, 161, 222], "lock": 50, "obj_a": 50, "obj_b": 50, "_b": [51, 53, 72, 73, 74, 206], "cmessag": [51, 53, 72, 73, 74, 206], "descriptor": [51, 53, 72, 73, 74, 83, 206], "googl": [51, 53, 72, 73, 74, 122, 186, 206], "pyext": [51, 53, 72, 73, 74, 206], "_messag": [51, 53, 72, 73, 74, 206], "messagedescriptor": [51, 53, 72, 73, 74, 206], "itemsentri": 51, "hyperparamrep": 51, "hyperparamvalu": 51, "bool_val": 51, "dict_val": 51, "dtype_v": 51, "enum_v": 51, "float_val": 51, "int_val": 51, "list_val": 51, "named_tuple_v": 51, "param_v": 51, "proto_v": 51, "string_repr_v": 51, "string_val": 51, "symbolic_v": 51, "tuple_v": 51, "type_v": 51, "protov": 51, "enumv": 51, "namedtuplev": 51, "inferencedeviceopt": 52, "retain_device_plac": 52, "var_opt": 52, "gen_init_op": 52, "dtype_overrid": 52, "fprop_dtype_overrid": 52, "guaranteeconstgett": 52, "next_creat": [52, 83], "constguaranteescop": 52, "noconstguaranteescop": 52, "disallow": [52, 195], "const": [52, 83, 91], "_dummyscop": 52, "_getvarnam": 52, "_makevariabledictionari": 52, "istpu": 52, "device_opt": 52, "isgpu": 52, "shouldforcebfloat16forweightsandactiv": 52, "shouldforcebfloat16foractiv": 52, "convertsubgraphdicttoproto": 52, "subgraphs_dict": 52, "getoutputopnam": 52, "inference_graph_proto": 52, "preserve_colocation_nod": 52, "preserve_saver_restore_nod": 52, "preserve_extra_op": 52, "saver_def": [52, 53], "_paramexist": 52, "param_obj": 52, "param_nam": [52, 80], "_freezegraphfromcheckpoint": 52, "output_op_nam": 52, "graphdef": [52, 71], "_freezedefault": 52, "inferencegraphexport": [52, 78], "model_cfg": 52, "inference_fn_nam": 52, "inference_fn_kwarg": 52, "freeze_checkpoint": 52, "freeze_default": 52, "export_path": 52, "subgraph_filt": 52, "disable_packed_input": 52, "prune_graph": [52, 228], "export_graph_collect": 52, "piecewis": [52, 83, 96, 100, 111], "enable_assert": [52, 84], "pin_vars_to_cpu": 52, "getparam": [52, 78, 127, 128], "modelnam": 52, "serv": [52, 58], "ascii": [52, 71], "_setclusterparam": 52, "_devicesupportsfreez": 52, "collectiondefentri": 53, "feedfetchmeta": 53, "data_typ": 53, "dispatch_stride_axi": 53, "quantized_max_const": 53, "quantized_max_tensor": 53, "quantized_min_const": 53, "quantized_min_tensor": 53, "quantized_num_bit": 53, "feedsentri": 53, "feedsmetaentri": 53, "fetchesentri": 53, "fetchesmetaentri": 53, "feeds_meta": 53, "fetches_meta": 53, "subgraphmeta": 53, "subgraphsentri": 53, "asset_file_def": 53, "collection_def": 53, "graph_def": [53, 78], "hyperparamet": [53, 82, 83, 86, 111], "computesplit": 54, "floor": [54, 83], "remaind": 54, "splittensor": 54, "evenli": [54, 71, 83], "dimenion": 54, "splitdictoftensor": 54, "t_dict": 54, "input_param": 55, "kermit": [56, 195, 199], "1906": [56, 195, 199], "01604": [56, 195, 199], "1902": [56, 58, 195, 199], "03249": [56, 195, 199], "sequencetrimlasttoken": 56, "trim": [56, 83, 108], "x_len_max": 56, "sequenceappendtoken": 56, "sequenceconcat": 56, "y_pad": 56, "y_len_max": 56, "symbolinsertionlay": 56, "rollin": 56, "canva": [56, 199], "force_sample_last_token": 56, "groundtruth": [56, 64], "english": [56, 202, 203, 205], "time_dim": [56, 195, 199], "rollin_polici": [56, 199], "c_dim": [56, 199], "canvas_indic": [56, 199], "canvas_pad": [56, 199], "target_indic": [56, 195, 199], "num_target": 56, "gather_nd": [56, 195, 199], "target_weight": [56, 83, 135, 195, 197, 199], "_isdefinableparamet": 57, "kind": 57, "positional_or_keyword": 57, "keyword_onli": 57, "var_posit": 57, "var_keyword": 57, "positional_onli": 57, "_extractparamet": 57, "defineparam": 57, "statement": [57, 83], "yourself": 57, "_makearg": 57, "callwithparam": 57, "constructwithparam": 57, "deconvlay": 58, "deconv": 58, "transpos": [58, 92, 108, 191], "convtransposelay": 58, "simpler": [58, 71, 80, 94], "deconvolut": 58, "height_strid": 58, "width_strid": 58, "identitylay": 58, "baseconv2dlay": 58, "filter_output_shap": 58, "arithmet": [58, 64, 83, 86], "_is_bn_fold": 58, "fold": 58, "filter_w": 58, "data_format": 58, "lower": [58, 76, 77, 116, 151], "depthwise_conv2d": 58, "convolution_lambda": 58, "folded_bn_pad": 58, "cast_dtyp": 58, "fuse": [58, 62, 141], "sens": [58, 86, 105, 125, 179, 228], "cnn": [58, 138, 154], "_comput": 58, "conv_pad": 58, "prop": [58, 91], "_computeconvlast": 58, "convnn2dlay": 58, "atrou": 58, "space_to_batch": 58, "batch_to_spac": 58, "tflite": [58, 83], "convlay": 58, "separableconv2dlay": 58, "term": [58, 83, 195], "deleg": [58, 83, 102, 106, 146], "cin": 58, "cout": 58, "pointwis": 58, "reconfigur": 58, "projectionlay": 58, "_getblockedmatmulinputoutputmultipli": 58, "_getblockedweightmatrix": 58, "_getblockdiagonalinitscal": 58, "dense_shap": 58, "output_qact_nam": 58, "qact": [58, 86, 91], "fpropfullsequ": [58, 92, 196], "weight_norm": 58, "batch_norm": 58, "_applyprojectionkernel": 58, "with_activ": 58, "quant": 58, "mix_kernel": [58, 83], "engin": [58, 86], "esp": [58, 152], "recogn": [58, 65], "_applyactivationfunct": 58, "fclayer": 58, "feedforwardnet": 58, "fpropalllay": 58, "hidden_layer_dim": 58, "stackingovertim": 58, "learnabl": 58, "windows": 58, "window_s": 58, "_applystack": 58, "pad_valu": [58, 92], "stacking_window_length": 58, "unstack": [58, 100], "invert": 58, "this_lay": 58, "reconstruct": 58, "longer": [58, 78, 83, 151, 197], "shorter": [58, 71], "rnn_dim": [58, 161], "rnn_out": [58, 135], "rnn": [58, 62, 68, 71, 83, 86, 87, 91, 92, 104, 106, 135, 138, 161, 195, 196], "back_projected_rnn_out": 58, "padortrimto": [58, 83], "getshap": [58, 83], "respons": [58, 92, 140, 179], "feature_dim": [58, 138, 191], "poolinglay": 58, "preced": [58, 109], "blurpoollay": 58, "blurpool": 58, "11486": 58, "blur": 58, "subsampl": [58, 140], "afterward": 58, "2x1": 58, "2x2": [58, 119], "singleshardembeddinglay": 58, "medium": 58, "50k": 58, "unif": 58, "embeddinglay": [58, 82, 105], "simpleembeddinglay": 58, "cleanup": [58, 80], "nmt": [58, 197, 199, 202, 203, 205, 219], "tt": 58, "deeprank": 58, "changetosimpleembed": 58, "switch": [58, 83, 161], "simpleembed": 58, "lose": 58, "scale_by_sqrt_dim": 58, "1k": 58, "emblookupdefaulttheta": 58, "emblookup": [58, 59, 105, 117], "min_params_per_shard": 58, "262144": [58, 167], "toco": 58, "use_matmul": 58, "use_gath": 58, "neither": [58, 179], "comparison": [58, 197], "_fpropimpl": 58, "ids_vec": 58, "emblookupdefaultthetaoncpu": 58, "_flatfprop": 58, "flatten": [58, 70, 83, 108, 114, 179, 189, 191], "einsumembeddinglay": 58, "onehotembeddinglay": 58, "hot": [58, 83, 145, 179, 196], "uncertainti": [58, 193], "positionalembeddinglay": 58, "tensor2tensor": 58, "common_attent": 58, "_posembeddingsfromposit": 58, "fpropwithposit": 58, "embedding_dim": [58, 105, 117, 164, 193], "positionanl": 58, "precursor": 58, "possibl": [58, 71, 83, 94, 102], "sin": 58, "express": [58, 140], "geometr": [58, 97], "min_timescal": 58, "max_timescal": 58, "position_tensor": 58, "learnablepositionalembeddinglay": 58, "relativepositionalembeddinglay": 58, "relative_dist": 58, "sinusoidalpositionalembeddinglay": 58, "tune": [58, 77, 182, 186], "blog": 58, "ron": 58, "colab": 58, "kazemnejad": 58, "transformer_architecture_positional_encod": 58, "softmaxlay": [58, 161], "wm_transpos": 58, "wm": [58, 91], "denseweight": 58, "xentlossfromlogit": 58, "xent": [58, 135, 161, 195], "xentloss": 58, "_fprop2d": 58, "class_weight": [58, 60, 161], "class_id": [58, 60, 161], "class_prob": [58, 60, 161], "num_class": [58, 60, 64, 83, 135, 179], "membership": [58, 60, 161], "per_example_argmax": [58, 60], "argmax": [58, 60, 83], "per_example_x": [58, 60], "per_example_weight": [58, 60], "total_x": [58, 60], "total_weight": [58, 60, 64, 83], "avg_xent": [58, 60], "total_loss": [58, 60], "simplefullsoftmax": [58, 60], "somewhat": 58, "_getinput": [58, 107], "_logitsusingconcatenatedweightshelp": 58, "_logitsusingconcatenatedweight": 58, "simplelogit": 58, "_xentlossbychunk": 58, "simplefullsigmoidcrossentropi": 58, "focalfullsoftmax": 58, "focal": [58, 83], "1708": [58, 83], "02002": [58, 83], "scone": 58, "2205": 58, "00704": 58, "einsumsoftmax": 58, "sharedsoftmaxlay": 58, "ty": 58, "singleshardfullsoftmax": 58, "xentlossbychunk": 58, "singleshardsharedembeddingsoftmax": 58, "convsoftmax": 58, "1x1": 58, "noise_shap": [58, 83], "deterministicdropoutlay": 58, "1607": [58, 91], "06450": [58, 91], "_getscaleandbia": 58, "reshapedlayernorm": 58, "resp": [58, 59], "augment": [58, 59, 87, 91, 100, 101, 134, 188], "categoricallayernorm": 58, "class_index": 58, "_biasvarnam": 58, "_scalevarnam": 58, "convsetlay": 58, "time_mod": 58, "frequency_mod": 58, "out_channel_1": 58, "out_channel_2": 58, "out_channel_i": 58, "localizedlabelsmooth": 58, "1612": 58, "02695": 58, "nearbi": 58, "strong": 58, "target_label": [58, 135, 195, 197], "target_id": [58, 60, 71, 116, 135, 195, 197], "1hot": 58, "neighborhood": 58, "uniformlabelsmooth": 58, "confid": 58, "1512": 58, "00567": 58, "highwayskiplay": 58, "highwai": 58, "open": 58, "srivastava": 58, "1505": 58, "00387v2": 58, "transformed_x": 58, "layer_out": 58, "gatinglay": 58, "w_1": 58, "w_2": 58, "gradnormtrack": 58, "grad_norm": 58, "has_nan": 58, "avg": [58, 64, 83], "excess": [58, 71, 76], "abort": 58, "weightedsumlay": [58, 60], "gatedaveragelay": 58, "x_1": 58, "x_n": 58, "g_1": 58, "g_n": 58, "gm": 58, "num_nod": 58, "lhuclay": 58, "contribut": [58, 83, 162], "lhuc": 58, "propos": [58, 59, 96], "aclweb": [58, 199], "anthologi": [58, 199], "n18": 58, "2080": 58, "frozen": 58, "residualadapterlay": 58, "nlp": [58, 189], "fine": [58, 77, 86, 179, 182, 183, 186], "bert": [58, 167, 168, 173, 181, 188], "00751": 58, "vanilla": 58, "distinguish": 58, "conv2dflop": 58, "mult": 58, "four": [58, 152], "conv2dlayernopad": 58, "laurenzo": [58, 140], "dedup": 58, "fetchlay": 58, "_returnsinglevalueorlist": 58, "lst": [58, 70, 97], "glulay": 58, "08083": 58, "multitaskadapterbaselay": 58, "multilingu": 58, "domain": [58, 86, 100], "down": [58, 76, 83, 96, 151, 152, 224], "wherea": [58, 189], "multitaskadapterlay": 58, "tbc": 58, "btc": 58, "substanti": 58, "multitaskadaptereinsumlay": 58, "175464137": 58, "cctgatingnetwork": [58, 59], "07106": [58, 59], "condscaleshiftffnlay": 58, "pub": [58, 122], "2018": 58, "statisticalpoolinglay": 58, "deviat": [58, 83, 86], "lshmemoryrankkonehottasklay": 58, "lsh": 58, "proceed": 58, "mlr": 58, "press": 58, "v130": 58, "panigrahy21a": 58, "html": [58, 100, 151, 152], "_computegridlshbucketid": 58, "lshtaskwithmultiplierlay": 58, "perframestatisticalpoolinglay": 58, "streamingstep": 58, "order1": 58, "order2": 58, "nframe": 58, "maskedlmdataaugment": 58, "1810": [58, 59], "04805": 58, "new_input": 58, "had": [58, 86], "undergon": 58, "rotarypositionalembeddinglay": 58, "2104": 58, "09864": 58, "jtensor": 58, "stochasticresiduallay": 59, "stocahst": 59, "branch": 59, "convnet": 59, "1603": 59, "09382": 59, "_dropconnect": 59, "surviv": 59, "five": 59, "context_vec": 59, "mask_typ": 59, "ey": 59, "leftward": 59, "gram": [59, 65, 97], "ngram": [59, 65, 71, 97], "mask_ngram_ord": 59, "04589": 59, "_initattent": [59, 135], "eg": [59, 60, 80, 125, 228], "_finishextendstep": 59, "unnormalized_query_vec": 59, "extended_packed_src": 59, "triplet": 59, "new_stat": [59, 135, 195], "prefix_st": [59, 195], "moefeedforwardlay": 59, "hybridfeedforwardlay": 59, "hybrid": [59, 199], "choosen": 59, "hybrid_p": 59, "fflayer_p": 59, "moe_p": 59, "sub_kei": 59, "hybrid_fflay": 59, "symboltovaluemap": [59, 109], "static_valu": 59, "outputs_mo": 59, "transformershardedmoelay": 59, "ln_input": 59, "moe_output": 59, "drop_output": 59, "upstream": [59, 179], "compon": [59, 71, 136], "reshapedtransformerfeedforwardlay": 59, "transformerfeedforward": 59, "aux_segment_id": [59, 60, 198], "scheme": [59, 60, 83, 91], "source_": [59, 60], "fork": [59, 60, 189], "aux_tim": [59, 60, 198], "aux_batch": [59, 60], "evolvedtransformerencoderbranchedconvslay": 59, "evolv": [59, 60], "portion": [59, 83, 100], "11117": [59, 60], "evolvedtransformerdecoderbranchedconvslay": 59, "evolvedtransformerbaselay": 59, "evolvedtransformerencoderlay": [59, 60], "evolvedtransformerdecoderlay": [59, 60], "stylelay": 59, "style": [59, 86, 91, 152, 177, 186], "styleembfromprob": 59, "feedin": 59, "num_styl": 59, "style_emb": 59, "transformerlayerwithmultitaskadapt": 59, "source_task_id": [59, 60], "cctattentionlay": 59, "cct": 59, "cctfeedforwardlay": 59, "transformerwithcontextlay": 59, "third": [59, 62, 83, 92], "newli": 59, "tertiary_atten": 59, "03581": 59, "tertiary_vec": 59, "tertiary_pad": 59, "tertiary_segment_id": 59, "tertiary_tim": 59, "tertiary_batch": 59, "tertiari": 59, "selfattentivelay": 59, "1703": [59, 91, 135], "03130": 59, "_common_gpipe_transformer_param": 60, "_common_gpipe_transformer_init": 60, "_common_gpipe_transformer_encoder_fprop": 60, "layer_class": 60, "target_segment_id": [60, 195], "transparent_acc": 60, "transparent_acc_help": 60, "target_task_id": 60, "_common_gpipe_transformer_decoder_fprop": 60, "_common_gpipe_transformer_fprop_meta": 60, "gpipetransformerlay": 60, "transformerstack": [60, 98, 196, 198], "gpipeevolvedtransformerencoderlay": 60, "_attentionsetupdeterministicdropout": 60, "tr_atten_tpl": 60, "_transformersetupdeterministicdropout": 60, "transformer_tpl": 60, "et": [60, 181], "gpipeevolvedtransformerdecoderlay": 60, "gpipetransformersoftmaxlay": 60, "gpipetransformerembeddinglay": 60, "getembed": 60, "emb_theta": 60, "pos_emb_theta": 60, "pos_emb": 60, "dropout_theta": 60, "input_id": [60, 79, 92], "input_segment_po": 60, "task_emb_theta": 60, "task_emb": [60, 196], "getencoderembeddingsdefaulttheta": 60, "getdecoderembeddingsdefaulttheta": 60, "source_segment_po": 60, "target_segment_po": 60, "gpipetransformerstack": 60, "getencod": 60, "getdecod": 60, "encoderembedfpropdefaulttheta": 60, "decoderembedfpropdefaulttheta": 60, "tgt_task_id": 60, "encoderfpropdefaulttheta": 60, "source_input": 60, "target_input": 60, "label_weight": 60, "transformer_output": 60, "gpipeevolvedtransformerstack": 60, "evolvedtransformerstack": 60, "deterministicweightslay": 60, "num_sourc": 60, "gpipebatchmajortransformersoftmaxlay": 60, "gpipebatchmajortransformerembeddinglay": 60, "gipe": 60, "disjoint": 61, "getvargrad": 61, "gettrainablevari": [61, 83], "applyposttrainingloop": [61, 76], "trainin": [61, 76], "learningr": 61, "gradient_mask": 61, "gradient_adjust": 61, "loss_nam": 61, "mutat": [61, 188], "var_grad": [61, 76, 83, 162], "_customcomputegradientsfn": 61, "compute_gradients_fn": [61, 83], "computegradi": [61, 76, 83], "_computelossesandgradi": 61, "_getglobalgradscal": 61, "all_grad_norm": 61, "has_nan_or_inf": 61, "inf": [61, 83], "represet": 61, "scalegradi": 61, "final_var_grad": 61, "grad_scal": [61, 83], "_addevalmetr": 61, "extractlearnerfromlegacyparam": 61, "Its": [61, 102, 114, 117], "lstm": [62, 82, 86, 91, 92, 162, 193], "frnn": [62, 92], "lstmcellext": 62, "projectinputsequ": 62, "notabl": 62, "reason": [62, 71, 76, 83, 179], "wm_i": 62, "wm_h": 62, "_mixwithprojectedinput": 62, "_mix": [62, 91], "fpropwithprojectedinput": 62, "proj_input": 62, "reset_mask": [62, 91, 92], "backprop": [62, 83, 87, 91], "lstmcellsimpleext": 62, "lstmcellsimpl": [62, 91, 161], "layernormalizedlstmcellsimpleext": 62, "layernormalizedlstmcellsimpl": [62, 91, 161], "layernormalizedlstmcellleanext": 62, "layernormalizedlstmcelllean": [62, 91], "lstmfrnn": 62, "exploit": 62, "cardin": [62, 92], "inputs_ar": [62, 92], "matrix_square_root": 63, "mat_a": 63, "mat_a_s": 63, "iter_count": 63, "ridge_epsilon": 63, "nichola": 63, "higham": 63, "231": [63, 166], "6b": 63, "citeseerx": 63, "ist": 63, "psu": 63, "edu": [63, 100], "viewdoc": 63, "download": [63, 170, 188, 215], "doi": 63, "8799": 63, "rep": 63, "rep1": 63, "symmetr": [63, 86], "psd": 63, "ridg": 63, "inlined_matrix_inverse_pth_root": 63, "mat_g": 63, "mat_g_siz": 63, "error_toler": 63, "schur": 63, "newton": 63, "invers": [63, 71, 83, 86, 96, 111, 191], "chun": 63, "hua": 63, "guo": 63, "siam": 63, "journal": 63, "analysi": [63, 228], "vol": 63, "28": [63, 166, 167], "No": [63, 71, 83, 90, 102], "pp": 63, "788": 63, "804": 63, "semanticscholar": 63, "0abe": 63, "7f77433cf5908bfe2b79aa91af881da83858": 63, "power": [63, 71], "createscalarsummari": 64, "simple_valu": 64, "tag": [64, 66, 80, 86, 91, 131, 136, 145, 224, 228], "configurablemetr": 64, "averagemetr": 64, "gettotalvalu": 64, "settotalvalu": 64, "total_valu": 64, "gettotalweight": 64, "settotalweight": 64, "uniqueaveragemetr": 64, "mismatch_is_error": 64, "f1metric": 64, "updatetrueposit": 64, "updatefalseposit": 64, "updatefalseneg": 64, "mccmetric": 64, "matthew": 64, "correl": 64, "updatetrueneg": 64, "corpusbleumetr": 64, "corpu": [64, 164, 212, 215, 219], "bleu": [64, 65, 97], "ref_str": [64, 65, 97, 137], "hyp_str": [64, 65, 97, 137], "unsegment": [64, 97], "tpuevalmetr": 64, "max_metr": 64, "256": [64, 166, 167], "hardcod": 64, "setmetr": 64, "metric_dict": 64, "step_arg": 64, "_metric": 64, "initial_valu": [64, 96], "_zip": 64, "finalizemetr": 64, "loop_result": 64, "batch_parallel": 64, "packmetricsvalu": 64, "toaveragemetr": 64, "aucmetr": 64, "roc": 64, "auc": [64, 83], "_precisionatrecal": 64, "recal": [64, 152], "_recallatprecis": 64, "precis": [64, 86, 97, 154, 179], "precisionatrecal": 64, "recall_threshold": 64, "recallatprecis": 64, "precision_threshold": 64, "multiclassaucmetr": 64, "mauc": 64, "multiclass": 64, "multilabel": 64, "perspect": [64, 86], "pr": [64, 83], "curv": [64, 77, 83], "teh": 64, "correlationmetr": 64, "pearson": 64, "pred": [64, 78], "averagekeyedcorrelationmetr": 64, "bypass_nan": 64, "samplingmetr": 64, "_createsummari": 64, "decoded_output": 64, "mlperf": [65, 66, 67, 71, 160, 167, 197], "is_unicod": 65, "to_unicod": 65, "ignore_error": 65, "native_to_unicod": 65, "_get_ngram": 65, "max_ord": 65, "compute_bleu": 65, "reference_corpu": 65, "translation_corpu": 65, "use_bp": 65, "breviti": 65, "bleu_scor": 65, "unused_kwarg": [65, 80, 188], "glue": 65, "gold": 65, "approx": 65, "unicoderegex": 65, "hoc": 65, "property_char": 65, "bleu_token": 65, "bleu_wrapp": 65, "ref_lin": 65, "hyp_lin": 65, "case_sensit": 65, "mlperfbleumetr": 65, "impelment": 65, "complianc": 66, "stdout": 66, "get_cal": 66, "stack_index": 66, "root_dir": 66, "mlperf_format": 66, "stack_offset": 66, "mlperf_print": 66, "mlperftoken": 67, "basetoken": [67, 116, 136, 168], "createunidirectionalrnnparam": 68, "cell_param": 68, "uni": [68, 196], "unidi_rnn_typ": 68, "createbidirectionalrnnparam": [68, 138], "forward_cell_param": 68, "backward_cell_param": 68, "bi": [68, 196], "bidi_rnn_typ": 68, "sharedencodermodel": 69, "sharedencoderdecodermodel": 69, "regexsharedvariablemodel": 69, "NOT": 69, "try": [69, 70, 81, 83, 87, 94, 127, 135, 195], "inde": [69, 86], "_fromnesteddict": 70, "_has_dynamic_attribut": 70, "_reserved_kei": 70, "frozenset": 70, "__class__": 70, "__class_getitem__": 70, "__contains__": 70, "__delattr__": 70, "__delitem__": 70, "__dir__": 70, "__doc__": 70, "__eq__": 70, "__format__": 70, "__ge__": 70, "__getattribute__": 70, "__getitem__": 70, "__gt__": 70, "__hash__": 70, "__init_subclass__": 70, "__ior__": 70, "__iter__": 70, "__le__": [70, 197], "__len__": 70, "__lt__": 70, "__ne__": 70, "__new__": 70, "__or__": 70, "__reduce__": 70, "__reduce_ex__": 70, "__reversed__": 70, "__ror__": 70, "__setattr__": 70, "__setitem__": 70, "__sizeof__": 70, "__str__": 70, "__subclasshook__": 70, "fromkei": 70, "pop": 70, "popitem": 70, "setdefault": 70, "_delet": 70, "deepcopi": 70, "nestedmapt": 70, "leaf": [70, 88], "fromnesteddict": 70, "tonesteddict": 70, "relev": [70, 83, 195], "checkkei": 70, "squarebracketindex": 70, "getitem": 70, "idx": [70, 80], "wasn": 70, "referenc": 70, "throw": 70, "key_part1": 70, "key_part2": 70, "key_partn": 70, "key_part": 70, "_recursivemap": 70, "flattenitem": 70, "baz": [70, 191], "transformwithkei": 70, "iscompat": [70, 83, 91], "vice": [70, 179], "versa": [70, 179], "filterkeyv": 70, "debugstr": 70, "vlog": 70, "assert_shape_match": [71, 83], "msg": [71, 80, 114], "assert_same_dim0": [71, 83], "random_permutation_sequ": 71, "epoch": [71, 175], "outofrangeerror": [71, 175], "tol": 71, "event": [71, 114], "path_to_fil": 71, "tfevent": 71, "greater": 71, "amount": [71, 76, 87, 93, 224], "beam_search_step_deprec": 71, "best_scor": 71, "cumulative_scor": 71, "in_scor": 71, "in_hyp": 71, "in_prev_hyp": 71, "in_done_hyp": 71, "in_atten_prob": 71, "eoc_id": 71, "valid_eos_max_logit_delta": 71, "local_eos_threshold": 71, "merge_path": 71, "allow_empty_terminated_hyp": 71, "ensure_full_beam": 71, "force_eos_in_last_step": 71, "beamsearchstepv2": 71, "beam_independ": 71, "out_best_scor": 71, "out_cumulative_scor": 71, "out_scor": 71, "out_hyp": 71, "out_prev_hyp": 71, "out_done_hyp": 71, "out_atten_prob": 71, "in_beam_don": 71, "force_eos_in_top_k": 71, "force_last_chunk_eoc_in_top_k": 71, "merged_topk_buffer_size_factor": 71, "atten_vecs_in_hypothesis_proto": 71, "alloc": [71, 161], "cur": [71, 91], "s_len": 71, "invoc": [71, 87, 102, 104, 106], "source_len": [71, 108, 135, 195], "explain": [71, 195], "exce": [71, 76, 116, 171], "threashold": 71, "awai": 71, "candid": [71, 91], "nt": [71, 135], "okai": [71, 197], "utter": [71, 144, 223], "silenc": 71, "embr": [71, 135], "prone": 71, "absenc": 71, "AND": 71, "inject": [71, 91, 134], "eoc": 71, "beam_id": [71, 72], "atten_vec": [71, 72], "out_beam_don": 71, "top_k_terminated_hyp": 71, "src_seq_length": 71, "length_norm": 71, "coverage_penalti": 71, "target_seq_length_ratio": 71, "src": [71, 88, 104, 171, 197, 199, 209], "highest": 71, "unpack_hyp": 71, "max_seq_length": [71, 104, 135], "unpack": [71, 83], "out_id": 71, "out_seq_len": 71, "deriv": [71, 90, 100, 136, 188], "longest": 71, "input_hyp": 71, "hyps_from_beam_search_out": 71, "prev_hyp": 71, "eos_scor": 71, "eos_atten_prob": 71, "fix_hyp_atten_vec": 71, "obsolet": [71, 94], "top_k_from_beam_search_out": 71, "cumulative_atten_prob": 71, "populate_topk_hyp": 71, "hypsfrombeamsearchout": 71, "topkterminatedhyp": 71, "unpackhyp": 71, "div": 71, "mod": 71, "assembl": [71, 102], "summat": 71, "strictli": 71, "cached_cal": 71, "memor": 71, "vocab_token_to_id": 71, "load_token_ids_from_vocab": 71, "colum": 71, "vocab_id_to_token": 71, "token_in_vocab": 71, "ascii_to_token_id": 71, "300": [71, 166], "pad_to_maxlen": 71, "token_id": [71, 116], "str_to_vocab_token": 71, "vocab_filepath": [71, 219], "white": [71, 100], "filepath": [71, 219], "id_to_ascii": 71, "ml_perf_subword_id_to_str": 71, "subword": [71, 219], "ngram_id_to_token": 71, "ngram_vocab_filepath": 71, "ngram_separ": 71, "join": 71, "bpe_ids_to_word": 71, "bpe": [71, 97, 116, 219], "conjunct": 71, "bpewordstoid": 71, "inbetween": 71, "bpe_words_to_id": 71, "tokenization_filepath": 71, "sos_id": [71, 83], "especi": 71, "sequenec": 71, "bpeidstoword": 71, "receiv": [71, 99], "aaron": 71, "10005": 71, "3466": 71, "aaronson": 71, "447": [71, 166], "static_map_string_int": 71, "unk": 71, "static_map_int_str": 71, "static_map_int_int": 71, "get_precondition": 71, "preconditioner_compute_graphdef": 71, "status": 71, "compute_precondition": 71, "pack_sequ": 71, "src_actual_seq_len": 71, "tgt_actual_seq_len": 71, "packed_batch_s": 71, "packed_src_seq_len": 71, "packed_tgt_seq_len": 71, "packsinglesequ": 71, "src_segment_id": [71, 92, 198], "src_segment_po": 71, "src_indices_in_input": 71, "tgt_indices_in_input": 71, "too": [71, 83, 197], "output_shap": 71, "remain": [71, 83, 96], "packed_": 71, "_seq_len": 71, "src_input_seq_len": 71, "tgt_input_seq_len": 71, "disambigu": [71, 197], "pack_single_sequ": 71, "input_length": 71, "max_packed_length": 71, "require_sequential_ord": 71, "indices_in_input": 71, "apply_pack": 71, "rearrang": 71, "packsequ": 71, "applypack": 71, "packed_seq_len": 71, "actual_seq_len": [71, 194], "mask_id": 71, "mask_ratio": 71, "mask_minlen": 71, "span_len": 71, "100000": 71, "random_start_prob": 71, "rand_prob": 71, "mask_prob": 71, "mask_target": 71, "first_unreserved_id": 71, "max_seq_len": [71, 188], "mask_len": 71, "tgt_weight": 71, "s1": 71, "s2": 71, "s3": 71, "bo": 71, "s4": 71, "s5": 71, "attenvec": 72, "normalized_scor": 72, "fieldsentri": 73, "versionedfileset": 74, "fileset": 74, "create_timestamp": 74, "getlrvalu": 76, "lr_or_cal": 76, "getoptim": [76, 166], "lr": [76, 96, 166], "addsummari": 76, "varreuseforslotvar": 76, "auto_reus": 76, "getlrschedulevalu": 76, "lr_schedule_cal": 76, "dynamicaccumul": 76, "suppos": [76, 191], "vari": [76, 83, 135], "did": 76, "compositeoptim": 76, "optimizer_map": 76, "default_optim": 76, "adam": [76, 117, 166, 182, 193], "sgd": [76, 117], "thrown": [76, 80], "rmsprop": 76, "adadelta": 76, "paramsa": 76, "paramsb": 76, "adamv2": 76, "accum_weight": 76, "happen": [76, 83, 87, 94, 121, 135, 141], "min_accum_weight": 76, "_stepnum": 76, "_adafactordecayratepow": 76, "decai": [76, 83, 86, 96, 193], "grow": [76, 88], "step_num": 76, "_adafactordecayrateadam": 76, "beta2": [76, 166], "subsum": 76, "xlashardingadafactoroptim": 76, "multiply_by_parameter_scal": 76, "decay_r": 76, "beta1": [76, 166, 167], "clipping_threshold": 76, "epsilon1": 76, "30": [76, 166, 167], "epsilon2": 76, "min_dim_size_to_factor": 76, "use_lock": [76, 121, 166], "cond_is_finit": 76, "adafactor": 76, "_factored_dim": 76, "_parameter_scal": 76, "chanc": [76, 179], "imput": 76, "try_apply_dens": 76, "xlashardingadafactor": 76, "gradientaggregationoptim": 76, "opt": [76, 171, 228], "num_micro_batch": [76, 161, 164, 166], "apply_crs_to_grad": 76, "hardwar": [76, 117], "demand": [76, 80], "difficult": 76, "simul": [76, 86], "caveat": [76, 117], "trade": 76, "compute_gradi": 76, "apply_gradi": [76, 83], "grads_and_var": 76, "get_slot": 76, "get_slot_nam": 76, "xlashardingadafactoraccugrad": 76, "matplotlib": [77, 108], "tounicod": 77, "addplot": 77, "unused_fig": 77, "ax": [77, 83, 86, 108, 191], "titl": 77, "xlabel": 77, "ylabel": 77, "fontsiz": 77, "xlim": 77, "ylim": 77, "suppress_xtick": 77, "suppress_ytick": 77, "addimag": [77, 108], "fig": [77, 108], "cmap": 77, "bone_r": 77, "clim": 77, "show_colorbar": 77, "aspect": [77, 86], "vmin": 77, "vmax": 77, "addscatterplot": 77, "_subplotmetadata": 77, "plot_func": 77, "matplotlibfiguresummari": [77, 108], "figsiz": 77, "max_output": [77, 108], "subplot_grid_shap": 77, "gridspec_kwarg": 77, "shared_subplot_kwarg": 77, "sever": [77, 139, 193], "subplot": 77, "fig_help": 77, "summary_nam": [77, 80], "addsubplot": [77, 108], "tensor1": 77, "tensor2": 77, "image_summari": 77, "plot_fun": 77, "realiz": 77, "data1": 77, "data2": 77, "datan": 77, "finalizeimag": 77, "creation": [77, 83], "overal": [77, 97, 108, 190], "_renderonematplotlibfigur": 77, "numpy_data_list": 77, "_rendermatplotlibfigur": 77, "render": 77, "unconvent": 77, "py_func": 77, "inch": 77, "uint8": 77, "figuretosummari": 77, "setter": 77, "accept": [77, 80, 83, 102, 140, 188], "pyplot": 77, "imshow": 77, "xtick": 77, "visual": 77, "addmulticurvesubplot": 77, "legend": 77, "_addmulticurverowplot": 77, "x_label_overrid": 77, "row_label": 77, "cut": [77, 87], "mymodel": [78, 145], "inference_graph": [78, 79], "tmp": [78, 83, 164, 202, 203, 205, 212, 228], "00000000": 78, "src_string": 78, "hello": 78, "world": [78, 199], "loadinferencegraph": 78, "clear_device_plac": 78, "subgraph_nam": [78, 145, 154, 162, 210], "device_typ": [78, 79], "session_config": 78, "load_graph_def_from_inference_graph": 78, "_load_graph_from_inference_graph": 78, "fetch_kei": 78, "feed_kei": 78, "fetch_shap": 78, "feed_shap": 78, "_get_subgraph": 78, "_get_subgraph_fetch": 78, "_get_subgraph_fe": 78, "subgraph_fetch_kei": 78, "subgraph_feed_kei": 78, "subgraph_fetch_shap": 78, "subgraph_feed_shap": 78, "_create_new_sess": 78, "_sess": 78, "_maybe_create_new_sess": 78, "sess_id": 78, "_run_with_valid_sess": 78, "_loadcheckpoint": 78, "validate_fetch": 78, "session_run_opt": 78, "run_metadata": 78, "time_session_run": 78, "dict_kei": 78, "runopt": 78, "runmetadata": 78, "invalidargumenterror": [78, 83], "meet": [78, 87], "predictorrunnerbas": 79, "runbatch": 79, "xla_devic": 79, "url": 79, "server": 79, "inference_thread": 79, "num_tpu_cor": 79, "output_dir": [79, 188], "inference_subgraph_nam": 79, "output_num_shard": 79, "output_shard_id": 79, "max_input": 79, "input_id_filt": 79, "prediction_step_interv": 79, "3000": 79, "fromflag": 79, "_shouldprocessinputid": 79, "_outputfilenam": 79, "_output_num_shard": 79, "_predictonecheckpoint": 79, "_predictcontinu": 79, "monitor": 79, "_rewritev1summaryintf2": 80, "baseprogram": 80, "shared_model": 80, "inspir": [80, 199], "tenanc": 80, "jit": 80, "signific": 80, "delai": 80, "steps_per_loop": 80, "_setprogramdir": 80, "_initializevizi": 80, "vizier": 80, "_summary_writ": 80, "filewrit": 80, "_summarizevalu": [80, 131, 228], "tensorboard": [80, 83, 195, 224], "_writeinputdatastat": 80, "_infeedloopforinput": 80, "inp_inst": 80, "_infeedloop": [80, 131, 228], "_reportviziermetr": 80, "bee": 80, "vizier_early_stop": 80, "buildtpusubgraph": 80, "tpu_funct": 80, "on_device_training_loop": 80, "setstatusmessagefn": 80, "workaround": 80, "setstatusmessag": 80, "borglet": 80, "initinput": 80, "threadpool": 80, "shutdown": 80, "saveprogramst": 80, "loadprogramst": 80, "restored_checkpoint_path": 80, "_instantiatetaskmodel": 80, "_outfeedenqueu": [80, 131, 228], "getmodel": 80, "inputbenchmark": 80, "trainprogram": 80, "_outfeeddequeueloop": [80, 131, 228], "num_loop": [80, 131, 228], "tputrainstep": [80, 131, 228], "tputrain": [80, 131, 228], "infeedtffunc": 80, "_shouldwritesummari": 80, "task_global_step": 80, "evalprogram": 80, "tpuevalstep": 80, "evalfunc": 80, "_updatecpupassthroughdata": 80, "cpu_pt": 80, "_fetchdecodeout": 80, "tpu_out": 80, "decodeprogram": 80, "_datasetsummarywrit": 80, "unused_dataset_nam": 80, "finalizecallback": 80, "unused_finalize_ret": 80, "_finalizedecod": 80, "decodefunc": 80, "decodefn": 80, "split_compile_and_shard": 80, "_decodeuntiloutofrangeinfeedloop": 80, "infeed_step_queu": 80, "outofrang": 80, "_decodestep": [80, 195], "dec_metr": [80, 199], "buffered_decode_out": 80, "postprocess_futur": 80, "_runpostprocess": 80, "decode_out_obj": 80, "postprocess": [80, 136, 144], "_postprocessstep": 80, "start_tim": 80, "runforinput": 80, "multiinputsdecodeprogram": 80, "finalize_ret": 80, "_inferstepsperloop": 80, "num_sampl": [80, 83, 140, 161, 164, 205], "drop_remaind": 80, "experimentaldecodeprogram": 80, "decodeloop": 80, "_outfeeddequeu": 80, "decode_nm": 80, "_decodeloop": 80, "_postprocess": 80, "elapsed_sec": 80, "_threadcal": 80, "break": [80, 94, 151, 152], "waitthread": 80, "mlperftraindecodeprogram": 80, "mlperfprogram": 80, "_trainanddecod": 80, "multitaskprogramschedul": 80, "simpleprogramschedul": 80, "train_program": 80, "eval_program": 80, "_createprogramparam": 80, "program_nam": 80, "decode_num_sampl": 80, "_checklengthorexpand": 80, "param_per_dataset": 80, "expected_len": 80, "simpleprogramschedulefortask": 80, "train_dataset_nam": 80, "train_steps_per_loop": [80, 119, 166, 167], "eval_dataset_nam": 80, "eval_steps_per_loop": 80, "decode_steps_per_loop": 80, "decode_trigger_offset": 80, "decode_trigger_interv": 80, "experimental_decod": 80, "multi_inputs_decod": 80, "train_program_cl": 80, "eval_program_cl": 80, "summary_exporter_cl": 80, "async_postprocess": 80, "experimental_async_postprocess": 80, "decode_until_out_of_rang": 80, "postprocess_all_at_onc": 80, "train_summary_interval_step": 80, "trigger_interv": 80, "trigger_offset": 80, "deocder": 80, "concurr": [80, 87], "But": [80, 87, 135, 197], "older": 80, "decodeout": 80, "flush": 80, "wether": 80, "_clearspecifiedprogram": 80, "program_list": 80, "program_cls_to_clear": 80, "updateprogramschedul": 80, "ps_param": 80, "dataset_list": 80, "decode_summary_email": 80, "oneoff_checkpoint_to_load": 80, "overriden": 80, "testset": 80, "checkpoint_to_load": 80, "mlperfprogramschedul": 80, "ml": 80, "perf": 80, "mlperfprogramschedulefortask": 80, "decode_dataset_nam": 80, "summarytocsv": 81, "csv": 81, "csvtosummari": 81, "decodestatuscach": 81, "program_dir": 81, "123": [81, 166], "rest": [81, 83, 121], "updateckpt": 81, "ckpt_kei": 81, "updatedataset": 81, "tryloadcach": 81, "success": [81, 97, 102], "triggerschedul": 81, "interv": [81, 100], "shouldrun": 81, "_isincollect": 82, "addtopruningcollect": 82, "old_weight": 82, "old_old_weight": 82, "usepruninginterfac": 82, "pruning_hparams_dict": 82, "applycompress": 82, "compress": 82, "flatembeddinglookup": 82, "emb_tabl": 82, "flat_id": 82, "matmul_axi": 82, "fprop_mod": 82, "number_id": 82, "pruningop": 82, "encapsul": [82, 83, 135, 179], "_pruning_hparams_dict": 82, "_global_step": 82, "_pruning_obj": 82, "_pruning_hparam": 82, "applyprun": 82, "lstmobj": 82, "weight_nam": [82, 86], "wm_pc": 82, "getmixresult": 82, "prune_opt": 82, "first_order_gradi": 82, "second_order_gradi": 82, "getlastcompressionop": 82, "getembeddinglookupresult": 82, "layer_obj": 82, "getpruningupd": 82, "applytensorflowupd": 82, "applypythonupd": 82, "applytensorflowandpythonupd": 82, "runpythonupd": 82, "assert_equ": 83, "assert_greater_equ": 83, "assert_great": 83, "assert_less_equ": 83, "assert_less": 83, "assert_between": 83, "assert_even_divid": 83, "denorm": 83, "assertidshap": 83, "expected_ids_shape_pattern": 83, "ids_shap": [83, 176], "_checknumer": 83, "checknumer": 83, "with_depend": 83, "_varincollect": 83, "_printopt": 83, "_print": 83, "simplifi": [83, 91, 182], "dbg": 83, "py_utils_test": 83, "429": [83, 166], "filename_prefix": [83, 94], "hasrank": 83, "expected_rank": 83, "syntact": 83, "sugar": 83, "hasatleastrank": 83, "getrank": 83, "ndim": 83, "hasshap": 83, "expected_shap": 83, "runtim": [83, 181, 182], "hassameshap": 83, "ref": [83, 97, 136, 137, 145, 151, 152], "getsiz": 83, "causalselfattenpad": 83, "linalg": 83, "band_part": 83, "outside_all_rewrit": 83, "runontpuhost": 83, "tpu_host": 83, "computew": [83, 137, 151], "wer": [83, 151, 152], "settpudeviceassign": 83, "tpu_device_assign": 83, "cleartpudevic": 83, "gettpudeviceassign": 83, "seteagermod": 83, "eager_mod": 83, "test_mod": 83, "iseagermod": [83, 114], "seteagerrngadapt": 83, "rng": 83, "gradienttap": [83, 114], "createemaformodel": 83, "sessionconfig": 83, "soft_plac": 83, "inlin": 83, "cluster_def": 83, "disable_meta_optim": 83, "allow_soft_plac": 83, "do_function_inlin": 83, "grappler": 83, "metagraph": 83, "assertiscompat": 83, "setshap": 83, "dst_nmap": 83, "src_nmap": 83, "nmap_list": 83, "tmpl": 83, "convertnonegradienttozero": 83, "dx": [83, 114], "sanit": 83, "lh": [83, 86], "rh": [83, 86], "_uniqu": 83, "uniqifi": 83, "touniquelist": 83, "readonlyattrdictview": 83, "tostaticshap": 83, "uniformsampl": 83, "reservoir": 83, "sampler": 83, "en": [83, 100, 122, 152, 202, 203, 205], "wikipedia": [83, 100, 152], "wiki": [83, 100, 152], "reservoir_sampl": 83, "rnncellstateinit": 83, "randomnorm": 83, "defaultrnncellstateinit": 83, "initrnncellst": 83, "is_ev": [83, 91, 141, 148, 202, 203], "implemetaiton": 83, "dype": 83, "stateless_vars_init": 83, "weightinit": 83, "custom_v_init": 83, "uniformposit": 83, "xavier": 83, "xavierwithfixupparam": 83, "layers_per_residual_block": 83, "fixup": 83, "geomeanxavi": [83, 91], "truncatedgaussian": 83, "truncated_norm": 83, "gaussiansqrtdim": 83, "gaussiansqrtfanin": 83, "fan_in": 83, "gaussiansqrtfanout": 83, "fan_out": 83, "gaussiansqrtfanavg": 83, "uniformsqrtdim": 83, "uniformunitsc": 83, "uniformunitscalingfanavg": 83, "variance_scaling_initi": 83, "kera": [83, 191, 225], "variancesc": 83, "truncatedgaussiansqrtdim": 83, "truncatedgaussiansqrtfanin": 83, "truncatedgaussiansqrtfanout": 83, "kaiminguniformfaninrelu": 83, "kaiminguniformfaninleakyrelu": 83, "23606797749979": 83, "customvarinit": 83, "customconstantvarinit": 83, "scaleddeltaorthogon": 83, "defaultparaminit": 83, "isdefaultparaminit": 83, "findneed": 83, "_collectiongett": 83, "default_factori": 83, "sanitizescopekei": 83, "unittestsessionscop": 83, "getunittestsess": 83, "opportunisticvariablereusescop": 83, "enable_opportunistic_reus": 83, "getopportunisticvariablereus": 83, "disablevariablenamecheck": 83, "taskcallscopenam": 83, "taskcallscop": 83, "gettaskcallscop": 83, "variablerenamescop": 83, "renam": [83, 87, 175], "regexp": 83, "new_name_format": 83, "interpol": [83, 96, 195, 196, 199], "getvariablenam": [83, 117], "untransform": 83, "scope_nam": 83, "variablelistdtyperegexscop": 83, "finddatatyp": 83, "generateseedfromnam": 83, "maybegenerateseedfromscop": 83, "generateseedfromid": 83, "obj_id": 83, "getvarleadingdimsascombinedlay": 83, "shape_prefix": 83, "getvariableshapeprefix": 83, "getvariablenumleadingdimsforcombinedlayerscontext": 83, "getfaninfanout": 83, "prefix_dims_to_skip": 83, "variablestor": 83, "default_stor": 83, "mimic": [83, 94, 117], "get_vari": 83, "regard": 83, "outermost": 83, "_getvariablestor": 83, "_defaultvariablecr": 83, "_getvariablecr": 83, "variablecreatorscop": 83, "variable_cr": 83, "creator": 83, "variable_creator_scop": 83, "upgrad": 83, "custom_gett": 83, "resolv": 83, "innermost": 83, "placeontpucor": 83, "core_id": 83, "maybereusefromvariablestor": 83, "maybepinvarstocpu": 83, "maybeopportunisticvariablereus": 83, "getlingvovariablecr": 83, "default_se": 83, "variablesynchron": 83, "variableaggregationv2": 83, "param_config": 83, "graphkei": 83, "global_vari": [83, 186], "distributionstrategi": 83, "variableaggreg": 83, "_createvariablest": 83, "_createvariablestateless": 83, "_randomxavieruniforminiti": 83, "_createvarinitst": 83, "init_dtyp": 83, "_generatestatelessrngse": 83, "aim": 83, "pseudo": [83, 88], "_deterministicrandomnormaliniti": 83, "stddev": [83, 100], "_deterministicrandomuniforminiti": 83, "minval": [83, 186], "maxval": [83, 186], "_deterministicrandomtruncatednormaliniti": 83, "truncat": [83, 100, 116, 171, 195], "_deterministicrandomuniformunitscalinginiti": 83, "_deterministicrandomvariancescalinginiti": 83, "_deterministicrandomxavieruniforminiti": 83, "_createvarinitstateless": 83, "getglobalvariablescop": 83, "variablescop": 83, "globalstepcontext": 83, "global_step_tensor": 83, "warnonglobalstepaccess": 83, "_maybewarnaboutpotentiallyincorrectevalu": 83, "unexpect": 83, "easili": 83, "triag": 83, "getglobalstep": [83, 96], "getorcreateglobalstepvar": 83, "logmultilin": 83, "_logplac": 83, "createlocaltheta": 83, "device_list": 83, "leav": 83, "intact": 83, "_getvarstoload": 83, "variable_loading_rul": 83, "var_ignore_rul": 83, "ckpt_path": 83, "suppress_log": 83, "overridevarsfromcheckpoint": 83, "pretrain": [83, 188, 194], "ckpts_loading_rul": 83, "collid": 83, "computegradientssimpl": 83, "loss_or_activ": 83, "grad_aggregation_method": 83, "colocate_gradients_with_op": 83, "gate_gradi": 83, "activations_grad": 83, "_computegradientstpu": 83, "skip_zero_gradi": 83, "use_bf16_gradients_ar": 83, "defer_crs_to_apply_grad": 83, "is_activ": 83, "tpu_embedding_activ": 83, "yonghui": 83, "_vargrad": 83, "vargrad": 83, "skipnonegradi": 83, "skip_none_gradi": 83, "aggregationmethod": 83, "race": 83, "switchabl": 83, "reduce_sum": 83, "tpu_embedding_var_grad": 83, "maskgradi": 83, "grad_mask": 83, "applygradmultipli": 83, "vs_g": [83, 108], "hasnanorinf": 83, "hasnanorinfgradi": 83, "applygradnormclip": 83, "scaled_gradi": 83, "adjustgradientswithlploss": 83, "lp_regularizer_weight": 83, "lp": 83, "lp_loss": 83, "regul": 83, "splitrecurs": 83, "nestmap": 83, "sublist": 83, "concatrecurs": 83, "weightedavg": 83, "sum_reduction_fn": 83, "weightedavgofmetr": 83, "ret_dict": 83, "concatperexampletensor": 83, "combinemetr": 83, "loss_metric_weight_pair": 83, "variat": 83, "subparam": 83, "variationalnoiseparam": 83, "global_vn": 83, "per_step_vn": 83, "start_step": 83, "defaultvn": 83, "disablevn": 83, "stepseedincrementcontext": 83, "_step_seed_incr": 83, "getstepse": 83, "step_se": 83, "resetstepse": 83, "mayberesetstepseedfromscop": 83, "seend": 83, "129159299": 83, "mayberesetstepse": 83, "getincstepse": 83, "transpar": [83, 114], "is_infer": 83, "stateless_random": 83, "deterministicdropout": 83, "deterministicvn": 83, "std": 83, "updatebatchnormvar": 83, "batch_norm_var": 83, "batch_norm_stat": 83, "findrelevantbatchnormupd": 83, "batch_norm_upd": 83, "samplestep": 83, "decodeonestep": 83, "_getsamplestep": 83, "adddebugtensor": 83, "print_debug_tensor": 83, "_ensurematrixshap": 83, "clip_by_valu": 83, "clip_value_min": 83, "clip_value_max": 83, "_transformandsum": 83, "sumsquar": 83, "sumab": 83, "reducerm": 83, "piecewiseconst": 83, "x_in": [83, 135, 195], "vdtype": 83, "padsequencedimens": 83, "pad_val": 83, "padsequenceto": 83, "applypad": 83, "use_select": 83, "ensure_shap": 83, "equiv": 83, "asid": 83, "easier": [83, 183], "friendli": 83, "necessarili": 83, "broadcast": 83, "platform": 83, "lengthsfrompad": 83, "isn": 83, "paddingsfromlength": 83, "unpad": 83, "trimtrailingpad": 83, "reversepaddedsequ": 83, "concatenatepaddedsequ": 83, "input0": 83, "padding0": 83, "padding1": 83, "seq_dim": 83, "reverse_sequ": 83, "shiftleft": 83, "shift_siz": 83, "createidsandlabel": 83, "lenght": 83, "retryontransienttferror": 83, "pad_after_cont": 83, "expandto": 83, "target_rank": 83, "expandandpadortrimto": 83, "target_shap": [83, 146], "thereaft": 83, "repeatdim": 83, "stacktensorsrecurs": 83, "mixbyweight": 83, "choic": [83, 140, 182], "probabilist": 83, "checkshap": 83, "fpropdtyp": 83, "updatefpropdtyp": 83, "updatedtyp": 83, "namescopedecor": 83, "foobar": 83, "myfoobarmethod": 83, "sequencestodebugstr": 83, "rematerializefn": 83, "statefulrandomopsindefun": 83, "inconsist": 83, "_definedfunct": 83, "toplacehold": 83, "extra_logit": 83, "softmaxcrossentropyfocalloss": 83, "label_id": 83, "label_prob": 83, "stop_gradient_on_focal_loss_coeffici": 83, "multinomi": 83, "focus": 83, "fl": 83, "p\u209c": 83, "\u03b1\u209c": 83, "\u02e0log": 83, "sigmoidcrossentropyfocalloss": 83, "recordformatfromfilepattern": 83, "tfrecord": [83, 160, 175, 183, 197, 205, 218, 221, 222, 223], "record_format": [83, 218], "filepattern": 83, "readfilelin": 83, "file_path": 83, "par": 83, "bazel": [83, 114, 123, 171, 225, 228], "workspac": 83, "exclus": 83, "use_einsum": 83, "08": [83, 166], "projectlastdim": 83, "removeassertcontext": 83, "_assertinputsmatch": 83, "implicit_captur": [83, 87], "implicitli": [83, 87, 179], "mismatch": [83, 92, 114], "keep_shap": 83, "_definedefun": 83, "fwd": [83, 92], "fwd_sig": 83, "bak": [83, 92], "bak_as_funct": 83, "dy": [83, 114], "dcaptur": [83, 87], "output_dtyp": 83, "stateful_op": 83, "op_nam": 83, "op_typ": 83, "captured_input": 83, "_sharedrendezvousscop": 83, "shared_rendezv": 83, "_getsharedrendezv": 83, "rendezv": 83, "_applysharedrendezv": 83, "_wrapfunct": 83, "input_signatur": [83, 114], "_definefunct": 83, "tffunctionscop": 83, "use_tf_funct": 83, "_usetffunct": 83, "extrem": [83, 91], "mention": 83, "del": [83, 137, 143, 151, 152], "then_branch": 83, "else_branch": 83, "definedfunct": 83, "trace": [83, 114], "addframeworkinput": 83, "__call__": 83, "suitabl": [83, 104, 179], "calldefun": 83, "_ityp": 83, "whileloop": 83, "loop_stat": 83, "forloop": 83, "readvari": 83, "varhandleop": 83, "_gettpusummarytensor": 83, "tpusummarytensorcontext": 83, "addtpusummarytensor": 83, "situat": 83, "gettpusummarytensor": 83, "cleartpusummarytensor": 83, "addsavedmodelasset": 83, "asset": 83, "getsavedmodelasset": 83, "computationshap": 83, "topologyproto": 83, "ll": 83, "getextravar": 83, "getextrainput": 83, "getextraarg": 83, "shardedfilepatterntoglob": 83, "computenceandauc": 83, "nce": 83, "gathertensorvaluesbyseqindic": 83, "class_indic": 83, "dim1": 83, "inclus": 83, "getsoftmaxprobsbyseqindic": 83, "dividenonan": 83, "divide_no_nan": 83, "sequencepad": 83, "appenddim": 83, "maybesoftcaplogit": 83, "gettpuembeddinggraphcollect": 83, "tpuembeddingcollect": [83, 117], "auxlosscontext": 83, "reentrant": [83, 118], "aux": 83, "_global_stack": [83, 118], "addloss": 83, "bprop_variable_exclus": 83, "var_path": 83, "blockdiagonalmatmul": 83, "input_num_block": 83, "linearli": [83, 96], "blockdiagonalprojectlastdim": 83, "getprocessedcheckpoint": 83, "updateprocessedcheckpoint": 83, "mergedictswithvaluecheck": 83, "dict1": 83, "dict2": 83, "mergeduplicateid": 83, "extra_tensor": 83, "ret_id": 83, "dedupl": [83, 179], "ret_pad": 83, "ret_tensor": 83, "decodeprotofield": 83, "serialized_proto": 83, "message_typ": 83, "field_nam": [83, 84, 191], "output_typ": 83, "decode_proto": [83, 197], "descriptor_sourc": [83, 197], "alwayslink": 83, "cc_librari": 83, "decoderepeatedprotofield": 83, "link": [83, 86, 87, 179], "field_name_s": 83, "_fromglob": 84, "allow_override_from_clust": 84, "enable_check_numer": 84, "use_xla": 84, "use_tpu": [84, 144], "testonly_skip_norm_lay": 84, "tpu_compat": 84, "use_stateless_vars_init": 84, "lib": 85, "samplequantizedprojectionlay": [85, 86], "quantutilsbasetest": 85, "methodnam": [85, 107, 114, 129], "runtest": [85, 107, 114, 129], "testcas": [85, 107, 113, 114, 129], "no_qdomain_expect": 85, "00071405": 85, "03868543": 85, "01999986": 85, "00994987": 85, "08905827": 85, "13636404": 85, "03180931": 85, "06056439": 85, "0208858": 85, "17595209": 85, "05192588": 85, "02618068": 85, "02125708": 85, "10454545": 85, "01147466": 85, "06903321": 85, "0276652": 85, "14823943": 85, "09726462": 85, "01415125": 85, "no_qdomain_expected_eag": 85, "00321277": 85, "0081814": 85, "02552385": 85, "01066932": 85, "01345658": 85, "06873785": 85, "07171492": 85, "06641106": 85, "1642895": 85, "04410084": 85, "02281524": 85, "00583461": 85, "20509389": 85, "02709481": 85, "09852847": 85, "01793884": 85, "11026311": 85, "01846472": 85, "08576044": 85, "06027214": 85, "_testlayerhelp": 85, "test_cas": 85, "not_expect": 85, "qdistribut": 86, "enum": 86, "unsign": 86, "log_softmax": 86, "random_uniform": [86, 91], "relu6": 86, "isposit": 86, "_generate_next_value_": 86, "last_valu": 86, "_member_names_": 86, "_member_map_": 86, "_member_type_": 86, "_value2member_map_": 86, "safe": 86, "emploi": [86, 179], "fall": [86, 88, 96, 181, 182, 197], "fake": [86, 155], "quantifi": 86, "apriori": 86, "passiv": 86, "constrain": 86, "mul": 86, "quit": 86, "system": 86, "thought": 86, "think": [86, 104], "alter": 86, "strongli": 86, "loos": 86, "honor": 86, "qweight": 86, "qract": 86, "terminologi": 86, "concept": [86, 136, 179], "8bit": 86, "16bit": 86, "rare": 86, "mirror": 86, "qout_nam": [86, 91], "trackqact": 86, "qmin": 86, "qmax": 86, "qtanh": 86, "qsigmoid": 86, "qsoftmax": 86, "qrelu": 86, "qrelu6": 86, "qlogsoftmax": 86, "fakeqdomain": 86, "qrandom_uniform": 86, "qadd": 86, "qsubtract": 86, "qmultipli": 86, "qlog": 86, "feature_ax": 86, "grain": [86, 179], "trackqweight": 86, "feature_axi": 86, "legacy_aqt_weight_nam": 86, "eval_onli": 86, "pressur": 86, "_validateargnam": 86, "op_arg_nam": 86, "qmatmul": 86, "lhs_name": 86, "rhs_name": 86, "lhs_dist": 86, "rhs_dist": 86, "ensure2d": 86, "op_kwarg": 86, "qconv1d": 86, "inputs_nam": 86, "filters_nam": 86, "inputs_dist": 86, "filters_dist": 86, "qconv2d": 86, "is_depthwis": 86, "qeinsum": 86, "einsum_kwarg": 86, "_validateweight": 86, "w_name": 86, "toaqtweight": 86, "expected_scale_shap": 86, "aqt": 86, "fromaqtweight": 86, "merge_feature_ax": 86, "rescal": 86, "toaqtconv": 86, "w_feature_axi": 86, "act_distribut": 86, "w_expected_scale_shap": 86, "quantizable_lay": 86, "fromaqtconv": 86, "depthwiseconv": 86, "toaqtinput": 86, "ot": 86, "fromaqtmatmul": 86, "toaqtactactinput": 86, "act_lh": 86, "act_rh": 86, "act_lhs_distribut": 86, "act_rhs_distribut": 86, "hand": 86, "fromaqtactactmatmul": 86, "_getqdomain": 86, "getqdomainparam": 86, "Will": 86, "_addquantizationfunct": 86, "unquant": 86, "quantizeweight": 86, "out_nam": 86, "fromaqtoutput": 86, "quantizeconstantrang": 86, "min_valu": 86, "max_valu": 86, "quantizenaturalrang": 86, "quantizeact": 86, "fake_quant_with_": 86, "_maybenarrowtoasymbitdepth": 86, "baseclippingcapschedul": 86, "getendrang": 86, "slightli": [86, 197], "lie": [86, 100], "getquantizedendrang": 86, "tightli": 86, "coupl": [86, 91, 161], "applyconstantclip": 86, "getstat": 86, "applyclippingwithst": 86, "applyclip": [86, 195, 196], "identityclippingcapschedul": 86, "dummi": [86, 109, 129], "linearclippingcapschedul": 86, "_valu": 86, "fakequantizationschedul": 86, "mobil": [86, 91], "fakequantizedlstmcel": 86, "exhaust": 86, "end_cap": 86, "_getquantizedrangeforcap": 86, "current_cap": 86, "_getcurrentminmax": 86, "start_cap": 86, "fixate_to_end_st": 86, "satur": [86, 197], "fixat": 86, "0d": 86, "ramp": [86, 96], "symmetricscheduledclipqdomain": 86, "aid": 86, "_countedminmaxaccumul": 86, "new_valu": 86, "passiveasymqdomain": 86, "asymmetr": 86, "1712": 86, "05877": 86, "_maybefakequ": 86, "min_v": 86, "max_v": 86, "num_bit": 86, "_getaccumulatornamefortensor": 86, "_getqstatevarnam": 86, "_createqstatevar": 86, "_getqstatevar": 86, "_summarizetensor": 86, "_recordtensor": 86, "_copyshap": [86, 88], "from_t": 86, "to_t": 86, "cell_fn": 87, "cell_grad": 87, "dstate1": 87, "dtheta": 87, "dstate0": 87, "dinput": 87, "bunch": 87, "accumulate_st": 87, "while_loop": [87, 118], "lot": 87, "why": 87, "my_tensor": 87, "allow_implicit_captur": 87, "devicepair": 87, "recv": [87, 99], "_assertsametensor": 87, "list_a": 87, "list_b": 87, "_index": 87, "_updat": 87, "nmap_acc": 87, "nmap_x": 87, "_seqlendim": 87, "flattenpad": 87, "_seqpaddinglength": 87, "inputs_nmap": 87, "_emptyacc": 87, "_emptywithfixshap": 87, "_emptylik": 87, "nmap_i": 87, "_transformdtyp": 87, "_recurr": 87, "stop_fn": 87, "cell_typ": 87, "accumulator_lay": 87, "unused_acc_st": 87, "backward_cleanup": 87, "return_acc_extra": 87, "_reflectoncellfn": 87, "check_stateful_op": 87, "allowed_tensor_captur": 87, "_getcellgrad": 87, "_augmentst": 87, "allow_overwrit": 87, "_wrapaccumulatorcellfn": 87, "_wrapaccumulatorcellgradfn": 87, "_wrapcellfnwithstepse": 87, "_wrapcellgradfnwithstepse": 87, "_wrapcellfnwithsymbolvalu": 87, "symbol_to_tensor_map": 87, "_wrapcellgradfnwithsymbolvalu": 87, "_decoratecellfn": 87, "_decoratecellgrad": 87, "_issingletimestep": 87, "_recurrentsingletimestep": 87, "stash": [87, 91], "unsupport": [87, 218], "expans": 87, "should_stop": 87, "_link": 87, "dpair": 87, "_createlink": 87, "_join": 87, "_input": 87, "cell_out": 87, "cell_out_grad": 87, "out_link": 87, "_middl": 87, "in_link": 87, "slen_dim": 87, "per_step_input": 87, "middl": 87, "_dependson": 87, "init_st": 87, "zip": 87, "shink": 87, "acc_stat": [87, 92], "num_t": 87, "_stackedrecurr": 87, "_repeat": 88, "common_input": 88, "layerwise_input": 88, "layerwis": 88, "iterative_input_0": 88, "layerwise_output": 88, "dst": 88, "layerwise_output_0": 88, "retry_valu": 89, "max_retri": 89, "initial_delay_sec": 89, "delay_growth_factor": 89, "delay_growth_fuzz": 89, "max_delay_sec": 89, "60": [89, 166, 167], "1707": [90, 91], "04585": 90, "revnetlay": 90, "y1": [90, 96], "x1": [90, 96], "x2": 90, "y2": 90, "retain": [90, 96, 97], "reverseandgrad": 90, "d_output": 90, "f_seed": 90, "g_seed": 90, "extra_input": 90, "revnet": 90, "split1": 90, "split2": 90, "dy1": 90, "dy2": 90, "reverse_grad": 90, "d_input": 90, "dx1": 90, "dx2": 90, "d_theta": 90, "stackedrevnetlay": 90, "peak": [90, 96], "footprint": 90, "\u03b8": 90, "activation_size_per_lay": 90, "param_size_per_lay": 90, "implment": 90, "gru": 91, "_histogramsummari": 91, "rnncell": [91, 102, 106], "getoutput": [91, 106], "furthermor": 91, "_gate": 91, "_resetst": 91, "reset_cell_st": 91, "good": [91, 183, 188], "dai": 91, "guten": 91, "thank": 91, "dank": 91, "facili": 91, "_zoneout": 91, "prev_v": 91, "cur_v": 91, "zo_prob": 91, "zoneout": 91, "regularl": 91, "1606": 91, "01305": 91, "zone": [91, 224], "cell_nod": 91, "input_nod": 91, "output_s": 91, "num_gat": 91, "_getbia": 91, "forget_gate_bia": 91, "elimin": [91, 140], "xmw": 91, "_retrieveandsplitg": 91, "_gatesintern": 91, "i_i": 91, "i_g": 91, "f_g": 91, "o_g": 91, "_processnewc": 91, "new_c": 91, "_applyzoneout": 91, "new_m": 91, "lstmcellgroup": 91, "10722": 91, "shufflenet": 91, "01083": 91, "child_cell_cl": 91, "_shuffleshard": 91, "num_shuffle_shard": 91, "0_0": 91, "0_1": 91, "0_2": 91, "0_3": 91, "1_0": 91, "1_1": 91, "1_2": 91, "1_3": 91, "2_0": 91, "2_1": 91, "2_2": 91, "2_3": 91, "quantizedlstmcel": 91, "output_nonlinear": 91, "layernormalizedlstmcel": 91, "weightnormalizedlstmcellsimpl": 91, "1602": 91, "07868": 91, "normalizedlstmcellsimpl": 91, "incomplet": 91, "c_state": 91, "enable_ln_on_c": 91, "ln_scale": 91, "_layernormg": 91, "gate_nam": 91, "embeddingaugmentedlayernormalizedlstmcellsimpl": 91, "inject_emb_method": 91, "prev_id": [91, 105], "num_token": [91, 188], "doubleprojectionlstmcel": 91, "wm_": 91, "_processinputproj": 91, "input_proj": 91, "convlstmcel": 91, "cell_shap": 91, "srucel": 91, "sru": 91, "1709": 91, "02755": 91, "unrol": [91, 92, 135, 141], "qrnnpoolingcel": 91, "quasi": [91, 92], "1611": 91, "01576": 91, "fc": 91, "qrnn": 91, "num_rnn_matric": 91, "grucel": 91, "gru_bias": 91, "gru_cel": 91, "1412": 91, "3555": 91, "w_n": 91, "w_u": 91, "w_r": 91, "b_n": 91, "b_u": 91, "b_r": 91, "output_cell_nod": 91, "hidden_cell_nod": 91, "actiav": 91, "generatepackedinputresetmask": 92, "is_revers": 92, "identityseqlay": 92, "stackedrnnbas": 92, "_getcelltpl": 92, "stackedfrnnlayerbylay": 92, "stackedbifrnnlayerbylay": 92, "bidirectionalfrnn": 92, "bidi": 92, "rcell_forward": 92, "rcell_backward": 92, "bidirectionalrnn": 92, "bidirectionalrnnv2": 92, "_padsequencetolength": 92, "t_input": 92, "_concatlastdim": 92, "_shiftright": 92, "x0": [92, 96], "_shiftrightwithmask": 92, "frnnwithattent": 92, "intertwin": 92, "src_enc": [92, 104], "src_context": 92, "src_end": 92, "atten_state_dim": 92, "zero_atten_st": 92, "reset_atten_st": 92, "accumulatest": 92, "accumulated_st": 92, "side_info": 92, "postprocessst": 92, "fulfil": 92, "rnn_output": 92, "rcell": 92, "num_output_nod": [92, 106], "multisourcefrnnwithattent": 92, "initattent": [92, 134], "source_nam": 92, "contrain": 92, "bidirectionalfrnnquasi": 92, "fwd_rnn": 92, "bak_rnn": 92, "templat": [93, 166, 167, 175, 176, 179, 224], "routingtransformerencoderparam": 93, "routing_factor": 93, "setuproutingtransformerencod": 93, "num_routing_lay": 93, "num_routing_head": 93, "num_clust": 93, "atten_dropout_prob": [93, 161, 193, 205], "relu_dropout_prob": [93, 161, 193, 205], "meanwhil": 94, "saniti": [94, 195], "sanitycheck": 94, "inrang": 94, "isfinit": 94, "_varkei": 94, "sanity_check": 94, "keep_latest_n": 94, "keep_every_n_hour": 94, "emption": 94, "indefinit": [94, 175], "garbag": 94, "gced": 94, "live": 94, "forev": 94, "re_pattern": 94, "_addshardedsaveop": 94, "checkpoint_prefix": 94, "var_key_fn": 94, "_buildsav": 94, "_buildrestor": 94, "_getstat": 94, "_setstat": 94, "getcheckpointid": 94, "_garbagecollect": 94, "ids_to_garbage_collect": 94, "_dosanitycheck": 94, "_saveasync": 94, "till": 94, "_savesync": 94, "_finalizesav": 94, "_updatest": 94, "checkpoint_id": [94, 124, 131], "successfulli": 94, "writenparrai": 94, "file_prefix": 94, "readnparrai": 94, "nestemap": 94, "setinplaceupd": 95, "inplace_upd": 95, "useinplaceupd": 95, "inplace_op": 95, "alias_inplace_upd": 95, "aka": 95, "inplaceupd": 95, "inplac": 95, "baseschedul": 96, "getstep": 96, "constanton": 96, "piecewiseconstantschedul": 96, "continuousschedul": 96, "polynomialschedul": 96, "polynomi": 96, "y0": 96, "linearschedul": 96, "linearrampupdecayschedul": 96, "annealingschedul": 96, "anneal": 96, "pow": 96, "lower_bound": 96, "exponentialschedul": [96, 111], "stepwiseexponentialschedul": 96, "combinedminimumschedul": 96, "transformerschedul": [96, 161, 193], "warmup_step": [96, 161, 167, 193, 205], "transformermlperfschedul": 96, "warmup": [96, 161, 193], "transformerschedulenowarmup": 96, "decay_start": 96, "warm": [96, 193], "linearrampupexponentialdecayscaledbynumsplitschedul": 96, "stai": [96, 102, 111], "linearrampupexponentialdecai": 96, "warmup_init": 96, "linearrampupsqrtdecai": 96, "linearrampupsqrtdecaybybatchsizeandreplica": 96, "warmup_exampl": 96, "linearrampuppiecewiseconstantschedul": 96, "linearrampupcosineschedul": 96, "cosin": 96, "rampup": 96, "devbasedschedul": 96, "lack": 96, "optimum": 96, "ref_step": 96, "recent": 96, "cur_factor": 96, "min_factor": 96, "cosineschedul": 96, "1608": 96, "03983": 96, "cycl": [96, 102], "angl": 96, "pi": 96, "peopl": 96, "09224": 96, "cyclic": 96, "gone": 96, "current_step": [96, 108, 111], "total_step": 96, "decay_gap": 96, "final_valu": 96, "piecewiseschedul": [96, 111], "sqrtdecai": 96, "sqrtdecaytozero": 96, "cycleschedul": 96, "inversesigmoid": 96, "1506": 96, "03099": 96, "_tounicod": 97, "_token": 97, "separator_typ": 97, "un": [97, 193], "surfac": 97, "_bpe_separ": 97, "_wpm_separ": 97, "_unsegmentwpm": 97, "_unsegmentbp": 97, "bleuscor": 97, "max_ngram": 97, "addsent": 97, "computeoverallscor": 97, "6687": 97, "pai": 98, "_transformerlayerblock": 98, "_stridedtransformerlayerblock": 98, "transformerstackv2": 98, "final_layer_first_n": 98, "final_layer_strid": 98, "stackedtransformerencoderlay": 98, "_send": 99, "_recv": 99, "python_op_gen_main": 99, "printallpythonop": 99, "_tpucor": 99, "send_devic": 99, "recv_devic": 99, "spectrum": [100, 101], "_random_uniform_op": 100, "use_stateless_op": 100, "_random_normal_op": 100, "_global_seed_from_input": 100, "input_float": 100, "_hat": 100, "hat": 100, "spectrumaugment": [100, 101], "specaug": [100, 101], "08779": [100, 101], "einsumbbmbm": [100, 101], "einsumbmtbmbt": [100, 101], "einsumbxycbybxyc": [100, 101], "einsumbxycbxbxyc": [100, 101], "einsumbxybxbxi": [100, 101], "einsumbxycbzxbzyc": [100, 101], "einsumbxycbzybxzc": [100, 101], "augment_weight": 100, "_getmask": 100, "choose_rang": 100, "mask_siz": 100, "global_se": 100, "masks_per_fram": 100, "max_ratio": 100, "region": 100, "proce": 100, "_getwarpmatrix": 100, "matrix_s": 100, "max_warp_fram": 100, "warp": 100, "displac": 100, "warp_matrix": 100, "_constructwarpmatrix": 100, "coordin": 100, "anchor": 100, "singular": 100, "slope": 100, "slope_0": 100, "slope_1": 100, "slope_2": 100, "orig_i": 100, "n_i": 100, "pixel": 100, "warped_pixel": 100, "sum_j": 100, "_frequencymask": 100, "domain_id_index": 100, "degre": 100, "time_length": 100, "num_freq": 100, "_timemask": 100, "noisifi": 100, "gaussian_nois": 100, "_frequencywarp": 100, "_timewarp": 100, "_frequencynois": 100, "logmel": 100, "rational": 100, "freq": 100, "period": [100, 128], "imit": 100, "ccrma": 100, "stanford": 100, "jo": 100, "sasp": 100, "filtered_white_nois": 100, "white_nois": 100, "time_white_nois": 100, "unstackfeatur": 100, "src_input": [100, 138, 140, 142], "_augmentationnetwork": 100, "domain_id": 100, "num_channel": [100, 177], "augmented_input": 100, "spectrumaugmenterondevic": 101, "portabl": 101, "bm": 101, "bmt": 101, "bt": 101, "bxyc": 101, "bx": 101, "bxy": 101, "bzx": 101, "bzyc": 101, "bzy": 101, "bxzc": 101, "processseq": 102, "external_input": [102, 104, 106], "prepared_input": [102, 104, 105, 106], "prepareexternalinput": [102, 104, 105, 106], "zerost": [102, 104, 105, 106], "step_input": [102, 104, 105, 106, 107], "step_output": 102, "statelesslayerstep": 102, "stackstep": [102, 105, 106], "primari": 102, "lowest": 102, "parallelstep": 102, "substep": 102, "external_signatur": 102, "graphstep": [102, 105], "layer_0": 102, "layer_1": 102, "step_param": 102, "n_batch": 102, "output_signatur": 102, "iteratorstep": 102, "recurrentstepwrapp": 102, "attentionstep": 104, "attention_prob": 104, "_getmaxseqlength": 104, "cum_atten_prob": 104, "attentionblockstep": 104, "atten_queri": 104, "embeddingstep": 105, "statefulembeddingstep": 105, "num_prev_token": 105, "rnnstep": 106, "unmodifi": 106, "external_input_dim": 106, "rnnstackstep": 106, "residual_start": [106, 161], "residual_strid": 106, "jun": 107, "streamsteptestbas": 107, "input_rank": 107, "_getparam": 107, "_getfpropoutput": 107, "max_seqlen": 107, "full_seq": 107, "_padinput": 107, "num_fram": [107, 140], "_normalizestreamstepoutput": 107, "query_funnel_pool_strid": 107, "_streamstep": 107, "step_pad": 107, "fprop_out": 107, "_teststreamstephelp": 107, "_buildstackingbasegraph": 107, "_buildstackingstreamgraph": 107, "_testrightcontextstackinglayershelp": 107, "_test_params_repr": 107, "_shouldaddsummari": 108, "scalar_input_stat": 108, "scalar_v2": 108, "histogram_v2": 108, "image_v2": 108, "text_v2": 108, "sequencelength": 108, "plot_tensor": 108, "trimpaddingandplotsequ": 108, "seq_matrix": 108, "num_row": 108, "trimpaddingandplotattent": 108, "atten_matrix": 108, "tgt_len": [108, 195], "transcript": [108, 136, 137, 151, 152, 223], "addattentionsummari": 108, "attention_tensor": 108, "tgt_pad": 108, "show": [108, 195], "target_len": [108, 195], "addattentionsummarybatchmajor": 108, "addnormsummari": 108, "collectvarhistogram": 108, "preparesequenceforplot": 108, "subcapt": 108, "reshaped_tensor": 108, "sequence_length": [108, 166, 167], "plotsequencefeatur": 108, "caption": [108, 151, 173, 179, 181, 183, 188, 203], "statscount": 108, "incbi": 108, "stepratetrack": 108, "computestepr": 108, "total_exampl": 108, "modelanalysi": 108, "topn": 108, "part_pattern": 108, "gettensornam": 108, "name_eag": 108, "i_eag": 108, "dummy_index": 109, "_explicit_class_assumpt": 109, "_prop_handl": 109, "extended_neg": 109, "expr": 109, "_eval_is_extended_neg": 109, "extended_posit": 109, "_eval_is_extended_posit": 109, "default_assumpt": 109, "issymbol": 109, "isexpr": 109, "_localsymboltovaluestack": 109, "_local": [109, 115], "value_typ": 109, "symbol_to_value_map": 109, "symbol1": 109, "value1": 109, "symbol2": 109, "value2": 109, "evalexpr": 109, "symbolic_expr": 109, "_local_stack": 109, "sympi": 109, "tostat": 109, "totensor": 109, "ocd": 110, "deliber": 110, "_computepad": 110, "targetsequencesampl": 110, "decoder_theta": [110, 145], "init_state_callback": 110, "pre_step_callback": 110, "post_step_callback": 110, "init_step_id": 110, "taskschedul": 111, "expos": [111, 191, 195], "adaptiveschedul": 111, "getmetrichistori": 111, "simpleadaptiveschedul": 111, "inverseratioadaptiveschedul": 111, "weigh": 111, "shiftedexponentialschedul": 111, "kiperwass": 111, "ballestero": 111, "1804": 111, "08915": 111, "eack": 111, "constantschedul": 111, "p_0": 111, "p_1": 111, "sigmoidschedul": 111, "roundrobinschedul": 111, "sequentialschedul": 111, "test_src_dir_path": 112, "relative_path": 112, "_modeltupl": 113, "model_class": 113, "makemodelvalidatortestcas": 113, "myregisteredmodel1": 113, "myregisteredmodel2": 113, "_skipif": 114, "test_func": 114, "skipifeag": 114, "skipifnoneag": 114, "tapeifeag": 114, "adaptor": 114, "watch": 114, "wrt": 114, "defineandtrac": 114, "tensor_specs_or_placehold": 114, "_placeholderadapt": 114, "redirect": 114, "_eagersessionadaptor": 114, "run_fn": 114, "feed_dict": 114, "function_or_fetch": 114, "_run_impl": 114, "disableeageradapt": 114, "tensorflowtestcas": 114, "fixtur": [114, 129], "exercis": [114, 129], "_create_sess": 114, "getscalarsummaryvalu": 114, "is_tf2_writ": 114, "value_dict": 114, "step_numb": 114, "_replaceonelineinfil": 114, "fpath": 114, "linenum": 114, "replacegoldensinglefloat": 114, "float_valu": 114, "replacegoldenstackanalysi": 114, "new_float_valu": 114, "analyz": 114, "golden": 114, "comparetogoldensinglefloat": 114, "testobj": 114, "update_golden": 114, "site": [114, 140], "liner": 114, "3232": 114, "pickeveryn": 114, "np_arr": 114, "computenumericgradi": 114, "extra_feed_dict": 114, "checker": 114, "computenumericgradienteag": 114, "fy": 114, "threadlocalstack": 115, "threadlocaldict": 115, "stringstoidswithseg": 116, "_stringstoidsimpl": [116, 168], "_stringstoidswithoffsetsimpl": 116, "_stringstoidswithsegmentsimpl": 116, "asciitoken": 116, "graphem": [116, 148, 209], "digit": 116, "vocabfiletoken": 116, "_vocab_file_param": 116, "_checkparam": 116, "bpetoken": 116, "wpmtoken": 116, "explan": 116, "sentencepiecetoken": 116, "sentencepiec": 116, "1808": 116, "06226": 116, "tf_text": 116, "191804185": 116, "_istputrain": 117, "_removeprivatevar": 117, "addtablevari": 117, "table_nam": 117, "is_inference_with_bfloat16": 117, "table_vari": 117, "inference_with_bfloat16_var_nam": 117, "addloadretrieveop": 117, "load_op": 117, "retrieve_op": 117, "_validatetaskscop": 117, "task_call_scop": 117, "addactiv": 117, "getactiv": 117, "addsummarytensor": 117, "summary_tensor": [117, 118], "setgradientmultiplierschedul": 117, "multiplier_schedul": 117, "settaskmod": 117, "shouldstopgradi": 117, "applygradi": 117, "feature_to_gradient_dict": 117, "_tpuembeddingoptim": 117, "tpuembeddingt": 117, "createoptimizerparamet": 117, "optimzi": 117, "createslotvariablesandop": 117, "table_var": 117, "tpu_embedding_t": 117, "tpuembeddingsgdoptim": 117, "tpuembeddingadagradoptim": 117, "tpuembeddingadamoptim": 117, "tpuembeddingftrloptim": 117, "ftrl": 117, "input_kei": 117, "declar": 117, "upfront": 117, "createoptimizerslotvari": 117, "slot_var_dict": 117, "getdevicenam": 117, "table_config": 117, "auxiliary_vari": 117, "max_sequence_length": 117, "_sequenceemblookup": 117, "dense_id": 117, "partition_strategi": 117, "_combineremblookup": 117, "sparse_id": 117, "sparsetensor": 117, "cpuemblookup": 117, "ids_map": 117, "cpuemblookupspars": 117, "embedding_lookup_spars": 117, "_checktpuembeddingconfig": 117, "table_to_config_dict": 117, "feature_to_config_dict": 117, "_tpuemblookup": 117, "_checkidsmap": 117, "monoloth": 117, "emblookupspars": 117, "getidsmap": 117, "getauxiliaryvari": 117, "my_model": 118, "my_model_param": 118, "merge_al": 118, "rewrite_while_loop": 118, "greedydecodeid": 118, "rewrit": 118, "tpusummaryscalar": 118, "plain": [118, 160], "while_loop_reduc": 118, "pwtpusummarytensor": 118, "tpusummarycontext": 118, "rewriteloopcontext": 118, "max_loop_var": 118, "pw_tensor": 118, "merge_all_pw_tensor": 118, "loop_vars_dtyp": 118, "toi": 119, "countinginputgener": 119, "identityregressionmodel": 119, "identityregressiontask": 119, "modeltrackingfpropresult": 119, "registeridentityregressionmodel": 119, "weight_init_valu": 119, "max_train_step": 119, "eval_decode_steps_per_loop": 119, "eval_decode_samples_per_summari": 119, "varialb": 119, "num_el": 120, "substitut": [120, 137, 151, 152], "totensorshap": 120, "temporari": 121, "varwrappertrackassign": 121, "previous_assign": 121, "control_after_assign": 121, "raw_var": 121, "read_valu": 121, "assign_add": 121, "assign_sub": 121, "stackedvarwrapperwithmanualshard": 121, "physic": 121, "_to_manu": 121, "_to_auto": 121, "collaps": [121, 140, 191], "paragraph": 122, "5150": 122, "schuster": 122, "nakajima": 122, "japanes": 122, "korean": 122, "voic": 122, "2012": 122, "ieee": 122, "confer": 122, "acoust": 122, "googleusercont": 122, "media": 122, "research": 122, "archiv": 122, "37842": 122, "wpmencod": 122, "wpm_filepath": 122, "merge_prob": 122, "_tokentostr": 122, "_stringtotoken": 122, "tokstr": 122, "_mergetoken": 122, "_encodetoid": 122, "sentence_start_id": 122, "sentence_start_str": 122, "sentence_end_id": 122, "sentence_end_str": 122, "unk_id": 122, "datasetfunctionerror": 123, "warn_on_error": 123, "apart": 123, "non_dataset_memb": 123, "registersingletaskmodel": [123, 128, 182], "getdatasetsast": 123, "base_dir": 123, "ast": 123, "accur": 123, "trainsummari": [124, 228], "eval_typ": [124, 131], "_getevalfunc": 124, "write_summari": 124, "_evalonc": [124, 131], "_getcheckpointidfordecodeout": [124, 131], "ckpt_id_from_fil": [124, 131], "diverg": [124, 131], "decoder_typ": [124, 131, 224], "_getdecodefunc": 124, "getdecodeoutpath": [124, 131], "decoder_dir": [124, 131], "_decodeonc": 124, "unsetunusedtrainparam": 125, "getexecutorparam": [125, 228], "model_nam": [125, 127, 228], "modelregistri": 125, "ps_params_dict": [125, 228], "programscheduleparam": [125, 228], "train_cfg": [125, 228], "executortpu": [125, 228], "overview": [125, 228], "mega": [125, 228], "cooper": [125, 228], "_maybeconstructsharedmodel": [125, 228], "share_model_object": [125, 228], "_loop": [125, 131, 228], "hyper": [127, 158, 165, 201, 213], "modelparam": [127, 128], "_import": 127, "_insertparam": 127, "everywher": 127, "importallparam": 127, "task_root": 127, "task_dir": 127, "require_success": 127, "registri": [127, 128, 129], "importparam": 127, "_modelregistryhelp": 128, "_model_params_allow_redef": 128, "_model_param": 128, "_registered_modul": 128, "_classpathprefix": 128, "_modelparamsclasskei": 128, "src_cl": 128, "mnist": [128, 153, 155, 156, 225, 228], "lenet5": [128, 157, 228], "conflict": 128, "_getsourceinfo": 128, "_registermodel": 128, "wrapper_cl": 128, "_createwrapperclass": 128, "maybeupdateparamsfromflag": 128, "cfg": [128, 224, 228], "registermultitaskmodel": 128, "getallregisteredclass": 128, "getclass": 128, "class_kei": 128, "lookuperror": 128, "getparamsfrommodelparamsobject": 128, "model_params_obj": 128, "model_params_overrid": 128, "model_params_file_overrid": 128, "getprogramschedulefrommodelparamsobject": 128, "getprogramschedul": 128, "models_test": 129, "_stuboutcreatevari": 129, "variable_cach": 129, "stub": 129, "spend": 129, "traverselay": 129, "tree": 129, "basemodelstest": 129, "_validateema": 129, "mdl": 129, "_testonemodelparam": 129, "createtestmethodsforallregisteredmodel": 129, "task_regex": 129, "exclude_regex": 129, "programmat": 129, "transformtest": 129, "test_method": 129, "pdb": 130, "catch_post_mortem": 130, "startshel": 131, "local_n": 131, "startenqueueop": [131, 228], "trainertpu": [131, 228], "_cleanup": [131, 228], "evallatestcheckpoint": 131, "last_path": 131, "evalcheckpoint": 131, "ckpt_id": 131, "_removescalarsummari": 131, "getdecoderdir": 131, "getckptidfromfil": 131, "decodecheckpoint": 131, "samples_per_summari": 131, "decodelatestcheckpoint": 131, "contextualizer_bas": [132, 133], "decoder_metr": [132, 133], "decoder_util": [132, 133], "eos_norm": [132, 133], "frontend": [132, 133, 145], "fusion": [132, 133, 135], "levenshtein_dist": [132, 133], "metrics_calcul": [132, 133], "model_test_input_gener": [132, 133], "classifi": [132, 153], "common_schema": [132, 172], "dataset_spec": [132, 172], "dual_encod": [132, 172, 189], "image_preprocessor": [132, 172], "score_funct": [132, 172], "tf_hub_lay": [132, 172], "tpu_util": [132, 172], "base_config": [132, 192], "data_augment": [132, 192], "text_input_pb2": [132, 192], "librispeech": [133, 147], "simple_w": [133, 150], "simple_wer_v2": [133, 150, 151], "contextualizerbas": 134, "contextu": [134, 195, 199], "setcontextmap": 134, "attn": 134, "zeroattent": 134, "queryattent": 134, "la": 134, "accessor": 134, "getcontextdim": 134, "misc_stat": [134, 135], "dec_b": [134, 135], "audio_context": 134, "aud_dim": 134, "audio": [134, 140, 173, 174, 217, 223], "attn_queri": 134, "nullcontextu": 134, "_totensorarrai": 135, "clear_after_read": 135, "tensorarrai": 135, "_newtensorarrai": 135, "asrdecoderbas": 135, "decoderstepst": 135, "cur_target_info": 135, "targetstobefedatcurrentdecodestep": 135, "singledecodestep": 135, "step_out": 135, "poststepdecoderstateupd": 135, "old_stat": 135, "displai": 135, "addadditionaldecodersummari": [135, 141], "seq_out_ta": [135, 141], "computehypswithbeamsearch": 135, "misczerost": 135, "targetinfo": 135, "createtargetinfomisc": 135, "_getattencontextdim": 135, "_createatten": 135, "basezerost": 135, "_getinitialseqstatetensorarrai": 135, "intiti": 135, "computepredictionsdynam": 135, "_getnewattenprob": 135, "misc": [135, 141], "sequenceouttensorarrai": [135, 141], "confidence_logit": 135, "_applydropout": 135, "extra_se": 135, "intial": 135, "_getencoderpad": 135, "misc_zero_st": 135, "softmax_input": [135, 141, 195, 199], "decoderstepzerost": 135, "_adddecoderactivationssummari": 135, "additional_atten_prob": 135, "target_align": 135, "max_source_length": 135, "rnn_output_dim": 135, "_computemetr": 135, "target_prob": 135, "per_sequence_loss": 135, "initdecod": 135, "accuraci": [135, 154, 195], "decoder_step_state_zero_fusion_flat": 135, "decoder_step_state_zero_misc_flat": 135, "decoder_step_st": 135, "_updatesequenceouttensorarrai": 135, "_getattenprobsfromsequenceouttensorarrai": 135, "_getpredictionfromsequenceouttensorarrai": 135, "_getinitialtargetinfo": 135, "target_emb": [135, 195, 199], "computepredictionsfunct": 135, "_computelogit": 135, "_extractconfidencefeatur": 135, "atten_dist": 135, "lm_output": [135, 141], "per_step_src_pad": 135, "use_deterministic_random": 135, "source_enc": [135, 141, 195], "new_decoder_st": 135, "miscellan": [135, 141], "target_info_ta": 135, "asrdecod": 135, "_computeattent": 135, "state_dim": 135, "1609": 135, "08144": 135, "08581": 135, "_getnumhypsforbeamsearch": 135, "_postprocessattenprobsforbeamsearch": 135, "noop": 135, "decodertopk": 136, "beamsearchdecodeoutputtodecodertopk": 136, "decoder_out": [136, 145], "ids_to_strings_fn": 136, "feed_encoder_out": 136, "encoder_out": [136, 145], "top_k_decod": 136, "top_k_scor": 136, "decodermetr": [136, 144], "gettopk": 136, "computenormalizedw": 136, "addadditionaldecodermetricstograph": 136, "filtered_hyp": 136, "filtered_ref": 136, "computemetr": 136, "createmetr": 136, "filterrealexampl": 136, "utt": 136, "detokenizetranscript": 136, "detokenizetopkdecod": 136, "preparepostprocess": 136, "postprocess_input": [136, 144], "_issymbolorposit": 137, "setrnncellnod": 137, "decoder_param": 137, "rnn_cell_param": 137, "word_err": 137, "editdist": 137, "levenshtein": [137, 143], "edit": [137, 143, 151, 152], "ins": [137, 143, 151, 152], "editdistanceinid": 137, "ref_id": [137, 144], "filterepsilon": 137, "filternois": 137, "convlstmblock": 138, "asrencod": [138, 145], "_use_funct": 138, "forward_p": 138, "backward_p": 138, "createconvlstmlayerparam": 138, "firstlstmlayerinputdimandpad": 138, "conv_output_shap": 138, "pad_to_multipl": 138, "supports_stream": 138, "conv_lstm": 138, "fillpaddingpo": 139, "id_len": 139, "padding_valu": 139, "new_id": [139, 195], "normalizetrailingeo": 139, "need_trailing_eo": 139, "id_len_eos_norm": 139, "max_label_len": 139, "numpynormalizetrailingeo": 139, "reader": [139, 218], "understand": 139, "asrfrontendconfig": 140, "is_nul": 140, "src_type": 140, "src_pcm_scale": 140, "src_pcm_sample_r": 140, "input_frame_ratio": 140, "_nextpoweroftwo": 140, "baseasrfrontend": [140, 145], "precomput": [140, 181, 188], "waveform": 140, "getconfigfromparam": 140, "vital": 140, "nullasrfrontend": 140, "melasrfrontend": 140, "asrfrontend": 140, "mel": [140, 217], "pcm": 140, "framer": 140, "fft": 140, "filterbank": [140, 217], "meanstddev": 140, "packet_s": 140, "channel_count": 140, "mono": 140, "glueless": 140, "influenc": 140, "refactor": 140, "_createwindowfunct": 140, "window_frame_s": 140, "window_frame_step": 140, "_removechanneldim": 140, "pcm_audio_data": 140, "_reshapetomono2d": 140, "rework": 140, "int16": 140, "32768": [140, 167], "_fpropdefault": 140, "_stacksign": 140, "stack_siz": 140, "_padandreshapespec": 140, "mel_spectrogram": 140, "mel_spectrogram_pad": 140, "_applypreemphasi": 140, "framed_sign": 140, "_getmelpad": 140, "pcm_audio_pad": 140, "_fpropchunk": 140, "pcm_audio_chunk": 140, "_melspectrogram": 140, "spectrogram": 140, "f32": 140, "mel_channel": 140, "fusionbas": 141, "_fproplmintern": 141, "lm_state": 141, "_fproplm": 141, "am_output": 141, "base_model_logits_dim": 141, "fused_output": 141, "_modifylmbeforefprop": 141, "computelogitswithlm": 141, "am": 141, "nullfus": 141, "asrinput": 142, "buildinputbatch": [142, 160, 197], "features_list": [142, 160, 197], "_maybepadsourceinput": 142, "errorstat": 143, "tot": 143, "levenshteindist": 143, "lst_ref": 143, "lst_hyp": 143, "postprocessinput": 144, "getrefid": 144, "ref_pad": 144, "calculatemetr": 144, "log_utf8": 144, "utf": 144, "asrmodel": 145, "_decodermetricsparam": 145, "_getdecodertarget": 145, "forwar": 145, "_makedecodertheta": 145, "ridden": 145, "ride": 145, "child_onehot": 145, "frontendandencoderfprop": 145, "input_batch_src": 145, "initial_st": 145, "_gettopk": 145, "_computenormalizedw": 145, "_gettargetfordecodermetr": 145, "_computedecodermetr": 145, "_inferencesubgraph_default": [145, 154, 162, 210], "offlin": 145, "testinputgener": 146, "_check_pad": 146, "getbpropparam": 146, "getbproptyp": 146, "sampleid": 146, "_sourc": 146, "_target": 146, "_getsourceinputsandlabel": 146, "data_sourc": 146, "setbproptyp": 146, "librispeech960bas": 148, "960": 148, "hour": 148, "_commoninputparam": [148, 202, 203], "setbuckets": 148, "devoth": 148, "testoth": 148, "librispeech960graphem": 148, "8x2": 148, "853": 148, "2k": [148, 203], "grapheme_target_sequence_length": 148, "620": 148, "grapheme_vocab_s": 148, "76": [148, 166], "initializetoken": 148, "librispeech960graphemetpuv2": 148, "librispeech960wpm": 148, "632": 148, "6k": 148, "wpm_symbol_table_filepath": 148, "wpm_16k_librispeech": 148, "wpm_target_sequence_length": 148, "140": [148, 166], "wpm_vocab_s": 148, "16328": 148, "embedding_dimens": 148, "96": [148, 166, 167], "num_training_work": 148, "librispeech960wpmtpuv2": 148, "alon": [151, 152], "script": [151, 152, 222, 224], "evalut": [151, 152], "NO": 151, "file_hypothesi": [151, 152], "file_refer": [151, 152], "diagnosis_html": 151, "diagnos": [151, 152], "averagew": 151, "computeeditdistancematrix": [151, 152], "preprocesstxtbeforew": 151, "txt": [151, 152, 164], "cacul": [151, 152], "_generatealignedhtml": 151, "err_typ": [151, 152], "highlight": [151, 152], "disagr": [151, 152], "green": [151, 152], "yellow": [151, 152], "generatesummaryfromerr": 151, "nref": 151, "diagnosi": 151, "diff": 151, "diagnoi": [151, 152], "verbos": 151, "argv": [151, 152, 222, 224, 225], "file_keyphras": 152, "phrase": 152, "_diagnoi": 152, "simplew": 152, "addhypref": 152, "getwer": 152, "getsummari": 152, "getkeyphrasestat": 152, "jaccard": 152, "jaccard_index": 152, "precision_and_recal": 152, "txtpreprocess": 152, "removecommenttxtpreprocess": 152, "brancket": 152, "highlightalignedhtml": 152, "nother": 152, "hyp_word": 152, "ref_word": 152, "key_phras": 152, "html_handler": 152, "preprocess_handl": 152, "aligned_html": 152, "hyp_keyphrase_count": 152, "ref_keyphrase_count": 152, "matched_keyphrase_count": 152, "hyp_keyphras": 152, "wer_info": 152, "insers": 152, "nw": 152, "percentag": [152, 197], "getbreakdownw": 152, "breakdown": 152, "f1_keyphras": 152, "prec": 152, "matched_keyphras": 152, "ref_keyphras": 152, "jaccard_similar": 152, "str_detail": 152, "str_str_keyphrases_info": 152, "kerphras": 152, "str_sum": 152, "topkaccuraci": 154, "baseclassifi": 154, "_addsummari": 154, "_accuraci": 154, "modelv1": 154, "maxpool": 154, "modelv2": 154, "_mnistinputbas": 155, "mnisttraininput": 155, "mnisttestinput": 155, "_getrandomimag": 155, "_getrandomlabel": 155, "fakemnistdata": 155, "tmpdir": 155, "train_siz": 155, "60000": 155, "test_siz": 155, "10000": [155, 167], "lenet": 157, "synthetic_packed_input": [159, 163, 171], "wiki_bert": [159, 163], "download_lm1b": [159, 169], "gshard_lm_decod": [159, 169], "lminput": 160, "lm1b": [160, 164, 170], "packedtextinputgener": 160, "_processsingleexampl": 160, "_datasetofexampl": 160, "_getpaddingvalu": 160, "add_segment_field": 160, "unbatch": 160, "_pack": [160, 197], "batch_in": 160, "tf_session": 160, "tfrecordbertinput": 160, "_parserecord": 160, "_padtobatchs": 160, "masked_id": 160, "baselanguagemodel": 161, "xent_output": 161, "stepoutputdimens": 161, "last_hidden": 161, "getfeeddict": 161, "combinest": 161, "switch_cond": 161, "nulllm": 161, "_rnnoutputs": 161, "computexentoutput": 161, "softmax_lay": 161, "softmax_theta": 161, "crossentropi": 161, "rnnlmnoembed": 161, "direct_featur": 161, "direct_feature_dim": 161, "rnnlm": 161, "2048": [161, 164, 166, 167, 205], "rnn_hidden_dim": 161, "layer_norm": 161, "softmax_max_alloc": 161, "couple_input_forget_g": 161, "forget": 161, "conditionalrnnlm": 161, "condition_dim": 161, "moelm": 161, "transformerlmnoembed": 161, "transformerlm": 161, "input_dropout_prob": [161, 193, 205], "attention_hidden_dim": 161, "micro_batch_s": 161, "num_shard": [161, 193], "languagemodel": 162, "_trimifpossiblethentranspos": 162, "max_lstm_gradient_norm": 162, "log_pplx_per_token": 162, "log_pplx_per_sampl": 162, "num_oovs_per_sampl": 162, "tokens_from_label": 162, "fixedshapeinputlanguagemodel": 162, "batchmajorlanguagemodel": 162, "_trimifposs": 162, "packedbatchmajorlanguagemodel": 162, "wordlevelonebwdsbas": 164, "wd": 164, "rafaljozefowicz": 164, "corpus_dir": 164, "r13output": 164, "max_token": 164, "num_embedding_shard": 164, "8192": [164, 166], "num_softmax_shard": 164, "rnn_state_dim": 164, "793472": 164, "word_vocab": 164, "wordlevelonebwdssimplesampledsoftmax": 164, "wordlevelonebwdssimplesampledsoftmaxtini": 164, "onebwdsgpipetransformerwpm": 164, "32000": [164, 166, 167, 193, 202, 205], "1bw": 164, "synthet": 166, "synthetictrain": 166, "denselmtempl": 166, "batch_dim_per_devic": 166, "0625": 166, "65536": 166, "num_transformer_lay": [166, 167, 198], "gated_gelu": [166, 167], "positional_embed": [166, 167], "denselm8b2x2": 166, "8b": 166, "125": [166, 167], "denselm8b2x2decod": [166, 171], "denselm128b8x8": 166, "128b": 166, "14": [166, 167, 202, 205, 219], "34": [166, 167], "36": [166, 167], "38": [166, 167], "40": [166, 167], "44": [166, 167], "47": [166, 167], "45": [166, 167], "43": [166, 167, 219], "41": [166, 167], "66": [166, 167], "68": 166, "70": 166, "72": 166, "74": 166, "78": 166, "79": 166, "77": 166, "75": 166, "73": 166, "71": 166, "69": 166, "67": [166, 182], "65": [166, 167], "98": 166, "102": 166, "104": 166, "106": 166, "108": 166, "110": 166, "111": 166, "109": 166, "107": 166, "105": 166, "103": 166, "101": 166, "99": 166, "97": 166, "112": 166, "114": 166, "116": 166, "118": 166, "122": 166, "124": 166, "126": [166, 167], "127": [166, 167], "121": 166, "119": 166, "117": 166, "115": 166, "113": 166, "80": 166, "82": 166, "84": 166, "86": 166, "88": 166, "90": 166, "92": 166, "94": 166, "95": 166, "93": 166, "91": 166, "89": 166, "87": 166, "85": 166, "83": 166, "81": 166, "48": [166, 167], "52": [166, 167], "54": [166, 167], "56": [166, 167, 219], "58": [166, 167], "62": [166, 167], "63": [166, 167], "61": [166, 167], "59": [166, 167], "57": [166, 167], "55": [166, 167], "53": [166, 167], "49": [166, 167], "18": [166, 167], "22": [166, 167, 171], "26": [166, 167, 219], "denselm128b16x16": 166, "v3": 166, "512": [166, 167, 205], "130": [166, 167], "132": 166, "134": 166, "136": 166, "138": 166, "142": 166, "144": 166, "146": 166, "148": 166, "150": 166, "152": 166, "154": 166, "156": 166, "158": 166, "159": 166, "157": 166, "155": 166, "153": 166, "151": 166, "149": 166, "147": 166, "145": 166, "143": 166, "141": 166, "139": 166, "137": 166, "135": 166, "133": 166, "131": 166, "129": [166, 167], "192": 166, "194": 166, "196": 166, "198": 166, "200": [166, 167], "202": 166, "204": 166, "206": 166, "208": 166, "210": 166, "212": 166, "214": 166, "216": 166, "218": 166, "220": 166, "222": 166, "223": 166, "221": 166, "219": 166, "217": 166, "215": 166, "213": 166, "211": 166, "209": 166, "207": 166, "205": 166, "203": 166, "201": 166, "199": 166, "197": 166, "195": 166, "193": 166, "258": [166, 167], "260": 166, "262": 166, "264": 166, "266": 166, "268": 166, "270": 166, "272": 166, "274": 166, "276": 166, "278": 166, "280": 166, "282": 166, "284": 166, "286": 166, "287": 166, "285": 166, "283": 166, "281": 166, "279": 166, "277": 166, "275": 166, "273": 166, "271": 166, "269": 166, "267": 166, "265": 166, "263": 166, "261": 166, "259": 166, "257": [166, 167], "320": 166, "322": 166, "324": 166, "326": 166, "328": 166, "330": 166, "332": 166, "334": 166, "336": 166, "338": 166, "340": 166, "342": 166, "344": 166, "346": 166, "348": 166, "350": 166, "351": 166, "349": 166, "347": 166, "345": 166, "343": 166, "341": 166, "339": 166, "337": 166, "335": 166, "333": 166, "331": 166, "329": 166, "327": 166, "325": 166, "323": 166, "321": 166, "384": 166, "386": 166, "388": 166, "390": 166, "392": 166, "394": 166, "396": 166, "398": 166, "400": 166, "402": 166, "404": 166, "406": 166, "408": 166, "410": 166, "412": 166, "414": 166, "415": 166, "413": 166, "411": 166, "409": 166, "407": 166, "405": 166, "403": 166, "401": 166, "399": 166, "397": 166, "395": 166, "393": 166, "391": 166, "389": 166, "387": 166, "385": 166, "448": 166, "450": 166, "452": 166, "454": 166, "456": 166, "458": 166, "460": 166, "462": 166, "464": 166, "466": 166, "468": 166, "470": 166, "472": 166, "474": 166, "476": 166, "478": 166, "479": 166, "477": 166, "475": 166, "473": 166, "471": 166, "469": 166, "467": 166, "465": 166, "463": 166, "461": 166, "459": 166, "457": 166, "455": 166, "453": 166, "451": 166, "449": 166, "480": 166, "482": 166, "484": 166, "486": 166, "488": 166, "490": 166, "492": 166, "494": 166, "496": 166, "498": 166, "500": 166, "502": 166, "504": 166, "506": 166, "508": 166, "510": [166, 167], "511": [166, 167], "509": [166, 167], "507": 166, "505": 166, "503": 166, "501": 166, "499": 166, "497": 166, "495": 166, "493": [166, 171], "491": 166, "489": 166, "487": 166, "485": 166, "483": 166, "481": 166, "416": 166, "418": 166, "420": 166, "422": 166, "424": 166, "426": 166, "428": 166, "430": 166, "432": [166, 171], "434": 166, "436": 166, "438": 166, "440": 166, "442": 166, "444": 166, "446": 166, "445": 166, "443": 166, "441": 166, "439": 166, "437": 166, "435": 166, "433": 166, "431": 166, "427": 166, "425": 166, "423": 166, "421": 166, "419": 166, "417": 166, "352": 166, "354": 166, "356": 166, "358": 166, "360": 166, "362": 166, "364": 166, "366": 166, "368": 166, "370": 166, "372": 166, "374": 166, "376": 166, "378": 166, "380": [166, 186], "382": 166, "383": 166, "381": 166, "379": 166, "377": 166, "375": 166, "373": 166, "371": 166, "369": 166, "367": 166, "365": 166, "363": 166, "361": 166, "359": 166, "357": 166, "355": 166, "353": 166, "288": 166, "290": 166, "292": 166, "294": 166, "296": 166, "298": 166, "302": 166, "304": 166, "306": 166, "308": 166, "310": 166, "312": 166, "314": 166, "316": 166, "318": 166, "319": 166, "317": 166, "315": 166, "313": 166, "311": 166, "309": 166, "307": 166, "305": 166, "303": 166, "301": 166, "299": [166, 186], "297": 166, "295": 166, "293": 166, "291": 166, "289": 166, "224": 166, "226": 166, "228": 166, "230": 166, "232": 166, "234": 166, "236": 166, "238": 166, "240": 166, "242": 166, "244": 166, "246": 166, "248": 166, "250": 166, "252": 166, "254": [166, 167], "255": [166, 167], "253": [166, 167], "251": 166, "249": 166, "247": 166, "245": 166, "243": 166, "241": 166, "239": 166, "237": 166, "235": 166, "233": 166, "229": 166, "227": 166, "225": 166, "160": 166, "162": 166, "164": 166, "166": 166, "168": 166, "170": 166, "172": 166, "174": 166, "176": 166, "178": 166, "180": 166, "182": 166, "184": 166, "186": 166, "188": 166, "190": [166, 167], "191": [166, 167], "189": [166, 167], "187": 166, "185": 166, "183": 166, "181": 166, "179": 166, "177": 166, "175": 166, "173": 166, "171": 166, "169": 166, "167": 166, "165": 166, "163": 166, "161": 166, "denselm175b32x32": 166, "175b": [166, 167], "49152": [166, 167], "12288": [166, 167], "1856": [166, 167], "1920": [166, 167], "1984": [166, 167], "1857": [166, 167], "1921": [166, 167], "1985": [166, 167], "1858": [166, 167], "1922": [166, 167], "1986": [166, 167], "1917": [166, 167], "1981": [166, 167], "2045": [166, 167], "1918": [166, 167], "1982": [166, 167], "2046": [166, 167], "1919": [166, 167], "1983": [166, 167], "2047": [166, 167], "denselm175b32x32dp": 166, "denselm175b1k": 166, "v4": 166, "976": [166, 167], "977": [166, 167], "978": [166, 167], "989": [166, 167], "990": [166, 167], "991": [166, 167], "992": [166, 167], "993": [166, 167], "994": [166, 167], "1005": [166, 167], "1006": [166, 167], "1007": [166, 167], "1008": [166, 167, 199], "1009": [166, 167], "1010": [166, 167], "1021": [166, 167], "1022": [166, 167], "1023": [166, 167], "denselm13b32x32": 166, "5120": [166, 167], "20480": [166, 167], "denselm175b8x8decode2d": 166, "denselm1t16x16": 166, "1t": [166, 167], "03125": 166, "131072": [166, 167], "16384": [166, 167], "denselm128b32x32": 166, "shardedadamoptim": 166, "999": [166, 193], "adamoptim": 166, "shardedadam": 166, "denselm12kwide41badam16x16": 166, "41b": 166, "denselm12kwide41badam8x8": 166, "denselm12kwide162badam16x16": 166, "162b": 166, "denselm12kwide162badambs25616x16": 166, "denselm12kwide162badam32x32": 166, "berttempl": 167, "attention_dropout_r": 167, "loss_denomin": 167, "train_exes_per_ev": 167, "gated_ffn_act": 167, "mlperftraintempl": 167, "mlperftrainbertdense2b": 167, "2b": 167, "30522": 167, "mlperfbertdense1t": 167, "chip": 167, "mlperfbertdense1twid": 167, "mlperfbertdense175b": 167, "mlperfbertdense500b": 167, "481b": 167, "remove_mask": 167, "mlperfbertdense500b2k": 167, "1280": 167, "1536": 167, "1792": 167, "513": 167, "1281": 167, "1537": 167, "1793": 167, "514": 167, "1282": 167, "1538": 167, "1794": 167, "765": 167, "1533": 167, "1789": 167, "766": 167, "1534": 167, "1790": 167, "767": 167, "1535": 167, "1791": 167, "mlperfbertdense13b32x32": 167, "13b": 167, "berttoken": 168, "detoken": 168, "www": [170, 186, 215], "statmt": 170, "print_output": 171, "gshardlmdecod": 171, "init_vocab": 171, "encode_string_to_id": 171, "decode_ids_to_str": 171, "override_flag": 171, "ids_to_strings_pack": 171, "skip_empti": 171, "preload_lm_prompt": 171, "tsv_file": 171, "tsv_data": 171, "append_extra_eo": 171, "preload": 171, "prompt": 171, "tsv": [171, 197], "read_files_1_col": 171, "tack": 171, "delimited_lm": 171, "lineno": 171, "fileno": 171, "read_file_1_col": 171, "gshardlmdecodebatch": 171, "preload_data": 171, "write_ith_sample_to_output": 171, "batch_decod": 171, "unused_argv": [171, 228], "cxc": [172, 180, 188], "dual_encoder_recip": [172, 180], "generic_dataset": [172, 180], "prepare_coco": [172, 187], "_featur": 173, "imagefeatur": 173, "images_per_exampl": 173, "usabl": 173, "textfeatur": 173, "captions_per_exampl": 173, "bert_embeddings_shap": 173, "schema": [173, 175], "audiofeatur": 173, "mfcc_shape": 173, "cpc8k_shape": 173, "mfcc": 173, "cpc": 173, "8k": 173, "magic": 174, "modal": [174, 176, 179, 185], "items_per_exampl": 175, "modality_batch_shap": [175, 179], "datasetspec": [175, 182], "_inferdefaultbatchshap": 175, "datasetv2": 175, "examplepair": [175, 179, 183], "filebaseddatasetspec": 175, "split_path": 175, "file_read": 175, "parser": 175, "label_fn": 175, "input_filepattern": 175, "shuffle_buffer_s": 175, "num_exampl": 175, "num_epoch": 175, "read_parallel": 175, "tfrecorddatasetspec": [175, 183], "fixedlenfeatur": 175, "fixedlensequencefeatur": 175, "_encodebatch": 176, "batch_shap": [176, 191], "encoderconfig": 176, "dualencod": 176, "encodemod": 176, "joint_embedding_dim": 176, "milantask": 176, "cloud": [177, 228], "repo": 177, "_distortbrightnessandcolor": 177, "distort": 177, "bright": 177, "color": 177, "imagepreprocessor": [177, 182], "incept": 177, "jpeg": 177, "rgb": 177, "resiz": 177, "output_image_s": 177, "output_rang": 177, "undergo": 177, "crop": 177, "training_crop_min_area": 177, "bilinearli": 177, "eval_crop_area": 177, "_preprocessfortrain": 177, "_preprocessforev": 177, "encoded_imag": 177, "milaninputgener": 178, "dataset_fn": 178, "dataset_fn_kwarg": 178, "preprocessor": [178, 182], "preprecessor": 178, "foopreprocessor": 178, "_filterfeaturesbynam": 178, "tradit": 179, "supervis": 179, "fly": 179, "relationship": 179, "fit": [179, 197], "priori": 179, "unrel": 179, "incorrect": 179, "unnecessari": 179, "example_id": 179, "easi": 179, "detect": 179, "trinari": 179, "ignore_pair_label": 179, "query_exampl": 179, "query_mod": 179, "result_exampl": 179, "result_mod": 179, "superset": 179, "query_batch_s": 179, "result_batch_s": 179, "rectangular": 179, "constitut": 179, "withinbatch": 179, "betweenlocalandglobalbatch": 179, "local_batch": 179, "examplepairlabel": 179, "drop_pairs_that_match": 179, "_broadcastexamplepairlabelstoallitempair": 179, "example_pair_label": 179, "queries_shap": 179, "results_shap": 179, "_ignorepairswher": 179, "multiitemexamplewrapp": 179, "former": 179, "modality_shap": 179, "intra": 179, "multilabelcontrastiveloss": 179, "positive_class": 179, "p_i": 179, "positive_class_i": 179, "softmax_cross_entropy_with_logit": 179, "crisscross": [181, 188], "parekh": 181, "al": 181, "intramod": 181, "intermod": 181, "judgment": 181, "coco": [181, 188], "eacl": 181, "15020": 181, "_baseimagetextrecip": 181, "dualencoderrecip": [181, 182], "recip": [181, 182], "addefficientnetb4imageencod": 181, "image_featur": [181, 182], "id_featur": [181, 182], "addbertadaptertextencod": 181, "bert_embeddings_featur": 181, "token_featur": 181, "lengths_featur": 181, "768": 181, "efficientnetb4bertadapt": 181, "efficientnet": [181, 186], "b4": [181, 186], "default_dataset": [181, 182], "recipeerror": 182, "advertis": 182, "myexperi": 182, "addmod": 182, "input_featur": 182, "text_featur": 182, "text_id": 182, "mytextencod": 182, "encoder_output_dim": 182, "addpreprocessor": 182, "image_id": 182, "myimageencod": 182, "_choosedatasetspec": 182, "encoder_config": 182, "startfromcheckpoint": 182, "tracker": [182, 188], "_simpleimagecaptiondatasetlabel": 183, "image_id_featur": 183, "imagetexttfrecord": 183, "common_shema": 183, "paramsfromenv": 183, "environment_vari": 183, "milan_dataset_config_json": 183, "die_if_unset": 183, "dotproductscorefunct": 185, "x_batch_siz": 185, "encoded_dim": 185, "y_batch_siz": 185, "_wrapnonlingvovar": 186, "dest_lay": 186, "trainable_vari": 186, "trackabl": 186, "_addupdateopstosignatur": 186, "hub": [186, 188], "imagemodul": 186, "common_signatur": 186, "inception_model": 186, "inception_v3": 186, "module_path": 186, "tfhub": 186, "imagenet": 186, "feature_vector": 186, "update_batch_norm": 186, "imagemodulev2": 186, "efficientnet_b4": 186, "efficientnetb4param": 186, "web": 188, "tensorflow_dataset": 188, "tensorflow_hub": 188, "gb": 188, "storag": 188, "tfds_data_dir": 188, "tfhub_cache_dir": 188, "my": 188, "tfhubbertencod": 188, "input_str": 188, "padded_featur": 188, "bert_feature_dim": 188, "dict_to_example_proto": 188, "example_dict": 188, "readcocofromtfdsfn": 188, "unused_arg": 188, "dofn": 188, "coco_capt": 188, "dofnrunn": 188, "pcollect": 188, "elementparam": 188, "timestampparam": 188, "sideinputparam": 188, "windowparam": 188, "timerparam": 188, "userst": 188, "runtimetim": 188, "stateparam": 188, "runtimest": 188, "keyparam": 188, "restrictionparam": 188, "iobas": 188, "restrictiontrack": 188, "treatment": 188, "splittabl": 188, "watermarkestimatorparam": 188, "watermark": 188, "encodecaptionsfn": 188, "encoder_param": 188, "bundl": 188, "transient": 188, "dispos": 188, "teardown": 188, "concatenateacrossreplica": 189, "stop_cross_gradi": 189, "crossreplicaconcat": 189, "local_tensor": 189, "neon": 189, "gettransformerstackwithembeddinginput": 190, "fixed_dim_encod": 190, "batchmajortotimemajor": 191, "makefnlay": 191, "add_two_th": 191, "getfromnestedmapordi": 191, "di": 191, "nice": 191, "selector": 191, "restructur": 191, "simplest": 191, "tuple_selector": 191, "fancy_selector": 191, "inferbatchs": 191, "resolvebatchdim": 191, "batchflatten": 191, "mess": 191, "bf": 191, "flat_input": 191, "flat_output": 191, "unflatten": 191, "nearli": 191, "fewer": 191, "flat_tensor": 191, "_packa": 191, "_getflatshap": 191, "flattenbatch": 191, "unflattenbatch": 191, "collectregularizationloss": 191, "regularzi": 191, "padortrimdimens": 191, "new_siz": 191, "xendec": [192, 199, 200], "wmt14_en_d": [192, 200, 204], "wmtm16_en_d": [192, 200], "inittraindatasetparam": 193, "nmtinput": [193, 197], "inittestdatasetparam": 193, "inittransformertestbucket": 193, "inittransformertrainbucket": 193, "setuptransformerparam": 193, "label_smoothing_uncertainti": 193, "is_transpar": [193, 195, 196, 198], "add_unnormalized_residu": 193, "atten_hidden_dim": 193, "num_encoder_lay": 193, "num_decoder_lay": 193, "16000": [193, 212], "4000": [193, 205], "40000": 193, "vaswani": 193, "2017": 193, "setuptransformerdecod": 193, "setuptransformerencod": 193, "setuprnmtparam": 193, "lr_warmup_step": 193, "lr_decay_start": 193, "lr_decay_end": 193, "lr_min": 193, "ls_uncertainti": 193, "l2_regularizer_weight": 193, "adam_beta1": 193, "adam_beta2": 193, "adam_epsilon": 193, "8e": 193, "07": 193, "rnmt": [193, 199, 212], "setupxendectransformerparam": 193, "use_dim_scal": 193, "dim_scal": 193, "seq_id": 194, "mtbasedecod": 195, "_computexentloss": 195, "time_axi": 195, "_computesoftmaxmetr": 195, "xent_loss": 195, "_fpropsoftmax": 195, "_truncatetargetsequ": 195, "_addattenprobssummari": 195, "_expandtonumhyp": 195, "source_enc_len": 195, "src_enc_len": 195, "mtdecoderv1": 195, "_float_dtype_max_scal": 195, "05": 195, "_createproject": 195, "proj_tpl": 195, "applydropout": 195, "_zerooutfirsttimestep": 195, "token_emb": 195, "samplesequencedecod": 195, "_initdecod": 195, "_getattentioninitst": 195, "_decoderinit": 195, "_setattentioninitst": 195, "_getattentionsourcest": 195, "rnn_state": 195, "atten_st": 195, "_forcealign": 195, "source_num_sent": 195, "hyp_num_sent": 195, "sentence_boundary_token_id": 195, "misalign": 195, "unequ": 195, "_updatelogitsforsingletokenfastdecod": 195, "is_single_token": 195, "_removeeosprob": 195, "num_trans_lay": 195, "target_length": [195, 199], "last_decoder_out": 195, "_addattenprobsscalarsummari": 195, "primarili": 195, "reveal": 195, "multi_headed_atten_prob": 195, "1_v_2": 195, "1_v_3": 195, "3rd": 195, "source_padding_ratio": 195, "1_v_mean": 195, "quantiti": 195, "insertiondecod": 195, "transformerbatchmajordecod": 195, "_maybetransposeencoderoutput": 195, "target_data_format": 195, "_maybetransposetarget": 195, "input_data_format": 195, "updated_prefix_st": 195, "_fpropfastsoftmax": 195, "xentropi": 195, "bs_result": 195, "transformerxdecod": 195, "mainli": 195, "kl": 195, "interpolation_batch": [195, 196], "source_emb": [195, 199], "ref_prob": 195, "tesnor": 195, "mtencoderv1": 196, "mtencoderunirnn": 196, "mtencoderbirnn": 196, "_computeinput": 196, "mtencoderbirnnprecomputedembed": 196, "transformer_stack": 196, "embedded_input": 196, "transformerbatchmajorencod": 196, "builder_param": 196, "selfatten_add_unnormalized_input": 196, "selfatten_enable_value_proj": 196, "output_data_format": 196, "transformerxencod": 196, "2106": [196, 199, 205], "04060": [196, 199, 205], "mlperfinput": 197, "_getsegmentpo": 197, "_getdescriptorsetfortextinput": 197, "textpackedinput": 197, "textinput": 197, "utf8": 197, "input_file_typ": 197, "tab": 197, "sentencepair": [197, 206], "quality_score_filter_fn": 197, "tokenizer_dict": 197, "packing_factor": 197, "discard": 197, "src_packed_token_ratio": 197, "tgt_packed_token_ratio": 197, "fluctuat": 197, "believ": 197, "remedi": 197, "conserv": 197, "num_samples_in_batch": 197, "exmpl": 197, "num_packed_exampl": 197, "targt": 197, "conrol": 197, "meaning": 197, "file_pattern_task_id": 197, "task_to_": 197, "_lang_map": 197, "eaxmpl": 197, "souce_id": 197, "lang_id": 197, "overload": 197, "logical_and": 197, "multithread": 197, "num_batcher_thread": 197, "_getbucketkei": 197, "_gettaskid": 197, "_getlangid": 197, "_processsingleinput": 197, "_processmassinput": 197, "_readrecordtsv": 197, "_readrecordtsvsinglecolumn": 197, "_readrecordsentencepairproto": 197, "_applypack": 197, "_scaledbatchs": 197, "_addnois": 197, "00043": 197, "hyparam": 197, "denois": 197, "shuffle_tok_rang": 197, "drop_tok_prob": 197, "blank_tok_prob": 197, "noise_sent_prob": 197, "nmtdoubleinput": 197, "monolingu": 197, "mono_source_id": 197, "mono_target_id": 197, "mono_source_pad": 197, "padd": 197, "mono_target_label": 197, "mono_target_pad": 197, "mono_target_weight": 197, "natural_ord": 197, "narur": 197, "nmtinputwithmono": 197, "_selectmaskposit": 197, "sampled_num": 197, "_shuffleword": 197, "permutation_dist": [197, 205], "_maskword": 197, "_generatenoises": 197, "_createsourcelambda": 197, "_processbatch": 197, "transformer_input": 198, "num_transparent_output": 198, "mtbasemodel": 199, "_encoderdevic": 199, "_decoderdevic": 199, "_gettokenizerkeytous": 199, "_beamsearchdecod": 199, "_postprocessbeamsearchdecodeout": 199, "rnmtmodel": [199, 210, 212], "p18": 199, "hybridmodel": 199, "insertionmodel": 199, "_samplecanvasandtarget": 199, "_createcanvasandtarget": 199, "transformerxendecmodel": 199, "_createtargetlambda": 199, "source_lambdas_pair": 199, "source_paddings_pair": 199, "target_paddings_pair": 199, "input_lambda": 199, "label_lambda": 199, "other_batch": 199, "source_lambda": 199, "target_lambda": 199, "conta": 199, "wmt": [202, 203, 205], "german": [202, 203, 205], "wmtendetransformerbas": 202, "datadir": [202, 203, 205], "wmt14": 202, "wmtendetransformersmal": 202, "wmtendetransformersmallcloudtpu": 202, "wmtendernmt": 202, "wmtendernmtcloudtpu": 202, "mmt": 203, "wmtcaptionendetransform": 203, "wmtm16": 203, "2000": 203, "vocab_fil": [203, 219], "voc": 203, "wmtcaptionendetransformercloudtpu": 203, "wmtendexendec": 205, "wmt14end": 205, "datatrain": 205, "datadev": 205, "newstest2013": 205, "00000": 205, "00001": 205, "datatest": 205, "newstest2014": 205, "wpm32k": 205, "source_mask_ratio": 205, "source_mask_ratio_beta": 205, "mask_word_id": 205, "pad_id": 205, "mask_words_ratio": 205, "loss_mix_weight": 205, "loss_clean_weight": 205, "loss_mono_weight": 205, "batch_size_ratio": 205, "4506303": 205, "use_prob_cl": 205, "atten_drop": 205, "use_atten_cl": 205, "use_prob_drop": 205, "_evalparam": 205, "wmtdeenxendec": 205, "wmt14deen": 205, "lang": 206, "src_sentenc": 206, "tgt_sentenc": 206, "codelab": [208, 211], "download_brown_corpu": [208, 214], "textlin": 209, "punctuatorinput": 209, "_process": 209, "_processlin": 209, "_getsequencelength": 209, "browncorpuswpm": 212, "brown": [212, 215], "_datadir": 212, "punctuator_data": 212, "_vocab_fil": 212, "brown_corpus_wpm": 212, "_vocab_s": 212, "nltk": 215, "nltk_data": 215, "decodeflactowav": 217, "input_byt": 217, "flac": 217, "wav": 217, "decodewav": 217, "audiotomfcc": 217, "sample_r": 217, "window_size_m": 217, "window_stride_m": 217, "num_coeffici": 217, "extractlogmelfeatur": 217, "wav_bytes_t": 217, "16khz": 217, "car": 218, "beaminit": 218, "getpipelineroot": 218, "pardo": 218, "exit": 218, "pipeline_opt": 218, "pipelineopt": 218, "getread": 218, "value_cod": 218, "coder": 218, "getwrit": 218, "getemitterfn": 218, "emitt": 218, "words_to_id": 219, "THAT": 219, "THE": 219, "THEIR": 219, "workflow": 219, "train_fil": 219, "code_fil": 219, "train_bpe_fil": 219, "words_to_ids_fil": 219, "_getvocabulari": 219, "_extracttoken": 219, "encoded_filepath": 219, "_hyperparams_text_to_dict": 220, "cfg_text": 220, "hyperparams_text_diff": 220, "cfg1_text": 220, "cfg2_text": 220, "cfg1_not_cfg2": 220, "cfg1": 220, "cfg2": 220, "cfg2_not_cfg1": 220, "cfg1_and_cfg2_diff": 220, "print_hyperparams_text_diff": 220, "path1": 220, "path2": 220, "get_model_params_as_text": 220, "model_path": 220, "statscollector": 221, "_accumulatemo": 221, "float_list": 221, "_computemeanvar": 221, "tf_ex": 221, "_printlengthbucket": 221, "_printmeanvar": 221, "littl": 222, "leverag": 222, "recommend": 222, "tarbal": 223, "_makebytesfeatur": [223, 227], "unicode_arrai": [223, 227], "_makeint64featur": [223, 227], "_makefloatfeatur": [223, 227], "_maketfexampl": [223, 227], "uttid": 223, "_readtranscript": 223, "_dumptranscript": 223, "_loadtranscriptionsfromfil": 223, "_makelogmelfromtensorflowbuiltin": 223, "tf_wav_byt": 223, "_opensubshard": 223, "_closesubshard": 223, "_selectrandomshard": 223, "_createasrfeatur": 223, "launch": 224, "gke": 224, "deploy": 224, "gc": 224, "docker": 224, "gcp": 224, "instal": 224, "gcloud": 224, "base_imag": 224, "date": 224, "trainer_cel": 224, "decoder_cel": 224, "yaml": 224, "python3": 224, "lingvo_lib_gpu": 224, "docker_imag": 224, "tpu_typ": 224, "tpu_cluster_nam": 224, "gpu_cluster_nam": 224, "decoder_gpu": 224, "gpu_typ": 224, "extra_env": 224, "kitti_dir": 224, "gcs_path": 224, "exp_nam": 224, "your_code_dir": 224, "action": 224, "_get_or_add": 224, "add_gpu_to_pod": 224, "num_gpu": 224, "set_pod_cpu_memori": 224, "cpu_memori": 224, "decoder_templ": 224, "_tpu_resourc": 224, "tpu_training_templ": 224, "tensorboard_templ": 224, "port": 224, "build_docker_imag": 224, "code_directori": 224, "push": 224, "gcr": 224, "get_gke_clust": 224, "gke_cluster_spec": 224, "shorthand": 224, "p100": 224, "europ": 224, "west4": 224, "nh16": 224, "qualifi": 224, "create_tpu_clust": 224, "cluster_nam": 224, "validate_arg": 224, "usageerror": 224, "_listdebugstr": 226, "to_str": 226, "_customshortdebugstr": 226, "tf_exampl": 226, "_printhead": 226, "_printfil": 226, "_asserttextformat": 227, "src_i": 227, "src_": 227, "tgt_i": 227, "tgt_": 227, "tfexampl": 227, "_runencod": 227, "bin": 228, "logtostderr": 228, "run_loc": 228, "cuda": 228, "command": 228, "_validatevizierreportingjob": 228, "_getclusterspecdict": 228, "cluster_spec": 228, "runnermanag": 228, "maybelaunchtensorflow": 228, "machineri": 228, "high_level": 228, "getparamsfordataset": 228, "maybeconfigrundistribut": 228, "maybeconfigcloudtpu": 228, "updateclusterparamsfromflag": 228, "_createrunn": 228, "createrunn": 228, "startrunn": 228, "all_runn": 228, "runtrial": 228, "maybeconfigrunloc": 228, "inspectparam": 228, "inspect_param": 228, "inspectmodel": 228, "inspectdataset": 228, "inspectdecod": 228, "setmodelnam": 228, "writeinferencegraph": 228, "runevaleronc": 228}, "objects": {"": [[1, 0, 0, "-", "lingvo"]], "lingvo": [[2, 0, 0, "-", "base_runner"], [3, 0, 0, "-", "base_trial"], [4, 0, 0, "-", "compat"], [5, 0, 0, "-", "core"], [123, 0, 0, "-", "datasets"], [124, 0, 0, "-", "eager_runners"], [125, 0, 0, "-", "executor"], [127, 0, 0, "-", "model_imports"], [128, 0, 0, "-", "model_registry"], [129, 0, 0, "-", "models_test_helper"], [130, 0, 0, "-", "pdb_wrapper"], [131, 0, 0, "-", "runners"], [132, 0, 0, "-", "tasks"], [216, 0, 0, "-", "tools"], [228, 0, 0, "-", "trainer"], [229, 0, 0, "-", "trainer_utils"]], "lingvo.base_runner": [[2, 1, 1, "", "BaseRunner"]], "lingvo.base_runner.BaseRunner": [[2, 2, 1, "", "GetTrainDir"], [2, 2, 1, "", "Start"], [2, 2, 1, "", "_CreateCheckpointer"], [2, 2, 1, "", "_CreateSummaryWriter"], [2, 2, 1, "", "_CreateTF2SummaryOps"], [2, 2, 1, "", "_CreateTF2SummaryWriter"], [2, 2, 1, "", "_DequeueThreadComplete"], [2, 2, 1, "", "_ExportMetrics"], [2, 2, 1, "", "_FindNewCheckpoint"], [2, 2, 1, "", "_FormatStatusMessage"], [2, 2, 1, "", "_GetSession"], [2, 2, 1, "", "_GetTtlDir"], [2, 2, 1, "", "_InVizierStudy"], [2, 2, 1, "", "_InitializeTF2SummaryWriter"], [2, 2, 1, "", "_LoopEnqueue"], [2, 2, 1, "", "_RunLoop"], [2, 2, 1, "", "_RunOnAllCheckpoints"], [2, 2, 1, "", "_RunOnLatestCheckpoints"], [2, 2, 1, "", "_RunTF2SummaryOps"], [2, 2, 1, "", "_SetStatusMessage"], [2, 2, 1, "", "_ShouldEarlyStop"], [2, 2, 1, "", "_ShouldStop"], [2, 2, 1, "", "_TF2SummaryContext"], [2, 2, 1, "", "_TrainerFinished"], [2, 2, 1, "", "_UpdateEarlyStopMetric"], [2, 2, 1, "", "_WaitUntilInit"], [2, 2, 1, "", "_WriteInputDataStatSummaries"], [2, 2, 1, "", "_WriteSummaries"], [2, 2, 1, "", "_WriteToLog"], [2, 3, 1, "", "params"]], "lingvo.base_trial": [[3, 1, 1, "", "NoOpTrial"], [3, 1, 1, "", "Trial"], [3, 4, 1, "", "TunerManagedError"]], "lingvo.base_trial.NoOpTrial": [[3, 2, 1, "", "Name"], [3, 2, 1, "", "OverrideModelParams"], [3, 2, 1, "", "ReportDone"], [3, 2, 1, "", "ReportEvalMeasure"], [3, 2, 1, "", "ShouldStop"], [3, 2, 1, "", "ShouldStopAndMaybeReport"]], "lingvo.base_trial.Trial": [[3, 2, 1, "", "Name"], [3, 2, 1, "", "OverrideModelParams"], [3, 2, 1, "", "Params"], [3, 2, 1, "", "ReportDone"], [3, 2, 1, "", "ReportEvalMeasure"], [3, 2, 1, "", "ShouldStop"], [3, 2, 1, "", "ShouldStopAndMaybeReport"], [3, 2, 1, "", "_DoReportTrainingProgress"], [3, 3, 1, "", "objective_metric_key"], [3, 3, 1, "", "report_interval_seconds"]], "lingvo.compat": [[4, 1, 1, "", "_CacheDataset"], [4, 1, 1, "", "_ShuffleDataset"], [4, 6, 1, "", "_clone_module"], [4, 6, 1, "", "stateless_cache_dataset"], [4, 6, 1, "", "stateless_list_files"], [4, 6, 1, "", "stateless_shuffle_dataset"], [4, 6, 1, "", "summarize_tf2_status"], [4, 1, 1, "", "variable_scope"]], "lingvo.compat._CacheDataset": [[4, 5, 1, "", "_abc_impl"]], "lingvo.compat._ShuffleDataset": [[4, 5, 1, "", "_abc_impl"]], "lingvo.core": [[6, 0, 0, "-", "activations"], [7, 0, 0, "-", "adagraft"], [8, 0, 0, "-", "attention"], [9, 0, 0, "-", "attention_util"], [10, 0, 0, "-", "base_decoder"], [11, 0, 0, "-", "base_input_generator"], [12, 0, 0, "-", "base_layer"], [13, 0, 0, "-", "base_model"], [14, 0, 0, "-", "base_model_params"], [15, 0, 0, "-", "batch_major_attention"], [16, 0, 0, "-", "batch_utils"], [17, 0, 0, "-", "beam_search_helper"], [18, 0, 0, "-", "bfloat16_variables"], [19, 0, 0, "-", "bn_layers"], [20, 0, 0, "-", "build_data"], [21, 0, 0, "-", "builder"], [22, 0, 0, "-", "builder_layers"], [23, 0, 0, "-", "checkpointer"], [24, 0, 0, "-", "cluster"], [25, 0, 0, "-", "cluster_factory"], [26, 0, 0, "-", "computation_cost"], [27, 0, 0, "-", "conformer_layer"], [28, 0, 0, "-", "constants"], [29, 0, 0, "-", "conv_layers_builder"], [30, 0, 0, "-", "conv_layers_with_time_padding"], [31, 0, 0, "-", "datasource"], [32, 0, 0, "-", "datasource_tfds"], [33, 0, 0, "-", "decoder_lib"], [34, 0, 0, "-", "differentiable_assignment"], [35, 0, 0, "-", "distillation_task"], [36, 0, 0, "-", "distributed_shampoo"], [37, 0, 0, "-", "early_stop"], [38, 0, 0, "-", "egdd"], [39, 0, 0, "-", "entmax"], [40, 0, 0, "-", "favor_attention"], [41, 0, 0, "-", "flat_beam_search_helper"], [42, 0, 0, "-", "generic_input"], [43, 0, 0, "-", "gpipe"], [44, 0, 0, "-", "graddrop"], [45, 0, 0, "-", "gradient_combiner"], [46, 0, 0, "-", "gshard_builder"], [47, 0, 0, "-", "gshard_decode"], [48, 0, 0, "-", "gshard_layers"], [49, 0, 0, "-", "gshard_utils"], [50, 0, 0, "-", "hyperparams"], [51, 0, 0, "-", "hyperparams_pb2"], [52, 0, 0, "-", "inference_graph_exporter"], [53, 0, 0, "-", "inference_graph_pb2"], [54, 0, 0, "-", "input_generator_helper"], [55, 0, 0, "-", "input_policy"], [56, 0, 0, "-", "insertion"], [57, 0, 0, "-", "inspect_utils"], [58, 0, 0, "-", "layers"], [59, 0, 0, "-", "layers_with_attention"], [60, 0, 0, "-", "layers_with_gpipe"], [61, 0, 0, "-", "learner"], [62, 0, 0, "-", "lstm_frnn_layer"], [63, 0, 0, "-", "matrix_functions"], [64, 0, 0, "-", "metrics"], [65, 0, 0, "-", "ml_perf_bleu_metric"], [66, 0, 0, "-", "ml_perf_log"], [67, 0, 0, "-", "ml_perf_tokenizer"], [68, 0, 0, "-", "model_helper"], [69, 0, 0, "-", "multitask_model"], [70, 0, 0, "-", "nested_map"], [71, 0, 0, "-", "ops"], [76, 0, 0, "-", "optimizer"], [77, 0, 0, "-", "plot"], [78, 0, 0, "-", "predictor"], [79, 0, 0, "-", "predictor_runner_base"], [80, 0, 0, "-", "program"], [81, 0, 0, "-", "program_utils"], [82, 0, 0, "-", "pruning_utils"], [83, 0, 0, "-", "py_utils"], [84, 0, 0, "-", "py_utils_flags"], [85, 0, 0, "-", "quant_test_lib"], [86, 0, 0, "-", "quant_utils"], [87, 0, 0, "-", "recurrent"], [88, 0, 0, "-", "repeat_layer"], [89, 0, 0, "-", "retry"], [90, 0, 0, "-", "reversible_layers"], [91, 0, 0, "-", "rnn_cell"], [92, 0, 0, "-", "rnn_layers"], [93, 0, 0, "-", "routing_config_helper"], [94, 0, 0, "-", "saver"], [95, 0, 0, "-", "scatter_update"], [96, 0, 0, "-", "schedule"], [97, 0, 0, "-", "scorers"], [98, 0, 0, "-", "self_attention_layer"], [99, 0, 0, "-", "sendrecv"], [100, 0, 0, "-", "spectrum_augmenter"], [101, 0, 0, "-", "spectrum_augmenter_on_device"], [102, 0, 0, "-", "step"], [103, 0, 0, "-", "steps"], [107, 0, 0, "-", "stream_step_test_base"], [108, 0, 0, "-", "summary_utils"], [109, 0, 0, "-", "symbolic"], [110, 0, 0, "-", "target_sequence_sampler"], [111, 0, 0, "-", "task_scheduler"], [112, 0, 0, "-", "test_helper"], [113, 0, 0, "-", "test_trainer_utils"], [114, 0, 0, "-", "test_utils"], [115, 0, 0, "-", "thread_local_utils"], [116, 0, 0, "-", "tokenizers"], [117, 0, 0, "-", "tpu_embedding_layers"], [118, 0, 0, "-", "tpu_summary"], [119, 0, 0, "-", "trainer_test_utils"], [120, 0, 0, "-", "tshape"], [121, 0, 0, "-", "var_tmp_wrappers"], [122, 0, 0, "-", "wpm_encoder"]], "lingvo.core.activations": [[6, 1, 1, "", "ActivationLayer"], [6, 6, 1, "", "DimMultiplier"], [6, 6, 1, "", "GLUVariants"], [6, 6, 1, "", "GetFlops"], [6, 6, 1, "", "GetFn"], [6, 6, 1, "", "IsSupported"]], "lingvo.core.activations.ActivationLayer": [[6, 2, 1, "", "FProp"], [6, 2, 1, "", "FPropMeta"], [6, 2, 1, "", "Params"]], "lingvo.core.adagraft": [[7, 1, 1, "", "AdaGraftOptimizer"]], "lingvo.core.adagraft.AdaGraftOptimizer": [[7, 2, 1, "", "_apply_dense"], [7, 2, 1, "", "_apply_sparse"], [7, 2, 1, "", "_create_slots"], [7, 2, 1, "", "_finish"], [7, 2, 1, "", "_internal_apply_dense"], [7, 2, 1, "", "_prepare"], [7, 2, 1, "", "_resource_apply_dense"], [7, 2, 1, "", "_resource_apply_sparse"]], "lingvo.core.attention": [[8, 1, 1, "", "AdditiveAttention"], [8, 1, 1, "", "BaseAttentionLayer"], [8, 1, 1, "", "DotProductAttention"], [8, 1, 1, "", "GmmMonotonicAttention"], [8, 1, 1, "", "LocationSensitiveAttention"], [8, 6, 1, "", "MergeSourcePaddingWithPerStepSourcePadding"], [8, 1, 1, "", "MergerLayer"], [8, 1, 1, "", "MonotonicAttention"], [8, 6, 1, "", "MonotonicAttentionProb"], [8, 1, 1, "", "MultiHeadedAttention"], [8, 1, 1, "", "MultiSourceAttention"], [8, 6, 1, "", "SafeCumprod"], [8, 6, 1, "", "_ApplyAttentionDropout"], [8, 6, 1, "", "_ConditionalCallDefun"], [8, 6, 1, "", "_RecursiveReshape"]], "lingvo.core.attention.AdditiveAttention": [[8, 2, 1, "", "AddGlobalVN"], [8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ZeroAttentionState"], [8, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.attention.BaseAttentionLayer": [[8, 2, 1, "", "ComputeContextVector"], [8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "GetInitializationSourceState"], [8, 2, 1, "", "InitForSourcePacked"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "SetInitializationSourceState"], [8, 2, 1, "", "_CreateLayerVariables"], [8, 2, 1, "", "_PaddedSoftmax"], [8, 2, 1, "", "_UpdatePaddingWithPackedInputMask"]], "lingvo.core.attention.DotProductAttention": [[8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ZeroAttentionState"], [8, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.attention.GmmMonotonicAttention": [[8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ZeroAttentionState"]], "lingvo.core.attention.LocationSensitiveAttention": [[8, 2, 1, "", "AddGlobalVN"], [8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ZeroAttentionState"], [8, 2, 1, "", "_ApplyConv"], [8, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.attention.MergerLayer": [[8, 2, 1, "", "FProp"], [8, 5, 1, "", "MERGER_OPS"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "_CreateLayerVariables"], [8, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.attention.MonotonicAttention": [[8, 2, 1, "", "AddGlobalVN"], [8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "ComputeProbabilities"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ZeroAttentionState"], [8, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.attention.MultiHeadedAttention": [[8, 2, 1, "", "ComputeContextVectorWithAttenProbs"], [8, 2, 1, "", "ComputeContextVectorWithCachedSource"], [8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "ExtendSourcePacked"], [8, 2, 1, "", "PackCachedSource"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ProcessProjectionVec"], [8, 2, 1, "", "SetOutputContextDim"], [8, 2, 1, "", "ZeroAttentionState"], [8, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.attention.MultiSourceAttention": [[8, 2, 1, "", "ComputeContextVectorWithSource"], [8, 2, 1, "", "PackSource"], [8, 2, 1, "", "Params"], [8, 2, 1, "", "ZeroAttentionState"], [8, 2, 1, "", "_CombineContext"]], "lingvo.core.attention_util": [[9, 6, 1, "", "AttenContext"], [9, 6, 1, "", "AttenLogits"], [9, 6, 1, "", "ComputeSparseAttention"], [9, 6, 1, "", "ConvertToBlocks"], [9, 6, 1, "", "ExtractBlockContext"], [9, 6, 1, "", "ExtractBlockContextV2"], [9, 1, 1, "", "KMeansClusteringForAtten"], [9, 6, 1, "", "MakeLocalMask"], [9, 1, 1, "", "PositionalAttenLogits"], [9, 6, 1, "", "RelShift"], [9, 6, 1, "", "_DoPadding"]], "lingvo.core.attention_util.KMeansClusteringForAtten": [[9, 2, 1, "", "FProp"], [9, 2, 1, "", "LayerNorm"], [9, 2, 1, "", "Params"], [9, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.attention_util.PositionalAttenLogits": [[9, 2, 1, "", "AttenLogitsRPE"], [9, 2, 1, "", "AttenLogitsRPEOneStep"], [9, 2, 1, "", "AttenLogitsXL"], [9, 2, 1, "", "AttenLogitsXLOneStep"], [9, 2, 1, "", "RelPositionBias"], [9, 2, 1, "", "_AttenLogits"], [9, 2, 1, "", "_ValidateBiases"]], "lingvo.core.base_decoder": [[10, 1, 1, "", "BaseBeamSearchDecoder"], [10, 1, 1, "", "BaseDecoder"], [10, 1, 1, "", "DecoderOutput"], [10, 6, 1, "", "_BatchLookup"], [10, 6, 1, "", "_BatchSampleGumbel"], [10, 6, 1, "", "_BatchScatter"], [10, 6, 1, "", "_KeepTopP"], [10, 6, 1, "", "_SampleGumbelWithMax"]], "lingvo.core.base_decoder.BaseBeamSearchDecoder": [[10, 2, 1, "", "AddExtraDecodingInfo"], [10, 2, 1, "", "BeamSearchDecode"], [10, 2, 1, "", "BeamSearchDecodeBiased"], [10, 2, 1, "", "BeamSearchDecodeWithTheta"], [10, 2, 1, "", "GreedySearchDecode"], [10, 2, 1, "", "GreedySearchDecodeWithTheta"], [10, 2, 1, "", "InferenceAdditionalEncoder"], [10, 2, 1, "", "Params"], [10, 2, 1, "", "SampleTargetSequences"], [10, 2, 1, "", "StochasticBeamSearchDecodeBiased"], [10, 2, 1, "", "UpdateTargetVocabSize"], [10, 2, 1, "", "_PostprocessSample"], [10, 2, 1, "", "_WrapInitBeamSearchStateCallback"], [10, 2, 1, "", "_WrapPostBeamSearchStepCallback"], [10, 2, 1, "", "_WrapPreBeamSearchStepCallback"]], "lingvo.core.base_decoder.BaseDecoder": [[10, 2, 1, "", "ComputeLoss"], [10, 2, 1, "", "ComputePredictions"], [10, 2, 1, "", "FProp"], [10, 2, 1, "", "Params"], [10, 2, 1, "", "UpdateTargetVocabSize"]], "lingvo.core.base_decoder.DecoderOutput": [[10, 2, 1, "", "_asdict"], [10, 5, 1, "", "_field_defaults"], [10, 5, 1, "", "_fields"], [10, 2, 1, "", "_make"], [10, 2, 1, "", "_replace"], [10, 5, 1, "", "metrics"], [10, 5, 1, "", "per_sequence"], [10, 5, 1, "", "predictions"]], "lingvo.core.base_input_generator": [[11, 1, 1, "", "BaseDataExampleInputGenerator"], [11, 1, 1, "", "BaseInputGenerator"], [11, 1, 1, "", "BaseInputGeneratorFromFiles"], [11, 1, 1, "", "BaseSequenceInputGenerator"], [11, 1, 1, "", "BaseTinyDatasetInput"], [11, 6, 1, "", "DefineTFDataInput"], [11, 6, 1, "", "FilePatternToDataSource"], [11, 6, 1, "", "MaybeOffsetDataSourceId"], [11, 6, 1, "", "PartitionFilePatternsIntoDataSources"], [11, 1, 1, "", "TFDataSequenceInputGenerator"], [11, 6, 1, "", "_PerHostInfeedTPUOrdinalFunction"], [11, 6, 1, "", "_ReorderTensorToLogical"], [11, 6, 1, "", "_RorderPartitionedTensorToLogical"]], "lingvo.core.base_input_generator.BaseDataExampleInputGenerator": [[11, 2, 1, "", "GetFeatureSpec"], [11, 2, 1, "", "GetPreprocessedInputBatch"], [11, 2, 1, "", "Params"], [11, 2, 1, "", "_AdditionalPreprocessInputBatch"], [11, 2, 1, "", "_InitDataset"]], "lingvo.core.base_input_generator.BaseInputGenerator": [[11, 2, 1, "", "CommonInputOpArgs"], [11, 2, 1, "", "CreateCpuPassthroughEnqueueOps"], [11, 2, 1, "", "CreateDatasource"], [11, 2, 1, "", "CreateTpuEmbeddingEnqueueOps"], [11, 2, 1, "", "CreateTpuEnqueueOps"], [11, 2, 1, "", "DefineInfeedParams"], [11, 2, 1, "", "DequeueCpuPassthrough"], [11, 2, 1, "", "DeviceLoopSetupEager"], [11, 2, 1, "", "GetBatchSize"], [11, 2, 1, "", "GetBpropVariableFilters"], [11, 2, 1, "", "GetCpuPassthroughKeys"], [11, 2, 1, "", "GetInputSourceOneHot"], [11, 2, 1, "", "GetPreprocessedInputBatch"], [11, 2, 1, "", "GlobalBatchSize"], [11, 2, 1, "", "InfeedBatchSize"], [11, 2, 1, "", "InfeedSetupGraph"], [11, 2, 1, "", "Initialize"], [11, 2, 1, "", "Params"], [11, 2, 1, "", "PreprocessTpuEmbeddingInputBatch"], [11, 2, 1, "", "Reset"], [11, 2, 1, "", "SplitInputBatch"], [11, 2, 1, "", "TpuDequeueBatch"], [11, 2, 1, "", "_GetTpuEmbeddingEnqueueData"], [11, 2, 1, "", "_InputBatch"], [11, 2, 1, "", "_PreprocessInputBatch"], [11, 3, 1, "", "_map_args"], [11, 3, 1, "", "input_data_summary_layout"], [11, 3, 1, "", "merged_input_data_summary_op"], [11, 3, 1, "", "tpu_infeed_op"], [11, 3, 1, "", "tpu_number_of_shards"]], "lingvo.core.base_input_generator.BaseInputGeneratorFromFiles": [[11, 2, 1, "", "CommonInputOpArgs"], [11, 2, 1, "", "CreateDatasource"], [11, 2, 1, "", "Params"], [11, 2, 1, "", "_BuildDataSource"], [11, 2, 1, "", "_BuildDataSourceWithMetadata"], [11, 2, 1, "", "_DataSourceFromFilePattern"], [11, 2, 1, "", "_InputBatch"], [11, 2, 1, "", "_InputOpBucketingArgs"]], "lingvo.core.base_input_generator.BaseSequenceInputGenerator": [[11, 2, 1, "", "Cast"], [11, 2, 1, "", "IdsToStrings"], [11, 2, 1, "", "IdsToTokens"], [11, 2, 1, "", "InfeedBatchSize"], [11, 2, 1, "", "Initialize"], [11, 2, 1, "", "Params"], [11, 2, 1, "", "StringsToIds"], [11, 2, 1, "", "StringsToIdsWithOffsets"], [11, 2, 1, "", "_InputOpBucketingArgs"], [11, 3, 1, "", "infeed_bucket_batch_limit"]], "lingvo.core.base_input_generator.BaseTinyDatasetInput": [[11, 2, 1, "", "Params"], [11, 2, 1, "", "_InputBatch"], [11, 2, 1, "", "_Preprocess"]], "lingvo.core.base_input_generator.TFDataSequenceInputGenerator": [[11, 2, 1, "", "ConvertFilePatternToDataSource"], [11, 2, 1, "", "CreateDatasource"], [11, 2, 1, "", "GetPreprocessedInputBatch"], [11, 2, 1, "", "GetSequenceLength"], [11, 2, 1, "", "LoadDataset"], [11, 2, 1, "", "Params"], [11, 2, 1, "", "ProcessDataset"], [11, 2, 1, "", "Reset"], [11, 2, 1, "", "TakeEvalSamples"], [11, 2, 1, "", "_InputPaddingValue"], [11, 2, 1, "", "_InputShape"]], "lingvo.core.base_layer": [[12, 1, 1, "", "ABCLayerMeta"], [12, 1, 1, "", "Accumulator"], [12, 1, 1, "", "BaseLayer"], [12, 1, 1, "", "BaseLayerMeta"], [12, 6, 1, "", "IsLayerParams"], [12, 6, 1, "", "RecursiveFindLayerParams"], [12, 6, 1, "", "_BaseLayerInitWrapper"]], "lingvo.core.base_layer.Accumulator": [[12, 2, 1, "", "DefaultValue"], [12, 2, 1, "", "Disable"], [12, 2, 1, "", "Enable"], [12, 2, 1, "", "GetValue"], [12, 2, 1, "", "Reset"], [12, 2, 1, "", "SetValue"], [12, 3, 1, "", "is_disabled"]], "lingvo.core.base_layer.BaseLayer": [[12, 2, 1, "", "AddChild"], [12, 2, 1, "", "AddExtraTheta"], [12, 2, 1, "", "AddFunction"], [12, 2, 1, "", "AddGlobalVN"], [12, 2, 1, "", "AddVN"], [12, 2, 1, "", "CopyBaseParams"], [12, 2, 1, "", "CreateChild"], [12, 2, 1, "", "CreateChildren"], [12, 2, 1, "", "CreateVariable"], [12, 2, 1, "", "FProp"], [12, 2, 1, "", "FPropDefaultTheta"], [12, 2, 1, "", "FPropMeta"], [12, 2, 1, "", "GetAccumulatorValues"], [12, 2, 1, "", "GetDescendant"], [12, 2, 1, "", "GetVariableSymbolicShape"], [12, 2, 1, "", "GetVariablesDict"], [12, 2, 1, "", "Params"], [12, 2, 1, "", "PostTrainingStepUpdate"], [12, 2, 1, "", "RegisterAccumulator"], [12, 2, 1, "", "SetAccumulatorValues"], [12, 2, 1, "", "TransformVarsTempContext"], [12, 2, 1, "", "_AutoAddChild"], [12, 2, 1, "", "_CastToFPropDtype"], [12, 2, 1, "", "_CheckName"], [12, 2, 1, "", "_CreateChildContext"], [12, 2, 1, "", "_CreateLayerVariables"], [12, 2, 1, "", "_EMAVariableScope"], [12, 2, 1, "", "_GetSelfVariablesDict"], [12, 5, 1, "", "_INFERENCE_DRIVER_NAME"], [12, 2, 1, "", "_InternalGetTheta"], [12, 2, 1, "", "_RemoveChild"], [12, 2, 1, "", "_RemoveChildren"], [12, 2, 1, "", "_SelfVariableScope"], [12, 2, 1, "", "_TransformVarsInternal"], [12, 2, 1, "", "_UndoTransformVarsInternal"], [12, 2, 1, "", "_VerifyChildren"], [12, 2, 1, "", "_VerifyVarsAndTheta"], [12, 2, 1, "", "_child_variable_scope_override"], [12, 3, 1, "", "accumulators"], [12, 3, 1, "", "children"], [12, 3, 1, "", "cluster"], [12, 3, 1, "", "do_eval"], [12, 3, 1, "", "ema"], [12, 3, 1, "", "fns"], [12, 3, 1, "", "layer_type"], [12, 3, 1, "", "params"], [12, 3, 1, "", "parent"], [12, 3, 1, "", "path"], [12, 3, 1, "", "theta"], [12, 3, 1, "", "vars"]], "lingvo.core.base_model": [[13, 1, 1, "", "BaseModel"], [13, 1, 1, "", "BaseTask"], [13, 1, 1, "", "DecodeEmailOptions"], [13, 1, 1, "", "DecodeFinalizeArgs"], [13, 1, 1, "", "MultiTaskModel"], [13, 1, 1, "", "MultiTaskSubModel"], [13, 1, 1, "", "SingleTaskBase"], [13, 1, 1, "", "SingleTaskModel"], [13, 6, 1, "", "_VariablesForEMA"]], "lingvo.core.base_model.BaseModel": [[13, 2, 1, "", "ApplyExponentialMovingAverage"], [13, 2, 1, "", "ConstructDecodeGraph"], [13, 2, 1, "", "ConstructFPropBPropGraph"], [13, 2, 1, "", "ConstructFPropGraph"], [13, 2, 1, "", "ConstructPostTrainingLoop"], [13, 2, 1, "", "Export"], [13, 2, 1, "", "GetTask"], [13, 2, 1, "", "Params"], [13, 2, 1, "", "ProcessFPropResults"], [13, 2, 1, "", "_GetSelfVariablesDict"], [13, 2, 1, "", "_MakeEMAVariablesDict"], [13, 3, 1, "", "global_step"], [13, 3, 1, "", "tasks"], [13, 3, 1, "", "variables_for_ema"]], "lingvo.core.base_model.BaseTask": [[13, 2, 1, "", "AddEvalMetric"], [13, 2, 1, "", "AddPerExampleTensor"], [13, 2, 1, "", "AdjustGradients"], [13, 2, 1, "", "ApplyExponentialMovingAverage"], [13, 2, 1, "", "BProp"], [13, 2, 1, "", "ComputeLoss"], [13, 2, 1, "", "ComputePredictions"], [13, 2, 1, "", "CreateDecoderMetrics"], [13, 2, 1, "", "Decode"], [13, 2, 1, "", "DecodeFinalize"], [13, 2, 1, "", "DecodeWithTheta"], [13, 2, 1, "", "EmailDecodeSummary"], [13, 2, 1, "", "Export"], [13, 2, 1, "", "FProp"], [13, 2, 1, "", "FPropDefaultTheta"], [13, 2, 1, "", "FPropTower"], [13, 2, 1, "", "FilterPerExampleTensors"], [13, 2, 1, "", "GetInputBatch"], [13, 2, 1, "", "Inference"], [13, 2, 1, "", "InferenceEager"], [13, 2, 1, "", "Params"], [13, 2, 1, "", "PostProcessDecodeOut"], [13, 2, 1, "", "PostTrainingLoop"], [13, 2, 1, "", "ProcessFPropResults"], [13, 2, 1, "", "UpdateTargetVocabSize"], [13, 2, 1, "", "_BPropForVariables"], [13, 2, 1, "", "_BPropGenTrainOps"], [13, 2, 1, "", "_ComputeGradientMask"], [13, 2, 1, "", "_FPropResult"], [13, 2, 1, "", "_FPropSplitInputBatch"], [13, 2, 1, "", "_FPropTpu"], [13, 2, 1, "", "_GetMaskUpdateOp"], [13, 2, 1, "", "_SetLearnerFromLegacyParams"], [13, 2, 1, "", "_UpdateVnConfig"], [13, 3, 1, "", "eval_metrics"], [13, 3, 1, "", "global_step"], [13, 3, 1, "", "input_generator"], [13, 3, 1, "", "loss"], [13, 3, 1, "", "per_example_tensors"], [13, 3, 1, "", "post_training_loop_op"], [13, 3, 1, "", "train_op"]], "lingvo.core.base_model.DecodeEmailOptions": [[13, 5, 1, "", "global_step"], [13, 5, 1, "", "job_name"], [13, 5, 1, "", "train_executions_per_eval"]], "lingvo.core.base_model.DecodeFinalizeArgs": [[13, 5, 1, "", "decode_out"], [13, 5, 1, "", "decode_out_path"]], "lingvo.core.base_model.MultiTaskModel": [[13, 2, 1, "", "ApplyExponentialMovingAverage"], [13, 2, 1, "", "ConstructDecodeGraph"], [13, 2, 1, "", "ConstructFPropBPropGraph"], [13, 2, 1, "", "ConstructFPropGraph"], [13, 2, 1, "", "GetTask"], [13, 2, 1, "", "Params"], [13, 2, 1, "", "SampleTask"], [13, 2, 1, "", "TaskNames"], [13, 2, 1, "", "_child_variable_scope_override"], [13, 3, 1, "", "task_names"], [13, 3, 1, "", "tasks"]], "lingvo.core.base_model.MultiTaskSubModel": [[13, 2, 1, "", "GetVariablesDict"], [13, 2, 1, "", "Params"]], "lingvo.core.base_model.SingleTaskBase": [[13, 2, 1, "", "ApplyExponentialMovingAverage"], [13, 2, 1, "", "ConstructDecodeGraph"], [13, 2, 1, "", "ConstructFPropBPropGraph"], [13, 2, 1, "", "ConstructFPropGraph"], [13, 2, 1, "", "ConstructPostTrainingLoop"], [13, 2, 1, "", "GetTask"], [13, 2, 1, "", "SampleTask"], [13, 3, 1, "", "tasks"]], "lingvo.core.base_model.SingleTaskModel": [[13, 2, 1, "", "Params"], [13, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.base_model_params": [[14, 4, 1, "", "DatasetError"], [14, 1, 1, "", "MultiTaskModelParams"], [14, 1, 1, "", "SingleTaskModelParams"], [14, 1, 1, "", "_BaseModelParams"]], "lingvo.core.base_model_params.MultiTaskModelParams": [[14, 2, 1, "", "Dev"], [14, 2, 1, "", "Model"], [14, 2, 1, "", "ProgramSchedule"], [14, 2, 1, "", "Test"], [14, 2, 1, "", "Train"]], "lingvo.core.base_model_params.SingleTaskModelParams": [[14, 2, 1, "", "Dev"], [14, 2, 1, "", "Model"], [14, 2, 1, "", "ProgramSchedule"], [14, 2, 1, "", "Task"], [14, 2, 1, "", "Test"], [14, 2, 1, "", "Train"]], "lingvo.core.base_model_params._BaseModelParams": [[14, 2, 1, "", "GetAllDatasetParams"], [14, 2, 1, "", "GetDatasetParams"]], "lingvo.core.batch_major_attention": [[15, 1, 1, "", "Builder"], [15, 6, 1, "", "CausalPadding"], [15, 6, 1, "", "CausalSegmentMask"], [15, 1, 1, "", "ChunkwiseSelfAttention"], [15, 1, 1, "", "ChunkwiseSelfAttentionXL"], [15, 6, 1, "", "ClearRelativeAttentionInTransformerLayer"], [15, 6, 1, "", "CrossAttentionPaddingWithTimestamp"], [15, 1, 1, "", "FunnelPoolingLayer"], [15, 1, 1, "", "FunnelTransformerAttentionLayer"], [15, 1, 1, "", "FunnelUpsampleLayer"], [15, 1, 1, "", "GPipeBatchMajorTransformerLayer"], [15, 6, 1, "", "GetDtypeMin"], [15, 1, 1, "", "LmBuilder"], [15, 1, 1, "", "LocalSelfAttention"], [15, 1, 1, "", "LocalSelfAttentionXL"], [15, 1, 1, "", "MemoryAddLayer"], [15, 1, 1, "", "MeshSplitLayer"], [15, 1, 1, "", "MultiHeadedAttention"], [15, 1, 1, "", "MultiHeadedAttentionRPE"], [15, 1, 1, "", "MultiHeadedAttentionXL"], [15, 1, 1, "", "MultiHeadedFavorAttention"], [15, 1, 1, "", "MultiHeadedProjectionLayer"], [15, 1, 1, "", "MultiSourceAttention"], [15, 1, 1, "", "MultiSourceTransformerDecoderLayer"], [15, 1, 1, "", "MultiSourceTransformerLayer"], [15, 1, 1, "", "PaddingLayer"], [15, 1, 1, "", "PerDimScaleLayer"], [15, 1, 1, "", "PerformerBuilder"], [15, 1, 1, "", "PipelinedTransformerLayers"], [15, 1, 1, "", "RepeatedTransformerLayer"], [15, 1, 1, "", "ReshapedMultiHeadedAttention"], [15, 1, 1, "", "ReshapedMultiHeadedProjectionLayer"], [15, 1, 1, "", "ResidualAddLayer"], [15, 1, 1, "", "RoutingAttention"], [15, 6, 1, "", "SegmentMask"], [15, 1, 1, "", "SketchMemTransformerBuilder"], [15, 1, 1, "", "StackedTransformerLayers"], [15, 1, 1, "", "StrideLayer"], [15, 1, 1, "", "TransformerAttentionLayer"], [15, 1, 1, "", "TransformerDecoderLayer"], [15, 1, 1, "", "TransformerFeedForwardLayerWithTaskId"], [15, 6, 1, "", "TransformerFlops"], [15, 1, 1, "", "TransformerLayer"], [15, 1, 1, "", "TransformerMultiSourceAttentionLayer"], [15, 6, 1, "", "UseRelativeAttentionInTransformerLayer"]], "lingvo.core.batch_major_attention.Builder": [[15, 2, 1, "", "Feedforward"], [15, 2, 1, "", "FunnelEncoderLayer"], [15, 2, 1, "", "GatedFeedforward"], [15, 2, 1, "", "GatedGeluFeedforward"], [15, 2, 1, "", "LConv"], [15, 2, 1, "", "LConvStack"], [15, 2, 1, "", "LconvBlock"], [15, 2, 1, "", "MeshSplit"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "Seq"], [15, 2, 1, "", "SetCanonicalShardingParams"], [15, 2, 1, "", "Stack"], [15, 2, 1, "", "TransformerEncoderLayer"], [15, 2, 1, "", "TransformerEncoderStack"], [15, 2, 1, "", "_Add"], [15, 2, 1, "", "_DefaultLN"], [15, 2, 1, "", "_DepthwiseConv2D"], [15, 2, 1, "", "_Dropout"], [15, 2, 1, "", "_ExpandDims"], [15, 2, 1, "", "_FunnelAttention"], [15, 2, 1, "", "_Glu"], [15, 2, 1, "", "_MaybeSplit"], [15, 2, 1, "", "_MultiHeadedAtten"], [15, 2, 1, "", "_NormalizedDepthwiseConv2D"], [15, 2, 1, "", "_Pad"], [15, 2, 1, "", "_Pool"], [15, 2, 1, "", "_Squeeze"], [15, 2, 1, "", "_Stride"], [15, 2, 1, "", "_StridedAttention"]], "lingvo.core.batch_major_attention.ChunkwiseSelfAttention": [[15, 2, 1, "", "AttenProbs"], [15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "StreamStep"], [15, 2, 1, "", "_AttenContext"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_ParamCheck"], [15, 2, 1, "", "_StreamStepStateless"], [15, 2, 1, "", "zero_state"]], "lingvo.core.batch_major_attention.ChunkwiseSelfAttentionXL": [[15, 2, 1, "", "Params"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.batch_major_attention.FunnelPoolingLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "StreamStep"]], "lingvo.core.batch_major_attention.FunnelTransformerAttentionLayer": [[15, 2, 1, "", "CommonParams"], [15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "StreamStep"]], "lingvo.core.batch_major_attention.FunnelUpsampleLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.batch_major_attention.GPipeBatchMajorTransformerLayer": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "SetupDeterministicDropout"]], "lingvo.core.batch_major_attention.LmBuilder": [[15, 2, 1, "", "Feedforward"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "TransformerEncoderLayer"], [15, 2, 1, "", "_Attention"], [15, 2, 1, "", "_Bias"], [15, 2, 1, "", "_BiasWeight"], [15, 2, 1, "", "_Linear"], [15, 2, 1, "", "_LinearWeight"], [15, 2, 1, "", "_ShardedVar"], [15, 2, 1, "", "_Var"]], "lingvo.core.batch_major_attention.LocalSelfAttention": [[15, 2, 1, "", "AttenProbs"], [15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "IsInferenceStepStatic"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "StreamStep"], [15, 2, 1, "", "StreamStepAddSkipConnection"], [15, 2, 1, "", "_AttenContext"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_StreamAttenLogits"], [15, 2, 1, "", "_StreamStepDimensions"], [15, 2, 1, "", "_StreamStepDynamicLength"], [15, 2, 1, "", "_StreamStepStaticComputeKeyValue"], [15, 2, 1, "", "_StreamStepStaticComputeKeyValue3d"], [15, 2, 1, "", "_StreamStepStaticComputeKeyValueClassic"], [15, 2, 1, "", "_StreamStepStaticComputeKeyValueMinimal"], [15, 2, 1, "", "_StreamStepStaticLength"], [15, 2, 1, "", "_zero_state_dynamic_length"], [15, 2, 1, "", "_zero_state_static_length_inputs"], [15, 2, 1, "", "_zero_state_static_length_key_value"], [15, 2, 1, "", "zero_state"]], "lingvo.core.batch_major_attention.LocalSelfAttentionXL": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "StreamStep"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_AttenLogitsOneStep"], [15, 2, 1, "", "_CreateLayerVariables"], [15, 2, 1, "", "_StreamAttenLogits"]], "lingvo.core.batch_major_attention.MemoryAddLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.MeshSplitLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.MultiHeadedAttention": [[15, 2, 1, "", "AttenProbs"], [15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_AttenContext"], [15, 2, 1, "", "_AttenContextOneStep"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_AttenLogitsOneStep"], [15, 2, 1, "", "_CapLogits"], [15, 2, 1, "", "_DotAtten"], [15, 2, 1, "", "_DotAttenOneStep"], [15, 2, 1, "", "_HeadsProj"], [15, 2, 1, "", "_MaybeScaleQuery"], [15, 2, 1, "", "_PostProj"], [15, 3, 1, "", "dim_per_head"]], "lingvo.core.batch_major_attention.MultiHeadedAttentionRPE": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_AttenContext"], [15, 2, 1, "", "_AttenContextOneStep"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_AttenLogitsOneStep"], [15, 2, 1, "", "_RelativePositionValueEmb"], [15, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.batch_major_attention.MultiHeadedAttentionXL": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_AttenLogits"], [15, 2, 1, "", "_AttenLogitsOneStep"], [15, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.batch_major_attention.MultiHeadedFavorAttention": [[15, 2, 1, "", "Params"], [15, 2, 1, "", "_DotAtten"]], "lingvo.core.batch_major_attention.MultiHeadedProjectionLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.batch_major_attention.MultiSourceAttention": [[15, 2, 1, "", "AttenProbs"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_CombineContext"]], "lingvo.core.batch_major_attention.MultiSourceTransformerDecoderLayer": [[15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.MultiSourceTransformerLayer": [[15, 2, 1, "", "Params"], [15, 2, 1, "", "_GetSourceBatchSize"], [15, 2, 1, "", "_GetSourceLength"], [15, 3, 1, "", "primary_source_key"]], "lingvo.core.batch_major_attention.PaddingLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"]], "lingvo.core.batch_major_attention.PerDimScaleLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.batch_major_attention.PerformerBuilder": [[15, 2, 1, "", "Params"], [15, 2, 1, "", "_MultiHeadedAtten"]], "lingvo.core.batch_major_attention.PipelinedTransformerLayers": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "Params"], [15, 1, 1, "", "WrappedStageClass"]], "lingvo.core.batch_major_attention.PipelinedTransformerLayers.WrappedStageClass": [[15, 2, 1, "", "ExtendStep"]], "lingvo.core.batch_major_attention.RepeatedTransformerLayer": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.ReshapedMultiHeadedAttention": [[15, 2, 1, "", "ExtendStep"]], "lingvo.core.batch_major_attention.ReshapedMultiHeadedProjectionLayer": [[15, 2, 1, "", "FProp"]], "lingvo.core.batch_major_attention.ResidualAddLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.RoutingAttention": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_DotAtten"], [15, 2, 1, "", "_DotAttenFastPath"], [15, 2, 1, "", "_DotAttenOneStep"], [15, 2, 1, "", "_DotAttenSlowPath"]], "lingvo.core.batch_major_attention.SketchMemTransformerBuilder": [[15, 2, 1, "", "Feedforward"], [15, 2, 1, "", "GatedFeedforward"], [15, 2, 1, "", "GatedGeluFeedforward"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_MemoryAdd"], [15, 2, 1, "", "_MultiHeadedAtten"]], "lingvo.core.batch_major_attention.StackedTransformerLayers": [[15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "GetSplitForLayer"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "_GetDeviceOfLayer"]], "lingvo.core.batch_major_attention.StrideLayer": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "FPropMeta"], [15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.TransformerAttentionLayer": [[15, 2, 1, "", "CommonParams"], [15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "SetFPropDtype"], [15, 2, 1, "", "StreamStep"], [15, 2, 1, "", "StreamStepAddSkipConnection"], [15, 2, 1, "", "_InitAttentionParams"], [15, 2, 1, "", "zero_state"]], "lingvo.core.batch_major_attention.TransformerDecoderLayer": [[15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.TransformerFeedForwardLayerWithTaskId": [[15, 2, 1, "", "FProp"], [15, 2, 1, "", "Params"]], "lingvo.core.batch_major_attention.TransformerLayer": [[15, 2, 1, "", "CommonParams"], [15, 2, 1, "", "ExtendStep"], [15, 2, 1, "", "FProp"], [15, 2, 1, "", "InitStates"], [15, 2, 1, "", "NumOutputNodes"], [15, 2, 1, "", "Params"], [15, 2, 1, "", "SetCanonicalShardingParams"], [15, 2, 1, "", "SetFPropDtype"], [15, 2, 1, "", "SetNumInputNodes"], [15, 2, 1, "", "SetReshapedLayers"], [15, 2, 1, "", "_GetSourceBatchSize"], [15, 2, 1, "", "_GetSourceLength"]], "lingvo.core.batch_major_attention.TransformerMultiSourceAttentionLayer": [[15, 2, 1, "", "Params"], [15, 2, 1, "", "_InitAttentionParams"]], "lingvo.core.batch_utils": [[16, 6, 1, "", "scale_global_to_infeed"], [16, 6, 1, "", "scale_infeed_to_global"], [16, 6, 1, "", "scale_split_to_infeed"]], "lingvo.core.beam_search_helper": [[17, 1, 1, "", "BeamSearchDecodeOutput"], [17, 1, 1, "", "BeamSearchHelper"], [17, 1, 1, "", "BeamSearchSharedParams"], [17, 1, 1, "", "GreedySearchHelper"], [17, 6, 1, "", "MergeBeamSearchOutputs"], [17, 6, 1, "", "_GetShapes"]], "lingvo.core.beam_search_helper.BeamSearchDecodeOutput": [[17, 2, 1, "", "_asdict"], [17, 5, 1, "", "_field_defaults"], [17, 5, 1, "", "_fields"], [17, 2, 1, "", "_make"], [17, 2, 1, "", "_replace"], [17, 5, 1, "", "other_states"], [17, 5, 1, "", "topk_decoded"], [17, 5, 1, "", "topk_hyps"], [17, 5, 1, "", "topk_ids"], [17, 5, 1, "", "topk_lens"], [17, 5, 1, "", "topk_scores"]], "lingvo.core.beam_search_helper.BeamSearchHelper": [[17, 2, 1, "", "BeamSearchDecode"], [17, 2, 1, "", "Params"], [17, 2, 1, "", "_BeamSearchStep"]], "lingvo.core.beam_search_helper.BeamSearchSharedParams": [[17, 2, 1, "", "Params"]], "lingvo.core.beam_search_helper.GreedySearchHelper": [[17, 2, 1, "", "GreedySearchDecode"], [17, 2, 1, "", "Params"], [17, 2, 1, "", "_GreedySearchStep"]], "lingvo.core.bfloat16_variables": [[18, 1, 1, "", "Bfloat16VariableSaveable"], [18, 6, 1, "", "get_saver_spec_for_variables_with_bf16_overrides"]], "lingvo.core.bfloat16_variables.Bfloat16VariableSaveable": [[18, 2, 1, "", "restore"]], "lingvo.core.bn_layers": [[19, 1, 1, "", "AddingAccumulator"], [19, 1, 1, "", "BatchNormLayer"], [19, 1, 1, "", "BatchNormLayerNoPadding"], [19, 1, 1, "", "CategoricalBN"], [19, 6, 1, "", "ComputeMoments"], [19, 1, 1, "", "GroupNormLayer"]], "lingvo.core.bn_layers.AddingAccumulator": [[19, 2, 1, "", "DefaultValue"], [19, 2, 1, "", "Update"]], "lingvo.core.bn_layers.BatchNormLayer": [[19, 2, 1, "", "ComputeAndUpdateMoments"], [19, 2, 1, "", "FProp"], [19, 2, 1, "", "FPropMeta"], [19, 2, 1, "", "GetCurrentMoments"], [19, 2, 1, "", "Params"], [19, 2, 1, "", "_ComputeBN"], [19, 2, 1, "", "_CreateLayerVariables"], [19, 2, 1, "", "_GetBetaGamma"], [19, 2, 1, "", "_GetDefaultPaddings"], [19, 2, 1, "", "_GetWeightShape"], [19, 2, 1, "", "_MaybeExpandPaddings"], [19, 3, 1, "", "epsilon"]], "lingvo.core.bn_layers.BatchNormLayerNoPadding": [[19, 2, 1, "", "FProp"], [19, 2, 1, "", "FPropMeta"], [19, 2, 1, "", "Params"], [19, 2, 1, "", "PostTrainingStepUpdate"], [19, 2, 1, "", "_CreateLayerVariables"], [19, 2, 1, "", "_Moments"]], "lingvo.core.bn_layers.CategoricalBN": [[19, 2, 1, "", "FProp"], [19, 2, 1, "", "Params"], [19, 2, 1, "", "_GetBetaGamma"], [19, 2, 1, "", "_GetWeightShape"]], "lingvo.core.bn_layers.GroupNormLayer": [[19, 2, 1, "", "FProp"], [19, 2, 1, "", "FPropMeta"], [19, 2, 1, "", "Params"], [19, 2, 1, "", "StreamStep"], [19, 2, 1, "", "_CreateLayerVariables"], [19, 2, 1, "", "_Normalize"], [19, 2, 1, "", "_StreamMoments"], [19, 3, 1, "", "group_size"], [19, 3, 1, "", "num_groups"], [19, 2, 1, "", "zero_state"]], "lingvo.core.build_data": [[20, 6, 1, "", "BuildData"]], "lingvo.core.builder": [[21, 1, 1, "", "Base"]], "lingvo.core.builder.Base": [[21, 2, 1, "", "Params"], [21, 2, 1, "", "_Activation"], [21, 2, 1, "", "_AddFetches"], [21, 2, 1, "", "_Arg"], [21, 2, 1, "", "_BN"], [21, 2, 1, "", "_BatchParallel"], [21, 2, 1, "", "_Bias"], [21, 2, 1, "", "_Concat"], [21, 2, 1, "", "_Conv2D"], [21, 2, 1, "", "_CreateNestedMap"], [21, 2, 1, "", "_Dropout"], [21, 2, 1, "", "_FC"], [21, 2, 1, "", "_Fn"], [21, 2, 1, "", "_Graph"], [21, 2, 1, "", "_Id"], [21, 2, 1, "", "_LN"], [21, 2, 1, "", "_Linear"], [21, 2, 1, "", "_MLP"], [21, 2, 1, "", "_Par"], [21, 2, 1, "", "_PrintShape"], [21, 2, 1, "", "_Rematerialize"], [21, 2, 1, "", "_Rep"], [21, 2, 1, "", "_Reshape"], [21, 2, 1, "", "_Save"], [21, 2, 1, "", "_Seq"], [21, 3, 1, "", "params"]], "lingvo.core.builder_layers": [[22, 1, 1, "", "ArgIndexLayer"], [22, 1, 1, "", "BatchParallelLayer"], [22, 1, 1, "", "BiasLayer"], [22, 1, 1, "", "BranchLayer"], [22, 1, 1, "", "ConcatLayer"], [22, 1, 1, "", "CreateNestedMapLayer"], [22, 1, 1, "", "FirstNLayer"], [22, 1, 1, "", "FnLayer"], [22, 1, 1, "", "GraphLayer"], [22, 1, 1, "", "GraphSignature"], [22, 1, 1, "", "GraphTensors"], [22, 1, 1, "", "LinearLayer"], [22, 1, 1, "", "MapLayer"], [22, 1, 1, "", "ParallelLayer"], [22, 1, 1, "", "ParallelRepeatLayer"], [22, 1, 1, "", "PrintShapeLayer"], [22, 1, 1, "", "RematerializationLayer"], [22, 1, 1, "", "RepeatLayer"], [22, 1, 1, "", "ReshapeLayer"], [22, 1, 1, "", "SequentialLayer"], [22, 1, 1, "", "SliceHelper"], [22, 1, 1, "", "SliceLayer"], [22, 1, 1, "", "SoftCondLayer"], [22, 1, 1, "", "UnarySequentialLayer"], [22, 6, 1, "", "_MaybeStackExtraTheta"], [22, 6, 1, "", "_ToTuple"]], "lingvo.core.builder_layers.ArgIndexLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.BatchParallelLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.BiasLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"], [22, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.builder_layers.BranchLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.ConcatLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.CreateNestedMapLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.FirstNLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.FnLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.GraphLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.GraphSignature": [[22, 2, 1, "", "_ConsumeItem"], [22, 2, 1, "", "_ConsumeKey"], [22, 2, 1, "", "_ConsumeList"], [22, 2, 1, "", "_ConsumeMap"], [22, 2, 1, "", "_ConsumePath"], [22, 2, 1, "", "_ConsumeSymbol"], [22, 2, 1, "", "_MaybeConsumeSymbol"], [22, 2, 1, "", "_ParseInputs"], [22, 2, 1, "", "_ParseOutputs"], [22, 2, 1, "", "_TokenizeInputs"], [22, 3, 1, "", "inputs"], [22, 3, 1, "", "outputs"]], "lingvo.core.builder_layers.GraphTensors": [[22, 2, 1, "", "GetTensor"], [22, 2, 1, "", "StoreTensor"]], "lingvo.core.builder_layers.LinearLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"], [22, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.builder_layers.MapLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.ParallelLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.ParallelRepeatLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "_InferOutShapes"]], "lingvo.core.builder_layers.PrintShapeLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"]], "lingvo.core.builder_layers.RematerializationLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.RepeatLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"], [22, 3, 1, "", "_body"], [22, 2, 1, "", "_child_variable_scope_override"], [22, 2, 1, "", "_unrolled_fprop"]], "lingvo.core.builder_layers.ReshapeLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.SequentialLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.SliceLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"]], "lingvo.core.builder_layers.SoftCondLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "Params"], [22, 2, 1, "", "_CreateLayerVariables"], [22, 2, 1, "", "_GetExpertDist"]], "lingvo.core.builder_layers.UnarySequentialLayer": [[22, 2, 1, "", "FProp"], [22, 2, 1, "", "FPropMeta"], [22, 2, 1, "", "Params"]], "lingvo.core.checkpointer": [[23, 1, 1, "", "Checkpointer"], [23, 1, 1, "", "EagerCheckpointerV1"], [23, 1, 1, "", "EagerCheckpointerV2"], [23, 6, 1, "", "GetSpecificCheckpoint"], [23, 1, 1, "", "SaverWrapper"], [23, 6, 1, "", "SortCheckpointPaths"], [23, 1, 1, "", "_EagerCheckpointer"], [23, 6, 1, "", "_GetSaveableVariablesDict"]], "lingvo.core.checkpointer.Checkpointer": [[23, 2, 1, "", "MaybeSave"], [23, 2, 1, "", "Restore"], [23, 2, 1, "", "RestoreFromPath"], [23, 2, 1, "", "RestoreGlobalStepIfNeeded"], [23, 2, 1, "", "RestoreIfNeeded"], [23, 2, 1, "", "Save"], [23, 2, 1, "", "ShouldSave"], [23, 2, 1, "", "Sync"], [23, 2, 1, "", "_BuildInitFromCheckpointRules"], [23, 2, 1, "", "_GetSaver"], [23, 2, 1, "", "_GetUninitializedVarNames"], [23, 2, 1, "", "_RestoreFromLatestCheckpoint"], [23, 2, 1, "", "_UpdateNextSaveTime"], [23, 3, 1, "", "async_checkpointing"], [23, 3, 1, "", "checkpoint_dir"]], "lingvo.core.checkpointer.EagerCheckpointerV1": [[23, 2, 1, "", "Restore"], [23, 2, 1, "", "RestoreFromPath"], [23, 2, 1, "", "RestoreGlobalStepIfNeeded"], [23, 2, 1, "", "Save"], [23, 2, 1, "", "Sync"], [23, 2, 1, "", "_GetRestorer"], [23, 2, 1, "", "_GetSaver"], [23, 2, 1, "", "_WrapRestoreErrorWithGraphModeWarning"]], "lingvo.core.checkpointer.EagerCheckpointerV2": [[23, 2, 1, "", "Restore"], [23, 2, 1, "", "RestoreFromPath"], [23, 2, 1, "", "RestoreGlobalStepIfNeeded"], [23, 2, 1, "", "Save"], [23, 2, 1, "", "Sync"], [23, 2, 1, "", "_GetSaver"]], "lingvo.core.checkpointer.SaverWrapper": [[23, 2, 1, "", "Restore"], [23, 2, 1, "", "Save"], [23, 2, 1, "", "Sync"]], "lingvo.core.checkpointer._EagerCheckpointer": [[23, 2, 1, "", "RestoreIfNeeded"], [23, 2, 1, "", "_MaybeBuildInitFromCheckpointRules"], [23, 2, 1, "", "_MaybeOverwriteModelVariablesWithEMA"]], "lingvo.core.cluster": [[24, 6, 1, "", "GetInfeedContext"], [24, 1, 1, "", "InfeedContext"], [24, 6, 1, "", "InfeedContextScope"], [24, 6, 1, "", "MakeDeviceString"], [24, 6, 1, "", "ParseDeviceString"], [24, 1, 1, "", "VarPlacer"], [24, 1, 1, "", "_Cluster"], [24, 1, 1, "", "_LeastLoadedPlacer"]], "lingvo.core.cluster.InfeedContext": [[24, 2, 1, "", "_asdict"], [24, 5, 1, "", "_field_defaults"], [24, 5, 1, "", "_fields"], [24, 2, 1, "", "_make"], [24, 2, 1, "", "_replace"], [24, 5, 1, "", "infeed_host_index"], [24, 5, 1, "", "num_infeed_hosts"]], "lingvo.core.cluster.VarPlacer": [[24, 2, 1, "", "DeviceFunction"], [24, 2, 1, "", "_AssignVar"]], "lingvo.core.cluster._Cluster": [[24, 2, 1, "", "ExportMetrics"], [24, 2, 1, "", "GetPlacer"], [24, 2, 1, "", "InitDevices"], [24, 2, 1, "", "InitDevicesEager"], [24, 2, 1, "", "ListDevices"], [24, 2, 1, "", "Params"], [24, 2, 1, "", "Top"], [24, 2, 1, "", "WorkerDeviceInModelSplit"], [24, 2, 1, "", "_CheckInvariants"], [24, 2, 1, "", "_JobSpec"], [24, 3, 1, "", "add_summary"], [24, 3, 1, "", "all_worker_names"], [24, 3, 1, "", "asynchronous"], [24, 3, 1, "", "available_devices"], [24, 3, 1, "", "do_eval"], [24, 3, 1, "", "in_unit_test"], [24, 3, 1, "", "input_device"], [24, 3, 1, "", "input_targets"], [24, 3, 1, "", "is_executor_tpu"], [24, 3, 1, "", "job"], [24, 3, 1, "", "job_spec"], [24, 3, 1, "", "logdir"], [24, 3, 1, "", "mode"], [24, 3, 1, "", "num_devices_per_replica"], [24, 3, 1, "", "num_devices_per_split"], [24, 3, 1, "", "num_replicas"], [24, 3, 1, "", "num_splits_per_client"], [24, 3, 1, "", "num_splits_per_replica"], [24, 3, 1, "", "num_tpu_hosts"], [24, 3, 1, "", "params"], [24, 3, 1, "", "reporting_job"], [24, 3, 1, "", "require_sequential_input_order"], [24, 3, 1, "", "synchronous"], [24, 3, 1, "", "task"], [24, 3, 1, "", "tf_data_service_address"], [24, 3, 1, "", "total_worker_devices"], [24, 3, 1, "", "tpus_per_replica"], [24, 3, 1, "", "worker_cluster_def"]], "lingvo.core.cluster._LeastLoadedPlacer": [[24, 2, 1, "", "_AssignVar"]], "lingvo.core.cluster_factory": [[25, 6, 1, "", "Current"], [25, 6, 1, "", "ForTestingWorker"], [25, 6, 1, "", "SetCluster"], [25, 6, 1, "", "SetEval"], [25, 6, 1, "", "SetModelSplit"], [25, 6, 1, "", "SetRequireSequentialInputOrder"]], "lingvo.core.computation_cost": [[26, 6, 1, "", "Add"], [26, 6, 1, "", "Get"], [26, 6, 1, "", "Prepare"], [26, 6, 1, "", "_GetAccumulator"], [26, 6, 1, "", "_HasAccumulator"]], "lingvo.core.conformer_layer": [[27, 6, 1, "", "ApplyGshard"], [27, 1, 1, "", "ConformerLayer"], [27, 6, 1, "", "GShardMoELayerParams"], [27, 1, 1, "", "LConvLayer"], [27, 6, 1, "", "_AttenCtxIsSet"]], "lingvo.core.conformer_layer.ConformerLayer": [[27, 2, 1, "", "CommonParams"], [27, 2, 1, "", "ConfigFFLayer"], [27, 2, 1, "", "ConfigMoEParams"], [27, 2, 1, "", "FProp"], [27, 2, 1, "", "NumOutputNodes"], [27, 2, 1, "", "Params"], [27, 2, 1, "", "SetFPropDtype"], [27, 2, 1, "", "StreamStep"], [27, 2, 1, "", "Stride"], [27, 2, 1, "", "_AddAttenProbsHistogramSummary"], [27, 2, 1, "", "_AddAttenProbsImageSummary"], [27, 2, 1, "", "_AddAttentionSummaries"], [27, 2, 1, "", "_ConfigFFLayerOrMoEParams"], [27, 2, 1, "", "_ConfigSelfAttenContext"], [27, 2, 1, "", "_FProp"], [27, 2, 1, "", "_LConv"], [27, 2, 1, "", "_MoeOrFFLayer"], [27, 2, 1, "", "_SelfAtten"], [27, 3, 1, "", "has_fflayer_start"], [27, 3, 1, "", "has_lconv"], [27, 3, 1, "", "has_mhsa"], [27, 2, 1, "", "zero_state"]], "lingvo.core.conformer_layer.LConvLayer": [[27, 2, 1, "", "CommonParams"], [27, 2, 1, "", "FProp"], [27, 2, 1, "", "Params"], [27, 2, 1, "", "SetCanonicalShardingParams"], [27, 2, 1, "", "SetFPropDtype"], [27, 2, 1, "", "StreamStep"], [27, 2, 1, "", "_ApplyActivation"], [27, 2, 1, "", "_GLU"], [27, 2, 1, "", "_Normalize"], [27, 2, 1, "", "_NormalizeStep"], [27, 2, 1, "", "zero_state"]], "lingvo.core.conv_layers_builder": [[29, 1, 1, "", "BiasLayer"], [29, 1, 1, "", "Builder"], [29, 1, 1, "", "CausalPoolingLayer"]], "lingvo.core.conv_layers_builder.BiasLayer": [[29, 2, 1, "", "FProp"]], "lingvo.core.conv_layers_builder.Builder": [[29, 2, 1, "", "Conv2D"], [29, 2, 1, "", "DepthwiseConv2D"], [29, 2, 1, "", "LConv"], [29, 2, 1, "", "NormalizedDepthwiseConv2D"], [29, 2, 1, "", "NormalizedLConv"], [29, 2, 1, "", "Params"], [29, 2, 1, "", "SeparableConv2D"], [29, 2, 1, "", "_Activation"], [29, 2, 1, "", "_Add"], [29, 2, 1, "", "_Bias"], [29, 2, 1, "", "_BiasNoPadding"], [29, 2, 1, "", "_ExpandDims"], [29, 2, 1, "", "_GlobalPooling"], [29, 2, 1, "", "_Glu"], [29, 2, 1, "", "_LConvCommon"], [29, 2, 1, "", "_MaybeNorm"], [29, 2, 1, "", "_Norm"], [29, 2, 1, "", "_NormOrBias"], [29, 2, 1, "", "_Padding"], [29, 2, 1, "", "_RawConv2D"], [29, 2, 1, "", "_RawDepthwiseConv2D"], [29, 2, 1, "", "_Squeeze"]], "lingvo.core.conv_layers_builder.CausalPoolingLayer": [[29, 2, 1, "", "FProp"], [29, 2, 1, "", "Params"]], "lingvo.core.conv_layers_with_time_padding": [[30, 1, 1, "", "BaseConv2DLayerWithPadding"], [30, 1, 1, "", "CausalConv2DLayerWithPadding"], [30, 1, 1, "", "CausalDepthwiseConv2DLayer"], [30, 1, 1, "", "CausalNormalizedDepthwiseConv2DLayer"], [30, 6, 1, "", "ComputeConvOutputPadding"], [30, 6, 1, "", "ComputeConvOutputShape"], [30, 6, 1, "", "ComputeExplicitPaddingForCausalConv"], [30, 1, 1, "", "Conv2DLayerWithPadding"], [30, 1, 1, "", "ConvBatchNormLayer"], [30, 1, 1, "", "ConvCategoricalBN"], [30, 1, 1, "", "DepthwiseConv2DLayer"], [30, 1, 1, "", "GlobalPoolingLayer"], [30, 1, 1, "", "NormalizedDepthwiseConv2DLayer"], [30, 1, 1, "", "PaddingLayer"], [30, 6, 1, "", "_ComputeConvOutputPaddingV2"], [30, 6, 1, "", "_PadForLengthCompatibleStridesV2"]], "lingvo.core.conv_layers_with_time_padding.BaseConv2DLayerWithPadding": [[30, 2, 1, "", "FProp"], [30, 2, 1, "", "OutShape"], [30, 2, 1, "", "OutputChannels"], [30, 2, 1, "", "Params"], [30, 2, 1, "", "_ApplyConv"], [30, 2, 1, "", "_EvaluateConvKernel"], [30, 2, 1, "", "_MaybeCausalPadding"], [30, 2, 1, "", "_RescaleBoundary"], [30, 3, 1, "", "filter_stride"], [30, 3, 1, "", "input_channels"], [30, 3, 1, "", "output_channels"]], "lingvo.core.conv_layers_with_time_padding.CausalConv2DLayerWithPadding": [[30, 2, 1, "", "Params"], [30, 2, 1, "", "StreamStep"], [30, 2, 1, "", "_MaybeCausalPadding"], [30, 2, 1, "", "zero_state"]], "lingvo.core.conv_layers_with_time_padding.CausalDepthwiseConv2DLayer": [[30, 2, 1, "", "StreamStep"], [30, 2, 1, "", "_MaybeCausalPadding"], [30, 2, 1, "", "zero_state"]], "lingvo.core.conv_layers_with_time_padding.CausalNormalizedDepthwiseConv2DLayer": [[30, 2, 1, "", "_MaybeCausalPadding"]], "lingvo.core.conv_layers_with_time_padding.Conv2DLayerWithPadding": [[30, 2, 1, "", "OutputChannels"], [30, 2, 1, "", "OutputShape"], [30, 2, 1, "", "Params"], [30, 2, 1, "", "_ApplyConv"], [30, 2, 1, "", "_CreateLayerVariables"], [30, 2, 1, "", "_EvaluateConvKernel"], [30, 2, 1, "", "_GetWeight"]], "lingvo.core.conv_layers_with_time_padding.ConvBatchNormLayer": [[30, 2, 1, "", "FProp"]], "lingvo.core.conv_layers_with_time_padding.ConvCategoricalBN": [[30, 2, 1, "", "FProp"]], "lingvo.core.conv_layers_with_time_padding.DepthwiseConv2DLayer": [[30, 2, 1, "", "OutputChannels"], [30, 2, 1, "", "Params"], [30, 2, 1, "", "_ApplyConv"], [30, 2, 1, "", "_CreateLayerVariables"], [30, 2, 1, "", "_EvaluateConvKernel"], [30, 2, 1, "", "_GetWeight"], [30, 2, 1, "", "_GetWeightShape"]], "lingvo.core.conv_layers_with_time_padding.GlobalPoolingLayer": [[30, 2, 1, "", "FProp"], [30, 2, 1, "", "Params"]], "lingvo.core.conv_layers_with_time_padding.NormalizedDepthwiseConv2DLayer": [[30, 2, 1, "", "FPropMeta"], [30, 2, 1, "", "OutputChannels"], [30, 2, 1, "", "Params"], [30, 2, 1, "", "_GetWeight"], [30, 2, 1, "", "_GetWeightShape"], [30, 3, 1, "", "input_channels"]], "lingvo.core.conv_layers_with_time_padding.PaddingLayer": [[30, 2, 1, "", "FProp"]], "lingvo.core.datasource": [[31, 1, 1, "", "CrossBatchMixingDataSource"], [31, 1, 1, "", "CurriculumDataSource"], [31, 1, 1, "", "CustomTFDatasetTransform"], [31, 1, 1, "", "DataSource"], [31, 6, 1, "", "GetTFDataServiceDataSet"], [31, 1, 1, "", "PrefixedDataSource"], [31, 1, 1, "", "RepeatableTFDatasetTransform"], [31, 1, 1, "", "SimpleDataSource"], [31, 1, 1, "", "TFDataServiceSource"], [31, 1, 1, "", "TFDatasetAdaptor"], [31, 1, 1, "", "TFDatasetBatchBySequenceLength"], [31, 1, 1, "", "TFDatasetFnInput"], [31, 1, 1, "", "TFDatasetMixer"], [31, 1, 1, "", "TFDatasetPrefetch"], [31, 1, 1, "", "TFDatasetSource"], [31, 1, 1, "", "TFDatasetTransform"]], "lingvo.core.datasource.CrossBatchMixingDataSource": [[31, 2, 1, "", "GetMeta"], [31, 2, 1, "", "GetNext"], [31, 2, 1, "", "Params"]], "lingvo.core.datasource.CurriculumDataSource": [[31, 2, 1, "", "GetMeta"], [31, 2, 1, "", "GetNext"], [31, 2, 1, "", "Params"]], "lingvo.core.datasource.CustomTFDatasetTransform": [[31, 2, 1, "", "Params"], [31, 2, 1, "", "Transform"]], "lingvo.core.datasource.DataSource": [[31, 2, 1, "", "GetMeta"], [31, 2, 1, "", "GetNext"], [31, 2, 1, "", "Initialize"], [31, 2, 1, "", "Params"], [31, 2, 1, "", "Reset"], [31, 2, 1, "", "SetInputGenerator"]], "lingvo.core.datasource.PrefixedDataSource": [[31, 2, 1, "", "Params"]], "lingvo.core.datasource.RepeatableTFDatasetTransform": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "GetNext"], [31, 2, 1, "", "Params"], [31, 2, 1, "", "Transform"]], "lingvo.core.datasource.SimpleDataSource": [[31, 2, 1, "", "GetMeta"], [31, 2, 1, "", "GetNext"], [31, 2, 1, "", "Params"]], "lingvo.core.datasource.TFDataServiceSource": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "Params"], [31, 2, 1, "", "Reset"], [31, 2, 1, "", "SetInputGenerator"]], "lingvo.core.datasource.TFDatasetAdaptor": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "Params"]], "lingvo.core.datasource.TFDatasetBatchBySequenceLength": [[31, 2, 1, "", "Params"], [31, 2, 1, "", "Transform"]], "lingvo.core.datasource.TFDatasetFnInput": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "Params"]], "lingvo.core.datasource.TFDatasetMixer": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "Params"]], "lingvo.core.datasource.TFDatasetPrefetch": [[31, 2, 1, "", "Params"], [31, 2, 1, "", "Transform"]], "lingvo.core.datasource.TFDatasetSource": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "GetNext"], [31, 2, 1, "", "Initialize"], [31, 2, 1, "", "Reset"], [31, 2, 1, "", "_InitIterator"], [31, 3, 1, "", "_map_args"], [31, 3, 1, "", "host_id"], [31, 3, 1, "", "num_hosts"]], "lingvo.core.datasource.TFDatasetTransform": [[31, 2, 1, "", "GetDataset"], [31, 2, 1, "", "Params"], [31, 2, 1, "", "Transform"]], "lingvo.core.datasource_tfds": [[32, 1, 1, "", "TFDSInput"]], "lingvo.core.datasource_tfds.TFDSInput": [[32, 2, 1, "", "GetDataset"], [32, 2, 1, "", "Params"]], "lingvo.core.decoder_lib": [[33, 6, 1, "", "SerializeOutputs"], [33, 6, 1, "", "WriteKeyValuePairs"]], "lingvo.core.differentiable_assignment": [[34, 6, 1, "", "max_assignment"]], "lingvo.core.distillation_task": [[35, 1, 1, "", "DistillationTask"]], "lingvo.core.distillation_task.DistillationTask": [[35, 2, 1, "", "BProp"], [35, 2, 1, "", "ComputeDistillationLoss"], [35, 2, 1, "", "ComputeLoss"], [35, 2, 1, "", "ComputePredictions"], [35, 2, 1, "", "CreateDecoderMetrics"], [35, 2, 1, "", "Decode"], [35, 2, 1, "", "Inference"], [35, 2, 1, "", "Params"], [35, 2, 1, "", "PostProcessDecodeOut"]], "lingvo.core.distributed_shampoo": [[36, 1, 1, "", "DistributedShampoo"], [36, 1, 1, "", "PartitionConfig"], [36, 1, 1, "", "PartitionMetadata"], [36, 1, 1, "", "TensorPartitioner"]], "lingvo.core.distributed_shampoo.DistributedShampoo": [[36, 2, 1, "", "_apply_dense"], [36, 2, 1, "", "_apply_sparse"], [36, 2, 1, "", "_compute_preconditioned_raw_grad"], [36, 2, 1, "", "_create_slots"], [36, 2, 1, "", "_fallback_to_diagonal_for_shape"], [36, 2, 1, "", "_generalized_inverse_pth_root"], [36, 2, 1, "", "_inverse_pth_root_graph"], [36, 2, 1, "", "_key_for_var"], [36, 2, 1, "", "_make_named_slot"], [36, 2, 1, "", "_preconditioned_update"], [36, 2, 1, "", "_preconditioner_available_for_dims"], [36, 2, 1, "", "_preconditioner_indices"], [36, 2, 1, "", "_preconditioner_key_for_partition_and_dim"], [36, 2, 1, "", "_prepare"], [36, 2, 1, "", "_resource_apply_dense"], [36, 2, 1, "", "_resource_apply_sparse"], [36, 2, 1, "", "_specialized_inverse_pth_root"], [36, 2, 1, "", "_statistics_key_for_partition_and_dim"], [36, 2, 1, "", "_updated_statistics"], [36, 2, 1, "", "assign_preconditioner_to_host_vars"], [36, 2, 1, "", "invoke_async_preconditioner_computation"], [36, 2, 1, "", "make_named_zeros_slot"]], "lingvo.core.distributed_shampoo.TensorPartitioner": [[36, 2, 1, "", "partition_metadata"], [36, 2, 1, "", "partition_tensor"], [36, 2, 1, "", "reform_tensor"]], "lingvo.core.early_stop": [[37, 1, 1, "", "EarlyStop"], [37, 1, 1, "", "MetricHistory"]], "lingvo.core.early_stop.EarlyStop": [[37, 2, 1, "", "Params"], [37, 2, 1, "", "Stop"], [37, 3, 1, "", "best_step"], [37, 3, 1, "", "last_step"], [37, 3, 1, "", "metric_history"]], "lingvo.core.early_stop.MetricHistory": [[37, 2, 1, "", "Append"], [37, 2, 1, "", "ConditionalAppend"], [37, 2, 1, "", "Params"], [37, 2, 1, "", "SetLogdirInMetricHistories"], [37, 2, 1, "", "_Key"], [37, 5, 1, "", "_metric_histories_map"], [37, 3, 1, "", "hist_file"], [37, 3, 1, "", "metric"], [37, 3, 1, "", "minimize"], [37, 3, 1, "", "tfevent_file"]], "lingvo.core.egdd": [[38, 1, 1, "", "EGDD"]], "lingvo.core.egdd.EGDD": [[38, 2, 1, "", "_apply_dense"], [38, 2, 1, "", "_apply_sparse"], [38, 2, 1, "", "_create_slots"], [38, 2, 1, "", "_prepare"], [38, 2, 1, "", "_resource_apply_dense"], [38, 2, 1, "", "_resource_apply_sparse"]], "lingvo.core.entmax": [[39, 6, 1, "", "_calculate_probability"], [39, 6, 1, "", "entmax_loss"], [39, 6, 1, "", "entmax_support"]], "lingvo.core.favor_attention": [[40, 6, 1, "", "causal_denominator"], [40, 6, 1, "", "causal_numerator"], [40, 6, 1, "", "chunked_causal_denominator"], [40, 6, 1, "", "chunked_causal_denominator_func"], [40, 6, 1, "", "chunked_causal_denominator_grad"], [40, 6, 1, "", "chunked_causal_numerator"], [40, 6, 1, "", "chunked_causal_numerator_func"], [40, 6, 1, "", "chunked_causal_numerator_grad"], [40, 6, 1, "", "cossim_kernel_transformation"], [40, 6, 1, "", "create_projection_matrix"], [40, 6, 1, "", "favor_attention"], [40, 6, 1, "", "next_seed"], [40, 6, 1, "", "noncausal_denominator"], [40, 6, 1, "", "noncausal_numerator"], [40, 6, 1, "", "relu_kernel_transformation"], [40, 6, 1, "", "softmax_kernel_transformation"]], "lingvo.core.flat_beam_search_helper": [[41, 6, 1, "", "einsum_i32"], [41, 6, 1, "", "flat_beam_search"], [41, 6, 1, "", "update_nbest"]], "lingvo.core.generic_input": [[42, 6, 1, "", "GenericInput"], [42, 6, 1, "", "GenericInputV2Create"], [42, 6, 1, "", "GenericInputV2GetNext"], [42, 6, 1, "", "IsGenericInputV2AllwedInEager"], [42, 6, 1, "", "ReplicatedGenericInput"], [42, 6, 1, "", "SetAllowGenericInputV2InEager"], [42, 6, 1, "", "_ParseProcessor"]], "lingvo.core.gpipe": [[43, 6, 1, "", "CellFnFPropOpReplacementWrapper"], [43, 1, 1, "", "FeatureExtractionLayer"], [43, 6, 1, "", "GenerateStepSeedPair"], [43, 6, 1, "", "GetOverWriteGlobalStep"], [43, 6, 1, "", "PartitionSequentialLayers"], [43, 1, 1, "", "PipeliningLayer"], [43, 1, 1, "", "SeqLayer"], [43, 6, 1, "", "SetOverWriteGlobalStep"], [43, 6, 1, "", "_ToTuple"]], "lingvo.core.gpipe.FeatureExtractionLayer": [[43, 2, 1, "", "FProp"], [43, 2, 1, "", "FPropMeta"], [43, 2, 1, "", "Params"]], "lingvo.core.gpipe.PipeliningLayer": [[43, 2, 1, "", "FProp"], [43, 2, 1, "", "Params"], [43, 2, 1, "", "_CalculateOutputShapes"], [43, 2, 1, "", "_get_input_shapes"], [43, 2, 1, "", "_get_state_dtype"]], "lingvo.core.gpipe.SeqLayer": [[43, 2, 1, "", "FProp"], [43, 2, 1, "", "Params"], [43, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.graddrop": [[44, 1, 1, "", "GradDrop"]], "lingvo.core.graddrop.GradDrop": [[44, 2, 1, "", "FProp"], [44, 2, 1, "", "Params"], [44, 2, 1, "", "SetLosses"]], "lingvo.core.gradient_combiner": [[45, 1, 1, "", "GradientCombiner"]], "lingvo.core.gradient_combiner.GradientCombiner": [[45, 2, 1, "", "Combine"]], "lingvo.core.gshard_builder": [[46, 1, 1, "", "BertTransformer"], [46, 1, 1, "", "DenseBuilder"], [46, 1, 1, "", "MoEBuilder"], [46, 1, 1, "", "RecurrentDenseBuilderParallelDecode"], [46, 1, 1, "", "TunableUniTransformer"], [46, 1, 1, "", "UniTransformer"], [46, 6, 1, "", "_ToInt32"]], "lingvo.core.gshard_builder.BertTransformer": [[46, 2, 1, "", "ComputeLoss"], [46, 2, 1, "", "ComputePerTokenLoss"], [46, 2, 1, "", "ComputePredictions"], [46, 2, 1, "", "Params"], [46, 2, 1, "", "_ComputeEncInput"], [46, 2, 1, "", "_ComputeNonPadding"], [46, 2, 1, "", "_ComputeSoftLabels"]], "lingvo.core.gshard_builder.DenseBuilder": [[46, 2, 1, "", "Attention"], [46, 2, 1, "", "DecEncAttention"], [46, 2, 1, "", "DecMultiDconvHeadAttention"], [46, 2, 1, "", "DecMultiDconvHeadAttentionRelativeBias"], [46, 2, 1, "", "DecSelfAttention"], [46, 2, 1, "", "DecSelfAttentionRelativeBias"], [46, 2, 1, "", "DenseReluDense"], [46, 2, 1, "", "DenseReluDenseGated"], [46, 2, 1, "", "DenseReluDenseQuantized"], [46, 2, 1, "", "DepthwiseConvAutoregressive"], [46, 2, 1, "", "EinsumWithModelDim"], [46, 2, 1, "", "Embedding"], [46, 2, 1, "", "MeshSplit"], [46, 2, 1, "", "MoE"], [46, 2, 1, "", "MoEGated"], [46, 2, 1, "", "ParallelDecSelfAttentionRelativeBiasFFN"], [46, 2, 1, "", "Params"], [46, 2, 1, "", "SelfAttention"], [46, 2, 1, "", "SelfAttentionRelativeBias"], [46, 2, 1, "", "_CapLogits"], [46, 2, 1, "", "_ComputeAttenOutputs"], [46, 2, 1, "", "_ComputeCombinedOutputs"], [46, 2, 1, "", "_ComputeQKV"], [46, 2, 1, "", "_ComputeQKVCombine"], [46, 2, 1, "", "_ComputeQKVH"], [46, 2, 1, "", "_EinsumWithModelDim"], [46, 2, 1, "", "_JaxReplicaLN"], [46, 2, 1, "", "_LN"], [46, 2, 1, "", "_MeshSplit"], [46, 2, 1, "", "_MoEWeightsGatedGELU"], [46, 2, 1, "", "_PN"], [46, 2, 1, "", "_ReshapeM"], [46, 2, 1, "", "_ReshapedModelDims"], [46, 2, 1, "", "_ShardedFeedForwardNetworksWeights"], [46, 2, 1, "", "_ShardedMoEGLU"], [46, 2, 1, "", "_ShardedMoEPositionWiseFeedForwardNetworks"], [46, 2, 1, "", "_TrueLN"], [46, 3, 1, "", "_attention_output_hdm_w_split"], [46, 3, 1, "", "_device_mesh"]], "lingvo.core.gshard_builder.MoEBuilder": [[46, 2, 1, "", "Attention"], [46, 2, 1, "", "CausalDepthwiseConv"], [46, 2, 1, "", "DecEncAttention"], [46, 2, 1, "", "DecMultiDconvHeadAttention"], [46, 2, 1, "", "DecMultiDconvHeadAttentionRelativeBias"], [46, 2, 1, "", "DecSelfAttention"], [46, 2, 1, "", "DecSelfAttentionQuantized"], [46, 2, 1, "", "DecSelfAttentionRelativeBias"], [46, 2, 1, "", "DecoderLayer"], [46, 2, 1, "", "DecoderLayerStack"], [46, 2, 1, "", "DenseReluDense"], [46, 2, 1, "", "DenseReluDenseGated"], [46, 2, 1, "", "DenseReluDenseGatedGELU"], [46, 2, 1, "", "DenseReluDenseGatedSILU"], [46, 2, 1, "", "DepthwiseConvAutoregressive"], [46, 2, 1, "", "Embedding"], [46, 2, 1, "", "EncoderLayer"], [46, 2, 1, "", "EncoderLayerStack"], [46, 2, 1, "", "Mask"], [46, 2, 1, "", "MoE"], [46, 2, 1, "", "Params"], [46, 2, 1, "", "Repeat"], [46, 2, 1, "", "SelfAttention"], [46, 2, 1, "", "SelfAttentionRelativeBias"], [46, 2, 1, "", "SetFPropDtype"], [46, 2, 1, "", "ShardablePipeline"], [46, 2, 1, "", "SharedEmbSoftmax"], [46, 2, 1, "", "SmoothedSoftmax"], [46, 2, 1, "", "SoftmaxWeight"], [46, 2, 1, "", "Split"], [46, 2, 1, "", "_Add"], [46, 2, 1, "", "_AddRelativeBias"], [46, 2, 1, "", "_AdjustMSplit"], [46, 2, 1, "", "_AdjustMSplitByName"], [46, 2, 1, "", "_AttentionState"], [46, 2, 1, "", "_AttentionWeights"], [46, 2, 1, "", "_ComputeAttenOutputs"], [46, 2, 1, "", "_ComputeGating"], [46, 2, 1, "", "_ComputeQKV"], [46, 2, 1, "", "_ComputeQKVCombine"], [46, 2, 1, "", "_DecComputeBiasGraphEdge"], [46, 2, 1, "", "_DecNotVisible"], [46, 3, 1, "", "_DecoderLayerInMapKeys"], [46, 2, 1, "", "_DenseReluDenseWeights"], [46, 2, 1, "", "_DenseReluDenseWeightsGatedGELU"], [46, 2, 1, "", "_Dropout"], [46, 2, 1, "", "_EmbeddingWeight"], [46, 2, 1, "", "_EncNotVisible"], [46, 2, 1, "", "_EncoderAddRelativeBias"], [46, 3, 1, "", "_EncoderLayerInMapKeys"], [46, 2, 1, "", "_FeedForwardNetworksApplyGating"], [46, 2, 1, "", "_GetRopeFn"], [46, 2, 1, "", "_Identity"], [46, 2, 1, "", "_JaxReplicaLN"], [46, 2, 1, "", "_LN"], [46, 2, 1, "", "_LNConv"], [46, 2, 1, "", "_LNInternal"], [46, 2, 1, "", "_LNNoScale"], [46, 2, 1, "", "_LayerStack"], [46, 2, 1, "", "_OneHotEncode"], [46, 2, 1, "", "_Override"], [46, 2, 1, "", "_PN"], [46, 2, 1, "", "_RelativeAttentionBiasWeights"], [46, 2, 1, "", "_RelativePositionBucket"], [46, 2, 1, "", "_ShardedFeedForwardNetworksWeights"], [46, 2, 1, "", "_ShardedMoEPositionWiseFeedForwardNetworks"], [46, 2, 1, "", "_ShardedVar"], [46, 2, 1, "", "_ShardedVarOn1DDeviceArray"], [46, 2, 1, "", "_Softmax"], [46, 2, 1, "", "_Top2GatingWeights"], [46, 2, 1, "", "_TrueLN"], [46, 2, 1, "", "_Var"], [46, 3, 1, "", "_device_mesh"], [46, 3, 1, "", "_model_dim_reshape_segments"], [46, 2, 1, "", "_zero_aux_loss"], [46, 2, 1, "", "get_quantized_weight_scale"]], "lingvo.core.gshard_builder.RecurrentDenseBuilderParallelDecode": [[46, 2, 1, "", "DecoderLayer"], [46, 2, 1, "", "DecoderLayerStack"], [46, 2, 1, "", "Params"], [46, 2, 1, "", "_ComputeQKVH"], [46, 3, 1, "", "_DecoderLayerInMapKeys"], [46, 2, 1, "", "_DecoderLayerInputProjWeights"], [46, 2, 1, "", "_DecoderLayerOutputProjWeights"], [46, 3, 1, "", "_atten_kv_var_heads"], [46, 3, 1, "", "_atten_q_var_heads"], [46, 3, 1, "", "_ffw_var_h_dim_size"], [46, 3, 1, "", "_num_input_proj_weights"], [46, 3, 1, "", "_num_output_proj_weights"]], "lingvo.core.gshard_builder.TunableUniTransformer": [[46, 2, 1, "", "Params"], [46, 2, 1, "", "_GetDecoderLayerStackParams"]], "lingvo.core.gshard_builder.UniTransformer": [[46, 2, 1, "", "ComputeLoss"], [46, 2, 1, "", "ComputePerTokenLoss"], [46, 2, 1, "", "ComputePredictions"], [46, 2, 1, "", "DecodeIds"], [46, 2, 1, "", "FilterPerExampleTensors"], [46, 2, 1, "", "Params"], [46, 2, 1, "", "ProcessFPropResults"], [46, 2, 1, "", "_BPropGenTrainOps"], [46, 2, 1, "", "_ComputeDecoderInput"], [46, 2, 1, "", "_ComputeNonPadding"], [46, 2, 1, "", "_ComputeSoftLabels"], [46, 2, 1, "", "_FlatBeamSearchCallback"], [46, 2, 1, "", "_GetDecoderLayerStackParams"], [46, 2, 1, "", "_SplitDecoderOutputAndSoftmax"], [46, 2, 1, "", "_top_k_fn"]], "lingvo.core.gshard_decode": [[47, 1, 1, "", "GShardDecode"], [47, 6, 1, "", "daemon"], [47, 6, 1, "", "get_zero_batch"], [47, 6, 1, "", "infinite_repeat"], [47, 6, 1, "", "preload_zero"]], "lingvo.core.gshard_decode.GShardDecode": [[47, 2, 1, "", "_config_infeed"], [47, 2, 1, "", "_config_outfeed"], [47, 2, 1, "", "_configure_cluster_params"], [47, 2, 1, "", "_init_tpu"], [47, 2, 1, "", "_no_opt_sess_cfg"], [47, 2, 1, "", "_start_heartbeat"], [47, 2, 1, "", "get_session"], [47, 2, 1, "", "init_graph"], [47, 2, 1, "", "load_spm"], [47, 2, 1, "", "reset_session"], [47, 2, 1, "", "reset_tpu_cluster"], [47, 2, 1, "", "run_init_sequence"]], "lingvo.core.gshard_layers": [[48, 1, 1, "", "CausalDepthwiseConv1DLayer"], [48, 6, 1, "", "ComputeGating"], [48, 1, 1, "", "Conv1DStateLayer"], [48, 6, 1, "", "EinsumWithModelDim"], [48, 6, 1, "", "FeedForwardNetworksApplyGating"], [48, 6, 1, "", "GatherK"], [48, 6, 1, "", "GetSentenceEmbeddings"], [48, 6, 1, "", "HashGating"], [48, 6, 1, "", "HashGatingOnLogits"], [48, 1, 1, "", "LayerwiseShardablePipelinedLayer"], [48, 1, 1, "", "MultiHeadAttentionStateLayer"], [48, 6, 1, "", "OptimalTransportGating"], [48, 6, 1, "", "OptimalTransportOnlogits"], [48, 1, 1, "", "OverrideLayer"], [48, 1, 1, "", "ReshapeInputLayer"], [48, 6, 1, "", "SentenceTop2Gating"], [48, 1, 1, "", "ShardedVarLayer"], [48, 6, 1, "", "ShardedWeightParams"], [48, 1, 1, "", "SharedEmbeddingSoftmaxLayer"], [48, 1, 1, "", "StateLayer"], [48, 6, 1, "", "TaskTop2Gating"], [48, 6, 1, "", "TokenShuffleGating"], [48, 6, 1, "", "TokenShuffleGatingV2"], [48, 6, 1, "", "TokenShufflingOnlogits"], [48, 6, 1, "", "TokenShufflingOnlogitsV2"], [48, 6, 1, "", "Top2Gating"], [48, 6, 1, "", "Top2GatingOnLogits"], [48, 1, 1, "", "VarLayer"], [48, 6, 1, "", "_EinsumEqWithModelDim"], [48, 6, 1, "", "_ToTuple"]], "lingvo.core.gshard_layers.CausalDepthwiseConv1DLayer": [[48, 2, 1, "", "FProp"], [48, 2, 1, "", "Params"], [48, 2, 1, "", "_CreateLayerVariables"], [48, 2, 1, "", "_DoConv"], [48, 2, 1, "", "_GetWeight"], [48, 2, 1, "", "_Var"]], "lingvo.core.gshard_layers.Conv1DStateLayer": [[48, 2, 1, "", "FProp"], [48, 2, 1, "", "NewState"], [48, 2, 1, "", "Params"], [48, 2, 1, "", "_ProcessPrefixOrSuffix"], [48, 2, 1, "", "_Step"]], "lingvo.core.gshard_layers.LayerwiseShardablePipelinedLayer": [[48, 2, 1, "", "BodyFProp"], [48, 2, 1, "", "BodyFPropNoMicrobatching"], [48, 2, 1, "", "FProp"], [48, 2, 1, "", "FPropFn"], [48, 2, 1, "", "PadMicrobatches"], [48, 2, 1, "", "Params"], [48, 2, 1, "", "_BodyFPropInternal"], [48, 2, 1, "", "_FindPerStageVarShardingDim"], [48, 2, 1, "", "_MicrobatchAndRepeatIDs"], [48, 2, 1, "", "_PadMicrobatchesInternal"], [48, 3, 1, "", "_body"], [48, 2, 1, "", "_child_variable_scope_override"], [48, 2, 1, "", "_unrolled_fprop"], [48, 2, 1, "", "layer_theta"]], "lingvo.core.gshard_layers.MultiHeadAttentionStateLayer": [[48, 2, 1, "", "NewState"], [48, 2, 1, "", "_Step"], [48, 5, 1, "", "_use_flat_beam_search"]], "lingvo.core.gshard_layers.OverrideLayer": [[48, 2, 1, "", "Clear"], [48, 2, 1, "", "FProp"], [48, 2, 1, "", "Params"], [48, 2, 1, "", "Set"], [48, 5, 1, "", "_OVERRIDE"]], "lingvo.core.gshard_layers.ReshapeInputLayer": [[48, 2, 1, "", "FProp"], [48, 2, 1, "", "Params"]], "lingvo.core.gshard_layers.ShardedVarLayer": [[48, 2, 1, "", "FProp"], [48, 2, 1, "", "Params"]], "lingvo.core.gshard_layers.SharedEmbeddingSoftmaxLayer": [[48, 2, 1, "", "ComputeLoss"], [48, 2, 1, "", "FProp"], [48, 2, 1, "", "Params"], [48, 2, 1, "", "_MaybeSplit"]], "lingvo.core.gshard_layers.StateLayer": [[48, 2, 1, "", "FProp"], [48, 2, 1, "", "InitState"], [48, 2, 1, "", "NewState"], [48, 2, 1, "", "Params"], [48, 2, 1, "", "UpdateState"], [48, 2, 1, "", "UpdateTheta"], [48, 2, 1, "", "_Step"]], "lingvo.core.gshard_layers.VarLayer": [[48, 2, 1, "", "FProp"], [48, 2, 1, "", "Params"], [48, 2, 1, "", "_get_var_from_collection"]], "lingvo.core.gshard_utils": [[49, 6, 1, "", "GetMeshSplitDimPrefixContext"], [49, 6, 1, "", "GetMeshSplitSharding"], [49, 6, 1, "", "GetNonPod2dMesh"], [49, 6, 1, "", "GetVarSharding"], [49, 6, 1, "", "LoadSpm"], [49, 6, 1, "", "ManualMeshDimContext"], [49, 6, 1, "", "MeshSplit"], [49, 6, 1, "", "MeshSplitDimPrefixContext"], [49, 6, 1, "", "Replicate"], [49, 6, 1, "", "ReshapeDim"], [49, 6, 1, "", "Split"], [49, 1, 1, "", "TensorShardingSpec"], [49, 6, 1, "", "ZigzagOrderOnDeviceMesh"]], "lingvo.core.gshard_utils.TensorShardingSpec": [[49, 2, 1, "", "AddLeadingDims"], [49, 2, 1, "", "ApplyToTensor"], [49, 2, 1, "", "ApplyToVariable"], [49, 2, 1, "", "AutoToManualPartitioning"], [49, 2, 1, "", "FromFullShape"], [49, 2, 1, "", "FromXlaOpSharding"], [49, 2, 1, "", "ManualToAutoPartitioning"], [49, 2, 1, "", "RemoveDim"], [49, 2, 1, "", "RemoveLeadingDims"], [49, 2, 1, "", "ReplicatedSpec"], [49, 2, 1, "", "ShardShape"], [49, 2, 1, "", "ToXlaOpSharding"], [49, 3, 1, "", "device_mesh"], [49, 3, 1, "", "is_replicated"], [49, 3, 1, "", "mesh_dim_to_tensor_dim_mapping"], [49, 3, 1, "", "split_dims_mapping"], [49, 3, 1, "", "uneven_padding"]], "lingvo.core.hyperparams": [[50, 6, 1, "", "CopyFieldsTo"], [50, 1, 1, "", "InstantiableParams"], [50, 1, 1, "", "Params"], [50, 6, 1, "", "_EndsWithTerminalQuote"], [50, 6, 1, "", "_IsNamedTuple"], [50, 1, 1, "", "_Param"], [50, 6, 1, "", "_QuoteString"], [50, 1, 1, "", "_SortedDict"], [50, 6, 1, "", "_UnquoteString"]], "lingvo.core.hyperparams.InstantiableParams": [[50, 2, 1, "", "Copy"], [50, 2, 1, "", "Instantiate"]], "lingvo.core.hyperparams.Params": [[50, 2, 1, "", "Copy"], [50, 2, 1, "", "Define"], [50, 2, 1, "", "Delete"], [50, 2, 1, "", "Freeze"], [50, 2, 1, "", "FromProto"], [50, 2, 1, "", "FromText"], [50, 2, 1, "", "FromTextWithTypes"], [50, 2, 1, "", "Get"], [50, 2, 1, "", "GetKeys"], [50, 2, 1, "", "IsImmutable"], [50, 2, 1, "", "IterParams"], [50, 2, 1, "", "MergeCommonKeysFrom"], [50, 2, 1, "", "Set"], [50, 2, 1, "", "TextDiff"], [50, 2, 1, "", "ToProto"], [50, 2, 1, "", "ToText"], [50, 2, 1, "", "ToTextWithTypes"], [50, 2, 1, "", "Visit"], [50, 2, 1, "", "_CopyTo"], [50, 2, 1, "", "_GetNested"], [50, 2, 1, "", "_KeyErrorString"], [50, 2, 1, "", "_SimilarKeys"], [50, 2, 1, "", "_ToString"]], "lingvo.core.hyperparams._Param": [[50, 2, 1, "", "Get"], [50, 2, 1, "", "GetDefault"], [50, 2, 1, "", "Set"], [50, 2, 1, "", "ToString"]], "lingvo.core.hyperparams_pb2": [[51, 1, 1, "", "EnumVal"], [51, 1, 1, "", "Hyperparam"], [51, 1, 1, "", "HyperparamRepeated"], [51, 1, 1, "", "HyperparamValue"], [51, 1, 1, "", "NamedTupleVal"], [51, 1, 1, "", "ProtoVal"], [51, 6, 1, "", "_b"]], "lingvo.core.hyperparams_pb2.EnumVal": [[51, 5, 1, "", "DESCRIPTOR"], [51, 5, 1, "", "name"], [51, 5, 1, "", "type"]], "lingvo.core.hyperparams_pb2.Hyperparam": [[51, 5, 1, "", "DESCRIPTOR"], [51, 1, 1, "", "ItemsEntry"], [51, 5, 1, "", "items"]], "lingvo.core.hyperparams_pb2.Hyperparam.ItemsEntry": [[51, 5, 1, "", "DESCRIPTOR"], [51, 5, 1, "", "key"], [51, 5, 1, "", "value"]], "lingvo.core.hyperparams_pb2.HyperparamRepeated": [[51, 5, 1, "", "DESCRIPTOR"], [51, 5, 1, "", "items"]], "lingvo.core.hyperparams_pb2.HyperparamValue": [[51, 5, 1, "", "DESCRIPTOR"], [51, 5, 1, "", "bool_val"], [51, 5, 1, "", "dict_val"], [51, 5, 1, "", "dtype_val"], [51, 5, 1, "", "enum_val"], [51, 5, 1, "", "float_val"], [51, 5, 1, "", "int_val"], [51, 5, 1, "", "list_val"], [51, 5, 1, "", "named_tuple_val"], [51, 5, 1, "", "param_val"], [51, 5, 1, "", "proto_val"], [51, 5, 1, "", "string_repr_val"], [51, 5, 1, "", "string_val"], [51, 5, 1, "", "symbolic_val"], [51, 5, 1, "", "tuple_val"], [51, 5, 1, "", "type_val"]], "lingvo.core.hyperparams_pb2.NamedTupleVal": [[51, 5, 1, "", "DESCRIPTOR"], [51, 5, 1, "", "items"], [51, 5, 1, "", "type"]], "lingvo.core.hyperparams_pb2.ProtoVal": [[51, 5, 1, "", "DESCRIPTOR"], [51, 5, 1, "", "type"], [51, 5, 1, "", "val"]], "lingvo.core.inference_graph_exporter": [[52, 6, 1, "", "ConstGuaranteeScope"], [52, 6, 1, "", "ConvertSubgraphDictToProto"], [52, 6, 1, "", "GetOutputOpNames"], [52, 6, 1, "", "GuaranteeConstGetter"], [52, 1, 1, "", "InferenceDeviceOptions"], [52, 1, 1, "", "InferenceGraphExporter"], [52, 6, 1, "", "IsGpu"], [52, 6, 1, "", "IsTpu"], [52, 6, 1, "", "NoConstGuaranteeScope"], [52, 6, 1, "", "ShouldForceBfloat16ForActivations"], [52, 6, 1, "", "ShouldForceBfloat16ForWeightsAndActivations"], [52, 6, 1, "", "_DummyScope"], [52, 6, 1, "", "_FreezeDefaults"], [52, 6, 1, "", "_FreezeGraphFromCheckpoint"], [52, 6, 1, "", "_GetVarName"], [52, 6, 1, "", "_MakeVariableDictionary"], [52, 6, 1, "", "_ParamExists"]], "lingvo.core.inference_graph_exporter.InferenceDeviceOptions": [[52, 2, 1, "", "_asdict"], [52, 5, 1, "", "_field_defaults"], [52, 5, 1, "", "_fields"], [52, 2, 1, "", "_make"], [52, 2, 1, "", "_replace"], [52, 5, 1, "", "device"], [52, 5, 1, "", "dtype_override"], [52, 5, 1, "", "fprop_dtype_override"], [52, 5, 1, "", "gen_init_op"], [52, 5, 1, "", "retain_device_placement"], [52, 5, 1, "", "var_options"]], "lingvo.core.inference_graph_exporter.InferenceGraphExporter": [[52, 2, 1, "", "Export"], [52, 2, 1, "", "_DeviceSupportsFreezing"], [52, 2, 1, "", "_SetClusterParams"]], "lingvo.core.inference_graph_pb2": [[53, 1, 1, "", "InferenceGraph"], [53, 6, 1, "", "_b"]], "lingvo.core.inference_graph_pb2.InferenceGraph": [[53, 1, 1, "", "CollectionDefEntry"], [53, 5, 1, "", "DESCRIPTOR"], [53, 1, 1, "", "FeedFetchMeta"], [53, 1, 1, "", "Subgraph"], [53, 1, 1, "", "SubgraphMeta"], [53, 1, 1, "", "SubgraphsEntry"], [53, 5, 1, "", "asset_file_def"], [53, 5, 1, "", "collection_def"], [53, 5, 1, "", "graph_def"], [53, 5, 1, "", "hyperparameters"], [53, 5, 1, "", "saver_def"], [53, 5, 1, "", "subgraphs"]], "lingvo.core.inference_graph_pb2.InferenceGraph.CollectionDefEntry": [[53, 5, 1, "", "DESCRIPTOR"], [53, 5, 1, "", "key"], [53, 5, 1, "", "value"]], "lingvo.core.inference_graph_pb2.InferenceGraph.FeedFetchMeta": [[53, 5, 1, "", "DESCRIPTOR"], [53, 5, 1, "", "data_type"], [53, 5, 1, "", "dispatch_stride_axis"], [53, 5, 1, "", "extensions"], [53, 5, 1, "", "layout"], [53, 5, 1, "", "quantized_max_const"], [53, 5, 1, "", "quantized_max_tensor"], [53, 5, 1, "", "quantized_min_const"], [53, 5, 1, "", "quantized_min_tensor"], [53, 5, 1, "", "quantized_num_bits"], [53, 5, 1, "", "shape"]], "lingvo.core.inference_graph_pb2.InferenceGraph.Subgraph": [[53, 5, 1, "", "DESCRIPTOR"], [53, 1, 1, "", "FeedsEntry"], [53, 1, 1, "", "FeedsMetaEntry"], [53, 1, 1, "", "FetchesEntry"], [53, 1, 1, "", "FetchesMetaEntry"], [53, 5, 1, "", "feeds"], [53, 5, 1, "", "feeds_meta"], [53, 5, 1, "", "fetches"], [53, 5, 1, "", "fetches_meta"], [53, 5, 1, "", "meta"]], "lingvo.core.inference_graph_pb2.InferenceGraph.Subgraph.FeedsEntry": [[53, 5, 1, "", "DESCRIPTOR"], [53, 5, 1, "", "key"], [53, 5, 1, "", "value"]], "lingvo.core.inference_graph_pb2.InferenceGraph.Subgraph.FeedsMetaEntry": [[53, 5, 1, "", "DESCRIPTOR"], [53, 5, 1, "", "key"], [53, 5, 1, "", "value"]], "lingvo.core.inference_graph_pb2.InferenceGraph.Subgraph.FetchesEntry": [[53, 5, 1, "", "DESCRIPTOR"], [53, 5, 1, "", "key"], [53, 5, 1, "", "value"]], "lingvo.core.inference_graph_pb2.InferenceGraph.Subgraph.FetchesMetaEntry": [[53, 5, 1, "", "DESCRIPTOR"], [53, 5, 1, "", "key"], [53, 5, 1, "", "value"]], "lingvo.core.inference_graph_pb2.InferenceGraph.SubgraphMeta": [[53, 5, 1, "", "DESCRIPTOR"], [53, 5, 1, "", "extensions"]], "lingvo.core.inference_graph_pb2.InferenceGraph.SubgraphsEntry": [[53, 5, 1, "", "DESCRIPTOR"], [53, 5, 1, "", "key"], [53, 5, 1, "", "value"]], "lingvo.core.input_generator_helper": [[54, 6, 1, "", "ComputeSplits"], [54, 6, 1, "", "SplitDictOfTensors"], [54, 6, 1, "", "SplitTensors"]], "lingvo.core.input_policy": [[55, 6, 1, "", "Apply"]], "lingvo.core.insertion": [[56, 6, 1, "", "SequenceAppendToken"], [56, 6, 1, "", "SequenceConcat"], [56, 6, 1, "", "SequenceTrimLastToken"], [56, 1, 1, "", "SymbolInsertionLayer"]], "lingvo.core.insertion.SymbolInsertionLayer": [[56, 2, 1, "", "FProp"], [56, 2, 1, "", "Params"]], "lingvo.core.inspect_utils": [[57, 6, 1, "", "CallWithParams"], [57, 6, 1, "", "ConstructWithParams"], [57, 6, 1, "", "DefineParams"], [57, 6, 1, "", "_ExtractParameters"], [57, 6, 1, "", "_IsDefinableParameter"], [57, 6, 1, "", "_MakeArgs"]], "lingvo.core.layers": [[58, 1, 1, "", "BaseConv2DLayer"], [58, 1, 1, "", "BlurPoolLayer"], [58, 1, 1, "", "CCTGatingNetwork"], [58, 1, 1, "", "CategoricalLayerNorm"], [58, 1, 1, "", "CondScaleShiftFFNLayer"], [58, 6, 1, "", "Conv2DFlops"], [58, 1, 1, "", "Conv2DLayer"], [58, 1, 1, "", "Conv2DLayerNoPadding"], [58, 5, 1, "", "ConvLayer"], [58, 1, 1, "", "ConvNN2DLayer"], [58, 1, 1, "", "ConvSetLayer"], [58, 1, 1, "", "ConvSoftmax"], [58, 1, 1, "", "DeconvLayer"], [58, 1, 1, "", "DepthwiseConv2DLayer"], [58, 1, 1, "", "DeterministicDropoutLayer"], [58, 1, 1, "", "DropoutLayer"], [58, 1, 1, "", "EinsumEmbeddingLayer"], [58, 1, 1, "", "EinsumSoftmax"], [58, 1, 1, "", "EmbeddingLayer"], [58, 1, 1, "", "FCLayer"], [58, 1, 1, "", "FeedForwardNet"], [58, 1, 1, "", "FetchLayer"], [58, 1, 1, "", "FocalFullSoftmax"], [58, 1, 1, "", "GatedAverageLayer"], [58, 1, 1, "", "GatingLayer"], [58, 1, 1, "", "GluLayer"], [58, 1, 1, "", "GradNormTracker"], [58, 1, 1, "", "HighwaySkipLayer"], [58, 1, 1, "", "IdentityLayer"], [58, 1, 1, "", "LHUCLayer"], [58, 1, 1, "", "LSHMemoryRankKOneHotTaskLayer"], [58, 1, 1, "", "LSHTaskWithMultiplierLayer"], [58, 1, 1, "", "LayerNorm"], [58, 1, 1, "", "LearnablePositionalEmbeddingLayer"], [58, 1, 1, "", "LocalizedLabelSmoother"], [58, 1, 1, "", "MaskedLmDataAugmenter"], [58, 1, 1, "", "MultitaskAdapterBaseLayer"], [58, 1, 1, "", "MultitaskAdapterEinsumLayer"], [58, 1, 1, "", "MultitaskAdapterLayer"], [58, 1, 1, "", "OneHotEmbeddingLayer"], [58, 1, 1, "", "PerFrameStatisticalPoolingLayer"], [58, 1, 1, "", "PoolingLayer"], [58, 1, 1, "", "PositionalEmbeddingLayer"], [58, 1, 1, "", "ProjectionLayer"], [58, 1, 1, "", "RelativePositionalEmbeddingLayer"], [58, 1, 1, "", "ReshapedLayerNorm"], [58, 1, 1, "", "ResidualAdapterLayer"], [58, 1, 1, "", "RotaryPositionalEmbeddingLayer"], [58, 1, 1, "", "Scones"], [58, 1, 1, "", "SeparableConv2DLayer"], [58, 1, 1, "", "SharedSoftmaxLayer"], [58, 1, 1, "", "SimpleEmbeddingLayer"], [58, 1, 1, "", "SimpleFullSigmoidCrossEntropy"], [58, 1, 1, "", "SimpleFullSoftmax"], [58, 1, 1, "", "SingleShardEmbeddingLayer"], [58, 1, 1, "", "SingleShardFullSoftmax"], [58, 1, 1, "", "SingleShardSharedEmbeddingSoftmax"], [58, 1, 1, "", "SinusoidalPositionalEmbeddingLayer"], [58, 1, 1, "", "SoftmaxLayer"], [58, 1, 1, "", "StackingOverTime"], [58, 1, 1, "", "StatisticalPoolingLayer"], [58, 1, 1, "", "UniformLabelSmoother"], [58, 1, 1, "", "WeightedSumLayer"]], "lingvo.core.layers.BaseConv2DLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "OutShape"], [58, 2, 1, "", "OutputShape"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_ApplyConv"], [58, 2, 1, "", "_Compute"], [58, 2, 1, "", "_ComputeConvLast"], [58, 2, 1, "", "_CreateLayerVariables"], [58, 2, 1, "", "_EvaluateConvKernel"], [58, 2, 1, "", "_GetWeights"], [58, 2, 1, "", "_child_variable_scope_override"], [58, 3, 1, "", "_is_bn_folded"], [58, 3, 1, "", "filter_output_shape"], [58, 3, 1, "", "output_channels"]], "lingvo.core.layers.BlurPoolLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.CCTGatingNetwork": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "FPropMeta"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.CategoricalLayerNorm": [[58, 2, 1, "", "Params"], [58, 2, 1, "", "_BiasVarName"], [58, 2, 1, "", "_CreateLayerVariables"], [58, 2, 1, "", "_GetScaleAndBias"], [58, 2, 1, "", "_ScaleVarName"]], "lingvo.core.layers.CondScaleShiftFFNLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.Conv2DLayer": [[58, 2, 1, "", "_EvaluateConvKernel"]], "lingvo.core.layers.Conv2DLayerNoPadding": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "FPropMeta"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.ConvNN2DLayer": [[58, 2, 1, "", "_EvaluateConvKernel"]], "lingvo.core.layers.ConvSetLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.ConvSoftmax": [[58, 2, 1, "", "Logits"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.DeconvLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "OutShape"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_ApplyConv"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.DepthwiseConv2DLayer": [[58, 2, 1, "", "Params"], [58, 2, 1, "", "_EvaluateConvKernel"], [58, 3, 1, "", "filter_output_shape"], [58, 3, 1, "", "output_channels"]], "lingvo.core.layers.DeterministicDropoutLayer": [[58, 2, 1, "", "_Dropout"]], "lingvo.core.layers.DropoutLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "FPropMeta"], [58, 2, 1, "", "NumOutputNodes"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_Dropout"]], "lingvo.core.layers.EinsumEmbeddingLayer": [[58, 2, 1, "", "AddGlobalVN"], [58, 2, 1, "", "EmbLookup"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.EinsumSoftmax": [[58, 2, 1, "", "DenseWeights"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Logits"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "XentLossFromLogits"], [58, 2, 1, "", "_CreateLayerVariables"], [58, 3, 1, "", "wm_transposed"]], "lingvo.core.layers.EmbeddingLayer": [[58, 2, 1, "", "AddGlobalVN"], [58, 2, 1, "", "EmbLookup"], [58, 2, 1, "", "EmbLookupDefaultTheta"], [58, 5, 1, "", "MIN_PARAMS_PER_SHARD"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.FCLayer": [[58, 2, 1, "", "Params"]], "lingvo.core.layers.FeedForwardNet": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "FPropAllLayers"], [58, 2, 1, "", "FPropMeta"], [58, 2, 1, "", "NumOutputNodes"], [58, 2, 1, "", "Params"], [58, 3, 1, "", "output_dim"]], "lingvo.core.layers.FetchLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "FPropMeta"], [58, 2, 1, "", "_ReturnSingleValueOrList"], [58, 3, 1, "", "activation"], [58, 3, 1, "", "gradient"]], "lingvo.core.layers.FocalFullSoftmax": [[58, 2, 1, "", "Params"], [58, 2, 1, "", "XentLossFromLogits"]], "lingvo.core.layers.GatedAverageLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.GatingLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.GluLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.GradNormTracker": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.HighwaySkipLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.IdentityLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "FPropMeta"]], "lingvo.core.layers.LHUCLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.LSHMemoryRankKOneHotTaskLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "FPropMeta"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_ComputeGridLSHBucketIds"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.LSHTaskWithMultiplierLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "FPropMeta"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.LayerNorm": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "FPropMeta"], [58, 2, 1, "", "NumOutputNodes"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"], [58, 2, 1, "", "_GetScaleAndBias"]], "lingvo.core.layers.LearnablePositionalEmbeddingLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "FPropWithPosition"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"], [58, 2, 1, "", "_PosEmbeddingsFromPositions"]], "lingvo.core.layers.LocalizedLabelSmoother": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.MaskedLmDataAugmenter": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.MultitaskAdapterBaseLayer": [[58, 2, 1, "", "Params"]], "lingvo.core.layers.MultitaskAdapterEinsumLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.MultitaskAdapterLayer": [[58, 2, 1, "", "FProp"]], "lingvo.core.layers.OneHotEmbeddingLayer": [[58, 2, 1, "", "EmbLookup"], [58, 2, 1, "", "EmbLookupDefaultTheta"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.PerFrameStatisticalPoolingLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "StreamingStep"]], "lingvo.core.layers.PoolingLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "OutShape"], [58, 2, 1, "", "OutputShape"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.PositionalEmbeddingLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "FPropWithPosition"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"], [58, 2, 1, "", "_PosEmbeddingsFromPositions"]], "lingvo.core.layers.ProjectionLayer": [[58, 2, 1, "", "AddGlobalVN"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "FPropFullSequence"], [58, 2, 1, "", "FPropMeta"], [58, 2, 1, "", "NumOutputNodes"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_ApplyActivationFunction"], [58, 2, 1, "", "_ApplyProjectionKernel"], [58, 2, 1, "", "_CreateLayerVariables"], [58, 2, 1, "", "_GetBlockDiagonalInitScale"], [58, 2, 1, "", "_GetBlockedMatMulInputOutputMultipliers"], [58, 2, 1, "", "_GetBlockedWeightMatrix"], [58, 2, 1, "", "_GetWeights"], [58, 2, 1, "", "_child_variable_scope_override"], [58, 3, 1, "", "_is_bn_folded"], [58, 3, 1, "", "output_qact_name"]], "lingvo.core.layers.RelativePositionalEmbeddingLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.ReshapedLayerNorm": [[58, 2, 1, "", "FProp"]], "lingvo.core.layers.ResidualAdapterLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.RotaryPositionalEmbeddingLayer": [[58, 2, 1, "", "ExtendStep"], [58, 2, 1, "", "FProp"]], "lingvo.core.layers.Scones": [[58, 2, 1, "", "Params"], [58, 2, 1, "", "XentLossFromLogits"]], "lingvo.core.layers.SeparableConv2DLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "OutShape"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.SharedSoftmaxLayer": [[58, 2, 1, "", "EmbLookup"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Logits"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "SimpleLogits"], [58, 2, 1, "", "XentLossFromLogits"], [58, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.layers.SimpleEmbeddingLayer": [[58, 2, 1, "", "AddGlobalVN"], [58, 2, 1, "", "EmbLookup"], [58, 2, 1, "", "EmbLookupDefaultTheta"], [58, 2, 1, "", "EmbLookupDefaultThetaOnCpu"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"], [58, 2, 1, "", "_FlatFProp"], [58, 2, 1, "", "_FpropImpl"], [58, 2, 1, "", "_GetWeightShape"]], "lingvo.core.layers.SimpleFullSigmoidCrossEntropy": [[58, 2, 1, "", "Params"], [58, 2, 1, "", "XentLossFromLogits"], [58, 2, 1, "", "_FProp2D"]], "lingvo.core.layers.SimpleFullSoftmax": [[58, 2, 1, "", "AddGlobalVN"], [58, 2, 1, "", "DenseWeights"], [58, 2, 1, "", "Logits"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "SimpleLogits"], [58, 2, 1, "", "XentLossFromLogits"], [58, 2, 1, "", "_CreateLayerVariables"], [58, 2, 1, "", "_FProp2D"], [58, 2, 1, "", "_GetInputs"], [58, 2, 1, "", "_LogitsUsingConcatenatedWeights"], [58, 2, 1, "", "_LogitsUsingConcatenatedWeightsHelper"], [58, 2, 1, "", "_XentLossByChunk"], [58, 3, 1, "", "wm_transposed"]], "lingvo.core.layers.SingleShardEmbeddingLayer": [[58, 2, 1, "", "AddGlobalVN"], [58, 2, 1, "", "EmbLookup"], [58, 2, 1, "", "EmbLookupDefaultTheta"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers.SingleShardFullSoftmax": [[58, 2, 1, "", "DenseWeights"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Logits"], [58, 2, 1, "", "XentLossByChunk"], [58, 2, 1, "", "XentLossFromLogits"]], "lingvo.core.layers.SingleShardSharedEmbeddingSoftmax": [[58, 2, 1, "", "EmbLookup"], [58, 2, 1, "", "EmbLookupDefaultTheta"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.SinusoidalPositionalEmbeddingLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.SoftmaxLayer": [[58, 2, 1, "", "DenseWeights"], [58, 2, 1, "", "FProp"], [58, 2, 1, "", "Logits"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "XentLoss"], [58, 2, 1, "", "XentLossFromLogits"], [58, 2, 1, "", "_FProp2D"], [58, 3, 1, "", "wm_transposed"]], "lingvo.core.layers.StackingOverTime": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "Unstack"], [58, 2, 1, "", "WindowSize"], [58, 2, 1, "", "_ApplyStack"], [58, 3, 1, "", "window_size"]], "lingvo.core.layers.StatisticalPoolingLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.UniformLabelSmoother": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"]], "lingvo.core.layers.WeightedSumLayer": [[58, 2, 1, "", "FProp"], [58, 2, 1, "", "Params"], [58, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers_with_attention": [[59, 1, 1, "", "CCTAttentionLayer"], [59, 1, 1, "", "CCTFeedForwardLayer"], [59, 1, 1, "", "EvolvedTransformerBaseLayer"], [59, 1, 1, "", "EvolvedTransformerDecoderBranchedConvsLayer"], [59, 1, 1, "", "EvolvedTransformerDecoderLayer"], [59, 1, 1, "", "EvolvedTransformerEncoderBranchedConvsLayer"], [59, 1, 1, "", "EvolvedTransformerEncoderLayer"], [59, 1, 1, "", "HybridFeedforwardLayer"], [59, 1, 1, "", "MoEFeedforwardLayer"], [59, 1, 1, "", "ReshapedTransformerFeedForwardLayer"], [59, 1, 1, "", "SelfAttentiveLayer"], [59, 1, 1, "", "StochasticResidualLayer"], [59, 1, 1, "", "StyleLayer"], [59, 1, 1, "", "TransformerAttentionLayer"], [59, 1, 1, "", "TransformerFeedForwardLayer"], [59, 1, 1, "", "TransformerLayer"], [59, 1, 1, "", "TransformerLayerWithMultitaskAdapters"], [59, 1, 1, "", "TransformerMultiSourceAttentionLayer"], [59, 1, 1, "", "TransformerShardedMoeLayer"], [59, 1, 1, "", "TransformerWithContextLayer"]], "lingvo.core.layers_with_attention.CCTAttentionLayer": [[59, 2, 1, "", "ExtendStep"], [59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"], [59, 2, 1, "", "_FinishExtendStep"]], "lingvo.core.layers_with_attention.CCTFeedForwardLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.EvolvedTransformerBaseLayer": [[59, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.EvolvedTransformerDecoderBranchedConvsLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.EvolvedTransformerDecoderLayer": [[59, 2, 1, "", "ExtendStep"], [59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.EvolvedTransformerEncoderBranchedConvsLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.EvolvedTransformerEncoderLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.HybridFeedforwardLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"], [59, 3, 1, "", "sub_key"]], "lingvo.core.layers_with_attention.MoEFeedforwardLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.ReshapedTransformerFeedForwardLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.SelfAttentiveLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.StochasticResidualLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "FPropMeta"], [59, 2, 1, "", "Params"], [59, 2, 1, "", "_DropConnect"]], "lingvo.core.layers_with_attention.StyleLayer": [[59, 2, 1, "", "EmbLookup"], [59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"], [59, 2, 1, "", "StyleEmbFromProbs"], [59, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers_with_attention.TransformerAttentionLayer": [[59, 2, 1, "", "ExtendStep"], [59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"], [59, 2, 1, "", "_FinishExtendStep"], [59, 2, 1, "", "_GetSourceLength"], [59, 2, 1, "", "_InitAttention"]], "lingvo.core.layers_with_attention.TransformerFeedForwardLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "NumOutputNodes"], [59, 2, 1, "", "Params"], [59, 2, 1, "", "SetFPropDtype"], [59, 3, 1, "", "output_dim"]], "lingvo.core.layers_with_attention.TransformerLayer": [[59, 2, 1, "", "ExtendStep"], [59, 2, 1, "", "FProp"], [59, 2, 1, "", "NumOutputNodes"], [59, 2, 1, "", "Params"], [59, 3, 1, "", "output_dim"]], "lingvo.core.layers_with_attention.TransformerLayerWithMultitaskAdapters": [[59, 2, 1, "", "ExtendStep"], [59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_attention.TransformerMultiSourceAttentionLayer": [[59, 2, 1, "", "Params"], [59, 2, 1, "", "_GetSourceLength"], [59, 2, 1, "", "_InitAttention"]], "lingvo.core.layers_with_attention.TransformerShardedMoeLayer": [[59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"], [59, 2, 1, "", "SetFPropDtype"], [59, 3, 1, "", "output_dim"]], "lingvo.core.layers_with_attention.TransformerWithContextLayer": [[59, 2, 1, "", "ExtendStep"], [59, 2, 1, "", "FProp"], [59, 2, 1, "", "Params"]], "lingvo.core.layers_with_gpipe": [[60, 1, 1, "", "DeterministicWeightsLayer"], [60, 1, 1, "", "GPipeBatchMajorTransformerEmbeddingLayer"], [60, 1, 1, "", "GPipeBatchMajorTransformerSoftmaxLayer"], [60, 1, 1, "", "GPipeBatchMajorTransformerStack"], [60, 1, 1, "", "GPipeEvolvedTransformerDecoderLayer"], [60, 1, 1, "", "GPipeEvolvedTransformerEncoderLayer"], [60, 1, 1, "", "GPipeEvolvedTransformerStack"], [60, 1, 1, "", "GPipeTransformerEmbeddingLayer"], [60, 1, 1, "", "GPipeTransformerLayer"], [60, 1, 1, "", "GPipeTransformerSoftmaxLayer"], [60, 1, 1, "", "GPipeTransformerStack"], [60, 6, 1, "", "_common_gpipe_transformer_decoder_fprop"], [60, 6, 1, "", "_common_gpipe_transformer_encoder_fprop"], [60, 6, 1, "", "_common_gpipe_transformer_fprop_meta"], [60, 6, 1, "", "_common_gpipe_transformer_init"], [60, 6, 1, "", "_common_gpipe_transformer_params"]], "lingvo.core.layers_with_gpipe.DeterministicWeightsLayer": [[60, 2, 1, "", "FProp"], [60, 2, 1, "", "Params"], [60, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.layers_with_gpipe.GPipeBatchMajorTransformerEmbeddingLayer": [[60, 2, 1, "", "FProp"], [60, 2, 1, "", "FPropMeta"], [60, 2, 1, "", "GetDecoderEmbeddingsDefaultTheta"], [60, 2, 1, "", "GetEmbeddings"], [60, 2, 1, "", "GetEncoderEmbeddingsDefaultTheta"], [60, 2, 1, "", "Params"]], "lingvo.core.layers_with_gpipe.GPipeBatchMajorTransformerSoftmaxLayer": [[60, 2, 1, "", "FProp"], [60, 2, 1, "", "FPropMeta"], [60, 2, 1, "", "Params"]], "lingvo.core.layers_with_gpipe.GPipeBatchMajorTransformerStack": [[60, 2, 1, "", "DecoderEmbedFPropDefaultTheta"], [60, 2, 1, "", "EncoderEmbedFPropDefaultTheta"], [60, 2, 1, "", "EncoderFPropDefaultTheta"], [60, 2, 1, "", "FProp"], [60, 2, 1, "", "GetDecoders"], [60, 2, 1, "", "GetEncoders"], [60, 2, 1, "", "Logits"], [60, 2, 1, "", "Params"], [60, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.layers_with_gpipe.GPipeEvolvedTransformerDecoderLayer": [[60, 2, 1, "", "FProp"], [60, 2, 1, "", "FPropMeta"], [60, 2, 1, "", "Params"], [60, 2, 1, "", "SetupDeterministicDropout"], [60, 2, 1, "", "_AttentionSetupDeterministicDropout"], [60, 2, 1, "", "_TransformerSetupDeterministicDropout"]], "lingvo.core.layers_with_gpipe.GPipeEvolvedTransformerEncoderLayer": [[60, 2, 1, "", "FProp"], [60, 2, 1, "", "FPropMeta"], [60, 2, 1, "", "Params"], [60, 2, 1, "", "SetupDeterministicDropout"], [60, 2, 1, "", "_AttentionSetupDeterministicDropout"], [60, 2, 1, "", "_TransformerSetupDeterministicDropout"]], "lingvo.core.layers_with_gpipe.GPipeEvolvedTransformerStack": [[60, 2, 1, "", "Params"]], "lingvo.core.layers_with_gpipe.GPipeTransformerEmbeddingLayer": [[60, 2, 1, "", "FProp"], [60, 2, 1, "", "FPropMeta"], [60, 2, 1, "", "GetDecoderEmbeddingsDefaultTheta"], [60, 2, 1, "", "GetEmbeddings"], [60, 2, 1, "", "GetEncoderEmbeddingsDefaultTheta"], [60, 2, 1, "", "Params"]], "lingvo.core.layers_with_gpipe.GPipeTransformerLayer": [[60, 2, 1, "", "FProp"], [60, 2, 1, "", "FPropMeta"], [60, 2, 1, "", "Params"], [60, 2, 1, "", "SetupDeterministicDropout"]], "lingvo.core.layers_with_gpipe.GPipeTransformerSoftmaxLayer": [[60, 2, 1, "", "FProp"], [60, 2, 1, "", "FPropMeta"], [60, 2, 1, "", "Params"]], "lingvo.core.layers_with_gpipe.GPipeTransformerStack": [[60, 2, 1, "", "DecoderEmbedFPropDefaultTheta"], [60, 2, 1, "", "EncoderEmbedFPropDefaultTheta"], [60, 2, 1, "", "EncoderFPropDefaultTheta"], [60, 2, 1, "", "FProp"], [60, 2, 1, "", "GetDecoders"], [60, 2, 1, "", "GetEncoders"], [60, 2, 1, "", "Logits"], [60, 2, 1, "", "Params"], [60, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.learner": [[61, 6, 1, "", "ExtractLearnerFromLegacyParams"], [61, 1, 1, "", "Learner"]], "lingvo.core.learner.Learner": [[61, 2, 1, "", "AdjustGradients"], [61, 2, 1, "", "Apply"], [61, 2, 1, "", "ApplyPostTrainingLoop"], [61, 2, 1, "", "ComputeLosses"], [61, 2, 1, "", "GetTrainableVariables"], [61, 2, 1, "", "GetVarGrads"], [61, 2, 1, "", "LearningRate"], [61, 2, 1, "", "Params"], [61, 2, 1, "", "ScaleGradients"], [61, 2, 1, "", "_AddEvalMetric"], [61, 2, 1, "", "_ComputeLossesAndGradients"], [61, 2, 1, "", "_CustomComputeGradientsFn"], [61, 2, 1, "", "_GetGlobalGradScale"], [61, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.lstm_frnn_layer": [[62, 1, 1, "", "LSTMCellExt"], [62, 1, 1, "", "LSTMCellSimpleExt"], [62, 1, 1, "", "LayerNormalizedLSTMCellLeanExt"], [62, 1, 1, "", "LayerNormalizedLSTMCellSimpleExt"], [62, 1, 1, "", "LstmFRNN"]], "lingvo.core.lstm_frnn_layer.LSTMCellExt": [[62, 2, 1, "", "FPropWithProjectedInput"], [62, 2, 1, "", "ProjectInputSequence"], [62, 2, 1, "", "_MixWithProjectedInput"]], "lingvo.core.lstm_frnn_layer.LstmFRNN": [[62, 2, 1, "", "FProp"], [62, 2, 1, "", "Params"], [62, 2, 1, "", "zero_state"]], "lingvo.core.matrix_functions": [[63, 6, 1, "", "inlined_matrix_inverse_pth_root"], [63, 6, 1, "", "matrix_square_root"]], "lingvo.core.metrics": [[64, 1, 1, "", "AUCMetric"], [64, 1, 1, "", "AverageKeyedCorrelationMetric"], [64, 1, 1, "", "AverageMetric"], [64, 1, 1, "", "BaseMetric"], [64, 1, 1, "", "ConfigurableMetric"], [64, 1, 1, "", "CorpusBleuMetric"], [64, 1, 1, "", "CorrelationMetric"], [64, 6, 1, "", "CreateScalarSummary"], [64, 1, 1, "", "F1Metric"], [64, 1, 1, "", "MCCMetric"], [64, 1, 1, "", "MultiClassAUCMetric"], [64, 1, 1, "", "PrecisionAtRecall"], [64, 1, 1, "", "RecallAtPrecision"], [64, 1, 1, "", "SamplingMetric"], [64, 1, 1, "", "TpuEvalMetrics"], [64, 1, 1, "", "UniqueAverageMetric"]], "lingvo.core.metrics.AUCMetric": [[64, 2, 1, "", "Summary"], [64, 2, 1, "", "Update"], [64, 2, 1, "", "_PrecisionAtRecall"], [64, 2, 1, "", "_RecallAtPrecision"], [64, 3, 1, "", "value"]], "lingvo.core.metrics.AverageKeyedCorrelationMetric": [[64, 2, 1, "", "Update"], [64, 3, 1, "", "value"]], "lingvo.core.metrics.AverageMetric": [[64, 2, 1, "", "GetTotalValue"], [64, 2, 1, "", "GetTotalWeight"], [64, 2, 1, "", "SetTotalValue"], [64, 2, 1, "", "SetTotalWeight"], [64, 2, 1, "", "Update"], [64, 3, 1, "", "total_value"], [64, 3, 1, "", "total_weight"], [64, 3, 1, "", "value"]], "lingvo.core.metrics.BaseMetric": [[64, 2, 1, "", "Summary"], [64, 2, 1, "", "Update"], [64, 3, 1, "", "value"]], "lingvo.core.metrics.ConfigurableMetric": [[64, 2, 1, "", "Params"]], "lingvo.core.metrics.CorpusBleuMetric": [[64, 2, 1, "", "Update"], [64, 3, 1, "", "unsegmenter"], [64, 3, 1, "", "value"]], "lingvo.core.metrics.CorrelationMetric": [[64, 2, 1, "", "Update"], [64, 3, 1, "", "value"]], "lingvo.core.metrics.F1Metric": [[64, 2, 1, "", "UpdateFalseNegative"], [64, 2, 1, "", "UpdateFalsePositive"], [64, 2, 1, "", "UpdateTruePositive"], [64, 3, 1, "", "value"]], "lingvo.core.metrics.MCCMetric": [[64, 2, 1, "", "UpdateTrueNegative"], [64, 3, 1, "", "value"]], "lingvo.core.metrics.MultiClassAUCMetric": [[64, 2, 1, "", "Update"], [64, 3, 1, "", "value"]], "lingvo.core.metrics.PrecisionAtRecall": [[64, 3, 1, "", "value"]], "lingvo.core.metrics.RecallAtPrecision": [[64, 3, 1, "", "value"]], "lingvo.core.metrics.SamplingMetric": [[64, 2, 1, "", "Params"], [64, 2, 1, "", "Summary"], [64, 2, 1, "", "Update"], [64, 2, 1, "", "_CreateSummary"], [64, 3, 1, "", "samples"]], "lingvo.core.metrics.TpuEvalMetrics": [[64, 2, 1, "", "FinalizeMetrics"], [64, 2, 1, "", "PackMetricsValues"], [64, 2, 1, "", "SetMetrics"], [64, 2, 1, "", "ToAverageMetric"], [64, 2, 1, "", "ToAverageMetrics"], [64, 2, 1, "", "_Zip"], [64, 3, 1, "", "initial_values"], [64, 3, 1, "", "metrics"]], "lingvo.core.metrics.UniqueAverageMetric": [[64, 2, 1, "", "Summary"], [64, 2, 1, "", "Update"], [64, 3, 1, "", "value"]], "lingvo.core.ml_perf_bleu_metric": [[65, 1, 1, "", "MlPerfBleuMetric"], [65, 1, 1, "", "UnicodeRegex"], [65, 6, 1, "", "_get_ngrams"], [65, 6, 1, "", "bleu_score"], [65, 6, 1, "", "bleu_tokenize"], [65, 6, 1, "", "bleu_wrapper"], [65, 6, 1, "", "compute_bleu"], [65, 6, 1, "", "is_unicode"], [65, 6, 1, "", "native_to_unicode"], [65, 6, 1, "", "to_unicode"]], "lingvo.core.ml_perf_bleu_metric.MlPerfBleuMetric": [[65, 2, 1, "", "Update"], [65, 3, 1, "", "value"]], "lingvo.core.ml_perf_bleu_metric.UnicodeRegex": [[65, 2, 1, "", "property_chars"]], "lingvo.core.ml_perf_log": [[66, 6, 1, "", "get_caller"], [66, 6, 1, "", "mlperf_format"], [66, 6, 1, "", "mlperf_print"]], "lingvo.core.ml_perf_tokenizer": [[67, 1, 1, "", "MlPerfTokenizer"]], "lingvo.core.ml_perf_tokenizer.MlPerfTokenizer": [[67, 2, 1, "", "IdsToStrings"], [67, 2, 1, "", "Params"]], "lingvo.core.model_helper": [[68, 6, 1, "", "CreateBidirectionalRNNParams"], [68, 6, 1, "", "CreateUnidirectionalRNNParams"]], "lingvo.core.multitask_model": [[69, 1, 1, "", "RegExSharedVariableModel"], [69, 1, 1, "", "SharedEncoderDecoderModel"], [69, 1, 1, "", "SharedEncoderModel"]], "lingvo.core.multitask_model.RegExSharedVariableModel": [[69, 2, 1, "", "ConstructFPropBPropGraph"], [69, 2, 1, "", "Params"]], "lingvo.core.multitask_model.SharedEncoderDecoderModel": [[69, 2, 1, "", "Params"]], "lingvo.core.multitask_model.SharedEncoderModel": [[69, 2, 1, "", "Params"]], "lingvo.core.nested_map": [[70, 1, 1, "", "NestedMap"], [70, 6, 1, "", "_FromNestedDict"]], "lingvo.core.nested_map.NestedMap": [[70, 2, 1, "", "CheckKey"], [70, 2, 1, "", "DebugString"], [70, 2, 1, "", "DeepCopy"], [70, 2, 1, "", "Filter"], [70, 2, 1, "", "FilterKeyVal"], [70, 2, 1, "", "Flatten"], [70, 2, 1, "", "FlattenItems"], [70, 2, 1, "", "FromNestedDict"], [70, 2, 1, "", "Get"], [70, 2, 1, "", "GetItem"], [70, 2, 1, "", "IsCompatible"], [70, 2, 1, "", "Pack"], [70, 2, 1, "", "Set"], [70, 2, 1, "", "SquareBracketIndex"], [70, 2, 1, "", "ToNestedDict"], [70, 2, 1, "", "Transform"], [70, 2, 1, "", "TransformWithKey"], [70, 2, 1, "", "VLog"], [70, 5, 1, "", "_DELETE"], [70, 5, 1, "", "_HAS_DYNAMIC_ATTRIBUTES"], [70, 5, 1, "", "_RESERVED_KEYS"], [70, 2, 1, "", "_RecursiveMap"], [70, 2, 1, "", "_ToStrings"], [70, 2, 1, "", "copy"]], "lingvo.core.ops": [[71, 6, 1, "", "apply_packing"], [71, 6, 1, "", "ascii_to_token_id"], [71, 6, 1, "", "assert_same_dim0"], [71, 6, 1, "", "assert_shape_match"], [71, 6, 1, "", "beam_search_step"], [71, 6, 1, "", "beam_search_step_deprecated"], [71, 6, 1, "", "best_step"], [71, 6, 1, "", "bpe_ids_to_words"], [71, 6, 1, "", "bpe_words_to_ids"], [71, 6, 1, "", "cached_call"], [71, 6, 1, "", "compute_preconditioners"], [71, 6, 1, "", "get_preconditioners"], [71, 6, 1, "", "hyps_from_beam_search_outs"], [72, 0, 0, "-", "hyps_pb2"], [71, 6, 1, "", "id_to_ascii"], [71, 6, 1, "", "mass"], [71, 6, 1, "", "ml_perf_subword_id_to_string"], [71, 6, 1, "", "ngram_id_to_token"], [71, 6, 1, "", "pack_sequences"], [71, 6, 1, "", "pack_single_sequence"], [71, 6, 1, "", "random_permutation_sequence"], [73, 0, 0, "-", "record_pb2"], [71, 6, 1, "", "static_map_int_int"], [71, 6, 1, "", "static_map_int_string"], [71, 6, 1, "", "static_map_string_int"], [71, 6, 1, "", "str_to_vocab_tokens"], [71, 6, 1, "", "token_in_vocab"], [71, 6, 1, "", "top_k_from_beam_search_outs"], [71, 6, 1, "", "top_k_terminated_hyps"], [71, 6, 1, "", "unpack_hyp"], [74, 0, 0, "-", "versioned_file_set_pb2"], [71, 6, 1, "", "vocab_id_to_token"], [71, 6, 1, "", "vocab_token_to_id"]], "lingvo.core.ops.hyps_pb2": [[72, 1, 1, "", "Hypothesis"], [72, 6, 1, "", "_b"]], "lingvo.core.ops.hyps_pb2.Hypothesis": [[72, 1, 1, "", "AttenVec"], [72, 5, 1, "", "DESCRIPTOR"], [72, 5, 1, "", "atten_vecs"], [72, 5, 1, "", "beam_id"], [72, 5, 1, "", "ids"], [72, 5, 1, "", "normalized_score"], [72, 5, 1, "", "scores"]], "lingvo.core.ops.hyps_pb2.Hypothesis.AttenVec": [[72, 5, 1, "", "DESCRIPTOR"], [72, 5, 1, "", "prob"]], "lingvo.core.ops.record_pb2": [[73, 1, 1, "", "Record"], [73, 6, 1, "", "_b"]], "lingvo.core.ops.record_pb2.Record": [[73, 5, 1, "", "DESCRIPTOR"], [73, 1, 1, "", "FieldsEntry"], [73, 5, 1, "", "fields"]], "lingvo.core.ops.record_pb2.Record.FieldsEntry": [[73, 5, 1, "", "DESCRIPTOR"], [73, 5, 1, "", "key"], [73, 5, 1, "", "value"]], "lingvo.core.ops.versioned_file_set_pb2": [[74, 1, 1, "", "FileSet"], [74, 1, 1, "", "VersionedFileSet"], [74, 6, 1, "", "_b"]], "lingvo.core.ops.versioned_file_set_pb2.FileSet": [[74, 5, 1, "", "DESCRIPTOR"], [74, 5, 1, "", "create_timestamp"], [74, 5, 1, "", "file_pattern"]], "lingvo.core.ops.versioned_file_set_pb2.VersionedFileSet": [[74, 5, 1, "", "DESCRIPTOR"], [74, 5, 1, "", "current"], [74, 5, 1, "", "history"]], "lingvo.core.optimizer": [[76, 1, 1, "", "Accumulator"], [76, 1, 1, "", "AdaDelta"], [76, 1, 1, "", "AdaGraft"], [76, 1, 1, "", "Adagrad"], [76, 1, 1, "", "Adam"], [76, 1, 1, "", "AdamV2"], [76, 1, 1, "", "Base"], [76, 1, 1, "", "CompositeOptimizer"], [76, 1, 1, "", "DistributedShampoo"], [76, 1, 1, "", "DynamicAccumulator"], [76, 6, 1, "", "GetLrValue"], [76, 1, 1, "", "GradientAggregationOptimizer"], [76, 1, 1, "", "Momentum"], [76, 1, 1, "", "RMSProp"], [76, 1, 1, "", "SGD"], [76, 1, 1, "", "XLAShardingAdafactor"], [76, 1, 1, "", "XLAShardingAdafactorAccuGrad"], [76, 1, 1, "", "XLAShardingAdafactorOptimizer"], [76, 6, 1, "", "_AdafactorDecayRateAdam"], [76, 6, 1, "", "_AdafactorDecayRatePow"], [76, 6, 1, "", "_StepNum"]], "lingvo.core.optimizer.Accumulator": [[76, 2, 1, "", "AddSummary"], [76, 2, 1, "", "Apply"], [76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"]], "lingvo.core.optimizer.AdaDelta": [[76, 2, 1, "", "AddSummary"], [76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"]], "lingvo.core.optimizer.AdaGraft": [[76, 2, 1, "", "AddSummary"], [76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"]], "lingvo.core.optimizer.Adagrad": [[76, 2, 1, "", "AddSummary"], [76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"]], "lingvo.core.optimizer.Adam": [[76, 2, 1, "", "AddSummary"], [76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"], [76, 2, 1, "", "ParamsA"], [76, 2, 1, "", "ParamsB"]], "lingvo.core.optimizer.AdamV2": [[76, 2, 1, "", "AddSummary"], [76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"], [76, 2, 1, "", "ParamsA"], [76, 2, 1, "", "ParamsB"]], "lingvo.core.optimizer.Base": [[76, 2, 1, "", "AddSummary"], [76, 2, 1, "", "Apply"], [76, 2, 1, "", "ApplyPostTrainingLoop"], [76, 2, 1, "", "ComputeGradients"], [76, 2, 1, "", "GetLrScheduleValue"], [76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"], [76, 2, 1, "", "VarReuseForSlotVars"], [76, 2, 1, "", "_GetSelfVariablesDict"]], "lingvo.core.optimizer.CompositeOptimizer": [[76, 2, 1, "", "Apply"], [76, 2, 1, "", "ApplyPostTrainingLoop"], [76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"]], "lingvo.core.optimizer.DistributedShampoo": [[76, 2, 1, "", "AddSummary"], [76, 2, 1, "", "Apply"], [76, 2, 1, "", "ApplyPostTrainingLoop"], [76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"]], "lingvo.core.optimizer.DynamicAccumulator": [[76, 2, 1, "", "AddSummary"], [76, 2, 1, "", "Apply"], [76, 2, 1, "", "GetLrScheduleValue"], [76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"]], "lingvo.core.optimizer.GradientAggregationOptimizer": [[76, 2, 1, "", "_create_slots"], [76, 2, 1, "", "apply_gradients"], [76, 2, 1, "", "compute_gradients"], [76, 2, 1, "", "get_slot"], [76, 2, 1, "", "get_slot_names"], [76, 2, 1, "", "variables"]], "lingvo.core.optimizer.Momentum": [[76, 2, 1, "", "AddSummary"], [76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"]], "lingvo.core.optimizer.RMSProp": [[76, 2, 1, "", "AddSummary"], [76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"]], "lingvo.core.optimizer.SGD": [[76, 2, 1, "", "AddSummary"], [76, 2, 1, "", "GetOptimizer"]], "lingvo.core.optimizer.XLAShardingAdafactor": [[76, 2, 1, "", "AddSummary"], [76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"]], "lingvo.core.optimizer.XLAShardingAdafactorAccuGrad": [[76, 2, 1, "", "GetOptimizer"], [76, 2, 1, "", "Params"]], "lingvo.core.optimizer.XLAShardingAdafactorOptimizer": [[76, 2, 1, "", "_apply_dense"], [76, 2, 1, "", "_create_slots"], [76, 2, 1, "", "_factored_dims"], [76, 2, 1, "", "_parameter_scale"], [76, 2, 1, "", "_resource_apply_dense"], [76, 2, 1, "", "_resource_apply_sparse"], [76, 2, 1, "", "try_apply_dense"]], "lingvo.core.plot": [[77, 6, 1, "", "AddImage"], [77, 6, 1, "", "AddMultiCurveSubplot"], [77, 6, 1, "", "AddPlot"], [77, 6, 1, "", "AddScatterPlot"], [77, 6, 1, "", "Curve"], [77, 6, 1, "", "FigureToSummary"], [77, 6, 1, "", "Image"], [77, 1, 1, "", "MatplotlibFigureSummary"], [77, 6, 1, "", "Matrix"], [77, 6, 1, "", "Scatter"], [77, 6, 1, "", "ToUnicode"], [77, 6, 1, "", "_AddMultiCurveRowPlots"], [77, 6, 1, "", "_RenderMatplotlibFigures"], [77, 6, 1, "", "_RenderOneMatplotlibFigure"], [77, 1, 1, "", "_SubplotMetadata"]], "lingvo.core.plot.MatplotlibFigureSummary": [[77, 2, 1, "", "AddSubplot"], [77, 2, 1, "", "Finalize"], [77, 2, 1, "", "FinalizeImage"]], "lingvo.core.plot._SubplotMetadata": [[77, 2, 1, "", "_asdict"], [77, 5, 1, "", "_field_defaults"], [77, 5, 1, "", "_fields"], [77, 2, 1, "", "_make"], [77, 2, 1, "", "_replace"], [77, 5, 1, "", "plot_func"], [77, 5, 1, "", "tensor_list"]], "lingvo.core.predictor": [[78, 6, 1, "", "LoadInferenceGraph"], [78, 1, 1, "", "Predictor"], [78, 6, 1, "", "main"]], "lingvo.core.predictor.Predictor": [[78, 2, 1, "", "Load"], [78, 2, 1, "", "Run"], [78, 2, 1, "", "_LoadCheckpoint"], [78, 2, 1, "", "_create_new_session"], [78, 2, 1, "", "_get_subgraph"], [78, 2, 1, "", "_get_subgraph_feeds"], [78, 2, 1, "", "_get_subgraph_fetches"], [78, 2, 1, "", "_load_graph_from_inference_graph"], [78, 2, 1, "", "_maybe_create_new_session"], [78, 2, 1, "", "_run_with_valid_session"], [78, 3, 1, "", "feed_keys"], [78, 3, 1, "", "feed_shapes"], [78, 3, 1, "", "fetch_keys"], [78, 3, 1, "", "fetch_shapes"], [78, 2, 1, "", "subgraph_feed_keys"], [78, 2, 1, "", "subgraph_feed_shapes"], [78, 2, 1, "", "subgraph_fetch_keys"], [78, 2, 1, "", "subgraph_fetch_shapes"], [78, 3, 1, "", "subgraphs"]], "lingvo.core.predictor_runner_base": [[79, 1, 1, "", "PredictorRunnerBase"]], "lingvo.core.predictor_runner_base.PredictorRunnerBase": [[79, 2, 1, "", "FromFlags"], [79, 2, 1, "", "InputGenerator"], [79, 2, 1, "", "Run"], [79, 2, 1, "", "RunBatch"], [79, 2, 1, "", "_OutputFilename"], [79, 2, 1, "", "_PredictContinuously"], [79, 2, 1, "", "_PredictOneCheckpoint"], [79, 2, 1, "", "_ShouldProcessInputId"]], "lingvo.core.program": [[80, 1, 1, "", "BaseProgram"], [80, 1, 1, "", "DecodeProgram"], [80, 1, 1, "", "EvalProgram"], [80, 1, 1, "", "ExperimentalDecodeProgram"], [80, 1, 1, "", "InputBenchmark"], [80, 1, 1, "", "MLPerfProgramSchedule"], [80, 6, 1, "", "MLPerfProgramScheduleForTask"], [80, 1, 1, "", "MLPerfTrainDecodeProgram"], [80, 1, 1, "", "MultiInputsDecodeProgram"], [80, 1, 1, "", "MultiTaskProgramSchedule"], [80, 1, 1, "", "SimpleProgramSchedule"], [80, 6, 1, "", "SimpleProgramScheduleForTask"], [80, 1, 1, "", "TrainProgram"], [80, 6, 1, "", "UpdateProgramSchedule"], [80, 6, 1, "", "_CheckLengthOrExpand"], [80, 6, 1, "", "_ClearSpecifiedProgram"], [80, 6, 1, "", "_CreateProgramParams"], [80, 6, 1, "", "_FetchDecodeOut"], [80, 6, 1, "", "_InferStepsPerLoop"], [80, 6, 1, "", "_RewriteV1SummaryInTF2"], [80, 6, 1, "", "_UpdateCpuPassThroughData"]], "lingvo.core.program.BaseProgram": [[80, 2, 1, "", "BuildTpuSubgraph"], [80, 2, 1, "", "Compile"], [80, 2, 1, "", "GetModel"], [80, 2, 1, "", "InitInputs"], [80, 2, 1, "", "LoadProgramState"], [80, 2, 1, "", "Params"], [80, 2, 1, "", "Run"], [80, 2, 1, "", "SaveProgramState"], [80, 2, 1, "", "SetStatusMessage"], [80, 2, 1, "", "SetStatusMessageFn"], [80, 2, 1, "", "Shutdown"], [80, 2, 1, "", "_InfeedLoop"], [80, 2, 1, "", "_InfeedLoopForInput"], [80, 2, 1, "", "_InitializeVizier"], [80, 2, 1, "", "_InstantiateTaskModel"], [80, 2, 1, "", "_OutfeedEnqueue"], [80, 2, 1, "", "_ReportVizierMetrics"], [80, 2, 1, "", "_SetProgramDir"], [80, 2, 1, "", "_SummarizeValue"], [80, 2, 1, "", "_WriteInputDataStats"], [80, 2, 1, "", "_WriteSummaries"], [80, 3, 1, "", "_summary_writer"]], "lingvo.core.program.DecodeProgram": [[80, 2, 1, "", "BuildTpuSubgraph"], [80, 2, 1, "", "DecodeFunc"], [80, 2, 1, "", "FinalizeCallback"], [80, 2, 1, "", "InfeedTFFunc"], [80, 2, 1, "", "Params"], [80, 2, 1, "", "Run"], [80, 2, 1, "", "RunForInput"], [80, 2, 1, "", "Summary"], [80, 2, 1, "", "_DatasetSummaryWriter"], [80, 2, 1, "", "_DecodeStep"], [80, 2, 1, "", "_DecodeUntilOutOfRangeInfeedLoop"], [80, 2, 1, "", "_FinalizeDecode"], [80, 2, 1, "", "_PostProcessStep"], [80, 2, 1, "", "_RunPostProcess"], [80, 2, 1, "", "_WriteInputDataStats"], [80, 2, 1, "", "_WriteSummaries"]], "lingvo.core.program.EvalProgram": [[80, 2, 1, "", "BuildTpuSubgraph"], [80, 2, 1, "", "EvalFunc"], [80, 2, 1, "", "InfeedTFFunc"], [80, 2, 1, "", "Run"], [80, 2, 1, "", "TpuEvalStep"]], "lingvo.core.program.ExperimentalDecodeProgram": [[80, 2, 1, "", "BuildTpuSubgraph"], [80, 2, 1, "", "DecodeFunc"], [80, 2, 1, "", "FinalizeCallback"], [80, 2, 1, "", "Params"], [80, 2, 1, "", "Run"], [80, 2, 1, "", "Summary"], [80, 2, 1, "", "WaitThread"], [80, 2, 1, "", "_DecodeLoop"], [80, 2, 1, "", "_OutfeedDequeue"], [80, 2, 1, "", "_PostProcess"], [80, 2, 1, "", "_ThreadCall"]], "lingvo.core.program.InputBenchmark": [[80, 2, 1, "", "BuildTpuSubgraph"], [80, 2, 1, "", "Params"], [80, 2, 1, "", "Run"]], "lingvo.core.program.MLPerfProgramSchedule": [[80, 2, 1, "", "Params"], [80, 2, 1, "", "Programs"], [80, 2, 1, "", "Run"], [80, 2, 1, "", "Shutdown"]], "lingvo.core.program.MLPerfTrainDecodeProgram": [[80, 2, 1, "", "BuildTpuSubgraph"], [80, 2, 1, "", "Params"], [80, 2, 1, "", "Run"], [80, 2, 1, "", "_InfeedLoop"], [80, 2, 1, "", "_InitializeVizier"], [80, 2, 1, "", "_TrainAndDecode"]], "lingvo.core.program.MultiInputsDecodeProgram": [[80, 2, 1, "", "BuildTpuSubgraph"], [80, 2, 1, "", "FinalizeCallback"], [80, 2, 1, "", "InitInputs"], [80, 2, 1, "", "Params"], [80, 2, 1, "", "Run"], [80, 2, 1, "", "_DatasetSummaryWriter"], [80, 2, 1, "", "_SetProgramDir"]], "lingvo.core.program.MultiTaskProgramSchedule": [[80, 2, 1, "", "Params"]], "lingvo.core.program.SimpleProgramSchedule": [[80, 2, 1, "", "Params"], [80, 2, 1, "", "Programs"], [80, 2, 1, "", "Run"], [80, 2, 1, "", "Shutdown"]], "lingvo.core.program.TrainProgram": [[80, 2, 1, "", "BuildTpuSubgraph"], [80, 2, 1, "", "InfeedTFFunc"], [80, 2, 1, "", "Params"], [80, 2, 1, "", "Run"], [80, 2, 1, "", "TpuTrainStep"], [80, 2, 1, "", "_OutfeedDequeueLoop"], [80, 2, 1, "", "_ShouldStop"], [80, 2, 1, "", "_ShouldWriteSummary"]], "lingvo.core.program_utils": [[81, 6, 1, "", "CsvToSummary"], [81, 1, 1, "", "DecodeStatusCache"], [81, 6, 1, "", "SummaryToCsv"], [81, 1, 1, "", "TriggerScheduler"]], "lingvo.core.program_utils.DecodeStatusCache": [[81, 2, 1, "", "TryLoadCache"], [81, 2, 1, "", "UpdateCkpt"], [81, 2, 1, "", "UpdateDataset"]], "lingvo.core.program_utils.TriggerScheduler": [[81, 2, 1, "", "ShouldRun"], [81, 2, 1, "", "Trigger"]], "lingvo.core.pruning_utils": [[82, 6, 1, "", "AddToPruningCollections"], [82, 6, 1, "", "ApplyCompression"], [82, 6, 1, "", "FlatEmbeddingLookup"], [82, 1, 1, "", "PruningOp"], [82, 6, 1, "", "UsePruningInterface"], [82, 6, 1, "", "_IsInCollection"]], "lingvo.core.pruning_utils.PruningOp": [[82, 2, 1, "", "ApplyPruning"], [82, 2, 1, "", "ApplyPythonUpdate"], [82, 2, 1, "", "ApplyTensorflowAndPythonUpdate"], [82, 2, 1, "", "ApplyTensorflowUpdate"], [82, 2, 1, "", "GetEmbeddingLookupResult"], [82, 2, 1, "", "GetLastCompressionOp"], [82, 2, 1, "", "GetMixResult"], [82, 2, 1, "", "GetPruningUpdate"], [82, 2, 1, "", "RunPythonUpdate"], [82, 2, 1, "", "Setup"], [82, 5, 1, "", "_global_step"], [82, 5, 1, "", "_pruning_hparams"], [82, 5, 1, "", "_pruning_hparams_dict"], [82, 5, 1, "", "_pruning_obj"]], "lingvo.core.py_utils": [[83, 6, 1, "", "AddDebugTensor"], [83, 6, 1, "", "AddSavedModelAssets"], [83, 6, 1, "", "AddTpuSummaryTensor"], [83, 6, 1, "", "AddVN"], [83, 6, 1, "", "AdjustGradientsWithLpLoss"], [83, 6, 1, "", "AppendDims"], [83, 6, 1, "", "ApplyGradMultiplier"], [83, 6, 1, "", "ApplyGradNormClipping"], [83, 6, 1, "", "ApplyPadding"], [83, 6, 1, "", "ArgMax"], [83, 6, 1, "", "Assert"], [83, 6, 1, "", "AssertIdShape"], [83, 6, 1, "", "AssertIsCompatible"], [83, 1, 1, "", "AuxLossContext"], [83, 6, 1, "", "BlockDiagonalMatmul"], [83, 6, 1, "", "BlockDiagonalProjectLastDim"], [83, 6, 1, "", "CallDefun"], [83, 6, 1, "", "CausalSelfAttenPadding"], [83, 6, 1, "", "CheckNumerics"], [83, 6, 1, "", "CheckShapes"], [83, 6, 1, "", "ClearTpuDevice"], [83, 6, 1, "", "ClearTpuSummaryTensors"], [83, 6, 1, "", "CombineMetrics"], [83, 6, 1, "", "ComputationShape"], [83, 6, 1, "", "ComputeGradients"], [83, 6, 1, "", "ComputeGradientsSimple"], [83, 6, 1, "", "ComputeNceAndAuc"], [83, 6, 1, "", "ConcatPerExampleTensors"], [83, 6, 1, "", "ConcatRecursively"], [83, 6, 1, "", "ConcatenatePaddedSequences"], [83, 6, 1, "", "ConvertNoneGradientToZeros"], [83, 6, 1, "", "CreateEMAForModel"], [83, 6, 1, "", "CreateIdsAndLabels"], [83, 6, 1, "", "CreateLocalTheta"], [83, 6, 1, "", "CreateVariable"], [83, 6, 1, "", "CumSum"], [83, 6, 1, "", "Debug"], [83, 6, 1, "", "DecodeProtoField"], [83, 6, 1, "", "DecodeRepeatedProtoField"], [83, 6, 1, "", "DefaultParamInit"], [83, 6, 1, "", "DefaultRNNCellStateInit"], [83, 6, 1, "", "DefaultVN"], [83, 1, 1, "", "DefinedFunction"], [83, 6, 1, "", "DeterministicDropout"], [83, 6, 1, "", "DeterministicVN"], [83, 6, 1, "", "DisableVN"], [83, 6, 1, "", "DisableVariableNameChecking"], [83, 6, 1, "", "DivideNoNan"], [83, 6, 1, "", "Dtypes"], [83, 6, 1, "", "ExpandAndPadOrTrimTo"], [83, 6, 1, "", "ExpandTo"], [83, 6, 1, "", "FPropDtype"], [83, 6, 1, "", "FindDataType"], [83, 6, 1, "", "FindNeeded"], [83, 6, 1, "", "FindRelevantBatchNormUpdates"], [83, 6, 1, "", "Flatten"], [83, 6, 1, "", "ForLoop"], [83, 1, 1, "", "Function"], [83, 6, 1, "", "GatherTensorValuesBySeqIndices"], [83, 6, 1, "", "GenerateSeedFromId"], [83, 6, 1, "", "GenerateSeedFromName"], [83, 6, 1, "", "GenerateStepSeedPair"], [83, 6, 1, "", "GetExtraArgs"], [83, 6, 1, "", "GetExtraInputs"], [83, 6, 1, "", "GetExtraVars"], [83, 6, 1, "", "GetFanInFanOut"], [83, 6, 1, "", "GetGlobalStep"], [83, 6, 1, "", "GetGlobalVariableScope"], [83, 6, 1, "", "GetIncStepSeed"], [83, 6, 1, "", "GetLingvoVariableCreator"], [83, 6, 1, "", "GetOpportunisticVariableReuse"], [83, 6, 1, "", "GetOrCreateGlobalStepVar"], [83, 6, 1, "", "GetProcessedCheckpoints"], [83, 6, 1, "", "GetRank"], [83, 6, 1, "", "GetSavedModelAssets"], [83, 6, 1, "", "GetShape"], [83, 6, 1, "", "GetSize"], [83, 6, 1, "", "GetSoftmaxProbsBySeqIndices"], [83, 6, 1, "", "GetStepSeed"], [83, 6, 1, "", "GetTaskCallScope"], [83, 6, 1, "", "GetTpuDeviceAssignment"], [83, 6, 1, "", "GetTpuEmbeddingGraphCollection"], [83, 6, 1, "", "GetTpuSummaryTensors"], [83, 6, 1, "", "GetTrainableVariables"], [83, 6, 1, "", "GetUnitTestSession"], [83, 6, 1, "", "GetVarLeadingDimsAsCombinedLayers"], [83, 6, 1, "", "GetVariableName"], [83, 6, 1, "", "GetVariableNumLeadingDimsForCombinedLayersContext"], [83, 6, 1, "", "GetVariableShapePrefixes"], [83, 6, 1, "", "GlobalStepContext"], [83, 6, 1, "", "GradientTape"], [83, 6, 1, "", "HasAtLeastRank"], [83, 6, 1, "", "HasNanOrInf"], [83, 6, 1, "", "HasNanOrInfGradient"], [83, 6, 1, "", "HasRank"], [83, 6, 1, "", "HasSameShape"], [83, 6, 1, "", "HasShape"], [83, 6, 1, "", "If"], [83, 6, 1, "", "InitRNNCellState"], [83, 6, 1, "", "IsCompatible"], [83, 6, 1, "", "IsDefaultParamInit"], [83, 6, 1, "", "IsEagerMode"], [83, 6, 1, "", "LengthsFromPaddings"], [83, 6, 1, "", "Log"], [83, 6, 1, "", "LogMultiLines"], [83, 6, 1, "", "MaskGradients"], [83, 6, 1, "", "Matmul"], [83, 6, 1, "", "MaybeGenerateSeedFromScope"], [83, 6, 1, "", "MaybeOpportunisticVariableReuse"], [83, 6, 1, "", "MaybePinVarsToCpu"], [83, 6, 1, "", "MaybeResetStepSeed"], [83, 6, 1, "", "MaybeResetStepSeedFromScope"], [83, 6, 1, "", "MaybeReuseFromVariableStore"], [83, 6, 1, "", "MaybeSoftCapLogits"], [83, 6, 1, "", "MergeDictsWithValueCheck"], [83, 6, 1, "", "MergeDuplicateIds"], [83, 6, 1, "", "MixByWeight"], [83, 6, 1, "", "NameScopeDecorator"], [83, 6, 1, "", "OpportunisticVariableReuseScope"], [83, 6, 1, "", "OverrideVarsFromCheckpoint"], [83, 6, 1, "", "OverrideVarsFromCheckpoints"], [83, 6, 1, "", "Pack"], [83, 6, 1, "", "PadOrTrimTo"], [83, 6, 1, "", "PadSequenceDimension"], [83, 6, 1, "", "PadSequenceTo"], [83, 6, 1, "", "PaddingsFromLengths"], [83, 6, 1, "", "PiecewiseConstant"], [83, 6, 1, "", "PlaceOnTpuCore"], [83, 6, 1, "", "ProjectLastDim"], [83, 1, 1, "", "RNNCellStateInit"], [83, 6, 1, "", "ReadFileLines"], [83, 6, 1, "", "ReadOnlyAttrDictView"], [83, 6, 1, "", "ReadVariable"], [83, 6, 1, "", "RecordFormatFromFilePattern"], [83, 6, 1, "", "ReduceRms"], [83, 6, 1, "", "RematerializeFn"], [83, 6, 1, "", "RemoveAssertContext"], [83, 6, 1, "", "RepeatDim"], [83, 6, 1, "", "ResetStepSeed"], [83, 6, 1, "", "Retry"], [83, 6, 1, "", "RetryOnTransientTfError"], [83, 6, 1, "", "ReversePaddedSequence"], [83, 6, 1, "", "RunOnTpuHost"], [83, 6, 1, "", "SampleStep"], [83, 6, 1, "", "SanitizeScopeKey"], [83, 6, 1, "", "Save"], [83, 6, 1, "", "SequencePaddings"], [83, 6, 1, "", "SequencesToDebugStrings"], [83, 6, 1, "", "SessionConfig"], [83, 6, 1, "", "SetEagerMode"], [83, 6, 1, "", "SetEagerRngAdaptation"], [83, 6, 1, "", "SetShapes"], [83, 6, 1, "", "SetTpuDeviceAssignment"], [83, 6, 1, "", "ShardedFilePatternToGlob"], [83, 6, 1, "", "ShiftLeft"], [83, 6, 1, "", "SigmoidCrossEntropyFocalLoss"], [83, 6, 1, "", "SkipNoneGradients"], [83, 6, 1, "", "Softmax"], [83, 6, 1, "", "SoftmaxCrossEntropyFocalLoss"], [83, 6, 1, "", "SplitRecursively"], [83, 6, 1, "", "StackTensorsRecursively"], [83, 6, 1, "", "StatefulRandomOpsInDefun"], [83, 6, 1, "", "StepSeedIncrementContext"], [83, 6, 1, "", "SumAbs"], [83, 6, 1, "", "SumSquared"], [83, 6, 1, "", "TaskCallScope"], [83, 6, 1, "", "TaskCallScopeName"], [83, 6, 1, "", "TensorSpecs"], [83, 6, 1, "", "TfFunctionScope"], [83, 6, 1, "", "ToPlaceholders"], [83, 6, 1, "", "ToStaticShape"], [83, 6, 1, "", "ToUniqueList"], [83, 6, 1, "", "TopK"], [83, 6, 1, "", "TpuSummaryTensorContext"], [83, 6, 1, "", "Transform"], [83, 6, 1, "", "TrimTrailingPaddings"], [83, 1, 1, "", "UniformSampler"], [83, 6, 1, "", "UnitTestSessionScope"], [83, 6, 1, "", "UpdateBatchNormVars"], [83, 6, 1, "", "UpdateDtype"], [83, 6, 1, "", "UpdateFpropDtype"], [83, 6, 1, "", "UpdateProcessedCheckpoints"], [83, 1, 1, "", "VarGrad"], [83, 6, 1, "", "VariableCreatorScope"], [83, 6, 1, "", "VariableListDtypeRegexScope"], [83, 6, 1, "", "VariableRenameScope"], [83, 6, 1, "", "VariableShapePrefixContext"], [83, 6, 1, "", "VariableStore"], [83, 6, 1, "", "VariationalNoiseParams"], [83, 6, 1, "", "WarnOnGlobalStepAccess"], [83, 1, 1, "", "WeightInit"], [83, 6, 1, "", "WeightParams"], [83, 6, 1, "", "WeightedAvg"], [83, 6, 1, "", "WeightedAvgOfMetrics"], [83, 6, 1, "", "WhileLoop"], [83, 6, 1, "", "Zeros"], [83, 6, 1, "", "_ApplySharedRendezvous"], [83, 6, 1, "", "_AssertInputsMatch"], [83, 6, 1, "", "_CheckNumerics"], [83, 1, 1, "", "_CollectionGetter"], [83, 6, 1, "", "_ComputeGradientsTpu"], [83, 6, 1, "", "_CreateVarInitStateful"], [83, 6, 1, "", "_CreateVarInitStateless"], [83, 6, 1, "", "_CreateVariableStateful"], [83, 6, 1, "", "_CreateVariableStateless"], [83, 6, 1, "", "_DefaultVariableCreator"], [83, 6, 1, "", "_DefineDefun"], [83, 6, 1, "", "_DefineFunction"], [83, 6, 1, "", "_DeterministicRandomNormalInitializer"], [83, 6, 1, "", "_DeterministicRandomTruncatedNormalInitializer"], [83, 6, 1, "", "_DeterministicRandomUniformInitializer"], [83, 6, 1, "", "_DeterministicRandomUniformUnitScalingInitializer"], [83, 6, 1, "", "_DeterministicRandomVarianceScalingInitializer"], [83, 6, 1, "", "_DeterministicRandomXavierUniformInitializer"], [83, 6, 1, "", "_EnsureMatrixShape"], [83, 6, 1, "", "_GenerateStatelessRngSeed"], [83, 6, 1, "", "_GetSampleStep"], [83, 6, 1, "", "_GetSharedRendezvous"], [83, 6, 1, "", "_GetTpuSummaryTensor"], [83, 6, 1, "", "_GetVariableCreator"], [83, 6, 1, "", "_GetVariableStore"], [83, 6, 1, "", "_GetVarsToLoad"], [83, 6, 1, "", "_Itype"], [83, 6, 1, "", "_LogPlacement"], [83, 6, 1, "", "_MaybeWarnAboutPotentiallyIncorrectEvaluations"], [83, 6, 1, "", "_Print"], [83, 6, 1, "", "_PrintOptions"], [83, 6, 1, "", "_RandomXavierUniformInitializer"], [83, 6, 1, "", "_Save"], [83, 6, 1, "", "_SharedRendezvousScope"], [83, 6, 1, "", "_TransformAndSum"], [83, 1, 1, "", "_Unique"], [83, 6, 1, "", "_UseTfFunction"], [83, 1, 1, "", "_VarGrad"], [83, 6, 1, "", "_VarInCollection"], [83, 6, 1, "", "_WrapFunction"], [83, 6, 1, "", "assert_between"], [83, 6, 1, "", "assert_equal"], [83, 6, 1, "", "assert_even_divide"], [83, 6, 1, "", "assert_greater"], [83, 6, 1, "", "assert_greater_equal"], [83, 6, 1, "", "assert_less"], [83, 6, 1, "", "assert_less_equal"], [83, 6, 1, "", "assert_same_dim0"], [83, 6, 1, "", "assert_shape_match"], [83, 6, 1, "", "clip_by_value"], [83, 6, 1, "", "outside_all_rewrites"], [83, 6, 1, "", "tpu_host"], [83, 6, 1, "", "with_dependencies"]], "lingvo.core.py_utils.AuxLossContext": [[83, 2, 1, "", "AddLoss"], [83, 2, 1, "", "Current"], [83, 5, 1, "", "_global_stack"], [83, 3, 1, "", "aux_losses"]], "lingvo.core.py_utils.DefinedFunction": [[83, 2, 1, "", "AddFrameworkInputs"], [83, 3, 1, "", "captured_inputs"], [83, 3, 1, "", "func"], [83, 3, 1, "", "output_dtypes"], [83, 3, 1, "", "stateful_ops"]], "lingvo.core.py_utils.RNNCellStateInit": [[83, 2, 1, "", "RandomNormal"], [83, 2, 1, "", "Zeros"], [83, 2, 1, "", "_Params"]], "lingvo.core.py_utils.UniformSampler": [[83, 2, 1, "", "Add"], [83, 3, 1, "", "samples"]], "lingvo.core.py_utils.WeightInit": [[83, 2, 1, "", "Category"], [83, 2, 1, "", "Constant"], [83, 2, 1, "", "CustomConstantVarInit"], [83, 2, 1, "", "CustomVarInit"], [83, 2, 1, "", "Gaussian"], [83, 2, 1, "", "GaussianSqrtDim"], [83, 2, 1, "", "GaussianSqrtFanAvg"], [83, 2, 1, "", "GaussianSqrtFanIn"], [83, 2, 1, "", "GaussianSqrtFanOut"], [83, 2, 1, "", "GeoMeanXavier"], [83, 2, 1, "", "KaimingUniformFanInLeakyRelu"], [83, 2, 1, "", "KaimingUniformFanInRelu"], [83, 2, 1, "", "ScaledDeltaOrthogonal"], [83, 2, 1, "", "TruncatedGaussian"], [83, 2, 1, "", "TruncatedGaussianSqrtDim"], [83, 2, 1, "", "TruncatedGaussianSqrtFanIn"], [83, 2, 1, "", "TruncatedGaussianSqrtFanOut"], [83, 2, 1, "", "Uniform"], [83, 2, 1, "", "UniformPositive"], [83, 2, 1, "", "UniformSqrtDim"], [83, 2, 1, "", "UniformUnitScaling"], [83, 2, 1, "", "UniformUnitScalingFanAvg"], [83, 2, 1, "", "Xavier"], [83, 2, 1, "", "XavierWithFixupParams"], [83, 2, 1, "", "_Params"]], "lingvo.core.py_utils._VarGrad": [[83, 2, 1, "", "_asdict"], [83, 5, 1, "", "_field_defaults"], [83, 5, 1, "", "_fields"], [83, 2, 1, "", "_make"], [83, 2, 1, "", "_replace"], [83, 5, 1, "", "grad"], [83, 5, 1, "", "scale"], [83, 5, 1, "", "var"]], "lingvo.core.py_utils_flags": [[84, 6, 1, "", "_FromGlobal"], [84, 6, 1, "", "enable_asserts"], [84, 6, 1, "", "enable_check_numerics"], [84, 6, 1, "", "testonly_skip_norm_layers"], [84, 6, 1, "", "tpu_compat"], [84, 6, 1, "", "use_stateless_vars_init"], [84, 6, 1, "", "use_tpu"], [84, 6, 1, "", "use_xla"]], "lingvo.core.quant_test_lib": [[85, 1, 1, "", "QuantUtilsBaseTest"], [85, 1, 1, "", "SampleQuantizedProjectionLayer"]], "lingvo.core.quant_test_lib.QuantUtilsBaseTest": [[85, 5, 1, "", "NO_QDOMAIN_EXPECTED"], [85, 5, 1, "", "NO_QDOMAIN_EXPECTED_EAGER"], [85, 2, 1, "", "_testLayerHelper"]], "lingvo.core.quant_test_lib.SampleQuantizedProjectionLayer": [[85, 2, 1, "", "FProp"], [85, 2, 1, "", "Params"], [85, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.quant_utils": [[86, 1, 1, "", "BaseClippingCapSchedule"], [86, 1, 1, "", "FakeQDomain"], [86, 1, 1, "", "FakeQuantizationSchedule"], [86, 1, 1, "", "IdentityClippingCapSchedule"], [86, 1, 1, "", "LinearClippingCapSchedule"], [86, 1, 1, "", "PassiveAsymQDomain"], [86, 1, 1, "", "QDistribution"], [86, 1, 1, "", "QDomain"], [86, 1, 1, "", "QuantizableLayer"], [86, 1, 1, "", "SymmetricScheduledClipQDomain"], [86, 6, 1, "", "_CopyShape"], [86, 1, 1, "", "_CountedMinMaxAccumulator"]], "lingvo.core.quant_utils.BaseClippingCapSchedule": [[86, 2, 1, "", "ApplyClipping"], [86, 2, 1, "", "ApplyClippingWithState"], [86, 2, 1, "", "ApplyConstantClip"], [86, 2, 1, "", "GetEndRange"], [86, 2, 1, "", "GetQuantizedEndRange"], [86, 2, 1, "", "GetState"], [86, 3, 1, "", "is_quantized"]], "lingvo.core.quant_utils.FakeQDomain": [[86, 2, 1, "", "Params"], [86, 2, 1, "", "QRAct"], [86, 2, 1, "", "_MaybeNarrowToAsymBitDepth"]], "lingvo.core.quant_utils.FakeQuantizationSchedule": [[86, 2, 1, "", "ApplyClippingWithState"], [86, 2, 1, "", "ApplyConstantClip"], [86, 2, 1, "", "GetEndRange"], [86, 2, 1, "", "GetQuantizedEndRange"], [86, 2, 1, "", "GetState"], [86, 2, 1, "", "Params"], [86, 2, 1, "", "_GetCurrentMinMax"], [86, 2, 1, "", "_GetQuantizedRangeForCap"], [86, 3, 1, "", "bits"], [86, 3, 1, "", "is_quantized"]], "lingvo.core.quant_utils.IdentityClippingCapSchedule": [[86, 2, 1, "", "ApplyClippingWithState"], [86, 2, 1, "", "ApplyConstantClip"], [86, 2, 1, "", "GetEndRange"], [86, 2, 1, "", "GetState"]], "lingvo.core.quant_utils.LinearClippingCapSchedule": [[86, 2, 1, "", "ApplyClippingWithState"], [86, 2, 1, "", "ApplyConstantClip"], [86, 2, 1, "", "GetEndRange"], [86, 2, 1, "", "GetState"], [86, 2, 1, "", "Params"], [86, 2, 1, "", "_Value"], [86, 3, 1, "", "is_quantized"]], "lingvo.core.quant_utils.PassiveAsymQDomain": [[86, 2, 1, "", "Params"], [86, 2, 1, "", "PostTrainingStepUpdate"], [86, 2, 1, "", "QuantizeAct"], [86, 2, 1, "", "QuantizeConstantRange"], [86, 2, 1, "", "QuantizeNaturalRange"], [86, 2, 1, "", "QuantizeWeight"], [86, 2, 1, "", "TrackQActs"], [86, 2, 1, "", "_CreateLayerVariables"], [86, 2, 1, "", "_CreateQStateVar"], [86, 2, 1, "", "_GetAccumulatorNameForTensor"], [86, 2, 1, "", "_GetQStateVar"], [86, 2, 1, "", "_GetQStateVarName"], [86, 2, 1, "", "_MaybeFakeQuant"], [86, 2, 1, "", "_RecordTensor"], [86, 2, 1, "", "_SummarizeTensor"], [86, 3, 1, "", "bits"]], "lingvo.core.quant_utils.QDistribution": [[86, 2, 1, "", "IsPositive"], [86, 5, 1, "", "LOG_SOFTMAX"], [86, 5, 1, "", "PADDING"], [86, 5, 1, "", "POSITIVE"], [86, 5, 1, "", "RANDOM_UNIFORM"], [86, 5, 1, "", "RELU"], [86, 5, 1, "", "RELU6"], [86, 5, 1, "", "SIGMOID"], [86, 5, 1, "", "SOFTMAX"], [86, 5, 1, "", "SYMMETRIC"], [86, 5, 1, "", "TANH"], [86, 2, 1, "", "_generate_next_value_"], [86, 5, 1, "", "_member_map_"], [86, 5, 1, "", "_member_names_"], [86, 5, 1, "", "_member_type_"], [86, 5, 1, "", "_value2member_map_"]], "lingvo.core.quant_utils.QDomain": [[86, 2, 1, "", "FromAqtActActMatmul"], [86, 2, 1, "", "FromAqtConv"], [86, 2, 1, "", "FromAqtMatmul"], [86, 2, 1, "", "FromAqtWeight"], [86, 2, 1, "", "QConv1D"], [86, 2, 1, "", "QConv2D"], [86, 2, 1, "", "QEinsum"], [86, 2, 1, "", "QMatmul"], [86, 2, 1, "", "QRAct"], [86, 2, 1, "", "QuantizeAct"], [86, 2, 1, "", "QuantizeConstantRange"], [86, 2, 1, "", "QuantizeNaturalRange"], [86, 2, 1, "", "QuantizeWeight"], [86, 2, 1, "", "ToAqtActActInputs"], [86, 2, 1, "", "ToAqtConv"], [86, 2, 1, "", "ToAqtInputs"], [86, 2, 1, "", "ToAqtWeight"], [86, 2, 1, "", "TrackQActs"], [86, 2, 1, "", "TrackQWeight"], [86, 3, 1, "", "bits"]], "lingvo.core.quant_utils.QuantizableLayer": [[86, 2, 1, "", "FromAqtActActMatmul"], [86, 2, 1, "", "FromAqtConv"], [86, 2, 1, "", "FromAqtMatmul"], [86, 2, 1, "", "FromAqtWeight"], [86, 2, 1, "", "GetQDomainParams"], [86, 2, 1, "", "Params"], [86, 2, 1, "", "QAct"], [86, 2, 1, "", "QConv1D"], [86, 2, 1, "", "QConv2D"], [86, 2, 1, "", "QEinsum"], [86, 2, 1, "", "QMatmul"], [86, 2, 1, "", "QRAct"], [86, 2, 1, "", "QWeight"], [86, 2, 1, "", "ToAqtActActInputs"], [86, 2, 1, "", "ToAqtConv"], [86, 2, 1, "", "ToAqtInputs"], [86, 2, 1, "", "ToAqtWeight"], [86, 2, 1, "", "TrackQActs"], [86, 2, 1, "", "TrackQWeight"], [86, 2, 1, "", "_AddQuantizationFunctions"], [86, 2, 1, "", "_GetQDomain"], [86, 2, 1, "", "_ValidateArgName"], [86, 2, 1, "", "_ValidateWeight"], [86, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.quant_utils.SymmetricScheduledClipQDomain": [[86, 2, 1, "", "Params"], [86, 2, 1, "", "QuantizeAct"], [86, 2, 1, "", "QuantizeConstantRange"], [86, 2, 1, "", "QuantizeNaturalRange"], [86, 2, 1, "", "QuantizeWeight"], [86, 3, 1, "", "bits"]], "lingvo.core.quant_utils._CountedMinMaxAccumulator": [[86, 2, 1, "", "DefaultValue"], [86, 2, 1, "", "Update"]], "lingvo.core.recurrent": [[87, 1, 1, "", "DevicePair"], [87, 6, 1, "", "FlattenPadding"], [87, 6, 1, "", "Recurrent"], [87, 6, 1, "", "StackedRecurrent"], [87, 6, 1, "", "_Add"], [87, 6, 1, "", "_AssertSameTensors"], [87, 6, 1, "", "_AugmentState"], [87, 6, 1, "", "_CreateLinks"], [87, 6, 1, "", "_DecorateCellFn"], [87, 6, 1, "", "_DecorateCellGrad"], [87, 6, 1, "", "_DependsOn"], [87, 6, 1, "", "_EmptyAcc"], [87, 6, 1, "", "_EmptyLike"], [87, 6, 1, "", "_EmptyWithFixShape"], [87, 6, 1, "", "_GetCellGrad"], [87, 6, 1, "", "_Index"], [87, 1, 1, "", "_Input"], [87, 6, 1, "", "_IsSingleTimeStep"], [87, 6, 1, "", "_Join"], [87, 1, 1, "", "_Link"], [87, 1, 1, "", "_Middle"], [87, 1, 1, "", "_Output"], [87, 1, 1, "", "_Recurrent"], [87, 6, 1, "", "_RecurrentSingleTimeStep"], [87, 6, 1, "", "_ReflectOnCellFn"], [87, 6, 1, "", "_SeqLenDim"], [87, 6, 1, "", "_SeqPaddingLength"], [87, 6, 1, "", "_StackedRecurrent"], [87, 6, 1, "", "_TransformDType"], [87, 6, 1, "", "_Update"], [87, 6, 1, "", "_WrapAccumulatorCellFn"], [87, 6, 1, "", "_WrapAccumulatorCellGradFn"], [87, 6, 1, "", "_WrapCellFnWithStepSeed"], [87, 6, 1, "", "_WrapCellFnWithSymbolValues"], [87, 6, 1, "", "_WrapCellGradFnWithStepSeed"], [87, 6, 1, "", "_WrapCellGradFnWithSymbolValues"]], "lingvo.core.recurrent.DevicePair": [[87, 2, 1, "", "_asdict"], [87, 5, 1, "", "_field_defaults"], [87, 5, 1, "", "_fields"], [87, 2, 1, "", "_make"], [87, 2, 1, "", "_replace"], [87, 5, 1, "", "recv"], [87, 5, 1, "", "send"]], "lingvo.core.recurrent._Input": [[87, 2, 1, "", "Compute"]], "lingvo.core.recurrent._Middle": [[87, 2, 1, "", "Compute"]], "lingvo.core.recurrent._Output": [[87, 2, 1, "", "Compute"]], "lingvo.core.recurrent._Recurrent": [[87, 2, 1, "", "Compute"]], "lingvo.core.repeat_layer": [[88, 1, 1, "", "GenericRepeatLayer"], [88, 6, 1, "", "_CopyShapes"]], "lingvo.core.repeat_layer.GenericRepeatLayer": [[88, 2, 1, "", "Params"], [88, 2, 1, "", "_MaybeStackExtraTheta"], [88, 2, 1, "", "_Repeat"], [88, 3, 1, "", "_body"], [88, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.retry": [[89, 6, 1, "", "Retry"]], "lingvo.core.reversible_layers": [[90, 1, 1, "", "RevNetLayer"], [90, 1, 1, "", "StackedRevNetLayer"]], "lingvo.core.reversible_layers.RevNetLayer": [[90, 2, 1, "", "FProp"], [90, 2, 1, "", "Params"], [90, 2, 1, "", "ReverseAndGrad"]], "lingvo.core.reversible_layers.StackedRevNetLayer": [[90, 2, 1, "", "FProp"], [90, 2, 1, "", "Params"]], "lingvo.core.rnn_cell": [[91, 1, 1, "", "ConvLSTMCell"], [91, 1, 1, "", "DoubleProjectionLSTMCell"], [91, 1, 1, "", "EmbeddingAugmentedLayerNormalizedLSTMCellSimple"], [91, 1, 1, "", "GRUCell"], [91, 1, 1, "", "LSTMCellGrouped"], [91, 1, 1, "", "LSTMCellSimple"], [91, 1, 1, "", "LayerNormalizedLSTMCell"], [91, 1, 1, "", "LayerNormalizedLSTMCellLean"], [91, 1, 1, "", "LayerNormalizedLSTMCellSimple"], [91, 1, 1, "", "NormalizedLSTMCellSimple"], [91, 1, 1, "", "QRNNPoolingCell"], [91, 1, 1, "", "QuantizedLSTMCell"], [91, 1, 1, "", "RNNCell"], [91, 1, 1, "", "SRUCell"], [91, 1, 1, "", "WeightNormalizedLSTMCellSimple"], [91, 6, 1, "", "_HistogramSummary"]], "lingvo.core.rnn_cell.ConvLSTMCell": [[91, 2, 1, "", "AddGlobalVN"], [91, 2, 1, "", "GetOutput"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_CreateLayerVariables"], [91, 2, 1, "", "_Gates"], [91, 2, 1, "", "_Mix"], [91, 2, 1, "", "batch_size"], [91, 3, 1, "", "hidden_size"], [91, 3, 1, "", "output_size"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.DoubleProjectionLSTMCell": [[91, 2, 1, "", "AddGlobalVN"], [91, 2, 1, "", "GetOutput"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_CreateLayerVariables"], [91, 2, 1, "", "_Gates"], [91, 2, 1, "", "_LayerNormGate"], [91, 2, 1, "", "_Mix"], [91, 2, 1, "", "_ProcessInputProj"], [91, 2, 1, "", "_ResetState"], [91, 2, 1, "", "batch_size"], [91, 3, 1, "", "gates"], [91, 3, 1, "", "hidden_size"], [91, 3, 1, "", "output_size"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.EmbeddingAugmentedLayerNormalizedLSTMCellSimple": [[91, 2, 1, "", "FProp"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.GRUCell": [[91, 2, 1, "", "AddGlobalVN"], [91, 2, 1, "", "FProp"], [91, 2, 1, "", "GetOutput"], [91, 2, 1, "", "LayerNorm"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_CreateLayerVariables"], [91, 2, 1, "", "_ResetState"], [91, 2, 1, "", "batch_size"], [91, 3, 1, "", "hidden_size"], [91, 3, 1, "", "output_size"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.LSTMCellGrouped": [[91, 2, 1, "", "FProp"], [91, 2, 1, "", "GetOutput"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_ShuffleShards"], [91, 2, 1, "", "batch_size"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.LSTMCellSimple": [[91, 2, 1, "", "AddGlobalVN"], [91, 2, 1, "", "GetOutput"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "PostTrainingStepUpdate"], [91, 2, 1, "", "_ApplyZoneOut"], [91, 2, 1, "", "_CreateLayerVariables"], [91, 2, 1, "", "_Gates"], [91, 2, 1, "", "_GatesInternal"], [91, 2, 1, "", "_GetBias"], [91, 2, 1, "", "_Mix"], [91, 2, 1, "", "_ProcessNewC"], [91, 2, 1, "", "_ResetState"], [91, 2, 1, "", "_RetrieveAndSplitGates"], [91, 2, 1, "", "batch_size"], [91, 3, 1, "", "hidden_size"], [91, 3, 1, "", "num_gates"], [91, 3, 1, "", "output_size"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.LayerNormalizedLSTMCell": [[91, 2, 1, "", "AddGlobalVN"], [91, 2, 1, "", "GetOutput"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_CreateLayerVariables"], [91, 2, 1, "", "_Gates"], [91, 2, 1, "", "_Mix"], [91, 2, 1, "", "_ResetState"], [91, 2, 1, "", "batch_size"], [91, 3, 1, "", "hidden_size"], [91, 3, 1, "", "output_size"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.LayerNormalizedLSTMCellLean": [[91, 2, 1, "", "AddGlobalVN"], [91, 2, 1, "", "GetOutput"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_CreateLayerVariables"], [91, 2, 1, "", "_Gates"], [91, 2, 1, "", "_LayerNormGate"], [91, 2, 1, "", "_Mix"], [91, 2, 1, "", "_ResetState"], [91, 2, 1, "", "batch_size"], [91, 3, 1, "", "hidden_size"], [91, 3, 1, "", "output_size"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.LayerNormalizedLSTMCellSimple": [[91, 2, 1, "", "AddGlobalVN"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_CreateLayerVariables"], [91, 2, 1, "", "_Gates"]], "lingvo.core.rnn_cell.NormalizedLSTMCellSimple": [[91, 2, 1, "", "Params"], [91, 2, 1, "", "_Gates"]], "lingvo.core.rnn_cell.QRNNPoolingCell": [[91, 2, 1, "", "GetOutput"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_ApplyZoneOut"], [91, 2, 1, "", "_Gates"], [91, 2, 1, "", "_Mix"], [91, 2, 1, "", "batch_size"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.QuantizedLSTMCell": [[91, 2, 1, "", "AddGlobalVN"], [91, 2, 1, "", "GetOutput"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_CreateLayerVariables"], [91, 2, 1, "", "_Gates"], [91, 2, 1, "", "_Mix"], [91, 2, 1, "", "_ResetState"], [91, 2, 1, "", "batch_size"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.RNNCell": [[91, 2, 1, "", "FProp"], [91, 2, 1, "", "GetOutput"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_ZoneOut"], [91, 2, 1, "", "batch_size"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.SRUCell": [[91, 2, 1, "", "AddGlobalVN"], [91, 2, 1, "", "GetOutput"], [91, 2, 1, "", "LayerNorm"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_ApplyZoneOut"], [91, 2, 1, "", "_CreateLayerVariables"], [91, 2, 1, "", "_Gates"], [91, 2, 1, "", "_Mix"], [91, 2, 1, "", "batch_size"], [91, 3, 1, "", "hidden_size"], [91, 3, 1, "", "num_gates"], [91, 3, 1, "", "output_size"], [91, 2, 1, "", "zero_state"]], "lingvo.core.rnn_cell.WeightNormalizedLSTMCellSimple": [[91, 2, 1, "", "AddGlobalVN"], [91, 2, 1, "", "Params"], [91, 2, 1, "", "_CreateLayerVariables"], [91, 2, 1, "", "_Gates"]], "lingvo.core.rnn_layers": [[92, 1, 1, "", "BidirectionalFRNN"], [92, 1, 1, "", "BidirectionalFRNNQuasi"], [92, 1, 1, "", "BidirectionalRNN"], [92, 1, 1, "", "BidirectionalRNNV2"], [92, 1, 1, "", "FRNN"], [92, 1, 1, "", "FRNNWithAttention"], [92, 6, 1, "", "GeneratePackedInputResetMask"], [92, 1, 1, "", "IdentitySeqLayer"], [92, 1, 1, "", "MultiSourceFRNNWithAttention"], [92, 1, 1, "", "RNN"], [92, 1, 1, "", "StackedBiFRNNLayerByLayer"], [92, 1, 1, "", "StackedFRNNLayerByLayer"], [92, 1, 1, "", "StackedRNNBase"], [92, 6, 1, "", "_ConcatLastDim"], [92, 6, 1, "", "_ShiftRight"], [92, 6, 1, "", "_ShiftRightWithMasking"]], "lingvo.core.rnn_layers.BidirectionalFRNN": [[92, 2, 1, "", "FProp"], [92, 2, 1, "", "Params"], [92, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.rnn_layers.BidirectionalFRNNQuasi": [[92, 2, 1, "", "FProp"], [92, 2, 1, "", "Params"], [92, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.rnn_layers.BidirectionalRNN": [[92, 2, 1, "", "FProp"], [92, 2, 1, "", "Params"], [92, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.rnn_layers.BidirectionalRNNV2": [[92, 2, 1, "", "FProp"], [92, 2, 1, "", "Params"], [92, 2, 1, "", "_PadSequenceToLength"], [92, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.rnn_layers.FRNN": [[92, 2, 1, "", "FProp"], [92, 2, 1, "", "Params"], [92, 2, 1, "", "_child_variable_scope_override"], [92, 3, 1, "", "rnn_cell"], [92, 2, 1, "", "zero_state"]], "lingvo.core.rnn_layers.FRNNWithAttention": [[92, 2, 1, "", "AccumulateStates"], [92, 2, 1, "", "FProp"], [92, 2, 1, "", "InitForSourcePacked"], [92, 2, 1, "", "Params"], [92, 2, 1, "", "PostProcessStates"], [92, 2, 1, "", "_child_variable_scope_override"], [92, 3, 1, "", "attention"], [92, 2, 1, "", "reset_atten_state"], [92, 3, 1, "", "rnn_cell"], [92, 2, 1, "", "zero_state"]], "lingvo.core.rnn_layers.IdentitySeqLayer": [[92, 2, 1, "", "FPropFullSequence"], [92, 2, 1, "", "zero_state"]], "lingvo.core.rnn_layers.MultiSourceFRNNWithAttention": [[92, 2, 1, "", "FProp"], [92, 2, 1, "", "InitAttention"], [92, 2, 1, "", "Params"], [92, 2, 1, "", "_child_variable_scope_override"], [92, 3, 1, "", "attention"], [92, 3, 1, "", "rnn_cell"]], "lingvo.core.rnn_layers.RNN": [[92, 2, 1, "", "FProp"], [92, 2, 1, "", "Params"], [92, 2, 1, "", "_child_variable_scope_override"], [92, 2, 1, "", "zero_state"]], "lingvo.core.rnn_layers.StackedBiFRNNLayerByLayer": [[92, 2, 1, "", "FProp"], [92, 2, 1, "", "FPropFullSequence"], [92, 2, 1, "", "Params"], [92, 2, 1, "", "_CreateLayerVariables"], [92, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.rnn_layers.StackedFRNNLayerByLayer": [[92, 2, 1, "", "FProp"], [92, 2, 1, "", "FPropFullSequence"], [92, 2, 1, "", "Params"], [92, 2, 1, "", "_CreateLayerVariables"], [92, 2, 1, "", "_child_variable_scope_override"], [92, 2, 1, "", "zero_state"]], "lingvo.core.rnn_layers.StackedRNNBase": [[92, 2, 1, "", "Params"], [92, 2, 1, "", "_GetCellTpls"]], "lingvo.core.routing_config_helper": [[93, 1, 1, "", "RoutingTransformerEncoderParams"], [93, 6, 1, "", "SetupRoutingTransformerEncoder"]], "lingvo.core.saver": [[94, 1, 1, "", "InRange"], [94, 1, 1, "", "IsFinite"], [94, 6, 1, "", "ReadNpArrays"], [94, 1, 1, "", "SanityCheck"], [94, 1, 1, "", "Saver"], [94, 6, 1, "", "WriteNpArrays"], [94, 6, 1, "", "_VarKey"]], "lingvo.core.saver.InRange": [[94, 2, 1, "", "Check"]], "lingvo.core.saver.IsFinite": [[94, 2, 1, "", "Check"]], "lingvo.core.saver.SanityCheck": [[94, 2, 1, "", "Check"]], "lingvo.core.saver.Saver": [[94, 2, 1, "", "GetCheckpointId"], [94, 5, 1, "", "RE_PATTERN"], [94, 2, 1, "", "Restore"], [94, 2, 1, "", "Save"], [94, 2, 1, "", "Sync"], [94, 2, 1, "", "_AddShardedSaveOps"], [94, 2, 1, "", "_BuildRestore"], [94, 2, 1, "", "_BuildSave"], [94, 2, 1, "", "_DoSanityCheck"], [94, 2, 1, "", "_FinalizeSave"], [94, 2, 1, "", "_GarbageCollect"], [94, 2, 1, "", "_GetState"], [94, 2, 1, "", "_SaveAsync"], [94, 2, 1, "", "_SaveSync"], [94, 2, 1, "", "_SetState"], [94, 2, 1, "", "_UpdateState"]], "lingvo.core.scatter_update": [[95, 6, 1, "", "SetInplaceUpdate"], [95, 6, 1, "", "Update"], [95, 6, 1, "", "UseInplaceUpdate"]], "lingvo.core.schedule": [[96, 1, 1, "", "AnnealingSchedule"], [96, 1, 1, "", "BaseSchedule"], [96, 1, 1, "", "CombinedMinimumSchedule"], [96, 1, 1, "", "Constant"], [96, 1, 1, "", "ConstantOne"], [96, 1, 1, "", "ContinuousSchedule"], [96, 1, 1, "", "CosineSchedule"], [96, 1, 1, "", "CycleSchedule"], [96, 1, 1, "", "DevBasedSchedule"], [96, 1, 1, "", "ExponentialSchedule"], [96, 1, 1, "", "InverseSigmoid"], [96, 1, 1, "", "LinearRampupCosineSchedule"], [96, 1, 1, "", "LinearRampupDecaySchedule"], [96, 1, 1, "", "LinearRampupExponentialDecay"], [96, 1, 1, "", "LinearRampupExponentialDecayScaledByNumSplitSchedule"], [96, 1, 1, "", "LinearRampupPiecewiseConstantSchedule"], [96, 1, 1, "", "LinearRampupSqrtDecay"], [96, 1, 1, "", "LinearRampupSqrtDecayByBatchSizeAndReplicas"], [96, 1, 1, "", "LinearSchedule"], [96, 1, 1, "", "PiecewiseConstantSchedule"], [96, 1, 1, "", "PiecewiseSchedule"], [96, 1, 1, "", "PolynomialSchedule"], [96, 1, 1, "", "SqrtDecay"], [96, 1, 1, "", "SqrtDecayToZero"], [96, 1, 1, "", "StepwiseExponentialSchedule"], [96, 1, 1, "", "TransformerMLPerfSchedule"], [96, 1, 1, "", "TransformerSchedule"], [96, 1, 1, "", "TransformerScheduleNoWarmUp"]], "lingvo.core.schedule.AnnealingSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.BaseSchedule": [[96, 2, 1, "", "GetStep"], [96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.CombinedMinimumSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.Constant": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.ContinuousSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.CosineSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.CycleSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.DevBasedSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"], [96, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.schedule.ExponentialSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.InverseSigmoid": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearRampupCosineSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearRampupDecaySchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearRampupExponentialDecay": [[96, 2, 1, "", "Params"]], "lingvo.core.schedule.LinearRampupExponentialDecayScaledByNumSplitSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearRampupPiecewiseConstantSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearRampupSqrtDecay": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearRampupSqrtDecayByBatchSizeAndReplicas": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.LinearSchedule": [[96, 2, 1, "", "Params"]], "lingvo.core.schedule.PiecewiseConstantSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.PiecewiseSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.PolynomialSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.SqrtDecay": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.SqrtDecayToZero": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.StepwiseExponentialSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.TransformerMLPerfSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.TransformerSchedule": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.schedule.TransformerScheduleNoWarmUp": [[96, 2, 1, "", "Params"], [96, 2, 1, "", "Value"]], "lingvo.core.scorers": [[97, 1, 1, "", "BleuScorer"], [97, 6, 1, "", "NGrams"], [97, 1, 1, "", "Unsegmenter"], [97, 6, 1, "", "_ToUnicode"], [97, 6, 1, "", "_Tokenize"]], "lingvo.core.scorers.BleuScorer": [[97, 2, 1, "", "AddSentence"], [97, 2, 1, "", "ComputeOverallScore"], [97, 3, 1, "", "unsegmenter"]], "lingvo.core.scorers.Unsegmenter": [[97, 5, 1, "", "_BPE_SEPARATOR"], [97, 2, 1, "", "_UnsegmentBpe"], [97, 2, 1, "", "_UnsegmentWpm"], [97, 5, 1, "", "_WPM_SEPARATOR"]], "lingvo.core.self_attention_layer": [[98, 1, 1, "", "Builder"], [98, 1, 1, "", "StackedTransformerEncoderLayers"]], "lingvo.core.self_attention_layer.Builder": [[98, 2, 1, "", "SelfAttention"], [98, 2, 1, "", "TransformerStack"], [98, 2, 1, "", "TransformerStackV2"], [98, 2, 1, "", "_StridedTransformerLayerBlock"], [98, 2, 1, "", "_TransformerLayerBlock"]], "lingvo.core.self_attention_layer.StackedTransformerEncoderLayers": [[98, 2, 1, "", "Cast"], [98, 2, 1, "", "FProp"]], "lingvo.core.sendrecv": [[99, 1, 1, "", "Channel"], [99, 6, 1, "", "_TpuCore"]], "lingvo.core.sendrecv.Channel": [[99, 2, 1, "", "Recv"], [99, 2, 1, "", "Send"]], "lingvo.core.spectrum_augmenter": [[100, 1, 1, "", "SpectrumAugmenter"], [100, 6, 1, "", "_global_seed_from_inputs"], [100, 6, 1, "", "_hat"], [100, 6, 1, "", "_random_normal_op"], [100, 6, 1, "", "_random_uniform_op"]], "lingvo.core.spectrum_augmenter.SpectrumAugmenter": [[100, 2, 1, "", "EinsumBBmBm"], [100, 2, 1, "", "EinsumBmtBmBt"], [100, 2, 1, "", "EinsumBxyBxBxy"], [100, 2, 1, "", "EinsumBxycBxBxyc"], [100, 2, 1, "", "EinsumBxycByBxyc"], [100, 2, 1, "", "EinsumBxycBzxBzyc"], [100, 2, 1, "", "EinsumBxycBzyBxzc"], [100, 2, 1, "", "FProp"], [100, 2, 1, "", "Params"], [100, 2, 1, "", "UnstackFeatures"], [100, 2, 1, "", "_AugmentationNetwork"], [100, 2, 1, "", "_ConstructWarpMatrix"], [100, 2, 1, "", "_FrequencyMask"], [100, 2, 1, "", "_FrequencyNoise"], [100, 2, 1, "", "_FrequencyWarp"], [100, 2, 1, "", "_GetMask"], [100, 2, 1, "", "_GetWarpMatrix"], [100, 2, 1, "", "_TimeMask"], [100, 2, 1, "", "_TimeWarp"], [100, 3, 1, "", "augment_weight"]], "lingvo.core.spectrum_augmenter_on_device": [[101, 1, 1, "", "SpectrumAugmenterOnDevice"]], "lingvo.core.spectrum_augmenter_on_device.SpectrumAugmenterOnDevice": [[101, 2, 1, "", "EinsumBBmBm"], [101, 2, 1, "", "EinsumBmtBmBt"], [101, 2, 1, "", "EinsumBxyBxBxy"], [101, 2, 1, "", "EinsumBxycBxBxyc"], [101, 2, 1, "", "EinsumBxycByBxyc"], [101, 2, 1, "", "EinsumBxycBzxBzyc"], [101, 2, 1, "", "EinsumBxycBzyBxzc"]], "lingvo.core.step": [[102, 1, 1, "", "GraphStep"], [102, 1, 1, "", "IteratorStep"], [102, 1, 1, "", "ParallelStep"], [102, 1, 1, "", "RecurrentStepWrapper"], [102, 1, 1, "", "StackStep"], [102, 1, 1, "", "StatelessLayerStep"], [102, 1, 1, "", "Step"], [102, 1, 1, "", "SubStep"]], "lingvo.core.step.GraphStep": [[102, 2, 1, "", "FProp"], [102, 2, 1, "", "Params"], [102, 2, 1, "", "PrepareExternalInputs"], [102, 2, 1, "", "ZeroState"], [102, 5, 1, "", "_seq"]], "lingvo.core.step.IteratorStep": [[102, 2, 1, "", "FProp"], [102, 2, 1, "", "Params"], [102, 2, 1, "", "PrepareExternalInputs"], [102, 2, 1, "", "ZeroState"]], "lingvo.core.step.ParallelStep": [[102, 2, 1, "", "FProp"], [102, 2, 1, "", "Params"]], "lingvo.core.step.RecurrentStepWrapper": [[102, 2, 1, "", "FProp"], [102, 2, 1, "", "Params"], [102, 2, 1, "", "PrepareExternalInputs"], [102, 2, 1, "", "ZeroState"], [102, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.step.StackStep": [[102, 2, 1, "", "FProp"], [102, 2, 1, "", "Params"], [102, 2, 1, "", "PrepareExternalInputs"], [102, 2, 1, "", "ZeroState"]], "lingvo.core.step.StatelessLayerStep": [[102, 2, 1, "", "FProp"], [102, 2, 1, "", "Params"]], "lingvo.core.step.Step": [[102, 2, 1, "", "FProp"], [102, 2, 1, "", "PrepareExternalInputs"], [102, 2, 1, "", "ZeroState"]], "lingvo.core.step.SubStep": [[102, 2, 1, "", "_asdict"], [102, 5, 1, "", "_field_defaults"], [102, 5, 1, "", "_fields"], [102, 2, 1, "", "_make"], [102, 2, 1, "", "_replace"], [102, 5, 1, "", "external_signature"], [102, 5, 1, "", "params"], [102, 5, 1, "", "signature"]], "lingvo.core.steps": [[104, 0, 0, "-", "attention_steps"], [105, 0, 0, "-", "embedding_steps"], [106, 0, 0, "-", "rnn_steps"]], "lingvo.core.steps.attention_steps": [[104, 1, 1, "", "AttentionBlockStep"], [104, 1, 1, "", "AttentionStep"]], "lingvo.core.steps.attention_steps.AttentionBlockStep": [[104, 2, 1, "", "FProp"], [104, 2, 1, "", "Params"], [104, 2, 1, "", "ZeroState"]], "lingvo.core.steps.attention_steps.AttentionStep": [[104, 2, 1, "", "FProp"], [104, 2, 1, "", "Params"], [104, 2, 1, "", "PrepareExternalInputs"], [104, 2, 1, "", "ZeroState"], [104, 2, 1, "", "_GetMaxSeqLength"]], "lingvo.core.steps.embedding_steps": [[105, 1, 1, "", "EmbeddingStep"], [105, 1, 1, "", "StatefulEmbeddingStep"]], "lingvo.core.steps.embedding_steps.EmbeddingStep": [[105, 2, 1, "", "FProp"], [105, 2, 1, "", "Params"]], "lingvo.core.steps.embedding_steps.StatefulEmbeddingStep": [[105, 2, 1, "", "EmbLookup"], [105, 2, 1, "", "FProp"], [105, 2, 1, "", "Params"], [105, 2, 1, "", "ZeroState"], [105, 2, 1, "", "zero_state"]], "lingvo.core.steps.rnn_steps": [[106, 1, 1, "", "RnnStackStep"], [106, 1, 1, "", "RnnStep"]], "lingvo.core.steps.rnn_steps.RnnStackStep": [[106, 2, 1, "", "FProp"], [106, 2, 1, "", "Params"], [106, 2, 1, "", "PrepareExternalInputs"], [106, 2, 1, "", "ZeroState"], [106, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.steps.rnn_steps.RnnStep": [[106, 2, 1, "", "FProp"], [106, 2, 1, "", "Params"], [106, 2, 1, "", "PrepareExternalInputs"], [106, 2, 1, "", "ZeroState"]], "lingvo.core.stream_step_test_base": [[107, 1, 1, "", "StreamStepTestBase"]], "lingvo.core.stream_step_test_base.StreamStepTestBase": [[107, 2, 1, "", "_BuildStackingBaseGraph"], [107, 2, 1, "", "_BuildStackingStreamGraph"], [107, 2, 1, "", "_FProp"], [107, 2, 1, "", "_GetFPropOutput"], [107, 2, 1, "", "_GetInputs"], [107, 2, 1, "", "_GetParams"], [107, 2, 1, "", "_NormalizeStreamStepOutput"], [107, 2, 1, "", "_PadInput"], [107, 2, 1, "", "_StreamStep"], [107, 2, 1, "", "_TestRightContextStackingLayersHelper"], [107, 2, 1, "", "_TestStreamStepHelper"], [107, 5, 1, "", "_test_params_reprs"], [107, 3, 1, "", "input_rank"]], "lingvo.core.summary_utils": [[108, 6, 1, "", "AddAttentionSummary"], [108, 6, 1, "", "AddAttentionSummaryBatchMajor"], [108, 6, 1, "", "AddNormSummary"], [108, 6, 1, "", "CollectVarHistogram"], [108, 6, 1, "", "GetTensorName"], [108, 6, 1, "", "ModelAnalysis"], [108, 6, 1, "", "PlotSequenceFeatures"], [108, 6, 1, "", "PrepareSequenceForPlot"], [108, 6, 1, "", "SequenceLength"], [108, 1, 1, "", "StatsCounter"], [108, 1, 1, "", "StepRateTracker"], [108, 6, 1, "", "TrimPaddingAndPlotAttention"], [108, 6, 1, "", "TrimPaddingAndPlotSequence"], [108, 6, 1, "", "_ShouldAddSummary"], [108, 6, 1, "", "histogram"], [108, 6, 1, "", "histogram_v2"], [108, 6, 1, "", "image"], [108, 6, 1, "", "image_v2"], [108, 6, 1, "", "scalar"], [108, 6, 1, "", "scalar_input_stats"], [108, 6, 1, "", "scalar_v2"], [108, 6, 1, "", "text"], [108, 6, 1, "", "text_v2"]], "lingvo.core.summary_utils.StatsCounter": [[108, 2, 1, "", "IncBy"], [108, 2, 1, "", "Value"]], "lingvo.core.summary_utils.StepRateTracker": [[108, 2, 1, "", "ComputeStepRate"]], "lingvo.core.symbolic": [[109, 6, 1, "", "EvalExpr"], [109, 6, 1, "", "IsExpr"], [109, 6, 1, "", "IsSymbol"], [109, 1, 1, "", "Symbol"], [109, 1, 1, "", "SymbolToValueMap"], [109, 6, 1, "", "ToStatic"], [109, 6, 1, "", "ToTensor"], [109, 1, 1, "", "_LocalSymbolToValueStack"]], "lingvo.core.symbolic.Symbol": [[109, 5, 1, "", "_explicit_class_assumptions"], [109, 5, 1, "", "_prop_handler"], [109, 5, 1, "", "default_assumptions"], [109, 5, 1, "", "dummy_index"]], "lingvo.core.symbolic.SymbolToValueMap": [[109, 2, 1, "", "Get"], [109, 2, 1, "", "Stack"], [109, 5, 1, "", "_local_stack"]], "lingvo.core.target_sequence_sampler": [[110, 1, 1, "", "TargetSequenceSampler"], [110, 6, 1, "", "_ComputePaddings"], [110, 6, 1, "", "_GetShapes"]], "lingvo.core.target_sequence_sampler.TargetSequenceSampler": [[110, 2, 1, "", "Params"], [110, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler": [[111, 1, 1, "", "AdaptiveScheduler"], [111, 1, 1, "", "ConstantScheduler"], [111, 1, 1, "", "ExponentialScheduler"], [111, 1, 1, "", "InverseRatioAdaptiveScheduler"], [111, 1, 1, "", "PieceWiseScheduler"], [111, 1, 1, "", "RoundRobinScheduler"], [111, 1, 1, "", "SequentialScheduler"], [111, 1, 1, "", "ShiftedExponentialScheduler"], [111, 1, 1, "", "SigmoidScheduler"], [111, 1, 1, "", "SimpleAdaptiveScheduler"], [111, 1, 1, "", "TaskScheduler"]], "lingvo.core.task_scheduler.AdaptiveScheduler": [[111, 2, 1, "", "Params"], [111, 2, 1, "", "getMetricHistories"]], "lingvo.core.task_scheduler.InverseRatioAdaptiveScheduler": [[111, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler.PieceWiseScheduler": [[111, 2, 1, "", "Params"], [111, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler.RoundRobinScheduler": [[111, 2, 1, "", "Params"], [111, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler.SequentialScheduler": [[111, 2, 1, "", "Params"], [111, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler.ShiftedExponentialScheduler": [[111, 2, 1, "", "Params"], [111, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler.SimpleAdaptiveScheduler": [[111, 2, 1, "", "Sample"]], "lingvo.core.task_scheduler.TaskScheduler": [[111, 2, 1, "", "Params"], [111, 2, 1, "", "Sample"]], "lingvo.core.test_helper": [[112, 6, 1, "", "test_src_dir_path"]], "lingvo.core.test_trainer_utils": [[113, 6, 1, "", "MakeModelValidatorTestCase"], [113, 6, 1, "", "_ModelTuples"]], "lingvo.core.test_utils": [[114, 6, 1, "", "CompareToGoldenSingleFloat"], [114, 6, 1, "", "ComputeNumericGradient"], [114, 6, 1, "", "ComputeNumericGradientEager"], [114, 6, 1, "", "DefineAndTrace"], [114, 6, 1, "", "DisableEagerAdapter"], [114, 6, 1, "", "PickEveryN"], [114, 6, 1, "", "ReplaceGoldenSingleFloat"], [114, 6, 1, "", "ReplaceGoldenStackAnalysis"], [114, 6, 1, "", "SkipIfEager"], [114, 6, 1, "", "SkipIfNonEager"], [114, 1, 1, "", "TapeIfEager"], [114, 1, 1, "", "TestCase"], [114, 1, 1, "", "_EagerSessionAdaptor"], [114, 6, 1, "", "_PlaceholderAdapter"], [114, 6, 1, "", "_ReplaceOneLineInFile"], [114, 6, 1, "", "_SkipIf"], [114, 6, 1, "", "main"]], "lingvo.core.test_utils.TapeIfEager": [[114, 2, 1, "", "gradient"], [114, 2, 1, "", "watch"]], "lingvo.core.test_utils.TestCase": [[114, 2, 1, "", "GetScalarSummaryValues"], [114, 2, 1, "", "SetEval"], [114, 2, 1, "", "_create_session"], [114, 2, 1, "", "session"], [114, 2, 1, "", "setUp"]], "lingvo.core.test_utils._EagerSessionAdaptor": [[114, 2, 1, "", "_run_impl"], [114, 2, 1, "", "run"]], "lingvo.core.thread_local_utils": [[115, 1, 1, "", "ThreadLocalDict"], [115, 1, 1, "", "ThreadLocalStack"]], "lingvo.core.tokenizers": [[116, 1, 1, "", "AsciiTokenizer"], [116, 1, 1, "", "BaseTokenizer"], [116, 1, 1, "", "BpeTokenizer"], [116, 1, 1, "", "SentencePieceTokenizer"], [116, 1, 1, "", "VocabFileTokenizer"], [116, 1, 1, "", "WpmTokenizer"]], "lingvo.core.tokenizers.AsciiTokenizer": [[116, 2, 1, "", "IdsToStrings"], [116, 2, 1, "", "_StringsToIdsImpl"]], "lingvo.core.tokenizers.BaseTokenizer": [[116, 2, 1, "", "IdsToStrings"], [116, 2, 1, "", "IdsToTokens"], [116, 2, 1, "", "Initialize"], [116, 2, 1, "", "Params"], [116, 2, 1, "", "StringsToIds"], [116, 2, 1, "", "StringsToIdsWithOffsets"], [116, 2, 1, "", "StringsToIdsWithSegments"], [116, 2, 1, "", "_StringsToIdsImpl"], [116, 2, 1, "", "_StringsToIdsWithOffsetsImpl"], [116, 2, 1, "", "_StringsToIdsWithSegmentsImpl"]], "lingvo.core.tokenizers.BpeTokenizer": [[116, 2, 1, "", "IdsToStrings"], [116, 2, 1, "", "Params"], [116, 2, 1, "", "_StringsToIdsImpl"]], "lingvo.core.tokenizers.SentencePieceTokenizer": [[116, 2, 1, "", "IdsToStrings"], [116, 2, 1, "", "IdsToTokens"], [116, 2, 1, "", "Params"], [116, 2, 1, "", "StringsToIds"], [116, 2, 1, "", "_StringsToIdsImpl"]], "lingvo.core.tokenizers.VocabFileTokenizer": [[116, 2, 1, "", "IdsToStrings"], [116, 2, 1, "", "Params"], [116, 2, 1, "", "_CheckParams"], [116, 2, 1, "", "_StringsToIdsImpl"], [116, 3, 1, "", "_vocab_file_params"]], "lingvo.core.tokenizers.WpmTokenizer": [[116, 2, 1, "", "IdsToStrings"], [116, 2, 1, "", "Params"], [116, 2, 1, "", "_StringsToIdsImpl"]], "lingvo.core.tpu_embedding_layers": [[117, 1, 1, "", "TPUEmbeddingAdagradOptimizer"], [117, 1, 1, "", "TPUEmbeddingAdamOptimizer"], [117, 1, 1, "", "TPUEmbeddingFTRLOptimizer"], [117, 1, 1, "", "TPUEmbeddingLayer"], [117, 1, 1, "", "TPUEmbeddingSGDOptimizer"], [117, 1, 1, "", "TPUEmbeddingTable"], [117, 1, 1, "", "TpuEmbeddingCollection"], [117, 6, 1, "", "_IsTpuTraining"], [117, 6, 1, "", "_RemovePrivateVar"], [117, 1, 1, "", "_TPUEmbeddingOptimizer"]], "lingvo.core.tpu_embedding_layers.TPUEmbeddingAdagradOptimizer": [[117, 2, 1, "", "CreateOptimizerParameters"], [117, 2, 1, "", "CreateSlotVariablesAndOps"], [117, 2, 1, "", "Params"]], "lingvo.core.tpu_embedding_layers.TPUEmbeddingAdamOptimizer": [[117, 2, 1, "", "CreateOptimizerParameters"], [117, 2, 1, "", "CreateSlotVariablesAndOps"], [117, 2, 1, "", "Params"]], "lingvo.core.tpu_embedding_layers.TPUEmbeddingFTRLOptimizer": [[117, 2, 1, "", "CreateOptimizerParameters"], [117, 2, 1, "", "CreateSlotVariablesAndOps"], [117, 2, 1, "", "Params"]], "lingvo.core.tpu_embedding_layers.TPUEmbeddingLayer": [[117, 2, 1, "", "EmbLookup"], [117, 2, 1, "", "EmbLookupSparse"], [117, 2, 1, "", "GetAuxiliaryVariables"], [117, 2, 1, "", "GetIdsMap"], [117, 2, 1, "", "Params"], [117, 2, 1, "", "_CheckIdsMap"], [117, 2, 1, "", "_CheckTPUEmbeddingConfig"], [117, 2, 1, "", "_CreateLayerVariables"], [117, 2, 1, "", "_TpuEmbLookup"], [117, 2, 1, "", "_child_variable_scope_override"]], "lingvo.core.tpu_embedding_layers.TPUEmbeddingSGDOptimizer": [[117, 2, 1, "", "CreateOptimizerParameters"], [117, 2, 1, "", "CreateSlotVariablesAndOps"]], "lingvo.core.tpu_embedding_layers.TPUEmbeddingTable": [[117, 2, 1, "", "CpuEmbLookup"], [117, 2, 1, "", "CpuEmbLookupSparse"], [117, 2, 1, "", "CreateOptimizerSlotVariable"], [117, 2, 1, "", "GetDeviceName"], [117, 2, 1, "", "GetVariableName"], [117, 2, 1, "", "Params"], [117, 2, 1, "", "_CombinerEmbLookup"], [117, 2, 1, "", "_CreateLayerVariables"], [117, 2, 1, "", "_GetSelfVariablesDict"], [117, 2, 1, "", "_SequenceEmbLookup"], [117, 3, 1, "", "auxiliary_variables"], [117, 3, 1, "", "input_keys"], [117, 3, 1, "", "max_sequence_length"], [117, 3, 1, "", "table_config"], [117, 3, 1, "", "table_name"]], "lingvo.core.tpu_embedding_layers.TpuEmbeddingCollection": [[117, 2, 1, "", "AddActivations"], [117, 2, 1, "", "AddLoadRetrieveOps"], [117, 2, 1, "", "AddSummaryTensor"], [117, 2, 1, "", "AddTableVariables"], [117, 2, 1, "", "ApplyGradients"], [117, 2, 1, "", "Get"], [117, 2, 1, "", "GetActivations"], [117, 2, 1, "", "SetGradientMultiplierSchedule"], [117, 2, 1, "", "SetTaskMode"], [117, 2, 1, "", "ShouldStopGradient"], [117, 2, 1, "", "_ValidateTaskScope"], [117, 3, 1, "", "feature_names"], [117, 3, 1, "", "inference_with_bfloat16_var_names"], [117, 3, 1, "", "load_ops"], [117, 3, 1, "", "retrieve_ops"], [117, 3, 1, "", "summary_tensors"], [117, 3, 1, "", "table_variables"], [117, 3, 1, "", "tpu_embedding"]], "lingvo.core.tpu_embedding_layers._TPUEmbeddingOptimizer": [[117, 2, 1, "", "CreateOptimizerParameters"], [117, 2, 1, "", "CreateSlotVariablesAndOps"], [117, 2, 1, "", "Params"], [117, 2, 1, "", "_GetSelfVariablesDict"]], "lingvo.core.tpu_summary": [[118, 1, 1, "", "PwTpuSummaryTensor"], [118, 1, 1, "", "RewriteLoopContext"], [118, 1, 1, "", "TpuSummaryContext"], [118, 1, 1, "", "TpuSummaryScalar"], [118, 6, 1, "", "context"], [118, 6, 1, "", "merge_all"], [118, 6, 1, "", "merge_all_pw_tensor"], [118, 6, 1, "", "pw_tensor"], [118, 6, 1, "", "scalar"], [118, 6, 1, "", "tensor"]], "lingvo.core.tpu_summary.PwTpuSummaryTensor": [[118, 5, 1, "", "name"], [118, 5, 1, "", "name_scope"], [118, 5, 1, "", "value"]], "lingvo.core.tpu_summary.RewriteLoopContext": [[118, 2, 1, "", "while_loop"]], "lingvo.core.tpu_summary.TpuSummaryContext": [[118, 5, 1, "", "_global_stack"], [118, 2, 1, "", "current"]], "lingvo.core.tpu_summary.TpuSummaryScalar": [[118, 5, 1, "", "name"], [118, 5, 1, "", "name_scope"], [118, 5, 1, "", "value"], [118, 5, 1, "", "while_loop_reduce"]], "lingvo.core.trainer_test_utils": [[119, 1, 1, "", "CountingInputGenerator"], [119, 1, 1, "", "IdentityRegressionTask"], [119, 1, 1, "", "ModelTrackingFPropResults"], [119, 6, 1, "", "RegisterIdentityRegressionModel"]], "lingvo.core.trainer_test_utils.CountingInputGenerator": [[119, 2, 1, "", "Params"], [119, 2, 1, "", "_InputBatch"]], "lingvo.core.trainer_test_utils.IdentityRegressionTask": [[119, 2, 1, "", "ComputeLoss"], [119, 2, 1, "", "ComputePredictions"], [119, 2, 1, "", "CreateDecoderMetrics"], [119, 2, 1, "", "DecodeWithTheta"], [119, 2, 1, "", "FilterPerExampleTensors"], [119, 2, 1, "", "Params"], [119, 2, 1, "", "PostProcessDecodeOut"], [119, 2, 1, "", "ProcessFPropResults"], [119, 2, 1, "", "_CreateLayerVariables"]], "lingvo.core.trainer_test_utils.ModelTrackingFPropResults": [[119, 2, 1, "", "ProcessFPropResults"]], "lingvo.core.tshape": [[120, 1, 1, "", "Shape"]], "lingvo.core.tshape.Shape": [[120, 2, 1, "", "Subs"], [120, 2, 1, "", "ToTensorShape"], [120, 2, 1, "", "num_elements"], [120, 3, 1, "", "rank"], [120, 3, 1, "", "size"]], "lingvo.core.var_tmp_wrappers": [[121, 1, 1, "", "StackedVarWrapperWithManualSharding"], [121, 1, 1, "", "VarWrapperTrackAssign"]], "lingvo.core.var_tmp_wrappers.StackedVarWrapperWithManualSharding": [[121, 2, 1, "", "_to_auto"], [121, 2, 1, "", "_to_manual"], [121, 2, 1, "", "assign"], [121, 2, 1, "", "assign_add"], [121, 2, 1, "", "assign_sub"], [121, 3, 1, "", "raw_var"], [121, 2, 1, "", "read_value"], [121, 2, 1, "", "value"]], "lingvo.core.var_tmp_wrappers.VarWrapperTrackAssign": [[121, 2, 1, "", "assign"], [121, 2, 1, "", "assign_add"], [121, 2, 1, "", "assign_sub"], [121, 2, 1, "", "control_after_assigns"], [121, 2, 1, "", "previous_assigns"], [121, 3, 1, "", "raw_var"]], "lingvo.core.wpm_encoder": [[122, 1, 1, "", "WpmEncoder"]], "lingvo.core.wpm_encoder.WpmEncoder": [[122, 2, 1, "", "Decode"], [122, 2, 1, "", "Encode"], [122, 2, 1, "", "_EncodeToIds"], [122, 2, 1, "", "_MergeTokens"], [122, 2, 1, "", "_StringToToken"], [122, 2, 1, "", "_TokenToString"], [122, 3, 1, "", "sentence_end_id"], [122, 3, 1, "", "sentence_end_string"], [122, 3, 1, "", "sentence_start_id"], [122, 3, 1, "", "sentence_start_string"], [122, 3, 1, "", "unk_id"]], "lingvo.datasets": [[123, 4, 1, "", "DatasetFunctionError"], [123, 4, 1, "", "GetAllDatasetParamsNotImplementedError"], [123, 6, 1, "", "GetDatasets"], [123, 6, 1, "", "GetDatasetsAst"]], "lingvo.eager_runners": [[124, 1, 1, "", "Decoder"], [124, 1, 1, "", "Evaler"], [124, 1, 1, "", "Trainer"], [124, 6, 1, "", "_GetCheckpointIdForDecodeOut"]], "lingvo.eager_runners.Decoder": [[124, 2, 1, "", "GetDecodeOutPath"], [124, 2, 1, "", "Start"], [124, 2, 1, "", "_DecodeOnce"], [124, 2, 1, "", "_GetDecodeFunc"]], "lingvo.eager_runners.Evaler": [[124, 2, 1, "", "Start"], [124, 2, 1, "", "_EvalOnce"], [124, 2, 1, "", "_GetEvalFunc"]], "lingvo.eager_runners.TrainSummaries": [[124, 2, 1, "", "Start"]], "lingvo.eager_runners.Trainer": [[124, 2, 1, "", "Start"]], "lingvo.executor.ExecutorTpu": [[125, 2, 1, "", "Start"], [125, 2, 1, "", "_GetSession"], [125, 2, 1, "", "_Loop"], [125, 2, 1, "", "_MaybeConstructSharedModel"]], "lingvo.executor": [[125, 6, 1, "", "GetExecutorParams"], [125, 6, 1, "", "UnsetUnusedTrainParams"]], "lingvo.model_imports": [[127, 6, 1, "", "ImportAllParams"], [127, 6, 1, "", "ImportParams"], [127, 6, 1, "", "_Import"], [127, 6, 1, "", "_InsertParams"]], "lingvo.model_registry": [[128, 6, 1, "", "GetAllRegisteredClasses"], [128, 6, 1, "", "GetClass"], [128, 6, 1, "", "GetParams"], [128, 6, 1, "", "GetProgramSchedule"], [128, 6, 1, "", "RegisterMultiTaskModel"], [128, 6, 1, "", "RegisterSingleTaskModel"], [128, 1, 1, "", "_ModelRegistryHelper"]], "lingvo.model_registry._ModelRegistryHelper": [[128, 2, 1, "", "GetAllRegisteredClasses"], [128, 2, 1, "", "GetClass"], [128, 2, 1, "", "GetParams"], [128, 2, 1, "", "GetParamsFromModelParamsObject"], [128, 2, 1, "", "GetProgramSchedule"], [128, 2, 1, "", "GetProgramScheduleFromModelParamsObject"], [128, 2, 1, "", "MaybeUpdateParamsFromFlags"], [128, 2, 1, "", "RegisterMultiTaskModel"], [128, 2, 1, "", "RegisterSingleTaskModel"], [128, 2, 1, "", "_ClassPathPrefix"], [128, 2, 1, "", "_CreateWrapperClass"], [128, 2, 1, "", "_GetSourceInfo"], [128, 5, 1, "", "_MODEL_PARAMS"], [128, 5, 1, "", "_MODEL_PARAMS_ALLOW_REDEF"], [128, 2, 1, "", "_ModelParamsClassKey"], [128, 5, 1, "", "_REGISTERED_MODULES"], [128, 2, 1, "", "_RegisterModel"]], "lingvo.models_test_helper": [[129, 1, 1, "", "BaseModelsTest"], [129, 6, 1, "", "TraverseLayer"], [129, 6, 1, "", "_StubOutCreateVariable"]], "lingvo.models_test_helper.BaseModelsTest": [[129, 2, 1, "", "CreateTestMethodsForAllRegisteredModels"], [129, 2, 1, "", "TransformTest"], [129, 2, 1, "", "_ValidateEMA"], [129, 2, 1, "", "_testOneModelParams"], [129, 2, 1, "", "setUp"]], "lingvo.pdb_wrapper": [[130, 6, 1, "", "catch_post_mortem"]], "lingvo.runners.Controller": [[131, 2, 1, "", "Start"], [131, 2, 1, "", "StartEnqueueOp"], [131, 2, 1, "", "_Loop"], [131, 2, 1, "", "_SummarizeValue"]], "lingvo.runners": [[131, 1, 1, "", "Decoder"], [131, 1, 1, "", "Evaler"], [131, 6, 1, "", "GetDecoderDir"], [131, 6, 1, "", "StartShell"], [131, 1, 1, "", "Trainer"], [131, 6, 1, "", "_GetCheckpointIdForDecodeOut"]], "lingvo.runners.Decoder": [[131, 2, 1, "", "DecodeCheckpoint"], [131, 2, 1, "", "DecodeLatestCheckpoint"], [131, 2, 1, "", "GetCkptIdFromFile"], [131, 2, 1, "", "GetDecodeOutPath"], [131, 2, 1, "", "Start"], [131, 2, 1, "", "_Loop"], [131, 2, 1, "", "_RemoveScalarSummaries"]], "lingvo.runners.Evaler": [[131, 2, 1, "", "EvalCheckpoint"], [131, 2, 1, "", "EvalLatestCheckpoint"], [131, 2, 1, "", "Start"], [131, 2, 1, "", "_EvalOnce"], [131, 2, 1, "", "_Loop"], [131, 2, 1, "", "_RemoveScalarSummaries"]], "lingvo.runners.Trainer": [[131, 2, 1, "", "Start"], [131, 2, 1, "", "StartEnqueueOp"], [131, 2, 1, "", "_Loop"], [131, 2, 1, "", "_LoopEnqueue"], [131, 2, 1, "", "_SummarizeValue"]], "lingvo.runners.TrainerTpu": [[131, 2, 1, "", "Start"], [131, 2, 1, "", "StartEnqueueOp"], [131, 2, 1, "", "_CleanUp"], [131, 2, 1, "", "_GetSession"], [131, 2, 1, "", "_InfeedLoop"], [131, 2, 1, "", "_Loop"], [131, 2, 1, "", "_LoopEnqueue"], [131, 2, 1, "", "_OutfeedDequeueLoop"], [131, 2, 1, "", "_OutfeedEnqueue"], [131, 2, 1, "", "_SummarizeValue"]], "lingvo.tasks": [[133, 0, 0, "-", "asr"], [153, 0, 0, "-", "image"], [159, 0, 0, "-", "lm"], [172, 0, 0, "-", "milan"], [192, 0, 0, "-", "mt"], [208, 0, 0, "-", "punctuator"]], "lingvo.tasks.asr": [[134, 0, 0, "-", "contextualizer_base"], [135, 0, 0, "-", "decoder"], [136, 0, 0, "-", "decoder_metrics"], [137, 0, 0, "-", "decoder_utils"], [138, 0, 0, "-", "encoder"], [139, 0, 0, "-", "eos_normalization"], [140, 0, 0, "-", "frontend"], [141, 0, 0, "-", "fusion"], [142, 0, 0, "-", "input_generator"], [143, 0, 0, "-", "levenshtein_distance"], [144, 0, 0, "-", "metrics_calculator"], [145, 0, 0, "-", "model"], [146, 0, 0, "-", "model_test_input_generator"], [147, 0, 0, "-", "params"], [150, 0, 0, "-", "tools"]], "lingvo.tasks.asr.contextualizer_base": [[134, 1, 1, "", "ContextualizerBase"], [134, 1, 1, "", "NullContextualizer"]], "lingvo.tasks.asr.contextualizer_base.ContextualizerBase": [[134, 2, 1, "", "GetContextDim"], [134, 2, 1, "", "InitAttention"], [134, 2, 1, "", "QueryAttention"], [134, 2, 1, "", "SetContextMap"], [134, 2, 1, "", "ZeroAttention"]], "lingvo.tasks.asr.contextualizer_base.NullContextualizer": [[134, 2, 1, "", "GetContextDim"], [134, 2, 1, "", "InitAttention"], [134, 2, 1, "", "QueryAttention"], [134, 2, 1, "", "SetContextMap"], [134, 2, 1, "", "ZeroAttention"]], "lingvo.tasks.asr.decoder": [[135, 1, 1, "", "AsrDecoder"], [135, 1, 1, "", "AsrDecoderBase"], [135, 6, 1, "", "_NewTensorArray"], [135, 6, 1, "", "_ToTensorArray"]], "lingvo.tasks.asr.decoder.AsrDecoder": [[135, 2, 1, "", "AddAdditionalDecoderSummaries"], [135, 2, 1, "", "Params"], [135, 2, 1, "", "SingleDecodeStep"], [135, 2, 1, "", "_ComputeAttention"], [135, 2, 1, "", "_GetNumHypsForBeamSearch"], [135, 2, 1, "", "_InitBeamSearchStateCallback"], [135, 2, 1, "", "_PostBeamSearchStepCallback"], [135, 2, 1, "", "_PostProcessAttenProbsForBeamSearch"], [135, 2, 1, "", "_PreBeamSearchStepCallback"]], "lingvo.tasks.asr.decoder.AsrDecoderBase": [[135, 2, 1, "", "AddAdditionalDecoderSummaries"], [135, 2, 1, "", "BaseZeroState"], [135, 2, 1, "", "ComputeLoss"], [135, 2, 1, "", "ComputePredictions"], [135, 2, 1, "", "ComputePredictionsDynamic"], [135, 2, 1, "", "ComputePredictionsFunctional"], [135, 2, 1, "", "CreateTargetInfoMisc"], [135, 2, 1, "", "DecoderStepZeroState"], [135, 2, 1, "", "InitDecoder"], [135, 2, 1, "", "MiscZeroState"], [135, 2, 1, "", "Params"], [135, 2, 1, "", "PostStepDecoderStateUpdate"], [135, 1, 1, "", "SequenceOutTensorArrays"], [135, 2, 1, "", "SingleDecodeStep"], [135, 1, 1, "", "TargetInfo"], [135, 2, 1, "", "TargetsToBeFedAtCurrentDecodeStep"], [135, 2, 1, "", "UpdateTargetVocabSize"], [135, 2, 1, "", "_AddDecoderActivationsSummary"], [135, 2, 1, "", "_ApplyDropout"], [135, 2, 1, "", "_ComputeLogits"], [135, 2, 1, "", "_ComputeMetrics"], [135, 2, 1, "", "_CreateAtten"], [135, 2, 1, "", "_ExtractConfidenceFeatures"], [135, 2, 1, "", "_GetAttenContextDim"], [135, 2, 1, "", "_GetAttenProbsFromSequenceOutTensorArrays"], [135, 2, 1, "", "_GetEncoderPaddings"], [135, 2, 1, "", "_GetInitialSeqStateTensorArrays"], [135, 2, 1, "", "_GetInitialTargetInfo"], [135, 2, 1, "", "_GetNewAttenProbs"], [135, 2, 1, "", "_GetPredictionFromSequenceOutTensorArrays"], [135, 2, 1, "", "_InitAttention"], [135, 2, 1, "", "_InitBeamSearchStateCallback"], [135, 2, 1, "", "_PostBeamSearchStepCallback"], [135, 2, 1, "", "_PreBeamSearchStepCallback"], [135, 2, 1, "", "_UpdateSequenceOutTensorArrays"]], "lingvo.tasks.asr.decoder.AsrDecoderBase.SequenceOutTensorArrays": [[135, 2, 1, "", "_asdict"], [135, 5, 1, "", "_field_defaults"], [135, 5, 1, "", "_fields"], [135, 2, 1, "", "_make"], [135, 2, 1, "", "_replace"], [135, 5, 1, "", "atten_probs"], [135, 5, 1, "", "confidence_logits"], [135, 5, 1, "", "fusion"], [135, 5, 1, "", "logits"], [135, 5, 1, "", "misc"], [135, 5, 1, "", "rnn_outs"], [135, 5, 1, "", "step_outs"]], "lingvo.tasks.asr.decoder.AsrDecoderBase.TargetInfo": [[135, 2, 1, "", "_asdict"], [135, 5, 1, "", "_field_defaults"], [135, 5, 1, "", "_fields"], [135, 2, 1, "", "_make"], [135, 2, 1, "", "_replace"], [135, 5, 1, "", "emb"], [135, 5, 1, "", "id"], [135, 5, 1, "", "label"], [135, 5, 1, "", "misc"], [135, 5, 1, "", "padding"], [135, 5, 1, "", "weight"]], "lingvo.tasks.asr.decoder_metrics": [[136, 6, 1, "", "BeamSearchDecodeOutputToDecoderTopK"], [136, 1, 1, "", "DecoderMetrics"], [136, 5, 1, "", "DecoderTopK"]], "lingvo.tasks.asr.decoder_metrics.DecoderMetrics": [[136, 2, 1, "", "AddAdditionalDecoderMetricsToGraph"], [136, 2, 1, "", "ComputeMetrics"], [136, 2, 1, "", "ComputeNormalizedWER"], [136, 2, 1, "", "CreateMetrics"], [136, 2, 1, "", "DeTokenizeTopkDecoded"], [136, 2, 1, "", "DeTokenizeTranscripts"], [136, 2, 1, "", "FilterRealExamples"], [136, 2, 1, "", "GetTopK"], [136, 2, 1, "", "Params"], [136, 2, 1, "", "PostProcess"], [136, 2, 1, "", "PreparePostProcess"]], "lingvo.tasks.asr.decoder_utils": [[137, 6, 1, "", "ComputeWer"], [137, 6, 1, "", "EditDistance"], [137, 6, 1, "", "EditDistanceInIds"], [137, 6, 1, "", "FilterEpsilon"], [137, 6, 1, "", "FilterNoise"], [137, 6, 1, "", "SetRnnCellNodes"], [137, 6, 1, "", "Tokenize"], [137, 6, 1, "", "_IsSymbolOrPositive"]], "lingvo.tasks.asr.encoder": [[138, 1, 1, "", "AsrEncoder"], [138, 1, 1, "", "ConvLSTMBlock"]], "lingvo.tasks.asr.encoder.AsrEncoder": [[138, 2, 1, "", "CreateBidirectionalRNNParams"], [138, 2, 1, "", "CreateConvLstmLayerParams"], [138, 2, 1, "", "FProp"], [138, 2, 1, "", "FirstLstmLayerInputDimAndPadding"], [138, 2, 1, "", "Params"], [138, 3, 1, "", "_use_functional"], [138, 3, 1, "", "input_shape"], [138, 3, 1, "", "supports_streaming"], [138, 2, 1, "", "zero_state"]], "lingvo.tasks.asr.encoder.ConvLSTMBlock": [[138, 2, 1, "", "_asdict"], [138, 5, 1, "", "_field_defaults"], [138, 5, 1, "", "_fields"], [138, 2, 1, "", "_make"], [138, 2, 1, "", "_replace"], [138, 5, 1, "", "cnn"], [138, 5, 1, "", "rnn"]], "lingvo.tasks.asr.eos_normalization": [[139, 6, 1, "", "FillPaddingPos"], [139, 6, 1, "", "NormalizeTrailingEos"], [139, 6, 1, "", "NumpyNormalizeTrailingEos"]], "lingvo.tasks.asr.frontend": [[140, 1, 1, "", "AsrFrontendConfig"], [140, 1, 1, "", "BaseAsrFrontend"], [140, 1, 1, "", "MelAsrFrontend"], [140, 1, 1, "", "NullAsrFrontend"], [140, 6, 1, "", "_NextPowerOfTwo"]], "lingvo.tasks.asr.frontend.AsrFrontendConfig": [[140, 2, 1, "", "_asdict"], [140, 5, 1, "", "_field_defaults"], [140, 5, 1, "", "_fields"], [140, 2, 1, "", "_make"], [140, 2, 1, "", "_replace"], [140, 5, 1, "", "input_frame_ratio"], [140, 5, 1, "", "is_null"], [140, 5, 1, "", "output_dim"], [140, 5, 1, "", "src_pcm_sample_rate"], [140, 5, 1, "", "src_pcm_scale"], [140, 5, 1, "", "src_type"]], "lingvo.tasks.asr.frontend.BaseAsrFrontend": [[140, 2, 1, "", "FProp"], [140, 2, 1, "", "GetConfigFromParams"], [140, 3, 1, "", "config"]], "lingvo.tasks.asr.frontend.MelAsrFrontend": [[140, 2, 1, "", "FProp"], [140, 2, 1, "", "GetConfigFromParams"], [140, 2, 1, "", "Params"], [140, 2, 1, "", "_ApplyPreemphasis"], [140, 2, 1, "", "_CreateWindowFunction"], [140, 2, 1, "", "_FPropChunk"], [140, 2, 1, "", "_FPropDefault"], [140, 2, 1, "", "_GetMelPadding"], [140, 2, 1, "", "_MelSpectrogram"], [140, 2, 1, "", "_PadAndReshapeSpec"], [140, 2, 1, "", "_RemoveChannelDim"], [140, 2, 1, "", "_ReshapeToMono2D"], [140, 2, 1, "", "_StackSignal"], [140, 3, 1, "", "window_frame_size"], [140, 3, 1, "", "window_frame_step"]], "lingvo.tasks.asr.frontend.NullAsrFrontend": [[140, 2, 1, "", "FProp"], [140, 2, 1, "", "GetConfigFromParams"]], "lingvo.tasks.asr.fusion": [[141, 1, 1, "", "FusionBase"], [141, 1, 1, "", "NullFusion"]], "lingvo.tasks.asr.fusion.FusionBase": [[141, 2, 1, "", "AddAdditionalDecoderSummaries"], [141, 2, 1, "", "ComputeLogitsWithLM"], [141, 2, 1, "", "FProp"], [141, 2, 1, "", "Params"], [141, 2, 1, "", "_FPropLm"], [141, 2, 1, "", "_FPropLmInternal"], [141, 2, 1, "", "_ModifyLmBeforeFProp"], [141, 2, 1, "", "_child_variable_scope_override"], [141, 2, 1, "", "zero_state"]], "lingvo.tasks.asr.fusion.NullFusion": [[141, 2, 1, "", "ComputeLogitsWithLM"], [141, 2, 1, "", "FProp"]], "lingvo.tasks.asr.input_generator": [[142, 1, 1, "", "AsrInput"]], "lingvo.tasks.asr.input_generator.AsrInput": [[142, 2, 1, "", "BuildInputBatch"], [142, 2, 1, "", "Params"], [142, 2, 1, "", "_DataSourceFromFilePattern"], [142, 2, 1, "", "_MaybePadSourceInputs"]], "lingvo.tasks.asr.levenshtein_distance": [[143, 1, 1, "", "ErrorStats"], [143, 6, 1, "", "LevenshteinDistance"]], "lingvo.tasks.asr.metrics_calculator": [[144, 6, 1, "", "CalculateMetrics"], [144, 6, 1, "", "GetRefIds"], [144, 5, 1, "", "PostProcessInputs"]], "lingvo.tasks.asr.model": [[145, 1, 1, "", "AsrModel"]], "lingvo.tasks.asr.model.AsrModel": [[145, 2, 1, "", "ComputeLoss"], [145, 2, 1, "", "ComputePredictions"], [145, 2, 1, "", "CreateDecoderMetrics"], [145, 2, 1, "", "DecodeWithTheta"], [145, 2, 1, "", "FrontendAndEncoderFProp"], [145, 2, 1, "", "Inference"], [145, 2, 1, "", "Params"], [145, 2, 1, "", "PostProcessDecodeOut"], [145, 2, 1, "", "ProgramSchedule"], [145, 2, 1, "", "_ComputeDecoderMetrics"], [145, 2, 1, "", "_ComputeNormalizedWER"], [145, 2, 1, "", "_DecoderMetricsParams"], [145, 2, 1, "", "_GetDecoderTargets"], [145, 2, 1, "", "_GetTargetForDecoderMetrics"], [145, 2, 1, "", "_GetTopK"], [145, 2, 1, "", "_InferenceSubgraph_Default"], [145, 2, 1, "", "_MakeDecoderTheta"]], "lingvo.tasks.asr.model_test_input_generator": [[146, 1, 1, "", "TestInputGenerator"]], "lingvo.tasks.asr.model_test_input_generator.TestInputGenerator": [[146, 2, 1, "", "GetBpropParams"], [146, 2, 1, "", "GetBpropType"], [146, 2, 1, "", "GlobalBatchSize"], [146, 2, 1, "", "Params"], [146, 2, 1, "", "SampleIds"], [146, 2, 1, "", "SetBpropType"], [146, 2, 1, "", "_GetSourceInputsAndLabels"], [146, 2, 1, "", "_InputBatch"], [146, 2, 1, "", "_Sources"], [146, 2, 1, "", "_Targets"], [146, 2, 1, "", "_check_paddings"]], "lingvo.tasks.asr.params": [[148, 0, 0, "-", "librispeech"], [149, 0, 0, "-", "params"]], "lingvo.tasks.asr.params.librispeech": [[148, 1, 1, "", "Librispeech960Base"], [148, 1, 1, "", "Librispeech960Grapheme"], [148, 1, 1, "", "Librispeech960GraphemeTpuV2"], [148, 1, 1, "", "Librispeech960Wpm"], [148, 1, 1, "", "Librispeech960WpmTpuV2"]], "lingvo.tasks.asr.params.librispeech.Librispeech960Base": [[148, 2, 1, "", "Dev"], [148, 2, 1, "", "Devother"], [148, 2, 1, "", "ProgramSchedule"], [148, 2, 1, "", "SetBucketSizes"], [148, 2, 1, "", "Task"], [148, 2, 1, "", "Test"], [148, 2, 1, "", "Testother"], [148, 2, 1, "", "Train"], [148, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.asr.params.librispeech.Librispeech960Grapheme": [[148, 2, 1, "", "Dev"], [148, 2, 1, "", "Devother"], [148, 5, 1, "", "GRAPHEME_TARGET_SEQUENCE_LENGTH"], [148, 5, 1, "", "GRAPHEME_VOCAB_SIZE"], [148, 2, 1, "", "InitializeTokenizer"], [148, 2, 1, "", "Task"], [148, 2, 1, "", "Test"], [148, 2, 1, "", "Testother"], [148, 2, 1, "", "Train"]], "lingvo.tasks.asr.params.librispeech.Librispeech960GraphemeTpuV2": [[148, 2, 1, "", "Task"], [148, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.asr.params.librispeech.Librispeech960Wpm": [[148, 2, 1, "", "Dev"], [148, 2, 1, "", "Devother"], [148, 5, 1, "", "EMBEDDING_DIMENSION"], [148, 2, 1, "", "InitializeTokenizer"], [148, 5, 1, "", "NUM_TRAINING_WORKERS"], [148, 2, 1, "", "Task"], [148, 2, 1, "", "Test"], [148, 2, 1, "", "Testother"], [148, 2, 1, "", "Train"], [148, 5, 1, "", "WPM_SYMBOL_TABLE_FILEPATH"], [148, 5, 1, "", "WPM_TARGET_SEQUENCE_LENGTH"], [148, 5, 1, "", "WPM_VOCAB_SIZE"]], "lingvo.tasks.asr.params.librispeech.Librispeech960WpmTpuV2": [[148, 2, 1, "", "Task"], [148, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.asr.tools": [[151, 0, 0, "-", "simple_wer"], [152, 0, 0, "-", "simple_wer_v2"]], "lingvo.tasks.asr.tools.simple_wer": [[151, 6, 1, "", "AverageWERs"], [151, 6, 1, "", "ComputeEditDistanceMatrix"], [151, 6, 1, "", "ComputeWER"], [151, 6, 1, "", "GenerateSummaryFromErrs"], [151, 6, 1, "", "PreprocessTxtBeforeWER"], [151, 6, 1, "", "_GenerateAlignedHtml"], [151, 6, 1, "", "main"]], "lingvo.tasks.asr.tools.simple_wer_v2": [[152, 6, 1, "", "ComputeEditDistanceMatrix"], [152, 6, 1, "", "HighlightAlignedHtml"], [152, 6, 1, "", "RemoveCommentTxtPreprocess"], [152, 1, 1, "", "SimpleWER"], [152, 6, 1, "", "TxtPreprocess"], [152, 6, 1, "", "main"]], "lingvo.tasks.asr.tools.simple_wer_v2.SimpleWER": [[152, 2, 1, "", "AddHypRef"], [152, 2, 1, "", "GetBreakdownWER"], [152, 2, 1, "", "GetKeyPhraseStats"], [152, 2, 1, "", "GetSummaries"], [152, 2, 1, "", "GetWER"], [152, 5, 1, "", "aligned_htmls"], [152, 5, 1, "", "hyp_keyphrase_counts"], [152, 5, 1, "", "key_phrases"], [152, 5, 1, "", "matched_keyphrase_counts"], [152, 5, 1, "", "ref_keyphrase_counts"], [152, 5, 1, "", "wer_info"]], "lingvo.tasks.image": [[154, 0, 0, "-", "classifier"], [155, 0, 0, "-", "input_generator"], [156, 0, 0, "-", "params"]], "lingvo.tasks.image.classifier": [[154, 1, 1, "", "BaseClassifier"], [154, 1, 1, "", "ModelV1"], [154, 1, 1, "", "ModelV2"], [154, 6, 1, "", "TopKAccuracy"]], "lingvo.tasks.image.classifier.BaseClassifier": [[154, 2, 1, "", "Params"], [154, 2, 1, "", "_Accuracy"], [154, 2, 1, "", "_AddSummary"]], "lingvo.tasks.image.classifier.ModelV1": [[154, 2, 1, "", "CreateDecoderMetrics"], [154, 2, 1, "", "Decode"], [154, 2, 1, "", "FPropTower"], [154, 2, 1, "", "Params"], [154, 2, 1, "", "PostProcessDecodeOut"]], "lingvo.tasks.image.classifier.ModelV2": [[154, 2, 1, "", "ComputeLoss"], [154, 2, 1, "", "ComputePredictions"], [154, 2, 1, "", "DecodeWithTheta"], [154, 2, 1, "", "Inference"], [154, 2, 1, "", "Params"], [154, 2, 1, "", "_InferenceSubgraph_Default"]], "lingvo.tasks.image.input_generator": [[155, 6, 1, "", "FakeMnistData"], [155, 1, 1, "", "MnistTestInput"], [155, 1, 1, "", "MnistTrainInput"], [155, 6, 1, "", "_GetRandomImages"], [155, 6, 1, "", "_GetRandomLabels"], [155, 1, 1, "", "_MnistInputBase"]], "lingvo.tasks.image.input_generator.MnistTestInput": [[155, 2, 1, "", "Params"]], "lingvo.tasks.image.input_generator.MnistTrainInput": [[155, 2, 1, "", "Params"]], "lingvo.tasks.image.input_generator._MnistInputBase": [[155, 2, 1, "", "Params"], [155, 2, 1, "", "_Preprocess"]], "lingvo.tasks.image.params": [[157, 0, 0, "-", "mnist"], [158, 0, 0, "-", "params"]], "lingvo.tasks.image.params.mnist": [[157, 1, 1, "", "Base"], [157, 1, 1, "", "LeNet5"]], "lingvo.tasks.image.params.mnist.Base": [[157, 2, 1, "", "Dev"], [157, 2, 1, "", "Test"], [157, 2, 1, "", "Train"], [157, 3, 1, "", "path"]], "lingvo.tasks.image.params.mnist.LeNet5": [[157, 5, 1, "", "BN"], [157, 5, 1, "", "DROP"], [157, 2, 1, "", "Task"]], "lingvo.tasks.lm": [[160, 0, 0, "-", "input_generator"], [161, 0, 0, "-", "layers"], [162, 0, 0, "-", "model"], [163, 0, 0, "-", "params"], [168, 0, 0, "-", "tokenizer"], [169, 0, 0, "-", "tools"]], "lingvo.tasks.lm.input_generator": [[160, 1, 1, "", "LmInput"], [160, 1, 1, "", "PackedTextInputGenerator"], [160, 1, 1, "", "TFRecordBertInput"]], "lingvo.tasks.lm.input_generator.LmInput": [[160, 2, 1, "", "BuildInputBatch"], [160, 2, 1, "", "Params"], [160, 2, 1, "", "_DataSourceFromFilePattern"]], "lingvo.tasks.lm.input_generator.PackedTextInputGenerator": [[160, 2, 1, "", "Initialize"], [160, 2, 1, "", "Params"], [160, 2, 1, "", "Reset"], [160, 2, 1, "", "_DatasetOfExamples"], [160, 2, 1, "", "_GetPaddingValues"], [160, 2, 1, "", "_InputBatch"], [160, 2, 1, "", "_Pack"], [160, 2, 1, "", "_ProcessSingleExample"]], "lingvo.tasks.lm.input_generator.TFRecordBertInput": [[160, 2, 1, "", "Initialize"], [160, 2, 1, "", "Params"], [160, 2, 1, "", "Reset"], [160, 2, 1, "", "_InputBatch"], [160, 2, 1, "", "_Pack"], [160, 2, 1, "", "_PadToBatchSize"], [160, 2, 1, "", "_ParseRecord"]], "lingvo.tasks.lm.layers": [[161, 1, 1, "", "BaseLanguageModel"], [161, 6, 1, "", "ComputeXentOutput"], [161, 1, 1, "", "ConditionalRnnLm"], [161, 1, 1, "", "GPipeTransformerLm"], [161, 1, 1, "", "MoeLm"], [161, 1, 1, "", "NullLm"], [161, 1, 1, "", "RnnLm"], [161, 1, 1, "", "RnnLmNoEmbedding"], [161, 1, 1, "", "TransformerLm"], [161, 1, 1, "", "TransformerLmNoEmbedding"], [161, 6, 1, "", "_RnnOutputSize"]], "lingvo.tasks.lm.layers.BaseLanguageModel": [[161, 2, 1, "", "CombineStates"], [161, 2, 1, "", "FProp"], [161, 2, 1, "", "GetFeedDict"], [161, 2, 1, "", "Logits"], [161, 2, 1, "", "Params"], [161, 2, 1, "", "Step"], [161, 2, 1, "", "StepOutputDimension"], [161, 2, 1, "", "UpdateTargetVocabSize"], [161, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.layers.ConditionalRnnLm": [[161, 2, 1, "", "FProp"], [161, 2, 1, "", "Params"]], "lingvo.tasks.lm.layers.GPipeTransformerLm": [[161, 2, 1, "", "CommonParams"], [161, 2, 1, "", "FProp"], [161, 2, 1, "", "Params"], [161, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.layers.MoeLm": [[161, 2, 1, "", "FProp"], [161, 2, 1, "", "Params"], [161, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.layers.NullLm": [[161, 2, 1, "", "CombineStates"], [161, 2, 1, "", "FProp"], [161, 2, 1, "", "Logits"], [161, 2, 1, "", "Step"], [161, 2, 1, "", "StepOutputDimension"], [161, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.layers.RnnLm": [[161, 2, 1, "", "CommonParams"], [161, 2, 1, "", "FProp"], [161, 2, 1, "", "Params"], [161, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.layers.RnnLmNoEmbedding": [[161, 2, 1, "", "CombineStates"], [161, 2, 1, "", "FProp"], [161, 2, 1, "", "Params"], [161, 2, 1, "", "Step"], [161, 2, 1, "", "StepOutputDimension"], [161, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.layers.TransformerLm": [[161, 2, 1, "", "CommonParams"], [161, 2, 1, "", "FProp"], [161, 2, 1, "", "Params"]], "lingvo.tasks.lm.layers.TransformerLmNoEmbedding": [[161, 2, 1, "", "FProp"], [161, 2, 1, "", "Params"], [161, 2, 1, "", "Step"], [161, 2, 1, "", "StepOutputDimension"], [161, 2, 1, "", "zero_state"]], "lingvo.tasks.lm.model": [[162, 1, 1, "", "BatchMajorLanguageModel"], [162, 1, 1, "", "FixedShapeInputLanguageModel"], [162, 1, 1, "", "LanguageModel"], [162, 1, 1, "", "PackedBatchMajorLanguageModel"]], "lingvo.tasks.lm.model.BatchMajorLanguageModel": [[162, 2, 1, "", "FPropTower"], [162, 2, 1, "", "_InferenceSubgraph_Default"], [162, 2, 1, "", "_TrimIfPossible"]], "lingvo.tasks.lm.model.FixedShapeInputLanguageModel": [[162, 2, 1, "", "_TrimIfPossibleThenTranspose"]], "lingvo.tasks.lm.model.LanguageModel": [[162, 2, 1, "", "AdjustGradients"], [162, 2, 1, "", "ComputeLoss"], [162, 2, 1, "", "ComputePredictions"], [162, 2, 1, "", "FPropTower"], [162, 2, 1, "", "Inference"], [162, 2, 1, "", "Params"], [162, 2, 1, "", "UpdateTargetVocabSize"], [162, 2, 1, "", "_InferenceSubgraph_Default"], [162, 2, 1, "", "_TrimIfPossibleThenTranspose"]], "lingvo.tasks.lm.model.PackedBatchMajorLanguageModel": [[162, 2, 1, "", "FPropTower"], [162, 2, 1, "", "Inference"], [162, 2, 1, "", "Params"], [162, 2, 1, "", "_InferenceSubgraph_Default"]], "lingvo.tasks.lm.params": [[164, 0, 0, "-", "one_billion_wds"], [165, 0, 0, "-", "params"], [166, 0, 0, "-", "synthetic_packed_input"], [167, 0, 0, "-", "wiki_bert"]], "lingvo.tasks.lm.params.one_billion_wds": [[164, 1, 1, "", "OneBWdsGPipeTransformerWPM"], [164, 1, 1, "", "WordLevelOneBwdsBase"], [164, 1, 1, "", "WordLevelOneBwdsSimpleSampledSoftmax"], [164, 1, 1, "", "WordLevelOneBwdsSimpleSampledSoftmaxTiny"]], "lingvo.tasks.lm.params.one_billion_wds.OneBWdsGPipeTransformerWPM": [[164, 5, 1, "", "BATCH_SIZE"], [164, 2, 1, "", "Dev"], [164, 5, 1, "", "EMBEDDING_DIM"], [164, 5, 1, "", "GPUS"], [164, 5, 1, "", "LAYERS"], [164, 5, 1, "", "MAX_TOKENS"], [164, 5, 1, "", "NUM_MICRO_BATCHES"], [164, 5, 1, "", "SPLITS"], [164, 2, 1, "", "Task"], [164, 2, 1, "", "Test"], [164, 2, 1, "", "Train"], [164, 5, 1, "", "VOCAB_SIZE"]], "lingvo.tasks.lm.params.one_billion_wds.WordLevelOneBwdsBase": [[164, 5, 1, "", "CORPUS_DIR"], [164, 2, 1, "", "Dev"], [164, 5, 1, "", "EMBEDDING_DIM"], [164, 5, 1, "", "MAX_TOKENS"], [164, 5, 1, "", "NUM_EMBEDDING_SHARDS"], [164, 5, 1, "", "NUM_SAMPLED"], [164, 5, 1, "", "NUM_SOFTMAX_SHARDS"], [164, 5, 1, "", "RNN_STATE_DIM"], [164, 2, 1, "", "Task"], [164, 2, 1, "", "Test"], [164, 2, 1, "", "Train"], [164, 5, 1, "", "VOCAB_SIZE"], [164, 5, 1, "", "WORD_VOCAB"]], "lingvo.tasks.lm.params.one_billion_wds.WordLevelOneBwdsSimpleSampledSoftmax": [[164, 2, 1, "", "Task"]], "lingvo.tasks.lm.params.one_billion_wds.WordLevelOneBwdsSimpleSampledSoftmaxTiny": [[164, 5, 1, "", "EMBEDDING_DIM"], [164, 5, 1, "", "MAX_TOKENS"], [164, 5, 1, "", "NUM_EMBEDDING_SHARDS"], [164, 5, 1, "", "NUM_SAMPLED"], [164, 5, 1, "", "NUM_SOFTMAX_SHARDS"], [164, 5, 1, "", "RNN_STATE_DIM"]], "lingvo.tasks.lm.params.synthetic_packed_input": [[166, 1, 1, "", "DenseLM13B32x32"], [166, 1, 1, "", "DenseLm128B16x16"], [166, 1, 1, "", "DenseLm128B32x32"], [166, 1, 1, "", "DenseLm128B8x8"], [166, 1, 1, "", "DenseLm12kWide162BAdam16x16"], [166, 1, 1, "", "DenseLm12kWide162BAdam32x32"], [166, 1, 1, "", "DenseLm12kWide162BAdamBS25616x16"], [166, 1, 1, "", "DenseLm12kWide41BAdam16x16"], [166, 1, 1, "", "DenseLm12kWide41BAdam8x8"], [166, 1, 1, "", "DenseLm175B1K"], [166, 1, 1, "", "DenseLm175B32x32"], [166, 1, 1, "", "DenseLm175B32x32DP"], [166, 1, 1, "", "DenseLm175B8x8Decode2D"], [166, 1, 1, "", "DenseLm1T16x16"], [166, 1, 1, "", "DenseLm8B2x2"], [166, 1, 1, "", "DenseLm8B2x2Decode"], [166, 1, 1, "", "DenseLmTemplate"], [166, 1, 1, "", "ShardedAdam"], [166, 1, 1, "", "ShardedAdamOptimizer"], [166, 1, 1, "", "SyntheticTrain"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLM13B32x32": [[166, 5, 1, "", "HIDDEN_DIM"], [166, 5, 1, "", "MODEL_DIM"], [166, 5, 1, "", "NUM_HEADS"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm128B16x16": [[166, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [166, 5, 1, "", "SEQUENCE_LENGTH"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm128B32x32": [[166, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [166, 5, 1, "", "SEQUENCE_LENGTH"], [166, 5, 1, "", "TRAIN_STEPS_PER_LOOP"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm128B8x8": [[166, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [166, 5, 1, "", "SEQUENCE_LENGTH"], [166, 2, 1, "", "Task"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm12kWide162BAdam16x16": [[166, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm12kWide162BAdam32x32": [[166, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [166, 5, 1, "", "TRAIN_STEPS_PER_LOOP"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm12kWide162BAdamBS25616x16": [[166, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [166, 5, 1, "", "NUM_MICRO_BATCHES"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm12kWide41BAdam16x16": [[166, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [166, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "GATED_GELU"], [166, 5, 1, "", "HIDDEN_DIM"], [166, 5, 1, "", "MODEL_DIM"], [166, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [166, 5, 1, "", "NUM_HEADS"], [166, 5, 1, "", "NUM_MICRO_BATCHES"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [166, 5, 1, "", "POSITIONAL_EMBEDDING"], [166, 5, 1, "", "SEQUENCE_LENGTH"], [166, 2, 1, "", "Task"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm12kWide41BAdam8x8": [[166, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [166, 5, 1, "", "NUM_MICRO_BATCHES"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm175B1K": [[166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm175B32x32": [[166, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [166, 5, 1, "", "ATTEN_LOGIT_CAP"], [166, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "GATED_GELU"], [166, 5, 1, "", "HIDDEN_DIM"], [166, 5, 1, "", "MODEL_DIM"], [166, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [166, 5, 1, "", "NUM_HEADS"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [166, 5, 1, "", "POSITIONAL_EMBEDDING"], [166, 5, 1, "", "SEQUENCE_LENGTH"], [166, 5, 1, "", "USE_REPEAT_LAYER"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm175B32x32DP": [[166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"], [166, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [166, 5, 1, "", "TRAIN_STEPS_PER_LOOP"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm175B8x8Decode2D": [[166, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [166, 2, 1, "", "Task"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm1T16x16": [[166, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [166, 5, 1, "", "HIDDEN_DIM"], [166, 5, 1, "", "MODEL_DIM"], [166, 5, 1, "", "NUM_HEADS"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [166, 5, 1, "", "SEQUENCE_LENGTH"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm8B2x2": [[166, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [166, 5, 1, "", "SEQUENCE_LENGTH"], [166, 2, 1, "", "Task"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLm8B2x2Decode": [[166, 2, 1, "", "Task"]], "lingvo.tasks.lm.params.synthetic_packed_input.DenseLmTemplate": [[166, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [166, 5, 1, "", "ATTEN_LOGIT_CAP"], [166, 5, 1, "", "BATCH_DIM_PER_DEVICE"], [166, 5, 1, "", "DEBUG"], [166, 5, 1, "", "DEVICE_MESH"], [166, 5, 1, "", "DEVICE_MESH_SHAPE"], [166, 5, 1, "", "GATED_GELU"], [166, 5, 1, "", "HIDDEN_DIM"], [166, 5, 1, "", "LABEL_SMOOTHING"], [166, 5, 1, "", "MODEL_DIM"], [166, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"], [166, 5, 1, "", "NUM_DEVICES_PER_SPLIT"], [166, 5, 1, "", "NUM_HEADS"], [166, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [166, 5, 1, "", "POSITIONAL_EMBEDDING"], [166, 2, 1, "", "ProgramSchedule"], [166, 5, 1, "", "SEQUENCE_LENGTH"], [166, 5, 1, "", "TRAIN_STEPS_PER_LOOP"], [166, 2, 1, "", "Task"], [166, 2, 1, "", "Train"], [166, 5, 1, "", "USE_REPEAT_LAYER"], [166, 5, 1, "", "VOCAB_SIZE"]], "lingvo.tasks.lm.params.synthetic_packed_input.ShardedAdam": [[166, 2, 1, "", "GetOptimizer"], [166, 2, 1, "", "Params"]], "lingvo.tasks.lm.params.synthetic_packed_input.ShardedAdamOptimizer": [[166, 2, 1, "", "_create_slots"]], "lingvo.tasks.lm.params.synthetic_packed_input.SyntheticTrain": [[166, 2, 1, "", "Params"], [166, 2, 1, "", "_InputBatch"]], "lingvo.tasks.lm.params.wiki_bert": [[167, 1, 1, "", "BertTemplate"], [167, 1, 1, "", "MLPerfBertDense13B32x32"], [167, 1, 1, "", "MLPerfBertDense175B"], [167, 1, 1, "", "MLPerfBertDense1T"], [167, 1, 1, "", "MLPerfBertDense1TWider"], [167, 1, 1, "", "MLPerfBertDense500B"], [167, 1, 1, "", "MLPerfBertDense500B2K"], [167, 1, 1, "", "MLPerfTrainBertDense2B"], [167, 1, 1, "", "MLPerfTrainTemplate"]], "lingvo.tasks.lm.params.wiki_bert.BertTemplate": [[167, 5, 1, "", "ATTENTION_DROPOUT_RATE"], [167, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [167, 5, 1, "", "ATTEN_LOGIT_CAP"], [167, 5, 1, "", "BATCH_SIZE"], [167, 5, 1, "", "BETA1"], [167, 5, 1, "", "DEBUG"], [167, 5, 1, "", "DEVICE_MESH"], [167, 5, 1, "", "DEVICE_MESH_SHAPE"], [167, 5, 1, "", "DROPOUT_RATE"], [167, 5, 1, "", "GATED_FFN_ACT"], [167, 5, 1, "", "HIDDEN_DIM"], [167, 5, 1, "", "LABEL_SMOOTHING"], [167, 5, 1, "", "LOSS_DENOMINATOR"], [167, 5, 1, "", "MODEL_DIM"], [167, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"], [167, 5, 1, "", "NUM_HEADS"], [167, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [167, 5, 1, "", "POSITIONAL_EMBEDDING"], [167, 5, 1, "", "SEQUENCE_LENGTH"], [167, 5, 1, "", "TRAIN_EXES_PER_EVAL"], [167, 5, 1, "", "TRAIN_STEPS_PER_LOOP"], [167, 2, 1, "", "Task"], [167, 5, 1, "", "USE_REPEAT_LAYER"], [167, 5, 1, "", "VOCAB_SIZE"], [167, 5, 1, "", "WARMUP_STEPS"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfBertDense13B32x32": [[167, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [167, 5, 1, "", "BATCH_SIZE"], [167, 5, 1, "", "DEVICE_MESH"], [167, 5, 1, "", "DEVICE_MESH_SHAPE"], [167, 5, 1, "", "GATED_GELU"], [167, 5, 1, "", "HIDDEN_DIM"], [167, 5, 1, "", "HIDDEN_DIM_RESHAPE_SEGMENTS"], [167, 5, 1, "", "LABEL_SMOOTHING"], [167, 5, 1, "", "MODEL_DIM"], [167, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"], [167, 5, 1, "", "NUM_HEADS"], [167, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [167, 5, 1, "", "POSITIONAL_EMBEDDING"], [167, 5, 1, "", "REMOVE_MASK"], [167, 5, 1, "", "TRAIN_EXES_PER_EVAL"], [167, 5, 1, "", "TRAIN_STEPS_PER_LOOP"], [167, 5, 1, "", "USE_REPEAT_LAYER"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfBertDense175B": [[167, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [167, 5, 1, "", "BATCH_SIZE"], [167, 5, 1, "", "HIDDEN_DIM"], [167, 5, 1, "", "MODEL_DIM"], [167, 5, 1, "", "NUM_HEADS"], [167, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [167, 5, 1, "", "POSITIONAL_EMBEDDING"], [167, 5, 1, "", "TRAIN_STEPS_PER_LOOP"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfBertDense1T": [[167, 5, 1, "", "BATCH_SIZE"], [167, 5, 1, "", "DEVICE_MESH"], [167, 5, 1, "", "DEVICE_MESH_SHAPE"], [167, 5, 1, "", "HIDDEN_DIM"], [167, 5, 1, "", "HIDDEN_DIM_RESHAPE_SEGMENTS"], [167, 5, 1, "", "MODEL_DIM"], [167, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"], [167, 5, 1, "", "NUM_HEADS"], [167, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [167, 5, 1, "", "USE_REPEAT_LAYER"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfBertDense1TWider": [[167, 5, 1, "", "BATCH_SIZE"], [167, 5, 1, "", "HIDDEN_DIM"], [167, 5, 1, "", "MODEL_DIM"], [167, 5, 1, "", "NUM_TRANSFORMER_LAYERS"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfBertDense500B": [[167, 5, 1, "", "BATCH_SIZE"], [167, 5, 1, "", "LABEL_SMOOTHING"], [167, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [167, 5, 1, "", "POSITIONAL_EMBEDDING"], [167, 5, 1, "", "REMOVE_MASK"], [167, 5, 1, "", "TRAIN_EXES_PER_EVAL"], [167, 5, 1, "", "TRAIN_STEPS_PER_LOOP"], [167, 5, 1, "", "VOCAB_SIZE"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfBertDense500B2K": [[167, 5, 1, "", "DEVICE_MESH"], [167, 5, 1, "", "DEVICE_MESH_SHAPE"], [167, 5, 1, "", "HIDDEN_DIM_RESHAPE_SEGMENTS"], [167, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfTrainBertDense2B": [[167, 5, 1, "", "ATTENTION_KEY_VALUE_DIM"], [167, 5, 1, "", "BATCH_SIZE"], [167, 5, 1, "", "DEVICE_MESH"], [167, 5, 1, "", "DEVICE_MESH_SHAPE"], [167, 5, 1, "", "HIDDEN_DIM"], [167, 5, 1, "", "MODEL_DIM"], [167, 5, 1, "", "MODEL_DIM_RESHAPE_SEGMENTS"], [167, 5, 1, "", "NUM_HEADS"], [167, 5, 1, "", "NUM_TRANSFORMER_LAYERS"], [167, 5, 1, "", "USE_REPEAT_LAYER"], [167, 5, 1, "", "VOCAB_SIZE"]], "lingvo.tasks.lm.params.wiki_bert.MLPerfTrainTemplate": [[167, 2, 1, "", "ProgramSchedule"], [167, 2, 1, "", "Task"], [167, 2, 1, "", "Test"], [167, 2, 1, "", "Train"]], "lingvo.tasks.lm.tokenizer": [[168, 1, 1, "", "BertTokenizer"]], "lingvo.tasks.lm.tokenizer.BertTokenizer": [[168, 2, 1, "", "IdsToStrings"], [168, 2, 1, "", "Params"], [168, 2, 1, "", "_StringsToIdsImpl"]], "lingvo.tasks.lm.tools": [[170, 0, 0, "-", "download_lm1b"], [171, 0, 0, "-", "gshard_lm_decode"]], "lingvo.tasks.lm.tools.download_lm1b": [[170, 6, 1, "", "main"]], "lingvo.tasks.lm.tools.gshard_lm_decode": [[171, 1, 1, "", "GShardLMDecode"], [171, 1, 1, "", "GShardLMDecodeBatch"], [171, 6, 1, "", "main"], [171, 6, 1, "", "override_flags"], [171, 6, 1, "", "read_file_1_col"], [171, 6, 1, "", "read_files_1_col"]], "lingvo.tasks.lm.tools.gshard_lm_decode.GShardLMDecode": [[171, 2, 1, "", "decode_ids_to_string"], [171, 2, 1, "", "encode_string_to_ids"], [171, 2, 1, "", "ids_to_strings_packed"], [171, 2, 1, "", "init_vocab"], [171, 2, 1, "", "preload_lm_prompts"]], "lingvo.tasks.lm.tools.gshard_lm_decode.GShardLMDecodeBatch": [[171, 2, 1, "", "batch_decode"], [171, 2, 1, "", "preload_data"], [171, 2, 1, "", "write_ith_sample_to_output"]], "lingvo.tasks.milan": [[173, 0, 0, "-", "common_schema"], [174, 0, 0, "-", "constants"], [175, 0, 0, "-", "dataset_spec"], [176, 0, 0, "-", "dual_encoder"], [177, 0, 0, "-", "image_preprocessor"], [178, 0, 0, "-", "input_generator"], [179, 0, 0, "-", "labels"], [180, 0, 0, "-", "params"], [185, 0, 0, "-", "score_functions"], [186, 0, 0, "-", "tf_hub_layers"], [187, 0, 0, "-", "tools"], [189, 0, 0, "-", "tpu_utils"], [190, 0, 0, "-", "transformers"], [191, 0, 0, "-", "utils"]], "lingvo.tasks.milan.common_schema": [[173, 6, 1, "", "AudioFeatures"], [173, 6, 1, "", "ImageFeatures"], [173, 6, 1, "", "TextFeatures"], [173, 6, 1, "", "_Feature"]], "lingvo.tasks.milan.constants": [[174, 1, 1, "", "Modality"], [174, 1, 1, "", "Split"]], "lingvo.tasks.milan.constants.Modality": [[174, 5, 1, "", "AUDIO"], [174, 5, 1, "", "IMAGE"], [174, 5, 1, "", "TEXT"]], "lingvo.tasks.milan.constants.Split": [[174, 5, 1, "", "DEV"], [174, 5, 1, "", "TEST"], [174, 5, 1, "", "TRAIN"]], "lingvo.tasks.milan.dataset_spec": [[175, 1, 1, "", "DatasetSpec"], [175, 1, 1, "", "FileBasedDatasetSpec"], [175, 1, 1, "", "Metadata"], [175, 1, 1, "", "TFRecordDatasetSpec"]], "lingvo.tasks.milan.dataset_spec.DatasetSpec": [[175, 2, 1, "", "Label"], [175, 2, 1, "", "Read"], [175, 5, 1, "", "_abc_impl"], [175, 3, 1, "", "meta"]], "lingvo.tasks.milan.dataset_spec.FileBasedDatasetSpec": [[175, 2, 1, "", "Label"], [175, 2, 1, "", "Read"], [175, 5, 1, "", "_abc_impl"], [175, 3, 1, "", "meta"]], "lingvo.tasks.milan.dataset_spec.Metadata": [[175, 2, 1, "", "_InferDefaultBatchShapes"], [175, 5, 1, "", "features"]], "lingvo.tasks.milan.dataset_spec.TFRecordDatasetSpec": [[175, 5, 1, "", "_abc_impl"]], "lingvo.tasks.milan.dual_encoder": [[176, 1, 1, "", "DualEncoder"], [176, 6, 1, "", "EncoderConfig"], [176, 1, 1, "", "MilanTask"], [176, 6, 1, "", "_EncodeBatch"]], "lingvo.tasks.milan.dual_encoder.DualEncoder": [[176, 2, 1, "", "ComputeLoss"], [176, 2, 1, "", "ComputePredictions"], [176, 2, 1, "", "EncodeModality"], [176, 2, 1, "", "Params"], [176, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.milan.dual_encoder.MilanTask": [[176, 2, 1, "", "ComputeLoss"], [176, 2, 1, "", "ComputePredictions"], [176, 2, 1, "", "CreateDecoderMetrics"], [176, 2, 1, "", "Decode"], [176, 2, 1, "", "Params"]], "lingvo.tasks.milan.image_preprocessor": [[177, 1, 1, "", "ImagePreprocessor"], [177, 6, 1, "", "_DistortBrightnessAndColor"]], "lingvo.tasks.milan.image_preprocessor.ImagePreprocessor": [[177, 2, 1, "", "FProp"], [177, 2, 1, "", "Params"], [177, 2, 1, "", "_PreprocessForEval"], [177, 2, 1, "", "_PreprocessForTraining"]], "lingvo.tasks.milan.input_generator": [[178, 1, 1, "", "MilanInputGenerator"]], "lingvo.tasks.milan.input_generator.MilanInputGenerator": [[178, 2, 1, "", "GetPreprocessedInputBatch"], [178, 2, 1, "", "Params"], [178, 2, 1, "", "_FilterFeaturesByName"], [178, 2, 1, "", "_PreprocessInputBatch"]], "lingvo.tasks.milan.labels": [[179, 1, 1, "", "ExamplePairLabeler"], [179, 1, 1, "", "ExamplePairs"], [179, 1, 1, "", "MultiItemExampleWrapper"], [179, 6, 1, "", "MultiLabelContrastiveLoss"], [179, 6, 1, "", "_BroadcastExamplePairLabelsToAllItemPairs"], [179, 6, 1, "", "_IgnorePairsWhere"]], "lingvo.tasks.milan.labels.ExamplePairs": [[179, 2, 1, "", "BetweenLocalAndGlobalBatches"], [179, 2, 1, "", "WithinBatch"], [179, 5, 1, "", "correspondences"], [179, 5, 1, "", "query_batch_size"], [179, 5, 1, "", "query_modality"], [179, 5, 1, "", "result_batch_size"], [179, 5, 1, "", "result_modality"]], "lingvo.tasks.milan.params": [[181, 0, 0, "-", "cxc"], [182, 0, 0, "-", "dual_encoder_recipe"], [183, 0, 0, "-", "generic_datasets"], [184, 0, 0, "-", "params"]], "lingvo.tasks.milan.params.cxc": [[181, 1, 1, "", "EfficientNetB4BertAdapter"], [181, 1, 1, "", "_BaseImageTextRecipe"]], "lingvo.tasks.milan.params.cxc.EfficientNetB4BertAdapter": [[181, 3, 1, "", "default_dataset"]], "lingvo.tasks.milan.params.cxc._BaseImageTextRecipe": [[181, 2, 1, "", "AddBertAdapterTextEncoder"], [181, 2, 1, "", "AddEfficientNetB4ImageEncoder"]], "lingvo.tasks.milan.params.dual_encoder_recipe": [[182, 1, 1, "", "DualEncoderRecipe"], [182, 4, 1, "", "RecipeError"]], "lingvo.tasks.milan.params.dual_encoder_recipe.DualEncoderRecipe": [[182, 2, 1, "", "AddModality"], [182, 2, 1, "", "AddPreprocessor"], [182, 2, 1, "", "GetAllDatasetParams"], [182, 2, 1, "", "StartFromCheckpoint"], [182, 2, 1, "", "Task"], [182, 2, 1, "", "_ChooseDatasetSpec"], [182, 3, 1, "", "default_dataset"], [182, 3, 1, "", "encoder_configs"]], "lingvo.tasks.milan.params.generic_datasets": [[183, 1, 1, "", "ImageTextTFRecords"], [183, 6, 1, "", "_SimpleImageCaptionDatasetLabeler"]], "lingvo.tasks.milan.params.generic_datasets.ImageTextTFRecords": [[183, 2, 1, "", "Params"], [183, 2, 1, "", "ParamsFromEnv"], [183, 5, 1, "", "_abc_impl"]], "lingvo.tasks.milan.score_functions": [[185, 1, 1, "", "DotProductScoreFunction"]], "lingvo.tasks.milan.score_functions.DotProductScoreFunction": [[185, 2, 1, "", "FProp"], [185, 2, 1, "", "Params"]], "lingvo.tasks.milan.tf_hub_layers": [[186, 6, 1, "", "EfficientNetB4Params"], [186, 1, 1, "", "ImageModule"], [186, 1, 1, "", "ImageModuleV2"], [186, 6, 1, "", "_AddUpdateOpsToSignature"], [186, 6, 1, "", "_WrapNonLingvoVars"]], "lingvo.tasks.milan.tf_hub_layers.ImageModule": [[186, 2, 1, "", "FProp"], [186, 2, 1, "", "Params"], [186, 2, 1, "", "_CreateLayerVariables"], [186, 3, 1, "", "losses"]], "lingvo.tasks.milan.tf_hub_layers.ImageModuleV2": [[186, 2, 1, "", "FProp"], [186, 2, 1, "", "Params"], [186, 3, 1, "", "losses"]], "lingvo.tasks.milan.tools": [[188, 0, 0, "-", "prepare_coco"]], "lingvo.tasks.milan.tools.prepare_coco": [[188, 1, 1, "", "EncodeCaptionsFn"], [188, 1, 1, "", "ReadCocoFromTfdsFn"], [188, 1, 1, "", "TfHubBertEncoder"], [188, 6, 1, "", "dict_to_example_proto"], [188, 6, 1, "", "log"], [188, 6, 1, "", "main"]], "lingvo.tasks.milan.tools.prepare_coco.EncodeCaptionsFn": [[188, 2, 1, "", "process"], [188, 2, 1, "", "setup"]], "lingvo.tasks.milan.tools.prepare_coco.ReadCocoFromTfdsFn": [[188, 2, 1, "", "process"]], "lingvo.tasks.milan.tools.prepare_coco.TfHubBertEncoder": [[188, 2, 1, "", "FProp"], [188, 2, 1, "", "Params"]], "lingvo.tasks.milan.tpu_utils": [[189, 6, 1, "", "ConcatenateAcrossReplicas"], [189, 6, 1, "", "CrossReplicaConcat"]], "lingvo.tasks.milan.transformers": [[190, 6, 1, "", "GetTransformerStackWithEmbeddingInput"]], "lingvo.tasks.milan.utils": [[191, 1, 1, "", "BatchFlattener"], [191, 6, 1, "", "BatchMajorToTimeMajor"], [191, 6, 1, "", "CollectRegularizationLosses"], [191, 6, 1, "", "FlattenBatch"], [191, 6, 1, "", "GetFromNestedMapOrDie"], [191, 6, 1, "", "InferBatchSize"], [191, 6, 1, "", "MakeFnLayer"], [191, 6, 1, "", "PadOrTrimDimension"], [191, 6, 1, "", "ResolveBatchDim"], [191, 1, 1, "", "Selector"], [191, 6, 1, "", "UnflattenBatch"]], "lingvo.tasks.milan.utils.BatchFlattener": [[191, 2, 1, "", "Flatten"], [191, 2, 1, "", "Unflatten"], [191, 2, 1, "", "_GetFlatShape"], [191, 2, 1, "", "_PackAs"], [191, 3, 1, "", "batch_shape"]], "lingvo.tasks.mt": [[193, 0, 0, "-", "base_config"], [194, 0, 0, "-", "data_augmenter"], [195, 0, 0, "-", "decoder"], [196, 0, 0, "-", "encoder"], [197, 0, 0, "-", "input_generator"], [198, 0, 0, "-", "layers"], [199, 0, 0, "-", "model"], [200, 0, 0, "-", "params"], [206, 0, 0, "-", "text_input_pb2"], [207, 0, 0, "-", "tools"]], "lingvo.tasks.mt.base_config": [[193, 6, 1, "", "InitTestDatasetParams"], [193, 6, 1, "", "InitTrainDatasetParams"], [193, 6, 1, "", "InitTransformerTestBuckets"], [193, 6, 1, "", "InitTransformerTrainBuckets"], [193, 6, 1, "", "SetupRNMTParams"], [193, 6, 1, "", "SetupTransformerDecoder"], [193, 6, 1, "", "SetupTransformerEncoder"], [193, 6, 1, "", "SetupTransformerParams"], [193, 6, 1, "", "SetupXEnDecTransformerParams"]], "lingvo.tasks.mt.data_augmenter": [[194, 1, 1, "", "MASS"]], "lingvo.tasks.mt.data_augmenter.MASS": [[194, 2, 1, "", "Mask"], [194, 2, 1, "", "Params"]], "lingvo.tasks.mt.decoder": [[195, 1, 1, "", "InsertionDecoder"], [195, 1, 1, "", "MTBaseDecoder"], [195, 1, 1, "", "MTDecoderV1"], [195, 1, 1, "", "TransformerBatchMajorDecoder"], [195, 1, 1, "", "TransformerDecoder"], [195, 1, 1, "", "TransformerXDecoder"]], "lingvo.tasks.mt.decoder.InsertionDecoder": [[195, 2, 1, "", "ComputeLoss"], [195, 2, 1, "", "ComputePredictions"], [195, 2, 1, "", "Params"], [195, 2, 1, "", "UpdateTargetVocabSize"]], "lingvo.tasks.mt.decoder.MTBaseDecoder": [[195, 2, 1, "", "ComputeLoss"], [195, 2, 1, "", "Params"], [195, 2, 1, "", "UpdateTargetVocabSize"], [195, 2, 1, "", "_AddAttenProbsHistogramSummary"], [195, 2, 1, "", "_AddAttenProbsImageSummary"], [195, 2, 1, "", "_AddAttenProbsSummary"], [195, 2, 1, "", "_ComputeSoftmaxMetrics"], [195, 2, 1, "", "_ComputeXentLoss"], [195, 2, 1, "", "_ExpandToNumHyps"], [195, 2, 1, "", "_FPropSoftmax"], [195, 2, 1, "", "_TruncateTargetSequence"]], "lingvo.tasks.mt.decoder.MTDecoderV1": [[195, 2, 1, "", "AddExtraDecodingInfo"], [195, 2, 1, "", "ApplyClipping"], [195, 2, 1, "", "ApplyDropout"], [195, 2, 1, "", "ComputePredictions"], [195, 2, 1, "", "Params"], [195, 2, 1, "", "SampleSequenceDecode"], [195, 2, 1, "", "UpdateTargetVocabSize"], [195, 2, 1, "", "_CreateProjection"], [195, 2, 1, "", "_DecodeStep"], [195, 5, 1, "", "_FLOAT_DTYPE_MAX_SCALER"], [195, 2, 1, "", "_ForceAlignment"], [195, 2, 1, "", "_GetAttentionInitState"], [195, 2, 1, "", "_InitBeamSearchStateCallback"], [195, 2, 1, "", "_InitDecoder"], [195, 2, 1, "", "_PostBeamSearchStepCallback"], [195, 2, 1, "", "_PreBeamSearchStepCallback"], [195, 2, 1, "", "_SetAttentionInitState"], [195, 2, 1, "", "_UpdateLogitsForSingleTokenFastDecode"], [195, 2, 1, "", "_ZeroOutFirstTimeStep"], [195, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.mt.decoder.TransformerBatchMajorDecoder": [[195, 2, 1, "", "ComputeLoss"], [195, 2, 1, "", "ComputePredictions"], [195, 2, 1, "", "ExtendStep"], [195, 2, 1, "", "Params"], [195, 2, 1, "", "_FProp"], [195, 2, 1, "", "_FPropFastSoftmax"], [195, 2, 1, "", "_InitBeamSearchStateCallback"], [195, 2, 1, "", "_MaybeTransposeEncoderOutputs"], [195, 2, 1, "", "_MaybeTransposeTargets"], [195, 2, 1, "", "_PostBeamSearchStepCallback"], [195, 2, 1, "", "_PreBeamSearchStepCallback"], [195, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.mt.decoder.TransformerDecoder": [[195, 2, 1, "", "AddExtraDecodingInfo"], [195, 2, 1, "", "ComputePredictions"], [195, 2, 1, "", "ExtendStep"], [195, 2, 1, "", "Params"], [195, 2, 1, "", "SampleSequenceDecode"], [195, 2, 1, "", "_AddAttenProbsScalarSummary"], [195, 2, 1, "", "_AddAttenProbsSummary"], [195, 2, 1, "", "_FProp"], [195, 2, 1, "", "_InitBeamSearchStateCallback"], [195, 2, 1, "", "_PostBeamSearchStepCallback"], [195, 2, 1, "", "_PreBeamSearchStepCallback"], [195, 2, 1, "", "_RemoveEOSProbs"], [195, 2, 1, "", "_ZeroOutFirstTimeStep"], [195, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.mt.decoder.TransformerXDecoder": [[195, 2, 1, "", "ComputeLoss"], [195, 2, 1, "", "ComputePredictions"], [195, 2, 1, "", "Params"], [195, 2, 1, "", "_FProp"], [195, 2, 1, "", "_FPropSoftmax"]], "lingvo.tasks.mt.encoder": [[196, 1, 1, "", "MTEncoderBiRNN"], [196, 1, 1, "", "MTEncoderBiRNNPrecomputedEmbedding"], [196, 1, 1, "", "MTEncoderUniRNN"], [196, 1, 1, "", "MTEncoderV1"], [196, 1, 1, "", "TransformerBatchMajorEncoder"], [196, 1, 1, "", "TransformerEncoder"], [196, 1, 1, "", "TransformerXEncoder"]], "lingvo.tasks.mt.encoder.MTEncoderBiRNN": [[196, 2, 1, "", "ApplyClipping"], [196, 2, 1, "", "FProp"], [196, 2, 1, "", "Params"], [196, 2, 1, "", "_ComputeInputs"], [196, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.mt.encoder.MTEncoderBiRNNPrecomputedEmbedding": [[196, 2, 1, "", "_ComputeInputs"]], "lingvo.tasks.mt.encoder.MTEncoderUniRNN": [[196, 2, 1, "", "ApplyClipping"], [196, 2, 1, "", "FProp"], [196, 2, 1, "", "Params"], [196, 2, 1, "", "zero_state"]], "lingvo.tasks.mt.encoder.MTEncoderV1": [[196, 2, 1, "", "ApplyClipping"], [196, 2, 1, "", "FProp"], [196, 2, 1, "", "Params"]], "lingvo.tasks.mt.encoder.TransformerBatchMajorEncoder": [[196, 2, 1, "", "FProp"], [196, 2, 1, "", "Params"], [196, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.mt.encoder.TransformerEncoder": [[196, 2, 1, "", "FProp"], [196, 2, 1, "", "FPropFullSequence"], [196, 2, 1, "", "Params"], [196, 2, 1, "", "_child_variable_scope_override"]], "lingvo.tasks.mt.encoder.TransformerXEncoder": [[196, 2, 1, "", "FProp"]], "lingvo.tasks.mt.input_generator": [[197, 1, 1, "", "MlPerfInput"], [197, 1, 1, "", "NmtDoubleInput"], [197, 1, 1, "", "NmtInput"], [197, 1, 1, "", "TextPackedInput"], [197, 6, 1, "", "_GetDescriptorSetForTextInput"], [197, 6, 1, "", "_GetSegmentPos"]], "lingvo.tasks.mt.input_generator.MlPerfInput": [[197, 2, 1, "", "BuildInputBatch"], [197, 2, 1, "", "Params"], [197, 2, 1, "", "_DataSourceFromFilePattern"]], "lingvo.tasks.mt.input_generator.NmtDoubleInput": [[197, 2, 1, "", "BuildInputBatch"], [197, 2, 1, "", "Params"], [197, 2, 1, "", "_CreateSourceLambdas"], [197, 2, 1, "", "_DataSourceFromFilePattern"], [197, 2, 1, "", "_GenerateNoiseSents"], [197, 2, 1, "", "_MaskWords"], [197, 2, 1, "", "_Pack"], [197, 2, 1, "", "_ProcessBatch"], [197, 2, 1, "", "_SelectMaskPositions"], [197, 2, 1, "", "_ShuffleWords"]], "lingvo.tasks.mt.input_generator.NmtInput": [[197, 2, 1, "", "BuildInputBatch"], [197, 2, 1, "", "Params"], [197, 2, 1, "", "_DataSourceFromFilePattern"]], "lingvo.tasks.mt.input_generator.TextPackedInput": [[197, 2, 1, "", "Params"], [197, 2, 1, "", "_AddNoise"], [197, 2, 1, "", "_ApplyPacking"], [197, 2, 1, "", "_DataSourceFromFilePattern"], [197, 2, 1, "", "_GetBucketKey"], [197, 2, 1, "", "_GetLangIds"], [197, 2, 1, "", "_GetTaskIds"], [197, 2, 1, "", "_Pack"], [197, 2, 1, "", "_ProcessMASSInput"], [197, 2, 1, "", "_ProcessSingleInput"], [197, 2, 1, "", "_ReadRecordSentencePairProto"], [197, 2, 1, "", "_ReadRecordTsv"], [197, 2, 1, "", "_ReadRecordTsvSingleColumn"], [197, 2, 1, "", "_ScaledBatchSize"]], "lingvo.tasks.mt.layers": [[198, 1, 1, "", "TransformerStack"]], "lingvo.tasks.mt.layers.TransformerStack": [[198, 2, 1, "", "FProp"], [198, 2, 1, "", "Params"]], "lingvo.tasks.mt.model": [[199, 1, 1, "", "HybridModel"], [199, 1, 1, "", "InsertionModel"], [199, 1, 1, "", "MTBaseModel"], [199, 1, 1, "", "RNMTModel"], [199, 1, 1, "", "TransformerModel"], [199, 1, 1, "", "TransformerXEnDecModel"]], "lingvo.tasks.mt.model.HybridModel": [[199, 2, 1, "", "Params"]], "lingvo.tasks.mt.model.InsertionModel": [[199, 2, 1, "", "ComputePredictions"], [199, 2, 1, "", "Params"], [199, 2, 1, "", "_CreateCanvasAndTargets"], [199, 2, 1, "", "_SampleCanvasAndTargets"]], "lingvo.tasks.mt.model.MTBaseModel": [[199, 2, 1, "", "ComputeLoss"], [199, 2, 1, "", "ComputePredictions"], [199, 2, 1, "", "CreateDecoderMetrics"], [199, 2, 1, "", "Decode"], [199, 2, 1, "", "PostProcessDecodeOut"], [199, 2, 1, "", "_BeamSearchDecode"], [199, 2, 1, "", "_DecoderDevice"], [199, 2, 1, "", "_EncoderDevice"], [199, 2, 1, "", "_GetTokenizerKeyToUse"], [199, 2, 1, "", "_PostProcessBeamSearchDecodeOut"]], "lingvo.tasks.mt.model.RNMTModel": [[199, 2, 1, "", "Params"]], "lingvo.tasks.mt.model.TransformerModel": [[199, 2, 1, "", "Params"]], "lingvo.tasks.mt.model.TransformerXEnDecModel": [[199, 2, 1, "", "ComputeLoss"], [199, 2, 1, "", "ComputePredictions"], [199, 2, 1, "", "Params"], [199, 2, 1, "", "_CreateTargetLambdas"]], "lingvo.tasks.mt.params": [[201, 0, 0, "-", "params"], [202, 0, 0, "-", "wmt14_en_de"], [203, 0, 0, "-", "wmtm16_en_de"], [204, 0, 0, "-", "xendec"]], "lingvo.tasks.mt.params.wmt14_en_de": [[202, 1, 1, "", "WmtEnDeRNMT"], [202, 1, 1, "", "WmtEnDeRNMTCloudTpu"], [202, 1, 1, "", "WmtEnDeTransformerBase"], [202, 1, 1, "", "WmtEnDeTransformerSmall"], [202, 1, 1, "", "WmtEnDeTransformerSmallCloudTpu"]], "lingvo.tasks.mt.params.wmt14_en_de.WmtEnDeRNMT": [[202, 2, 1, "", "Task"], [202, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.mt.params.wmt14_en_de.WmtEnDeRNMTCloudTpu": [[202, 2, 1, "", "Task"], [202, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.mt.params.wmt14_en_de.WmtEnDeTransformerBase": [[202, 5, 1, "", "DATADIR"], [202, 2, 1, "", "Dev"], [202, 2, 1, "", "Task"], [202, 2, 1, "", "Test"], [202, 2, 1, "", "Train"], [202, 5, 1, "", "VOCAB_SIZE"], [202, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.mt.params.wmt14_en_de.WmtEnDeTransformerSmall": [[202, 2, 1, "", "Task"]], "lingvo.tasks.mt.params.wmt14_en_de.WmtEnDeTransformerSmallCloudTpu": [[202, 2, 1, "", "Task"], [202, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.mt.params.wmtm16_en_de": [[203, 1, 1, "", "WmtCaptionEnDeTransformer"], [203, 1, 1, "", "WmtCaptionEnDeTransformerCloudTpu"]], "lingvo.tasks.mt.params.wmtm16_en_de.WmtCaptionEnDeTransformer": [[203, 5, 1, "", "DATADIR"], [203, 2, 1, "", "Dev"], [203, 2, 1, "", "Task"], [203, 2, 1, "", "Test"], [203, 2, 1, "", "Train"], [203, 5, 1, "", "VOCAB_FILE"], [203, 5, 1, "", "VOCAB_SIZE"], [203, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.mt.params.wmtm16_en_de.WmtCaptionEnDeTransformerCloudTpu": [[203, 2, 1, "", "Task"], [203, 2, 1, "", "_CommonInputParams"]], "lingvo.tasks.mt.params.xendec": [[205, 0, 0, "-", "wmt14_en_de"]], "lingvo.tasks.mt.params.xendec.wmt14_en_de": [[205, 1, 1, "", "WmtDeEnXEnDec"], [205, 1, 1, "", "WmtEnDeXEnDec"]], "lingvo.tasks.mt.params.xendec.wmt14_en_de.WmtDeEnXEnDec": [[205, 5, 1, "", "DATADIR"]], "lingvo.tasks.mt.params.xendec.wmt14_en_de.WmtEnDeXEnDec": [[205, 5, 1, "", "DATADEV"], [205, 5, 1, "", "DATADIR"], [205, 5, 1, "", "DATATEST"], [205, 5, 1, "", "DATATRAIN"], [205, 2, 1, "", "Dev"], [205, 5, 1, "", "PACKED_INPUT"], [205, 2, 1, "", "Task"], [205, 2, 1, "", "Test"], [205, 2, 1, "", "Train"], [205, 5, 1, "", "VOCAB"], [205, 2, 1, "", "_EvalParams"], [205, 5, 1, "", "atten_drop"], [205, 5, 1, "", "atten_dropout_prob"], [205, 5, 1, "", "batch_size_ratio"], [205, 5, 1, "", "hidden_dim"], [205, 5, 1, "", "input_dropout_prob"], [205, 5, 1, "", "learning_rate"], [205, 5, 1, "", "loss_clean_weight"], [205, 5, 1, "", "loss_mix_weight"], [205, 5, 1, "", "loss_mono_weight"], [205, 5, 1, "", "mask_word_id"], [205, 5, 1, "", "mask_words_ratio"], [205, 5, 1, "", "model_dim"], [205, 5, 1, "", "num_heads"], [205, 5, 1, "", "num_samples"], [205, 5, 1, "", "pad_id"], [205, 5, 1, "", "permutation_distance"], [205, 5, 1, "", "relu_dropout_prob"], [205, 5, 1, "", "residual_dropout_prob"], [205, 5, 1, "", "source_mask_ratio"], [205, 5, 1, "", "source_mask_ratio_beta"], [205, 5, 1, "", "use_atten_cl"], [205, 5, 1, "", "use_prob_cl"], [205, 5, 1, "", "use_prob_drop"], [205, 5, 1, "", "vocab_size"], [205, 5, 1, "", "warmup_steps"]], "lingvo.tasks.mt.text_input_pb2": [[206, 1, 1, "", "Sentence"], [206, 1, 1, "", "SentencePair"], [206, 6, 1, "", "_b"]], "lingvo.tasks.mt.text_input_pb2.Sentence": [[206, 5, 1, "", "DESCRIPTOR"], [206, 5, 1, "", "lang"], [206, 5, 1, "", "sentence"]], "lingvo.tasks.mt.text_input_pb2.SentencePair": [[206, 5, 1, "", "DESCRIPTOR"], [206, 5, 1, "", "src_sentence"], [206, 5, 1, "", "tgt_sentence"]], "lingvo.tasks.punctuator": [[209, 0, 0, "-", "input_generator"], [210, 0, 0, "-", "model"], [211, 0, 0, "-", "params"], [214, 0, 0, "-", "tools"]], "lingvo.tasks.punctuator.input_generator": [[209, 1, 1, "", "PunctuatorInput"], [209, 1, 1, "", "TextLines"]], "lingvo.tasks.punctuator.input_generator.PunctuatorInput": [[209, 2, 1, "", "CreateDatasource"], [209, 2, 1, "", "Params"], [209, 2, 1, "", "_GetSequenceLength"], [209, 2, 1, "", "_InputPaddingValue"], [209, 2, 1, "", "_InputShape"], [209, 2, 1, "", "_Process"], [209, 2, 1, "", "_ProcessLine"]], "lingvo.tasks.punctuator.input_generator.TextLines": [[209, 2, 1, "", "GetDataset"], [209, 2, 1, "", "Params"]], "lingvo.tasks.punctuator.model": [[210, 1, 1, "", "RNMTModel"]], "lingvo.tasks.punctuator.model.RNMTModel": [[210, 2, 1, "", "Inference"], [210, 2, 1, "", "_InferenceSubgraph_Default"]], "lingvo.tasks.punctuator.params": [[212, 0, 0, "-", "codelab"], [213, 0, 0, "-", "params"]], "lingvo.tasks.punctuator.params.codelab": [[212, 1, 1, "", "BrownCorpusWPM"], [212, 1, 1, "", "RNMTModel"]], "lingvo.tasks.punctuator.params.codelab.BrownCorpusWPM": [[212, 2, 1, "", "Test"], [212, 2, 1, "", "Train"], [212, 5, 1, "", "_DATADIR"], [212, 5, 1, "", "_VOCAB_FILE"], [212, 5, 1, "", "_VOCAB_SIZE"]], "lingvo.tasks.punctuator.params.codelab.RNMTModel": [[212, 2, 1, "", "Task"]], "lingvo.tasks.punctuator.tools": [[215, 0, 0, "-", "download_brown_corpus"]], "lingvo.tasks.punctuator.tools.download_brown_corpus": [[215, 6, 1, "", "main"]], "lingvo.tools": [[217, 0, 0, "-", "audio_lib"], [218, 0, 0, "-", "beam_utils"], [219, 0, 0, "-", "bpe_word_tokenizer"], [220, 0, 0, "-", "compare_params"], [221, 0, 0, "-", "compute_stats"], [222, 0, 0, "-", "count_records"], [223, 0, 0, "-", "create_asr_features"], [224, 0, 0, "-", "gke_launch"], [225, 0, 0, "-", "keras2ckpt"], [226, 0, 0, "-", "print_tf_records"], [227, 0, 0, "-", "wpm_encode_file"]], "lingvo.tools.audio_lib": [[217, 6, 1, "", "AudioToMfcc"], [217, 6, 1, "", "DecodeFlacToWav"], [217, 6, 1, "", "DecodeWav"], [217, 6, 1, "", "ExtractLogMelFeatures"]], "lingvo.tools.beam_utils": [[218, 6, 1, "", "BeamInit"], [218, 6, 1, "", "GetEmitterFn"], [218, 6, 1, "", "GetPipelineRoot"], [218, 6, 1, "", "GetReader"], [218, 6, 1, "", "GetWriter"]], "lingvo.tools.bpe_word_tokenizer": [[219, 6, 1, "", "_ExtractTokenization"], [219, 6, 1, "", "_GetVocabulary"], [219, 6, 1, "", "main"]], "lingvo.tools.compare_params": [[220, 6, 1, "", "_hyperparams_text_to_dict"], [220, 6, 1, "", "get_model_params_as_text"], [220, 6, 1, "", "hyperparams_text_diff"], [220, 6, 1, "", "print_hyperparams_text_diff"]], "lingvo.tools.compute_stats": [[221, 1, 1, "", "StatsCollector"], [221, 6, 1, "", "main"]], "lingvo.tools.compute_stats.StatsCollector": [[221, 2, 1, "", "Accumulate"], [221, 2, 1, "", "Print"], [221, 2, 1, "", "_AccumulateMoments"], [221, 2, 1, "", "_ComputeMeanVar"], [221, 2, 1, "", "_PrintLengthBuckets"], [221, 2, 1, "", "_PrintMeanVar"]], "lingvo.tools.count_records": [[222, 6, 1, "", "main"]], "lingvo.tools.create_asr_features": [[223, 6, 1, "", "_CloseSubShards"], [223, 6, 1, "", "_CreateAsrFeatures"], [223, 6, 1, "", "_DumpTranscripts"], [223, 6, 1, "", "_LoadTranscriptionsFromFile"], [223, 6, 1, "", "_MakeBytesFeature"], [223, 6, 1, "", "_MakeFloatFeature"], [223, 6, 1, "", "_MakeInt64Feature"], [223, 6, 1, "", "_MakeLogMelFromTensorflowBuiltin"], [223, 6, 1, "", "_MakeTfExample"], [223, 6, 1, "", "_OpenSubShards"], [223, 6, 1, "", "_ReadTranscriptions"], [223, 6, 1, "", "_SelectRandomShard"], [223, 6, 1, "", "main"]], "lingvo.tools.gke_launch": [[224, 6, 1, "", "_get_or_add"], [224, 6, 1, "", "_tpu_resource"], [224, 6, 1, "", "add_gpu_to_pod"], [224, 6, 1, "", "build_docker_image"], [224, 6, 1, "", "create_tpu_cluster"], [224, 6, 1, "", "decoder_template"], [224, 6, 1, "", "get_gke_cluster"], [224, 6, 1, "", "main"], [224, 6, 1, "", "set_pod_cpu_memory"], [224, 6, 1, "", "tensorboard_template"], [224, 6, 1, "", "tpu_training_template"], [224, 6, 1, "", "validate_args"]], "lingvo.tools.keras2ckpt": [[225, 6, 1, "", "main"]], "lingvo.tools.print_tf_records": [[226, 6, 1, "", "_CustomShortDebugString"], [226, 6, 1, "", "_ListDebugString"], [226, 6, 1, "", "_PrintFiles"], [226, 6, 1, "", "_PrintHeader"], [226, 6, 1, "", "main"]], "lingvo.tools.wpm_encode_file": [[227, 6, 1, "", "_AssertTextFormat"], [227, 6, 1, "", "_MakeBytesFeature"], [227, 6, 1, "", "_MakeFloatFeature"], [227, 6, 1, "", "_MakeInt64Feature"], [227, 6, 1, "", "_MakeTfExample"], [227, 6, 1, "", "_Preprocess"], [227, 6, 1, "", "_RunEncoding"], [227, 6, 1, "", "main"]], "lingvo.trainer": [[228, 1, 1, "", "RunnerManager"], [228, 6, 1, "", "_GetClusterSpecDict"], [228, 6, 1, "", "_ValidateVizierReportingJob"], [228, 6, 1, "", "main"]], "lingvo.trainer.RunnerManager": [[228, 1, 1, "", "Controller"], [228, 2, 1, "", "CreateRunners"], [228, 3, 1, "", "Decoder"], [228, 3, 1, "", "Evaler"], [228, 1, 1, "", "ExecutorTpu"], [228, 2, 1, "", "GetExecutorParams"], [228, 2, 1, "", "GetParamsForDataset"], [228, 2, 1, "", "InspectDatasets"], [228, 2, 1, "", "InspectDecoder"], [228, 2, 1, "", "InspectModel"], [228, 2, 1, "", "InspectParams"], [228, 2, 1, "", "MaybeConfigCloudTpu"], [228, 2, 1, "", "MaybeConfigRunDistributed"], [228, 2, 1, "", "MaybeConfigRunLocally"], [228, 2, 1, "", "MaybeLaunchTensorFlow"], [228, 2, 1, "", "RunEvalerOnce"], [228, 2, 1, "", "RunTrial"], [228, 2, 1, "", "SetModelName"], [228, 2, 1, "", "Start"], [228, 2, 1, "", "StartRunners"], [228, 1, 1, "", "TrainSummaries"], [228, 3, 1, "", "Trainer"], [228, 1, 1, "", "TrainerTpu"], [228, 2, 1, "", "UpdateClusterParamsFromFlags"], [228, 2, 1, "", "WriteInferenceGraph"], [228, 2, 1, "", "_CreateRunner"], [228, 5, 1, "", "inference_graph_exporter"], [228, 5, 1, "", "model_registry"]], "lingvo.trainer.RunnerManager.Controller": [[228, 2, 1, "", "Start"], [228, 2, 1, "", "StartEnqueueOp"], [228, 2, 1, "", "_Loop"], [228, 2, 1, "", "_SummarizeValue"]], "lingvo.trainer.RunnerManager.ExecutorTpu": [[228, 2, 1, "", "Start"], [228, 2, 1, "", "_GetSession"], [228, 2, 1, "", "_Loop"], [228, 2, 1, "", "_MaybeConstructSharedModel"]], "lingvo.trainer.RunnerManager.TrainSummaries": [[228, 2, 1, "", "Start"]], "lingvo.trainer.RunnerManager.TrainerTpu": [[228, 2, 1, "", "Start"], [228, 2, 1, "", "StartEnqueueOp"], [228, 2, 1, "", "_CleanUp"], [228, 2, 1, "", "_GetSession"], [228, 2, 1, "", "_InfeedLoop"], [228, 2, 1, "", "_Loop"], [228, 2, 1, "", "_LoopEnqueue"], [228, 2, 1, "", "_OutfeedDequeueLoop"], [228, 2, 1, "", "_OutfeedEnqueue"], [228, 2, 1, "", "_SummarizeValue"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:property", "4": "py:exception", "5": "py:attribute", "6": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "property", "Python property"], "4": ["py", "exception", "Python exception"], "5": ["py", "attribute", "Python attribute"], "6": ["py", "function", "Python function"]}, "titleterms": {"welcom": 0, "lingvo": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230], "": 0, "document": 0, "indic": 0, "tabl": 0, "packag": [1, 5, 71, 103, 132, 133, 150, 153, 159, 169, 192, 207, 208, 214, 216], "subpackag": [1, 5, 132, 133, 153, 159, 172, 192, 200, 208], "submodul": [1, 5, 71, 103, 133, 147, 150, 153, 156, 159, 163, 169, 172, 180, 187, 192, 200, 204, 208, 211, 214, 216], "base_runn": 2, "modul": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 148, 149, 151, 152, 154, 155, 157, 158, 160, 161, 162, 164, 165, 166, 167, 168, 170, 171, 173, 174, 175, 176, 177, 178, 179, 181, 182, 183, 184, 185, 186, 188, 189, 190, 191, 193, 194, 195, 196, 197, 198, 199, 201, 202, 203, 205, 206, 209, 210, 212, 213, 215, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "base_tri": 3, "compat": 4, "core": [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122], "activ": 6, "adagraft": 7, "attent": 8, "attention_util": 9, "base_decod": 10, "base_input_gener": 11, "base_lay": 12, "base_model": 13, "base_model_param": 14, "batch_major_attent": 15, "batch_util": 16, "beam_search_help": 17, "bfloat16_vari": 18, "bn_layer": 19, "build_data": 20, "builder": 21, "builder_lay": 22, "checkpoint": 23, "cluster": 24, "cluster_factori": 25, "computation_cost": 26, "conformer_lay": 27, "constant": [28, 174], "conv_layers_build": 29, "conv_layers_with_time_pad": 30, "datasourc": 31, "datasource_tfd": 32, "decoder_lib": 33, "differentiable_assign": 34, "distillation_task": 35, "distributed_shampoo": 36, "early_stop": 37, "egdd": 38, "entmax": 39, "favor_attent": 40, "flat_beam_search_help": 41, "generic_input": 42, "gpipe": 43, "graddrop": 44, "gradient_combin": 45, "gshard_build": 46, "gshard_decod": 47, "gshard_lay": 48, "gshard_util": 49, "hyperparam": 50, "hyperparams_pb2": 51, "inference_graph_export": 52, "inference_graph_pb2": 53, "input_generator_help": 54, "input_polici": 55, "insert": 56, "inspect_util": 57, "layer": [58, 161, 198], "layers_with_attent": 59, "layers_with_gpip": 60, "learner": 61, "lstm_frnn_layer": 62, "matrix_funct": 63, "metric": 64, "ml_perf_bleu_metr": 65, "ml_perf_log": 66, "ml_perf_token": 67, "model_help": 68, "multitask_model": 69, "nested_map": 70, "op": [71, 72, 73, 74, 75], "hyps_pb2": 72, "record_pb2": 73, "versioned_file_set_pb2": 74, "x_op": 75, "optim": 76, "plot": 77, "predictor": 78, "predictor_runner_bas": 79, "program": 80, "program_util": 81, "pruning_util": 82, "py_util": 83, "py_utils_flag": 84, "quant_test_lib": 85, "quant_util": 86, "recurr": 87, "repeat_lay": 88, "retri": 89, "reversible_lay": 90, "rnn_cell": 91, "rnn_layer": 92, "routing_config_help": 93, "saver": 94, "scatter_upd": 95, "schedul": 96, "scorer": 97, "self_attention_lay": 98, "sendrecv": 99, "spectrum_augment": 100, "spectrum_augmenter_on_devic": 101, "step": [102, 103, 104, 105, 106], "attention_step": 104, "embedding_step": 105, "rnn_step": 106, "stream_step_test_bas": 107, "summary_util": 108, "symbol": 109, "target_sequence_sampl": 110, "task_schedul": 111, "test_help": 112, "test_trainer_util": 113, "test_util": 114, "thread_local_util": 115, "token": [116, 168], "tpu_embedding_lay": 117, "tpu_summari": 118, "trainer_test_util": 119, "tshape": 120, "var_tmp_wrapp": 121, "wpm_encod": 122, "dataset": 123, "eager_runn": 124, "executor": 125, "ipython_kernel": 126, "model_import": 127, "model_registri": 128, "models_test_help": 129, "pdb_wrapper": 130, "runner": 131, "task": [132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215], "asr": [133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152], "contextualizer_bas": 134, "decod": [135, 195], "decoder_metr": 136, "decoder_util": 137, "encod": [138, 196], "eos_norm": 139, "frontend": 140, "fusion": 141, "input_gener": [142, 155, 160, 178, 197, 209], "levenshtein_dist": 143, "metrics_calcul": 144, "model": [145, 162, 199, 210], "model_test_input_gener": 146, "param": [147, 148, 149, 156, 157, 158, 163, 164, 165, 166, 167, 180, 181, 182, 183, 184, 200, 201, 202, 203, 204, 205, 211, 212, 213], "namespac": [147, 156, 163, 172, 180, 187, 200, 204, 211], "librispeech": 148, "tool": [150, 151, 152, 169, 170, 171, 187, 188, 207, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227], "simple_w": 151, "simple_wer_v2": 152, "imag": [153, 154, 155, 156, 157, 158], "classifi": 154, "mnist": 157, "lm": [159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171], "one_billion_wd": 164, "synthetic_packed_input": 166, "wiki_bert": 167, "download_lm1b": 170, "gshard_lm_decod": 171, "milan": [172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191], "common_schema": 173, "dataset_spec": 175, "dual_encod": 176, "image_preprocessor": 177, "label": 179, "function": 179, "cxc": 181, "dual_encoder_recip": 182, "generic_dataset": 183, "score_funct": 185, "tf_hub_lay": 186, "prepare_coco": 188, "tpu_util": 189, "transform": 190, "util": 191, "mt": [192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207], "base_config": 193, "data_augment": 194, "wmt14_en_d": [202, 205], "wmtm16_en_d": 203, "xendec": [204, 205], "text_input_pb2": 206, "punctuat": [208, 209, 210, 211, 212, 213, 214, 215], "codelab": 212, "download_brown_corpu": 215, "audio_lib": 217, "beam_util": 218, "bpe_word_token": 219, "compare_param": 220, "compute_stat": 221, "count_record": 222, "create_asr_featur": 223, "gke_launch": 224, "keras2ckpt": 225, "print_tf_record": 226, "wpm_encode_fil": 227, "trainer": 228, "trainer_util": 229}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})